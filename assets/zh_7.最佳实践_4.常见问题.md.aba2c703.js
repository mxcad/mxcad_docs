import{_ as s,a,b as n,c as l,d as o,e as p,f as e,g as t,h as c,i as r}from"./chunks/读取扩展数据.62bf7d9e.js";import{_ as y,o as F,c as D,V as C}from"./chunks/framework.24f0af87.js";const g=JSON.parse('{"title":"常见问题","description":"","frontmatter":{},"headers":[],"relativePath":"zh/7.最佳实践/4.常见问题.md","filePath":"zh/7.最佳实践/4.常见问题.md"}'),i={name:"zh/7.最佳实践/4.常见问题.md"},A=C(`<h1 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h1><h2 id="图纸" tabindex="-1">图纸 <a class="header-anchor" href="#图纸" aria-label="Permalink to &quot;图纸&quot;">​</a></h2><h3 id="_1-图纸无法显示" tabindex="-1">1.图纸无法显示 <a class="header-anchor" href="#_1-图纸无法显示" aria-label="Permalink to &quot;1.图纸无法显示&quot;">​</a></h3><p>尽量保证mxcad和mxdraw以及<a href="https://www.mxdraw.com/download.html" target="_blank" rel="noreferrer">MxDraw云图开发包</a>是最新版本，</p><p>出现图纸无法显示且浏览器控制台没有报错，一般情况都是版本问题。</p><p>更新到最新版本:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxcad@latest</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxdraw@latest</span></span></code></pre></div><h3 id="_2-图纸显示错误" tabindex="-1">2.图纸显示错误 <a class="header-anchor" href="#_2-图纸显示错误" aria-label="Permalink to &quot;2.图纸显示错误&quot;">​</a></h3><p>如果你在打开我们提供的转换后的示例图纸打开是正常的,但是你自己转换的图纸无法显示部分或者根本不显示。</p><p>那么你可以多转换几张图纸, 如果只是这张图纸有问题，那么可能是转换程序对该图纸支持不完善，你可以将这张图纸发给客服，便于我们修复这个问题。</p><h3 id="_3-mxcad集成项目中-如何修改默认打开的图纸" tabindex="-1">3.mxcad集成项目中，如何修改默认打开的图纸 <a class="header-anchor" href="#_3-mxcad集成项目中-如何修改默认打开的图纸" aria-label="Permalink to &quot;3.mxcad集成项目中，如何修改默认打开的图纸&quot;">​</a></h3><p>可以通过 iframe 的 src 属性进行 query 传参<code>{file:&#39;目标图纸&#39;}</code>，如下所示：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:3000/mxcad?file=empty_template.mxweb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="_4-修改图纸精度" tabindex="-1">4.修改图纸精度 <a class="header-anchor" href="#_4-修改图纸精度" aria-label="Permalink to &quot;4.修改图纸精度&quot;">​</a></h3><p>在 mxcad 中打开 mxweb 图纸时，会出现图形显示精度不够导致图形偏差的情况。如：图纸上的圆显示为多边形，这是因为在图纸初始化时它的显示精度是一个经验值，mxcad 会根据圆的大小来确定它的显示精度。</p><p>解决方案1：调用重绘方法，重新调整图纸显示精度。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mxcad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 调用重绘命令</span></span>
<span class="line"><span style="color:#A6ACCD;">MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentMxCAD</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">regen</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>解决方案2：在 mxcad 项目初始化时，手动设定显示精度值（0~1000）。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mxcad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 设置对象的显示精度</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> mxcad </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentMxCAD</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setAttribute</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">DisplayPrecision</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">900</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="_5-文字显示" tabindex="-1">5.文字显示 <a class="header-anchor" href="#_5-文字显示" aria-label="Permalink to &quot;5.文字显示&quot;">​</a></h3><p>在 mxcad 中加载 mxweb 图纸时，会出现图纸文字乱码的问题。如：打开图纸，图纸上的部分文字或所有文字均显示为“？”，这是因为 mxcad 的字体文件加载路径<code>fontspath</code>下并没有找到图纸上文字对应的目标字体文件。</p><p>解决方案1：将图纸上的所有未加载相应字体文件的字体，全部转成 mxcad 项目中已经加载了字体文件的字体。</p><p>解决方案2：将图纸上缺少的字体文件放入 mxcad 的字体文件加载路径<code>fontspath</code>下。</p><p><img src="`+s+`" alt="添加字体文件"></p><h2 id="图块" tabindex="-1">图块 <a class="header-anchor" href="#图块" aria-label="Permalink to &quot;图块&quot;">​</a></h2><h3 id="_1-一个图块多次插入-改变其中一个其它的图块随之改变" tabindex="-1">1.一个图块多次插入，改变其中一个其它的图块随之改变 <a class="header-anchor" href="#_1-一个图块多次插入-改变其中一个其它的图块随之改变" aria-label="Permalink to &quot;1.一个图块多次插入，改变其中一个其它的图块随之改变&quot;">​</a></h3><p>CAD的图块功能，它默认采用的是引用的方式，因此其中一个改变其他图块也会跟着一起改变。你如果不想采用引用的方式插入图块，可以直接修改图块名。</p><p>以引用的方式使用图块就比较节约内存，如果不使用引用的方式的话，你有100个图块，相当于就有100个内存不同的名字。</p><h3 id="_2-获取目标图块详情" tabindex="-1">2.获取目标图块详情 <a class="header-anchor" href="#_2-获取目标图块详情" aria-label="Permalink to &quot;2.获取目标图块详情&quot;">​</a></h3><p>我们可以通过调用 CAD 图块引用实体 McDbBlockReference() 中的 <a href="https://www.mxdraw3d.com/mxcad_docs/api/classes/2d.McDbBlockReference.html#getallattribute" target="_blank" rel="noreferrer">getAllAttribute()</a> 方法得到块引用的所有属性文字对象id，然后通过对象id获取到图块中的实体详情。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">McDbBlockReference</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">McDbAttribute</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mxcad</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对象选择事件</span></span>
<span class="line"><span style="color:#A6ACCD;">MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentMxCAD</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">get</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">selectChange</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">ids</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">McObjectId</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">ids</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ids</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mxent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMxDbEntity</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMcDbEntity</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">ent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">ent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">instanceof</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">McDbBlockReference</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blkRef</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">McDbBlockReference</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ent</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">aryId</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blkRef</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getAllAttribute</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">aryId</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">attribt</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">McDbAttribute</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMcDbEntity</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">attribt</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">textString</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">attribt</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tag</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h2 id="图层" tabindex="-1">图层 <a class="header-anchor" href="#图层" aria-label="Permalink to &quot;图层&quot;">​</a></h2><h3 id="_1-对象过滤" tabindex="-1">1.对象过滤 <a class="header-anchor" href="#_1-对象过滤" aria-label="Permalink to &quot;1.对象过滤&quot;">​</a></h3><p>在CAD中，图层允许用户将图形对象组织到不同的层中，以便于管理和编辑。每个图层都有其独特的特性，如颜色、线型、线宽等，这些特性决定了图层上对象的显示方式。我们可以通过设置 <a href="https://www.mxdraw3d.com/mxcad_docs/api/classes/2d.MxCADResbuf.html#class-mxcadresbuf" target="_blank" rel="noreferrer">MxCADResbuf</a> 过滤器来实现图层上的对象过滤。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCADSelectionSet</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mxcad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> ss </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MxCADSelectionSet</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 得到图上，直线，圆，圆弧，多义线，在0层上的对象.</span></span>
<span class="line"><span style="color:#A6ACCD;">ss</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">allSelect</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MxCADResbuf</span><span style="color:#A6ACCD;">([DxfCode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">kEntityType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LINE,ARC,CIRCLE,LWPOLYLINE</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">DxfCode</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">kLayer</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">]))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">得到对象数目:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> ss</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">())</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h2 id="更新版本" tabindex="-1">更新版本 <a class="header-anchor" href="#更新版本" aria-label="Permalink to &quot;更新版本&quot;">​</a></h2><p>运行项目调用API的过程中可能出现调用不成功或报错：is not a function 等，这些都是由于调用的mxcad中的API为最新版本，而项目中的 mxcad 版本未更新，因此需保证项目中的 mxcad 和 mxdraw 均为最新版本。</p><p>清除项目缓存和清除浏览器缓存后，先卸载再重新安装。其中，清除浏览器缓存可参考下面操作：</p><p><img src="`+a+`" alt="Alt text"></p><p>清除项目缓存可通过运行命令，以 npm 为例：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cache</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">clean</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--force</span></span></code></pre></div><p>卸载 mxcad 和 mxdraw，并下载最新版本的 mxcad 和 mxdraw 。以 npm 为示例：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uni</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxcad</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxdraw</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">i</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxcad@latest</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mxdraw@latest</span></span></code></pre></div><p>更新完成后，可通过查看依赖包的版本号是否与 npm 库的最新版本相同。 <img src="`+n+'" alt="Alt text"></p><p>或者，查看运行起来的项目日志中打印的版本号是否与<a href="https://demo.mxdraw3d.com:3000/mxcad/" target="_blank" rel="noreferrer">在线demo</a>日志中打印的版本号一致 <img src="'+l+'" alt="Alt text"></p><h2 id="mxcad-app应用集成" tabindex="-1">MxCAD APP应用集成 <a class="header-anchor" href="#mxcad-app应用集成" aria-label="Permalink to &quot;MxCAD APP应用集成&quot;">​</a></h2><h3 id="_1-如何修改app的ui界面" tabindex="-1">1.如何修改APP的UI界面 <a class="header-anchor" href="#_1-如何修改app的ui界面" aria-label="Permalink to &quot;1.如何修改APP的UI界面&quot;">​</a></h3><ol><li><p>若只是在原有 MxCAD App 界面的基础上简单修改页面布局可参考 <a href="https://www.mxdraw3d.com/mxcad_docs/zh/7.%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/1.MxCAD%20APP%E5%BA%94%E7%94%A8%E9%9B%86%E6%88%90.html#mxcad-app%E5%9C%A8%E7%BA%BFcad-%E9%85%8D%E5%88%B6%E8%AF%B4%E6%98%8E" target="_blank" rel="noreferrer">MxCAD APP在线CAD 配制说明</a> ,根据自身需求修改 mxUiConfig.json 文件来配置界面。</p></li><li><p>若想要自定义界面，可以在项目中实现自己的UI，然后根据ID、类、属性等定位到目标位置插入你自己的UI。</p></li></ol><ul><li><p>在项目中绘制UI界面 <img src="'+o+'" alt="Alt text"></p></li><li><p>将绘制好的UI界面插入目标位置 <img src="'+p+`" alt="Alt text"></p></li></ul><p>此外，你也可以直接创建元素插入到目标位置，其中，该目标位置需要自己取获取，拿到它对应的元素后把你写的元素或者组件插入进去。</p><h3 id="_2-如何修改文字字体" tabindex="-1">2.如何修改文字字体 <a class="header-anchor" href="#_2-如何修改文字字体" aria-label="Permalink to &quot;2.如何修改文字字体&quot;">​</a></h3><p>在项目初始化时通过 <a href="https://www.mxdraw3d.com/mxcad_docs/api/classes/2d.McAppType.html#addnetworkloadingtruetypefont" target="_blank" rel="noreferrer">MxCpp.App.addNetworkLoadingTrueTypeFont()</a> 方法来设置我们系统需要加载哪些字体，方便后面我们修改字体时加载使用。</p><p>然后获取文字实体，最后将该文字的 textStyle 属性设置为目标文字字体样式。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxFun</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mxdraw</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mxcad</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// MxCAD创建成功</span></span>
<span class="line"><span style="color:#A6ACCD;">MxFun</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mxcadApplicationCreatedMxCADObject</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">param</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// addNetworkLoadingTrueTypeFont([字体名],[字体中文名],[字体文件])</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">App</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addNetworkLoadingTrueTypeFont</span><span style="color:#F07178;">([</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">simsun</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syadobe</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">思原宋体</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">思原黑体</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stadobe.otf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syadobe.otf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 修改文字样式</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Mx_Test_TrueText</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCurrentMxCAD</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//清空当前显示内容</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">newFile</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">MxCpp</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">App</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loadFonts</span><span style="color:#F07178;">([]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syadobe</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">simsun</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 添加一个黑体文字样式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddTureTypeTextStyle</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ht_style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syadobe</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 添加一个宋体文字样式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddTureTypeTextStyle</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">st_style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">simsun</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 设置当前样式为黑体</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">drawTextStyle</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ht_style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">drawColor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">McCmColor</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">255</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">50</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idText</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">drawText</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3500</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">绘图控件TrueType文字测试</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">idText</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMcDbEntity</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 修改文字样式为宋体</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ent</span><span style="color:#F07178;">) </span><span style="color:#A6ACCD;">ent</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">textStyle</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">st_style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zoomAll</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">regen</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">mxcad</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">updateDisplay</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="_3-添加字体文件" tabindex="-1">3.添加字体文件 <a class="header-anchor" href="#_3-添加字体文件" aria-label="Permalink to &quot;3.添加字体文件&quot;">​</a></h3><p>mxcad 项目中存储了一些常用的字体文件，但我们经常会遇到一些目标图纸需要加载自己特需的字体文件。这种图纸在 mxcad 项目中初次打开的时候会出现文本样式与AutoCAD中的展示有偏差、字体文本显示为“？”、或字体样式不符合预期等情况。</p><p>我们可以将目标字体文件拷贝到云图开发包的<code>MxDrawCloudServer\\Bin\\MxCAD\\Release\\fonts</code> 目录下，在 mxcad 项目中添加上图纸需要的目标字体文件。</p><p><img src="`+e+'" alt="Alt text"></p><h3 id="_4-更新图纸水印显示" tabindex="-1">4.更新图纸水印显示 <a class="header-anchor" href="#_4-更新图纸水印显示" aria-label="Permalink to &quot;4.更新图纸水印显示&quot;">​</a></h3><p>我们在修改图纸水印后会提供修改水印后的云图开发包，在该开发包中的MxCAD项目中打开项目能够直接看到图纸水印修改后的样子。若用户需要在其他MxCAD项目中使用修改的水印效果，则需要替换 mxcad 依赖包中的 wasm 文件夹下的相关文件，其具体操作如下：</p><ol><li>解压修改水印后的云图开发包，找到<code>MxDrawCloudServer\\SRC\\TsWeb\\public\\mxcad\\assets</code>目录。</li><li>将上述目录下的 js文件、wasm文件等分别拷贝到目标项目的 mxcad 依赖包下的 wasm 中。</li></ol><ul><li>选中<code>MxDrawCloudServer\\SRC\\TsWeb\\public\\mxcad\\assets</code>目录下的 <code>mxdrawassembly_min.js</code> 、 <code>mxdrawassembly_min.wasm</code> 、<code>mxdrawassembly_min.worker.js</code> 三个文件拷贝进目标项目的 <code>\\node_modules\\mxcad\\dist\\wasm\\2d</code> 文件夹下；再将 <code>mxdrawassembly_min.js</code>、 <code>mxdrawassembly_minst.wasm</code> 两个文件拷贝进目标项目的 <code>\\node_modules\\mxcad\\dist\\wasm\\2d-st</code> 文件夹下。其中，拷贝的文件命名中会有一串hash码，在放入<code>2d</code>文件夹下时需将文件重命名去除中间的hash码。 <img src="'+t+'" alt="Alt text"><img src="'+c+'" alt="Alt text"></li><li>替换文件后，删除目标项目中<code>node_modules</code>文件夹下的所有缓存文件，如<code>.vite</code>文件夹下的所有文件（可直接删除<code>.vite </code>文件夹），再清除浏览器中缓存。</li><li>重新启动项目，查看效果。</li></ul><div class="tip custom-block"><p class="custom-block-title">注意</p><p><code>MxDrawCloudServer\\SRC\\TsWeb\\public\\mxcad\\assets</code>目录下有两个<code>mxdrawassembly_min.js</code>文件，这两个文件名中的hash码不同，文件大小也有差异。这两个文件需要分别拷贝到对应的<code>2d</code>和<code>2d-st</code>文件夹中。通常情况下，<code>2d</code>文件夹下的<code>mxdrawassembly_min.js</code>文件体积会偏大一点，在替换的时候需要注意。</p></div><h3 id="_5-设置加载扩展数据" tabindex="-1">5.设置加载扩展数据 <a class="header-anchor" href="#_5-设置加载扩展数据" aria-label="Permalink to &quot;5.设置加载扩展数据&quot;">​</a></h3><p>在通过云图开发包启动node.js后台服务，打开dwg图纸时可能会出现无法读取图纸内扩展数据的情况。这是因为为了提高程序转换图纸的速率，我们默认在打开dwg文件时不加载扩展数据。如果你需要在加载图纸后能够读取扩展数据，则需要将<code>MxDrawCloudServer\\Bin\\MxCAD\\Release</code>目录下的<code>mxcad_ini.json</code>文件种的<code>read_exdata</code>属性设置为<code>true</code>，并重启服务。清理缓存或不使用缓存打开图纸后就能够读取图纸中的扩展数据了。</p><p><img src="'+r+'" alt="Alt text"></p><h2 id="其他" tabindex="-1">其他 <a class="header-anchor" href="#其他" aria-label="Permalink to &quot;其他&quot;">​</a></h2><h3 id="_1-对象id句柄使用说明" tabindex="-1">1.对象ID句柄使用说明 <a class="header-anchor" href="#_1-对象id句柄使用说明" aria-label="Permalink to &quot;1.对象ID句柄使用说明&quot;">​</a></h3><p>ID和句柄都用来标识一个对象，ID是一个64位长整型变量，是一个内存地址，访问速度最快，但它每次打开都不一样，如果需要把一个对象的标识存起来，下次又能找到对象，就需要使用句柄，句柄是一个字符串变量，它保证不管什么时候总是不会变化,句柄在DWG图纸中是唯一存在，ID是内存中唯一存在。</p>',69),d=[A];function m(h,u,x,b,f,_){return F(),D("div",null,d)}const w=y(i,[["render",m]]);export{g as __pageData,w as default};
