class PubSub{constructor(){this.events={}}on(r,o){let a=this;a.events.hasOwnProperty(r)||(a.events[r]=[]),a.events[r].push(o)}emit(r,...o){this.events.hasOwnProperty(r)&&this.events[r].map(a=>a(...o))}off(r,o){if(this.events[r])if(o===void 0)this.events[r]=[];else{const a=this.events[r].indexOf(o);this.events[r].splice(a,1)}}}class Store{constructor(r){let o=this;o.actions={},o.mutations={},o.state=r.state,o.status="resting",o.events=new PubSub,r.hasOwnProperty("actions")&&(o.actions=r.actions),r.hasOwnProperty("mutations")&&(o.mutations=r.mutations)}dispatch(r,o){let a=this;return typeof a.actions[r]=="function"&&(console.groupCollapsed(`ACTION: ${r}`),a.status="action",a.actions[r](a,o),console.groupEnd(),!0)}commit(r,o){let a=this;if(typeof a.mutations[r]!="function")return console.log(`Mutation "${r}" doesn't exist`),!1;a.status="mutation";let v=a.mutations[r](a.state,o);return a.state=Object.assign(a.state,v),!0}}const options={state:{MxFun:null,Mxassembly:null,isCreateDrawObj:!1},actions:{},mutations:{}};for(let b in options.state){const r=b.charAt(0).toUpperCase()+b.slice(1);options.mutations["set"+r]=(o,a)=>{o[b]=a}}const store=new Store(options);function mxfun(){(function b(r,o,a){function v(L,G){if(!o[L]){if(!r[L]){var k=typeof require=="function"&&require;if(!G&&k)return k(L,!0);if(h)return h(L,!0);var D=new Error("Cannot find module '"+L+"'");throw D.code="MODULE_NOT_FOUND",D}var f=o[L]={exports:{}};r[L][0].call(f.exports,function(O){return v(r[L][1][O]||O)},f,f.exports,b,r,o,a)}return o[L].exports}for(var h=typeof require=="function"&&require,w=0;w<a.length;w++)v(a[w]);return v})({1:[function(b,r,o){var a={};(0,b("./lib/utils/common").assign)(a,b("./lib/deflate"),b("./lib/inflate"),b("./lib/zlib/constants")),r.exports=a},{"./lib/deflate":2,"./lib/inflate":3,"./lib/utils/common":4,"./lib/zlib/constants":7}],2:[function(b,r,o){var a=b("./zlib/deflate"),v=b("./utils/common"),h=b("./utils/strings"),w=b("./zlib/messages"),L=b("./zlib/zstream"),G=Object.prototype.toString,k=0,D=-1,f=0,O=8;function C(V){if(!(this instanceof C))return new C(V);this.options=v.assign({level:D,method:O,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},V||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L,this.strm.avail_out=0;var M=a.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(M!==k)throw new Error(w[M]);if(R.header&&a.deflateSetHeader(this.strm,R.header),R.dictionary){var ee;if(ee=typeof R.dictionary=="string"?h.string2buf(R.dictionary):G.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(M=a.deflateSetDictionary(this.strm,ee))!==k)throw new Error(w[M]);this._dict_set=!0}}function j(V,R){var M=new C(R);if(M.push(V,!0),M.err)throw M.msg||w[M.err];return M.result}C.prototype.push=function(V,R){var M,ee,F=this.strm,_=this.options.chunkSize;if(this.ended)return!1;ee=R===~~R?R:R===!0?4:0,typeof V=="string"?F.input=h.string2buf(V):G.call(V)==="[object ArrayBuffer]"?F.input=new Uint8Array(V):F.input=V,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new v.Buf8(_),F.next_out=0,F.avail_out=_),(M=a.deflate(F,ee))!==1&&M!==k)return this.onEnd(M),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||ee!==4&&ee!==2)||(this.options.to==="string"?this.onData(h.buf2binstring(v.shrinkBuf(F.output,F.next_out))):this.onData(v.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&M!==1);return ee===4?(M=a.deflateEnd(this.strm),this.onEnd(M),this.ended=!0,M===k):ee!==2||(this.onEnd(k),!(F.avail_out=0))},C.prototype.onData=function(V){this.chunks.push(V)},C.prototype.onEnd=function(V){V===k&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},o.Deflate=C,o.deflate=j,o.deflateRaw=function(V,R){return(R=R||{}).raw=!0,j(V,R)},o.gzip=function(V,R){return(R=R||{}).gzip=!0,j(V,R)}},{"./utils/common":4,"./utils/strings":5,"./zlib/deflate":9,"./zlib/messages":14,"./zlib/zstream":16}],3:[function(b,r,o){var a=b("./zlib/inflate"),v=b("./utils/common"),h=b("./utils/strings"),w=b("./zlib/constants"),L=b("./zlib/messages"),G=b("./zlib/zstream"),k=b("./zlib/gzheader"),D=Object.prototype.toString;function f(C){if(!(this instanceof f))return new f(C);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},C||{});var j=this.options;j.raw&&0<=j.windowBits&&j.windowBits<16&&(j.windowBits=-j.windowBits,j.windowBits===0&&(j.windowBits=-15)),!(0<=j.windowBits&&j.windowBits<16)||C&&C.windowBits||(j.windowBits+=32),15<j.windowBits&&j.windowBits<48&&!(15&j.windowBits)&&(j.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new G,this.strm.avail_out=0;var V=a.inflateInit2(this.strm,j.windowBits);if(V!==w.Z_OK)throw new Error(L[V]);if(this.header=new k,a.inflateGetHeader(this.strm,this.header),j.dictionary&&(typeof j.dictionary=="string"?j.dictionary=h.string2buf(j.dictionary):D.call(j.dictionary)==="[object ArrayBuffer]"&&(j.dictionary=new Uint8Array(j.dictionary)),j.raw&&(V=a.inflateSetDictionary(this.strm,j.dictionary))!==w.Z_OK))throw new Error(L[V])}function O(C,j){var V=new f(j);if(V.push(C,!0),V.err)throw V.msg||L[V.err];return V.result}f.prototype.push=function(C,j){var V,R,M,ee,F,_=this.strm,J=this.options.chunkSize,T=this.options.dictionary,B=!1;if(this.ended)return!1;R=j===~~j?j:j===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof C=="string"?_.input=h.binstring2buf(C):D.call(C)==="[object ArrayBuffer]"?_.input=new Uint8Array(C):_.input=C,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new v.Buf8(J),_.next_out=0,_.avail_out=J),(V=a.inflate(_,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&T&&(V=a.inflateSetDictionary(this.strm,T)),V===w.Z_BUF_ERROR&&B===!0&&(V=w.Z_OK,B=!1),V!==w.Z_STREAM_END&&V!==w.Z_OK)return this.onEnd(V),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&V!==w.Z_STREAM_END&&(_.avail_in!==0||R!==w.Z_FINISH&&R!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(M=h.utf8border(_.output,_.next_out),ee=_.next_out-M,F=h.buf2string(_.output,M),_.next_out=ee,_.avail_out=J-ee,ee&&v.arraySet(_.output,_.output,M,ee,0),this.onData(F)):this.onData(v.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(B=!0)}while((0<_.avail_in||_.avail_out===0)&&V!==w.Z_STREAM_END);return V===w.Z_STREAM_END&&(R=w.Z_FINISH),R===w.Z_FINISH?(V=a.inflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===w.Z_OK):R!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(_.avail_out=0))},f.prototype.onData=function(C){this.chunks.push(C)},f.prototype.onEnd=function(C){C===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg},o.Inflate=f,o.inflate=O,o.inflateRaw=function(C,j){return(j=j||{}).raw=!0,O(C,j)},o.ungzip=O},{"./utils/common":4,"./utils/strings":5,"./zlib/constants":7,"./zlib/gzheader":10,"./zlib/inflate":12,"./zlib/messages":14,"./zlib/zstream":16}],4:[function(b,r,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(w){for(var L,G,k=Array.prototype.slice.call(arguments,1);k.length;){var D=k.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var f in D)L=D,G=f,Object.prototype.hasOwnProperty.call(L,G)&&(w[f]=D[f])}}return w},o.shrinkBuf=function(w,L){return w.length===L?w:w.subarray?w.subarray(0,L):(w.length=L,w)};var v={arraySet:function(w,L,G,k,D){if(L.subarray&&w.subarray)w.set(L.subarray(G,G+k),D);else for(var f=0;f<k;f++)w[D+f]=L[G+f]},flattenChunks:function(w){var L,G,k,D,f,O;for(L=k=0,G=w.length;L<G;L++)k+=w[L].length;for(O=new Uint8Array(k),L=D=0,G=w.length;L<G;L++)f=w[L],O.set(f,D),D+=f.length;return O}},h={arraySet:function(w,L,G,k,D){for(var f=0;f<k;f++)w[D+f]=L[G+f]},flattenChunks:function(w){return[].concat.apply([],w)}};o.setTyped=function(w){w?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,v)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,h))},o.setTyped(a)},{}],5:[function(b,r,o){var a=b("./common"),v=!0,h=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{h=!1}for(var w=new a.Buf8(256),L=0;L<256;L++)w[L]=252<=L?6:248<=L?5:240<=L?4:224<=L?3:192<=L?2:1;function G(k,D){if(D<65534&&(k.subarray&&h||!k.subarray&&v))return String.fromCharCode.apply(null,a.shrinkBuf(k,D));for(var f="",O=0;O<D;O++)f+=String.fromCharCode(k[O]);return f}w[254]=w[254]=1,o.string2buf=function(k){var D,f,O,C,j,V=k.length,R=0;for(C=0;C<V;C++)(64512&(f=k.charCodeAt(C)))==55296&&C+1<V&&(64512&(O=k.charCodeAt(C+1)))==56320&&(f=65536+(f-55296<<10)+(O-56320),C++),R+=f<128?1:f<2048?2:f<65536?3:4;for(D=new a.Buf8(R),C=j=0;j<R;C++)(64512&(f=k.charCodeAt(C)))==55296&&C+1<V&&(64512&(O=k.charCodeAt(C+1)))==56320&&(f=65536+(f-55296<<10)+(O-56320),C++),f<128?D[j++]=f:(f<2048?D[j++]=192|f>>>6:(f<65536?D[j++]=224|f>>>12:(D[j++]=240|f>>>18,D[j++]=128|f>>>12&63),D[j++]=128|f>>>6&63),D[j++]=128|63&f);return D},o.buf2binstring=function(k){return G(k,k.length)},o.binstring2buf=function(k){for(var D=new a.Buf8(k.length),f=0,O=D.length;f<O;f++)D[f]=k.charCodeAt(f);return D},o.buf2string=function(k,D){var f,O,C,j,V=D||k.length,R=new Array(2*V);for(f=O=0;f<V;)if((C=k[f++])<128)R[O++]=C;else if(4<(j=w[C]))R[O++]=65533,f+=j-1;else{for(C&=j===2?31:j===3?15:7;1<j&&f<V;)C=C<<6|63&k[f++],j--;1<j?R[O++]=65533:C<65536?R[O++]=C:(C-=65536,R[O++]=55296|C>>10&1023,R[O++]=56320|1023&C)}return G(R,O)},o.utf8border=function(k,D){var f;for((D=D||k.length)>k.length&&(D=k.length),f=D-1;0<=f&&(192&k[f])==128;)f--;return!(f<0)&&f!==0&&f+w[k[f]]>D?f:D}},{"./common":4}],6:[function(b,r,o){r.exports=function(a,v,h,w){for(var L=65535&a|0,G=a>>>16&65535|0,k=0;h!==0;){for(h-=k=2e3<h?2e3:h;G=G+(L=L+v[w++]|0)|0,--k;);L%=65521,G%=65521}return L|G<<16|0}},{}],7:[function(b,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],8:[function(b,r,o){var a=function(){for(var v,h=[],w=0;w<256;w++){v=w;for(var L=0;L<8;L++)v=1&v?3988292384^v>>>1:v>>>1;h[w]=v}return h}();r.exports=function(v,h,w,L){var G=a,k=L+w;v^=-1;for(var D=L;D<k;D++)v=v>>>8^G[255&(v^h[D])];return-1^v}},{}],9:[function(b,r,o){var a,v=b("../utils/common"),h=b("./trees"),w=b("./adler32"),L=b("./crc32"),G=b("./messages"),k=0,D=0,f=-2,O=2,C=8,j=286,V=30,R=19,M=2*j+1,ee=15,F=3,_=258,J=_+F+1,T=42,B=113;function N(q,ge){return q.msg=G[ge],ge}function u(q){return(q<<1)-(4<q?9:0)}function c(q){for(var ge=q.length;0<=--ge;)q[ge]=0}function m(q){var ge=q.state,oe=ge.pending;oe>q.avail_out&&(oe=q.avail_out),oe!==0&&(v.arraySet(q.output,ge.pending_buf,ge.pending_out,oe,q.next_out),q.next_out+=oe,ge.pending_out+=oe,q.total_out+=oe,q.avail_out-=oe,ge.pending-=oe,ge.pending===0&&(ge.pending_out=0))}function E(q,ge){h._tr_flush_block(q,0<=q.block_start?q.block_start:-1,q.strstart-q.block_start,ge),q.block_start=q.strstart,m(q.strm)}function U(q,ge){q.pending_buf[q.pending++]=ge}function X(q,ge){q.pending_buf[q.pending++]=ge>>>8&255,q.pending_buf[q.pending++]=255&ge}function W(q,ge){var oe,se,Ae=q.max_chain_length,Ye=q.strstart,Ge=q.prev_length,Ne=q.nice_match,le=q.strstart>q.w_size-J?q.strstart-(q.w_size-J):0,ve=q.window,He=q.w_mask,nt=q.prev,ht=q.strstart+_,Tt=ve[Ye+Ge-1],Ct=ve[Ye+Ge];q.prev_length>=q.good_match&&(Ae>>=2),Ne>q.lookahead&&(Ne=q.lookahead);do if(ve[(oe=ge)+Ge]===Ct&&ve[oe+Ge-1]===Tt&&ve[oe]===ve[Ye]&&ve[++oe]===ve[Ye+1]){Ye+=2,oe++;do;while(ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&ve[++Ye]===ve[++oe]&&Ye<ht);if(se=_-(ht-Ye),Ye=ht-_,Ge<se){if(q.match_start=ge,Ne<=(Ge=se))break;Tt=ve[Ye+Ge-1],Ct=ve[Ye+Ge]}}while((ge=nt[ge&He])>le&&--Ae!=0);return Ge<=q.lookahead?Ge:q.lookahead}function te(q){var ge,oe,se,Ae,Ye,Ge,Ne,le,ve,He,nt=q.w_size;do{if(Ae=q.window_size-q.lookahead-q.strstart,q.strstart>=nt+(nt-J)){for(v.arraySet(q.window,q.window,nt,nt,0),q.match_start-=nt,q.strstart-=nt,q.block_start-=nt,ge=oe=q.hash_size;se=q.head[--ge],q.head[ge]=nt<=se?se-nt:0,--oe;);for(ge=oe=nt;se=q.prev[--ge],q.prev[ge]=nt<=se?se-nt:0,--oe;);Ae+=nt}if(q.strm.avail_in===0)break;if(Ge=q.strm,Ne=q.window,le=q.strstart+q.lookahead,He=void 0,(ve=Ae)<(He=Ge.avail_in)&&(He=ve),oe=He===0?0:(Ge.avail_in-=He,v.arraySet(Ne,Ge.input,Ge.next_in,He,le),Ge.state.wrap===1?Ge.adler=w(Ge.adler,Ne,He,le):Ge.state.wrap===2&&(Ge.adler=L(Ge.adler,Ne,He,le)),Ge.next_in+=He,Ge.total_in+=He,He),q.lookahead+=oe,q.lookahead+q.insert>=F)for(Ye=q.strstart-q.insert,q.ins_h=q.window[Ye],q.ins_h=(q.ins_h<<q.hash_shift^q.window[Ye+1])&q.hash_mask;q.insert&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[Ye+F-1])&q.hash_mask,q.prev[Ye&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=Ye,Ye++,q.insert--,!(q.lookahead+q.insert<F)););}while(q.lookahead<J&&q.strm.avail_in!==0)}function ne(q,ge){for(var oe,se;;){if(q.lookahead<J){if(te(q),q.lookahead<J&&ge===k)return 1;if(q.lookahead===0)break}if(oe=0,q.lookahead>=F&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+F-1])&q.hash_mask,oe=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),oe!==0&&q.strstart-oe<=q.w_size-J&&(q.match_length=W(q,oe)),q.match_length>=F)if(se=h._tr_tally(q,q.strstart-q.match_start,q.match_length-F),q.lookahead-=q.match_length,q.match_length<=q.max_lazy_match&&q.lookahead>=F){for(q.match_length--;q.strstart++,q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+F-1])&q.hash_mask,oe=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart,--q.match_length!=0;);q.strstart++}else q.strstart+=q.match_length,q.match_length=0,q.ins_h=q.window[q.strstart],q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+1])&q.hash_mask;else se=h._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++;if(se&&(E(q,!1),q.strm.avail_out===0))return 1}return q.insert=q.strstart<F-1?q.strstart:F-1,ge===4?(E(q,!0),q.strm.avail_out===0?3:4):q.last_lit&&(E(q,!1),q.strm.avail_out===0)?1:2}function ce(q,ge){for(var oe,se,Ae;;){if(q.lookahead<J){if(te(q),q.lookahead<J&&ge===k)return 1;if(q.lookahead===0)break}if(oe=0,q.lookahead>=F&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+F-1])&q.hash_mask,oe=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),q.prev_length=q.match_length,q.prev_match=q.match_start,q.match_length=F-1,oe!==0&&q.prev_length<q.max_lazy_match&&q.strstart-oe<=q.w_size-J&&(q.match_length=W(q,oe),q.match_length<=5&&(q.strategy===1||q.match_length===F&&4096<q.strstart-q.match_start)&&(q.match_length=F-1)),q.prev_length>=F&&q.match_length<=q.prev_length){for(Ae=q.strstart+q.lookahead-F,se=h._tr_tally(q,q.strstart-1-q.prev_match,q.prev_length-F),q.lookahead-=q.prev_length-1,q.prev_length-=2;++q.strstart<=Ae&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+F-1])&q.hash_mask,oe=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),--q.prev_length!=0;);if(q.match_available=0,q.match_length=F-1,q.strstart++,se&&(E(q,!1),q.strm.avail_out===0))return 1}else if(q.match_available){if((se=h._tr_tally(q,0,q.window[q.strstart-1]))&&E(q,!1),q.strstart++,q.lookahead--,q.strm.avail_out===0)return 1}else q.match_available=1,q.strstart++,q.lookahead--}return q.match_available&&(se=h._tr_tally(q,0,q.window[q.strstart-1]),q.match_available=0),q.insert=q.strstart<F-1?q.strstart:F-1,ge===4?(E(q,!0),q.strm.avail_out===0?3:4):q.last_lit&&(E(q,!1),q.strm.avail_out===0)?1:2}function we(q,ge,oe,se,Ae){this.good_length=q,this.max_lazy=ge,this.nice_length=oe,this.max_chain=se,this.func=Ae}function Ie(q){var ge;return q&&q.state?(q.total_in=q.total_out=0,q.data_type=O,(ge=q.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?T:B,q.adler=ge.wrap===2?0:1,ge.last_flush=k,h._tr_init(ge),D):N(q,f)}function xe(q){var ge,oe=Ie(q);return oe===D&&((ge=q.state).window_size=2*ge.w_size,c(ge.head),ge.max_lazy_match=a[ge.level].max_lazy,ge.good_match=a[ge.level].good_length,ge.nice_match=a[ge.level].nice_length,ge.max_chain_length=a[ge.level].max_chain,ge.strstart=0,ge.block_start=0,ge.lookahead=0,ge.insert=0,ge.match_length=ge.prev_length=F-1,ge.match_available=0,ge.ins_h=0),oe}function Be(q,ge,oe,se,Ae,Ye){if(!q)return f;var Ge=1;if(ge===-1&&(ge=6),se<0?(Ge=0,se=-se):15<se&&(Ge=2,se-=16),Ae<1||9<Ae||oe!==C||se<8||15<se||ge<0||9<ge||Ye<0||4<Ye)return N(q,f);se===8&&(se=9);var Ne=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(2*M),this.dyn_dtree=new v.Buf16(2*(2*V+1)),this.bl_tree=new v.Buf16(2*(2*R+1)),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(ee+1),this.heap=new v.Buf16(2*j+1),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(2*j+1),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return(q.state=Ne).strm=q,Ne.wrap=Ge,Ne.gzhead=null,Ne.w_bits=se,Ne.w_size=1<<Ne.w_bits,Ne.w_mask=Ne.w_size-1,Ne.hash_bits=Ae+7,Ne.hash_size=1<<Ne.hash_bits,Ne.hash_mask=Ne.hash_size-1,Ne.hash_shift=~~((Ne.hash_bits+F-1)/F),Ne.window=new v.Buf8(2*Ne.w_size),Ne.head=new v.Buf16(Ne.hash_size),Ne.prev=new v.Buf16(Ne.w_size),Ne.lit_bufsize=1<<Ae+6,Ne.pending_buf_size=4*Ne.lit_bufsize,Ne.pending_buf=new v.Buf8(Ne.pending_buf_size),Ne.d_buf=+Ne.lit_bufsize,Ne.l_buf=3*Ne.lit_bufsize,Ne.level=ge,Ne.strategy=Ye,Ne.method=oe,xe(q)}a=[new we(0,0,0,0,function(q,ge){var oe=65535;for(oe>q.pending_buf_size-5&&(oe=q.pending_buf_size-5);;){if(q.lookahead<=1){if(te(q),q.lookahead===0&&ge===k)return 1;if(q.lookahead===0)break}q.strstart+=q.lookahead,q.lookahead=0;var se=q.block_start+oe;if((q.strstart===0||q.strstart>=se)&&(q.lookahead=q.strstart-se,q.strstart=se,E(q,!1),q.strm.avail_out===0)||q.strstart-q.block_start>=q.w_size-J&&(E(q,!1),q.strm.avail_out===0))return 1}return q.insert=0,ge===4?(E(q,!0),q.strm.avail_out===0?3:4):(q.strstart>q.block_start&&(E(q,!1),q.strm.avail_out),1)}),new we(4,4,8,4,ne),new we(4,5,16,8,ne),new we(4,6,32,32,ne),new we(4,4,16,16,ce),new we(8,16,32,32,ce),new we(8,16,128,128,ce),new we(8,32,128,256,ce),new we(32,128,258,1024,ce),new we(32,258,258,4096,ce)],o.deflateInit=function(q,ge){return Be(q,ge,C,15,8,0)},o.deflateInit2=Be,o.deflateReset=xe,o.deflateResetKeep=Ie,o.deflateSetHeader=function(q,ge){return q&&q.state&&q.state.wrap===2?(q.state.gzhead=ge,D):f},o.deflate=function(q,ge){var oe,se,Ae,Ye;if(!q||!q.state||5<ge||ge<0)return q?N(q,f):f;if(se=q.state,!q.output||!q.input&&q.avail_in!==0||se.status===666&&ge!==4)return N(q,q.avail_out===0?-5:f);if(se.strm=q,oe=se.last_flush,se.last_flush=ge,se.status===T)if(se.wrap===2)q.adler=0,U(se,31),U(se,139),U(se,8),se.gzhead?(U(se,(se.gzhead.text?1:0)+(se.gzhead.hcrc?2:0)+(se.gzhead.extra?4:0)+(se.gzhead.name?8:0)+(se.gzhead.comment?16:0)),U(se,255&se.gzhead.time),U(se,se.gzhead.time>>8&255),U(se,se.gzhead.time>>16&255),U(se,se.gzhead.time>>24&255),U(se,se.level===9?2:2<=se.strategy||se.level<2?4:0),U(se,255&se.gzhead.os),se.gzhead.extra&&se.gzhead.extra.length&&(U(se,255&se.gzhead.extra.length),U(se,se.gzhead.extra.length>>8&255)),se.gzhead.hcrc&&(q.adler=L(q.adler,se.pending_buf,se.pending,0)),se.gzindex=0,se.status=69):(U(se,0),U(se,0),U(se,0),U(se,0),U(se,0),U(se,se.level===9?2:2<=se.strategy||se.level<2?4:0),U(se,3),se.status=B);else{var Ge=C+(se.w_bits-8<<4)<<8;Ge|=(2<=se.strategy||se.level<2?0:se.level<6?1:se.level===6?2:3)<<6,se.strstart!==0&&(Ge|=32),Ge+=31-Ge%31,se.status=B,X(se,Ge),se.strstart!==0&&(X(se,q.adler>>>16),X(se,65535&q.adler)),q.adler=1}if(se.status===69)if(se.gzhead.extra){for(Ae=se.pending;se.gzindex<(65535&se.gzhead.extra.length)&&(se.pending!==se.pending_buf_size||(se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),m(q),Ae=se.pending,se.pending!==se.pending_buf_size));)U(se,255&se.gzhead.extra[se.gzindex]),se.gzindex++;se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),se.gzindex===se.gzhead.extra.length&&(se.gzindex=0,se.status=73)}else se.status=73;if(se.status===73)if(se.gzhead.name){Ae=se.pending;do{if(se.pending===se.pending_buf_size&&(se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),m(q),Ae=se.pending,se.pending===se.pending_buf_size)){Ye=1;break}Ye=se.gzindex<se.gzhead.name.length?255&se.gzhead.name.charCodeAt(se.gzindex++):0,U(se,Ye)}while(Ye!==0);se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),Ye===0&&(se.gzindex=0,se.status=91)}else se.status=91;if(se.status===91)if(se.gzhead.comment){Ae=se.pending;do{if(se.pending===se.pending_buf_size&&(se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),m(q),Ae=se.pending,se.pending===se.pending_buf_size)){Ye=1;break}Ye=se.gzindex<se.gzhead.comment.length?255&se.gzhead.comment.charCodeAt(se.gzindex++):0,U(se,Ye)}while(Ye!==0);se.gzhead.hcrc&&se.pending>Ae&&(q.adler=L(q.adler,se.pending_buf,se.pending-Ae,Ae)),Ye===0&&(se.status=103)}else se.status=103;if(se.status===103&&(se.gzhead.hcrc?(se.pending+2>se.pending_buf_size&&m(q),se.pending+2<=se.pending_buf_size&&(U(se,255&q.adler),U(se,q.adler>>8&255),q.adler=0,se.status=B)):se.status=B),se.pending!==0){if(m(q),q.avail_out===0)return se.last_flush=-1,D}else if(q.avail_in===0&&u(ge)<=u(oe)&&ge!==4)return N(q,-5);if(se.status===666&&q.avail_in!==0)return N(q,-5);if(q.avail_in!==0||se.lookahead!==0||ge!==k&&se.status!==666){var Ne=se.strategy===2?function(le,ve){for(var He;;){if(le.lookahead===0&&(te(le),le.lookahead===0)){if(ve===k)return 1;break}if(le.match_length=0,He=h._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,He&&(E(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,ve===4?(E(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(E(le,!1),le.strm.avail_out===0)?1:2}(se,ge):se.strategy===3?function(le,ve){for(var He,nt,ht,Tt,Ct=le.window;;){if(le.lookahead<=_){if(te(le),le.lookahead<=_&&ve===k)return 1;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=F&&0<le.strstart&&(nt=Ct[ht=le.strstart-1])===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]){Tt=le.strstart+_;do;while(nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&nt===Ct[++ht]&&ht<Tt);le.match_length=_-(Tt-ht),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=F?(He=h._tr_tally(le,1,le.match_length-F),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(He=h._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),He&&(E(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,ve===4?(E(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(E(le,!1),le.strm.avail_out===0)?1:2}(se,ge):a[se.level].func(se,ge);if(Ne!==3&&Ne!==4||(se.status=666),Ne===1||Ne===3)return q.avail_out===0&&(se.last_flush=-1),D;if(Ne===2&&(ge===1?h._tr_align(se):ge!==5&&(h._tr_stored_block(se,0,0,!1),ge===3&&(c(se.head),se.lookahead===0&&(se.strstart=0,se.block_start=0,se.insert=0))),m(q),q.avail_out===0))return se.last_flush=-1,D}return ge!==4?D:se.wrap<=0?1:(se.wrap===2?(U(se,255&q.adler),U(se,q.adler>>8&255),U(se,q.adler>>16&255),U(se,q.adler>>24&255),U(se,255&q.total_in),U(se,q.total_in>>8&255),U(se,q.total_in>>16&255),U(se,q.total_in>>24&255)):(X(se,q.adler>>>16),X(se,65535&q.adler)),m(q),0<se.wrap&&(se.wrap=-se.wrap),se.pending!==0?D:1)},o.deflateEnd=function(q){var ge;return q&&q.state?(ge=q.state.status)!==T&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==B&&ge!==666?N(q,f):(q.state=null,ge===B?N(q,-3):D):f},o.deflateSetDictionary=function(q,ge){var oe,se,Ae,Ye,Ge,Ne,le,ve,He=ge.length;if(!q||!q.state||(Ye=(oe=q.state).wrap)===2||Ye===1&&oe.status!==T||oe.lookahead)return f;for(Ye===1&&(q.adler=w(q.adler,ge,He,0)),oe.wrap=0,He>=oe.w_size&&(Ye===0&&(c(oe.head),oe.strstart=0,oe.block_start=0,oe.insert=0),ve=new v.Buf8(oe.w_size),v.arraySet(ve,ge,He-oe.w_size,oe.w_size,0),ge=ve,He=oe.w_size),Ge=q.avail_in,Ne=q.next_in,le=q.input,q.avail_in=He,q.next_in=0,q.input=ge,te(oe);oe.lookahead>=F;){for(se=oe.strstart,Ae=oe.lookahead-(F-1);oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[se+F-1])&oe.hash_mask,oe.prev[se&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=se,se++,--Ae;);oe.strstart=se,oe.lookahead=F-1,te(oe)}return oe.strstart+=oe.lookahead,oe.block_start=oe.strstart,oe.insert=oe.lookahead,oe.lookahead=0,oe.match_length=oe.prev_length=F-1,oe.match_available=0,q.next_in=Ne,q.input=le,q.avail_in=Ge,oe.wrap=Ye,D},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":4,"./adler32":6,"./crc32":8,"./messages":14,"./trees":15}],10:[function(b,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],11:[function(b,r,o){r.exports=function(a,v){var h,w,L,G,k,D,f,O,C,j,V,R,M,ee,F,_,J,T,B,N,u,c,m,E,U;h=a.state,w=a.next_in,E=a.input,L=w+(a.avail_in-5),G=a.next_out,U=a.output,k=G-(v-a.avail_out),D=G+(a.avail_out-257),f=h.dmax,O=h.wsize,C=h.whave,j=h.wnext,V=h.window,R=h.hold,M=h.bits,ee=h.lencode,F=h.distcode,_=(1<<h.lenbits)-1,J=(1<<h.distbits)-1;e:do{M<15&&(R+=E[w++]<<M,M+=8,R+=E[w++]<<M,M+=8),T=ee[R&_];t:for(;;){if(R>>>=B=T>>>24,M-=B,(B=T>>>16&255)==0)U[G++]=65535&T;else{if(!(16&B)){if(!(64&B)){T=ee[(65535&T)+(R&(1<<B)-1)];continue t}if(32&B){h.mode=12;break e}a.msg="invalid literal/length code",h.mode=30;break e}N=65535&T,(B&=15)&&(M<B&&(R+=E[w++]<<M,M+=8),N+=R&(1<<B)-1,R>>>=B,M-=B),M<15&&(R+=E[w++]<<M,M+=8,R+=E[w++]<<M,M+=8),T=F[R&J];n:for(;;){if(R>>>=B=T>>>24,M-=B,!(16&(B=T>>>16&255))){if(!(64&B)){T=F[(65535&T)+(R&(1<<B)-1)];continue n}a.msg="invalid distance code",h.mode=30;break e}if(u=65535&T,M<(B&=15)&&(R+=E[w++]<<M,(M+=8)<B&&(R+=E[w++]<<M,M+=8)),f<(u+=R&(1<<B)-1)){a.msg="invalid distance too far back",h.mode=30;break e}if(R>>>=B,M-=B,(B=G-k)<u){if(C<(B=u-B)&&h.sane){a.msg="invalid distance too far back",h.mode=30;break e}if(m=V,(c=0)===j){if(c+=O-B,B<N){for(N-=B;U[G++]=V[c++],--B;);c=G-u,m=U}}else if(j<B){if(c+=O+j-B,(B-=j)<N){for(N-=B;U[G++]=V[c++],--B;);if(c=0,j<N){for(N-=B=j;U[G++]=V[c++],--B;);c=G-u,m=U}}}else if(c+=j-B,B<N){for(N-=B;U[G++]=V[c++],--B;);c=G-u,m=U}for(;2<N;)U[G++]=m[c++],U[G++]=m[c++],U[G++]=m[c++],N-=3;N&&(U[G++]=m[c++],1<N&&(U[G++]=m[c++]))}else{for(c=G-u;U[G++]=U[c++],U[G++]=U[c++],U[G++]=U[c++],2<(N-=3););N&&(U[G++]=U[c++],1<N&&(U[G++]=U[c++]))}break}}break}}while(w<L&&G<D);w-=N=M>>3,R&=(1<<(M-=N<<3))-1,a.next_in=w,a.next_out=G,a.avail_in=w<L?L-w+5:5-(w-L),a.avail_out=G<D?D-G+257:257-(G-D),h.hold=R,h.bits=M}},{}],12:[function(b,r,o){var a=b("../utils/common"),v=b("./adler32"),h=b("./crc32"),w=b("./inffast"),L=b("./inftrees"),G=0,k=-2,D=1,f=852,O=592;function C(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function V(N){var u;return N&&N.state?(u=N.state,N.total_in=N.total_out=u.total=0,N.msg="",u.wrap&&(N.adler=1&u.wrap),u.mode=D,u.last=0,u.havedict=0,u.dmax=32768,u.head=null,u.hold=0,u.bits=0,u.lencode=u.lendyn=new a.Buf32(f),u.distcode=u.distdyn=new a.Buf32(O),u.sane=1,u.back=-1,G):k}function R(N){var u;return N&&N.state?((u=N.state).wsize=0,u.whave=0,u.wnext=0,V(N)):k}function M(N,u){var c,m;return N&&N.state?(m=N.state,u<0?(c=0,u=-u):(c=1+(u>>4),u<48&&(u&=15)),u&&(u<8||15<u)?k:(m.window!==null&&m.wbits!==u&&(m.window=null),m.wrap=c,m.wbits=u,R(N))):k}function ee(N,u){var c,m;return N?(m=new j,(N.state=m).window=null,(c=M(N,u))!==G&&(N.state=null),c):k}var F,_,J=!0;function T(N){if(J){var u;for(F=new a.Buf32(512),_=new a.Buf32(32),u=0;u<144;)N.lens[u++]=8;for(;u<256;)N.lens[u++]=9;for(;u<280;)N.lens[u++]=7;for(;u<288;)N.lens[u++]=8;for(L(1,N.lens,0,288,F,0,N.work,{bits:9}),u=0;u<32;)N.lens[u++]=5;L(2,N.lens,0,32,_,0,N.work,{bits:5}),J=!1}N.lencode=F,N.lenbits=9,N.distcode=_,N.distbits=5}function B(N,u,c,m){var E,U=N.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new a.Buf8(U.wsize)),m>=U.wsize?(a.arraySet(U.window,u,c-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(m<(E=U.wsize-U.wnext)&&(E=m),a.arraySet(U.window,u,c-m,E,U.wnext),(m-=E)?(a.arraySet(U.window,u,c-m,m,0),U.wnext=m,U.whave=U.wsize):(U.wnext+=E,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=E))),0}o.inflateReset=R,o.inflateReset2=M,o.inflateResetKeep=V,o.inflateInit=function(N){return ee(N,15)},o.inflateInit2=ee,o.inflate=function(N,u){var c,m,E,U,X,W,te,ne,ce,we,Ie,xe,Be,q,ge,oe,se,Ae,Ye,Ge,Ne,le,ve,He,nt=0,ht=new a.Buf8(4),Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return k;(c=N.state).mode===12&&(c.mode=13),X=N.next_out,E=N.output,te=N.avail_out,U=N.next_in,m=N.input,W=N.avail_in,ne=c.hold,ce=c.bits,we=W,Ie=te,le=G;e:for(;;)switch(c.mode){case D:if(c.wrap===0){c.mode=13;break}for(;ce<16;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(2&c.wrap&&ne===35615){ht[c.check=0]=255&ne,ht[1]=ne>>>8&255,c.check=h(c.check,ht,2,0),ce=ne=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&ne)<<8)+(ne>>8))%31){N.msg="incorrect header check",c.mode=30;break}if((15&ne)!=8){N.msg="unknown compression method",c.mode=30;break}if(ce-=4,Ne=8+(15&(ne>>>=4)),c.wbits===0)c.wbits=Ne;else if(Ne>c.wbits){N.msg="invalid window size",c.mode=30;break}c.dmax=1<<Ne,N.adler=c.check=1,c.mode=512&ne?10:12,ce=ne=0;break;case 2:for(;ce<16;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(c.flags=ne,(255&c.flags)!=8){N.msg="unknown compression method",c.mode=30;break}if(57344&c.flags){N.msg="unknown header flags set",c.mode=30;break}c.head&&(c.head.text=ne>>8&1),512&c.flags&&(ht[0]=255&ne,ht[1]=ne>>>8&255,c.check=h(c.check,ht,2,0)),ce=ne=0,c.mode=3;case 3:for(;ce<32;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.head&&(c.head.time=ne),512&c.flags&&(ht[0]=255&ne,ht[1]=ne>>>8&255,ht[2]=ne>>>16&255,ht[3]=ne>>>24&255,c.check=h(c.check,ht,4,0)),ce=ne=0,c.mode=4;case 4:for(;ce<16;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.head&&(c.head.xflags=255&ne,c.head.os=ne>>8),512&c.flags&&(ht[0]=255&ne,ht[1]=ne>>>8&255,c.check=h(c.check,ht,2,0)),ce=ne=0,c.mode=5;case 5:if(1024&c.flags){for(;ce<16;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.length=ne,c.head&&(c.head.extra_len=ne),512&c.flags&&(ht[0]=255&ne,ht[1]=ne>>>8&255,c.check=h(c.check,ht,2,0)),ce=ne=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&(W<(xe=c.length)&&(xe=W),xe&&(c.head&&(Ne=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),a.arraySet(c.head.extra,m,U,xe,Ne)),512&c.flags&&(c.check=h(c.check,m,xe,U)),W-=xe,U+=xe,c.length-=xe),c.length))break e;c.length=0,c.mode=7;case 7:if(2048&c.flags){if(W===0)break e;for(xe=0;Ne=m[U+xe++],c.head&&Ne&&c.length<65536&&(c.head.name+=String.fromCharCode(Ne)),Ne&&xe<W;);if(512&c.flags&&(c.check=h(c.check,m,xe,U)),W-=xe,U+=xe,Ne)break e}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if(W===0)break e;for(xe=0;Ne=m[U+xe++],c.head&&Ne&&c.length<65536&&(c.head.comment+=String.fromCharCode(Ne)),Ne&&xe<W;);if(512&c.flags&&(c.check=h(c.check,m,xe,U)),W-=xe,U+=xe,Ne)break e}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;ce<16;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(ne!==(65535&c.check)){N.msg="header crc mismatch",c.mode=30;break}ce=ne=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),N.adler=c.check=0,c.mode=12;break;case 10:for(;ce<32;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}N.adler=c.check=C(ne),ce=ne=0,c.mode=11;case 11:if(c.havedict===0)return N.next_out=X,N.avail_out=te,N.next_in=U,N.avail_in=W,c.hold=ne,c.bits=ce,2;N.adler=c.check=1,c.mode=12;case 12:if(u===5||u===6)break e;case 13:if(c.last){ne>>>=7&ce,ce-=7&ce,c.mode=27;break}for(;ce<3;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}switch(c.last=1&ne,--ce,3&(ne>>>=1)){case 0:c.mode=14;break;case 1:if(T(c),c.mode=20,u!==6)break;ne>>>=2,ce-=2;break e;case 2:c.mode=17;break;case 3:N.msg="invalid block type",c.mode=30}ne>>>=2,ce-=2;break;case 14:for(ne>>>=7&ce,ce-=7&ce;ce<32;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if((65535&ne)!=(ne>>>16^65535)){N.msg="invalid stored block lengths",c.mode=30;break}if(c.length=65535&ne,ce=ne=0,c.mode=15,u===6)break e;case 15:c.mode=16;case 16:if(xe=c.length){if(W<xe&&(xe=W),te<xe&&(xe=te),xe===0)break e;a.arraySet(E,m,U,xe,X),W-=xe,U+=xe,te-=xe,X+=xe,c.length-=xe;break}c.mode=12;break;case 17:for(;ce<14;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(c.nlen=257+(31&ne),ne>>>=5,ce-=5,c.ndist=1+(31&ne),ne>>>=5,ce-=5,c.ncode=4+(15&ne),ne>>>=4,ce-=4,286<c.nlen||30<c.ndist){N.msg="too many length or distance symbols",c.mode=30;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;ce<3;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.lens[Tt[c.have++]]=7&ne,ne>>>=3,ce-=3}for(;c.have<19;)c.lens[Tt[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,ve={bits:c.lenbits},le=L(0,c.lens,0,19,c.lencode,0,c.work,ve),c.lenbits=ve.bits,le){N.msg="invalid code lengths set",c.mode=30;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;oe=(nt=c.lencode[ne&(1<<c.lenbits)-1])>>>16&255,se=65535&nt,!((ge=nt>>>24)<=ce);){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(se<16)ne>>>=ge,ce-=ge,c.lens[c.have++]=se;else{if(se===16){for(He=ge+2;ce<He;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(ne>>>=ge,ce-=ge,c.have===0){N.msg="invalid bit length repeat",c.mode=30;break}Ne=c.lens[c.have-1],xe=3+(3&ne),ne>>>=2,ce-=2}else if(se===17){for(He=ge+3;ce<He;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}ce-=ge,Ne=0,xe=3+(7&(ne>>>=ge)),ne>>>=3,ce-=3}else{for(He=ge+7;ce<He;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}ce-=ge,Ne=0,xe=11+(127&(ne>>>=ge)),ne>>>=7,ce-=7}if(c.have+xe>c.nlen+c.ndist){N.msg="invalid bit length repeat",c.mode=30;break}for(;xe--;)c.lens[c.have++]=Ne}}if(c.mode===30)break;if(c.lens[256]===0){N.msg="invalid code -- missing end-of-block",c.mode=30;break}if(c.lenbits=9,ve={bits:c.lenbits},le=L(1,c.lens,0,c.nlen,c.lencode,0,c.work,ve),c.lenbits=ve.bits,le){N.msg="invalid literal/lengths set",c.mode=30;break}if(c.distbits=6,c.distcode=c.distdyn,ve={bits:c.distbits},le=L(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,ve),c.distbits=ve.bits,le){N.msg="invalid distances set",c.mode=30;break}if(c.mode=20,u===6)break e;case 20:c.mode=21;case 21:if(6<=W&&258<=te){N.next_out=X,N.avail_out=te,N.next_in=U,N.avail_in=W,c.hold=ne,c.bits=ce,w(N,Ie),X=N.next_out,E=N.output,te=N.avail_out,U=N.next_in,m=N.input,W=N.avail_in,ne=c.hold,ce=c.bits,c.mode===12&&(c.back=-1);break}for(c.back=0;oe=(nt=c.lencode[ne&(1<<c.lenbits)-1])>>>16&255,se=65535&nt,!((ge=nt>>>24)<=ce);){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(oe&&!(240&oe)){for(Ae=ge,Ye=oe,Ge=se;oe=(nt=c.lencode[Ge+((ne&(1<<Ae+Ye)-1)>>Ae)])>>>16&255,se=65535&nt,!(Ae+(ge=nt>>>24)<=ce);){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}ne>>>=Ae,ce-=Ae,c.back+=Ae}if(ne>>>=ge,ce-=ge,c.back+=ge,c.length=se,oe===0){c.mode=26;break}if(32&oe){c.back=-1,c.mode=12;break}if(64&oe){N.msg="invalid literal/length code",c.mode=30;break}c.extra=15&oe,c.mode=22;case 22:if(c.extra){for(He=c.extra;ce<He;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.length+=ne&(1<<c.extra)-1,ne>>>=c.extra,ce-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;oe=(nt=c.distcode[ne&(1<<c.distbits)-1])>>>16&255,se=65535&nt,!((ge=nt>>>24)<=ce);){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(!(240&oe)){for(Ae=ge,Ye=oe,Ge=se;oe=(nt=c.distcode[Ge+((ne&(1<<Ae+Ye)-1)>>Ae)])>>>16&255,se=65535&nt,!(Ae+(ge=nt>>>24)<=ce);){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}ne>>>=Ae,ce-=Ae,c.back+=Ae}if(ne>>>=ge,ce-=ge,c.back+=ge,64&oe){N.msg="invalid distance code",c.mode=30;break}c.offset=se,c.extra=15&oe,c.mode=24;case 24:if(c.extra){for(He=c.extra;ce<He;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}c.offset+=ne&(1<<c.extra)-1,ne>>>=c.extra,ce-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){N.msg="invalid distance too far back",c.mode=30;break}c.mode=25;case 25:if(te===0)break e;if(xe=Ie-te,c.offset>xe){if((xe=c.offset-xe)>c.whave&&c.sane){N.msg="invalid distance too far back",c.mode=30;break}Be=xe>c.wnext?(xe-=c.wnext,c.wsize-xe):c.wnext-xe,xe>c.length&&(xe=c.length),q=c.window}else q=E,Be=X-c.offset,xe=c.length;for(te<xe&&(xe=te),te-=xe,c.length-=xe;E[X++]=q[Be++],--xe;);c.length===0&&(c.mode=21);break;case 26:if(te===0)break e;E[X++]=c.length,te--,c.mode=21;break;case 27:if(c.wrap){for(;ce<32;){if(W===0)break e;W--,ne|=m[U++]<<ce,ce+=8}if(Ie-=te,N.total_out+=Ie,c.total+=Ie,Ie&&(N.adler=c.check=(c.flags?h:v)(c.check,E,Ie,X-Ie)),Ie=te,(c.flags?ne:C(ne))!==c.check){N.msg="incorrect data check",c.mode=30;break}ce=ne=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;ce<32;){if(W===0)break e;W--,ne+=m[U++]<<ce,ce+=8}if(ne!==(4294967295&c.total)){N.msg="incorrect length check",c.mode=30;break}ce=ne=0}c.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;default:return k}return N.next_out=X,N.avail_out=te,N.next_in=U,N.avail_in=W,c.hold=ne,c.bits=ce,(c.wsize||Ie!==N.avail_out&&c.mode<30&&(c.mode<27||u!==4))&&B(N,N.output,N.next_out,Ie-N.avail_out)?(c.mode=31,-4):(we-=N.avail_in,Ie-=N.avail_out,N.total_in+=we,N.total_out+=Ie,c.total+=Ie,c.wrap&&Ie&&(N.adler=c.check=(c.flags?h:v)(c.check,E,Ie,N.next_out-Ie)),N.data_type=c.bits+(c.last?64:0)+(c.mode===12?128:0)+(c.mode===20||c.mode===15?256:0),(we==0&&Ie===0||u===4)&&le===G&&(le=-5),le)},o.inflateEnd=function(N){if(!N||!N.state)return k;var u=N.state;return u.window&&(u.window=null),N.state=null,G},o.inflateGetHeader=function(N,u){var c;return N&&N.state&&2&(c=N.state).wrap?((c.head=u).done=!1,G):k},o.inflateSetDictionary=function(N,u){var c,m=u.length;return!N||!N.state||(c=N.state).wrap!==0&&c.mode!==11?k:c.mode===11&&v(1,u,m,0)!==c.check?-3:B(N,u,m,m)?(c.mode=31,-4):(c.havedict=1,G)},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":4,"./adler32":6,"./crc32":8,"./inffast":11,"./inftrees":13}],13:[function(b,r,o){var a=b("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],L=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(G,k,D,f,O,C,j,V){var R,M,ee,F,_,J,T,B,N,u=V.bits,c=0,m=0,E=0,U=0,X=0,W=0,te=0,ne=0,ce=0,we=0,Ie=null,xe=0,Be=new a.Buf16(16),q=new a.Buf16(16),ge=null,oe=0;for(c=0;c<=15;c++)Be[c]=0;for(m=0;m<f;m++)Be[k[D+m]]++;for(X=u,U=15;1<=U&&Be[U]===0;U--);if(U<X&&(X=U),U===0)return O[C++]=20971520,O[C++]=20971520,V.bits=1,0;for(E=1;E<U&&Be[E]===0;E++);for(X<E&&(X=E),c=ne=1;c<=15;c++)if(ne<<=1,(ne-=Be[c])<0)return-1;if(0<ne&&(G===0||U!==1))return-1;for(q[1]=0,c=1;c<15;c++)q[c+1]=q[c]+Be[c];for(m=0;m<f;m++)k[D+m]!==0&&(j[q[k[D+m]]++]=m);if(J=G===0?(Ie=ge=j,19):G===1?(Ie=v,xe-=257,ge=h,oe-=257,256):(Ie=w,ge=L,-1),c=E,_=C,te=m=we=0,ee=-1,F=(ce=1<<(W=X))-1,G===1&&852<ce||G===2&&592<ce)return 1;for(;;){for(T=c-te,N=j[m]<J?(B=0,j[m]):j[m]>J?(B=ge[oe+j[m]],Ie[xe+j[m]]):(B=96,0),R=1<<c-te,E=M=1<<W;O[_+(we>>te)+(M-=R)]=T<<24|B<<16|N|0,M!==0;);for(R=1<<c-1;we&R;)R>>=1;if(R!==0?(we&=R-1,we+=R):we=0,m++,--Be[c]==0){if(c===U)break;c=k[D+j[m]]}if(X<c&&(we&F)!==ee){for(te===0&&(te=X),_+=E,ne=1<<(W=c-te);W+te<U&&!((ne-=Be[W+te])<=0);)W++,ne<<=1;if(ce+=1<<W,G===1&&852<ce||G===2&&592<ce)return 1;O[ee=we&F]=X<<24|W<<16|_-C|0}}return we!==0&&(O[_+we]=c-te<<24|64<<16|0),V.bits=X,0}},{"../utils/common":4}],14:[function(b,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],15:[function(b,r,o){var a=b("../utils/common");function v(oe){for(var se=oe.length;0<=--se;)oe[se]=0}var h=256,w=286,L=30,G=15,k=16,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],f=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(576);v(j);var V=new Array(60);v(V);var R=new Array(512);v(R);var M=new Array(256);v(M);var ee=new Array(29);v(ee);var F,_,J,T=new Array(L);function B(oe,se,Ae,Ye,Ge){this.static_tree=oe,this.extra_bits=se,this.extra_base=Ae,this.elems=Ye,this.max_length=Ge,this.has_stree=oe&&oe.length}function N(oe,se){this.dyn_tree=oe,this.max_code=0,this.stat_desc=se}function u(oe){return oe<256?R[oe]:R[256+(oe>>>7)]}function c(oe,se){oe.pending_buf[oe.pending++]=255&se,oe.pending_buf[oe.pending++]=se>>>8&255}function m(oe,se,Ae){oe.bi_valid>k-Ae?(oe.bi_buf|=se<<oe.bi_valid&65535,c(oe,oe.bi_buf),oe.bi_buf=se>>k-oe.bi_valid,oe.bi_valid+=Ae-k):(oe.bi_buf|=se<<oe.bi_valid&65535,oe.bi_valid+=Ae)}function E(oe,se,Ae){m(oe,Ae[2*se],Ae[2*se+1])}function U(oe,se){for(var Ae=0;Ae|=1&oe,oe>>>=1,Ae<<=1,0<--se;);return Ae>>>1}function X(oe,se,Ae){var Ye,Ge,Ne=new Array(G+1),le=0;for(Ye=1;Ye<=G;Ye++)Ne[Ye]=le=le+Ae[Ye-1]<<1;for(Ge=0;Ge<=se;Ge++){var ve=oe[2*Ge+1];ve!==0&&(oe[2*Ge]=U(Ne[ve]++,ve))}}function W(oe){var se;for(se=0;se<w;se++)oe.dyn_ltree[2*se]=0;for(se=0;se<L;se++)oe.dyn_dtree[2*se]=0;for(se=0;se<19;se++)oe.bl_tree[2*se]=0;oe.dyn_ltree[512]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function te(oe){8<oe.bi_valid?c(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function ne(oe,se,Ae,Ye){var Ge=2*se,Ne=2*Ae;return oe[Ge]<oe[Ne]||oe[Ge]===oe[Ne]&&Ye[se]<=Ye[Ae]}function ce(oe,se,Ae){for(var Ye=oe.heap[Ae],Ge=Ae<<1;Ge<=oe.heap_len&&(Ge<oe.heap_len&&ne(se,oe.heap[Ge+1],oe.heap[Ge],oe.depth)&&Ge++,!ne(se,Ye,oe.heap[Ge],oe.depth));)oe.heap[Ae]=oe.heap[Ge],Ae=Ge,Ge<<=1;oe.heap[Ae]=Ye}function we(oe,se,Ae){var Ye,Ge,Ne,le,ve=0;if(oe.last_lit!==0)for(;Ye=oe.pending_buf[oe.d_buf+2*ve]<<8|oe.pending_buf[oe.d_buf+2*ve+1],Ge=oe.pending_buf[oe.l_buf+ve],ve++,Ye===0?E(oe,Ge,se):(E(oe,(Ne=M[Ge])+h+1,se),(le=D[Ne])!==0&&m(oe,Ge-=ee[Ne],le),E(oe,Ne=u(--Ye),Ae),(le=f[Ne])!==0&&m(oe,Ye-=T[Ne],le)),ve<oe.last_lit;);E(oe,256,se)}function Ie(oe,se){var Ae,Ye,Ge,Ne=se.dyn_tree,le=se.stat_desc.static_tree,ve=se.stat_desc.has_stree,He=se.stat_desc.elems,nt=-1;for(oe.heap_len=0,oe.heap_max=573,Ae=0;Ae<He;Ae++)Ne[2*Ae]!==0?(oe.heap[++oe.heap_len]=nt=Ae,oe.depth[Ae]=0):Ne[2*Ae+1]=0;for(;oe.heap_len<2;)Ne[2*(Ge=oe.heap[++oe.heap_len]=nt<2?++nt:0)]=1,oe.depth[Ge]=0,oe.opt_len--,ve&&(oe.static_len-=le[2*Ge+1]);for(se.max_code=nt,Ae=oe.heap_len>>1;1<=Ae;Ae--)ce(oe,Ne,Ae);for(Ge=He;Ae=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],ce(oe,Ne,1),Ye=oe.heap[1],oe.heap[--oe.heap_max]=Ae,oe.heap[--oe.heap_max]=Ye,Ne[2*Ge]=Ne[2*Ae]+Ne[2*Ye],oe.depth[Ge]=(oe.depth[Ae]>=oe.depth[Ye]?oe.depth[Ae]:oe.depth[Ye])+1,Ne[2*Ae+1]=Ne[2*Ye+1]=Ge,oe.heap[1]=Ge++,ce(oe,Ne,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(ht,Tt){var Ct,We,It,Bt,Ln,rn,Xn=Tt.dyn_tree,yt=Tt.max_code,ze=Tt.stat_desc.static_tree,Zt=Tt.stat_desc.has_stree,An=Tt.stat_desc.extra_bits,Yn=Tt.stat_desc.extra_base,pt=Tt.stat_desc.max_length,st=0;for(Bt=0;Bt<=G;Bt++)ht.bl_count[Bt]=0;for(Xn[2*ht.heap[ht.heap_max]+1]=0,Ct=ht.heap_max+1;Ct<573;Ct++)pt<(Bt=Xn[2*Xn[2*(We=ht.heap[Ct])+1]+1]+1)&&(Bt=pt,st++),Xn[2*We+1]=Bt,yt<We||(ht.bl_count[Bt]++,Ln=0,Yn<=We&&(Ln=An[We-Yn]),rn=Xn[2*We],ht.opt_len+=rn*(Bt+Ln),Zt&&(ht.static_len+=rn*(ze[2*We+1]+Ln)));if(st!==0){do{for(Bt=pt-1;ht.bl_count[Bt]===0;)Bt--;ht.bl_count[Bt]--,ht.bl_count[Bt+1]+=2,ht.bl_count[pt]--,st-=2}while(0<st);for(Bt=pt;Bt!==0;Bt--)for(We=ht.bl_count[Bt];We!==0;)yt<(It=ht.heap[--Ct])||(Xn[2*It+1]!==Bt&&(ht.opt_len+=(Bt-Xn[2*It+1])*Xn[2*It],Xn[2*It+1]=Bt),We--)}}(oe,se),X(Ne,nt,oe.bl_count)}function xe(oe,se,Ae){var Ye,Ge,Ne=-1,le=se[1],ve=0,He=7,nt=4;for(le===0&&(He=138,nt=3),se[2*(Ae+1)+1]=65535,Ye=0;Ye<=Ae;Ye++)Ge=le,le=se[2*(Ye+1)+1],++ve<He&&Ge===le||(ve<nt?oe.bl_tree[2*Ge]+=ve:Ge!==0?(Ge!==Ne&&oe.bl_tree[2*Ge]++,oe.bl_tree[32]++):ve<=10?oe.bl_tree[34]++:oe.bl_tree[36]++,Ne=Ge,nt=(ve=0)===le?(He=138,3):Ge===le?(He=6,3):(He=7,4))}function Be(oe,se,Ae){var Ye,Ge,Ne=-1,le=se[1],ve=0,He=7,nt=4;for(le===0&&(He=138,nt=3),Ye=0;Ye<=Ae;Ye++)if(Ge=le,le=se[2*(Ye+1)+1],!(++ve<He&&Ge===le)){if(ve<nt)for(;E(oe,Ge,oe.bl_tree),--ve!=0;);else Ge!==0?(Ge!==Ne&&(E(oe,Ge,oe.bl_tree),ve--),E(oe,16,oe.bl_tree),m(oe,ve-3,2)):ve<=10?(E(oe,17,oe.bl_tree),m(oe,ve-3,3)):(E(oe,18,oe.bl_tree),m(oe,ve-11,7));Ne=Ge,nt=(ve=0)===le?(He=138,3):Ge===le?(He=6,3):(He=7,4)}}v(T);var q=!1;function ge(oe,se,Ae,Ye){var Ge,Ne,le;m(oe,0+(Ye?1:0),3),Ne=se,le=Ae,te(Ge=oe),c(Ge,le),c(Ge,~le),a.arraySet(Ge.pending_buf,Ge.window,Ne,le,Ge.pending),Ge.pending+=le}o._tr_init=function(oe){q||(function(){var se,Ae,Ye,Ge,Ne,le=new Array(G+1);for(Ge=Ye=0;Ge<28;Ge++)for(ee[Ge]=Ye,se=0;se<1<<D[Ge];se++)M[Ye++]=Ge;for(M[Ye-1]=Ge,Ge=Ne=0;Ge<16;Ge++)for(T[Ge]=Ne,se=0;se<1<<f[Ge];se++)R[Ne++]=Ge;for(Ne>>=7;Ge<L;Ge++)for(T[Ge]=Ne<<7,se=0;se<1<<f[Ge]-7;se++)R[256+Ne++]=Ge;for(Ae=0;Ae<=G;Ae++)le[Ae]=0;for(se=0;se<=143;)j[2*se+1]=8,se++,le[8]++;for(;se<=255;)j[2*se+1]=9,se++,le[9]++;for(;se<=279;)j[2*se+1]=7,se++,le[7]++;for(;se<=287;)j[2*se+1]=8,se++,le[8]++;for(X(j,287,le),se=0;se<L;se++)V[2*se+1]=5,V[2*se]=U(se,5);F=new B(j,D,257,w,G),_=new B(V,f,0,L,G),J=new B(new Array(0),O,0,19,7)}(),q=!0),oe.l_desc=new N(oe.dyn_ltree,F),oe.d_desc=new N(oe.dyn_dtree,_),oe.bl_desc=new N(oe.bl_tree,J),oe.bi_buf=0,oe.bi_valid=0,W(oe)},o._tr_stored_block=ge,o._tr_flush_block=function(oe,se,Ae,Ye){var Ge,Ne,le=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ve){var He,nt=4093624447;for(He=0;He<=31;He++,nt>>>=1)if(1&nt&&ve.dyn_ltree[2*He]!==0)return 0;if(ve.dyn_ltree[18]!==0||ve.dyn_ltree[20]!==0||ve.dyn_ltree[26]!==0)return 1;for(He=32;He<h;He++)if(ve.dyn_ltree[2*He]!==0)return 1;return 0}(oe)),Ie(oe,oe.l_desc),Ie(oe,oe.d_desc),le=function(ve){var He;for(xe(ve,ve.dyn_ltree,ve.l_desc.max_code),xe(ve,ve.dyn_dtree,ve.d_desc.max_code),Ie(ve,ve.bl_desc),He=18;3<=He&&ve.bl_tree[2*C[He]+1]===0;He--);return ve.opt_len+=3*(He+1)+5+5+4,He}(oe),Ge=oe.opt_len+3+7>>>3,(Ne=oe.static_len+3+7>>>3)<=Ge&&(Ge=Ne)):Ge=Ne=Ae+5,Ae+4<=Ge&&se!==-1?ge(oe,se,Ae,Ye):oe.strategy===4||Ne===Ge?(m(oe,2+(Ye?1:0),3),we(oe,j,V)):(m(oe,4+(Ye?1:0),3),function(ve,He,nt,ht){var Tt;for(m(ve,He-257,5),m(ve,nt-1,5),m(ve,ht-4,4),Tt=0;Tt<ht;Tt++)m(ve,ve.bl_tree[2*C[Tt]+1],3);Be(ve,ve.dyn_ltree,He-1),Be(ve,ve.dyn_dtree,nt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,le+1),we(oe,oe.dyn_ltree,oe.dyn_dtree)),W(oe),Ye&&te(oe)},o._tr_tally=function(oe,se,Ae){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=se>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&se,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Ae,oe.last_lit++,se===0?oe.dyn_ltree[2*Ae]++:(oe.matches++,se--,oe.dyn_ltree[2*(M[Ae]+h+1)]++,oe.dyn_dtree[2*u(se)]++),oe.last_lit===oe.lit_bufsize-1},o._tr_align=function(oe){var se;m(oe,2,3),E(oe,256,j),(se=oe).bi_valid===16?(c(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}},{"../utils/common":4}],16:[function(b,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],17:[function(b,r,o){var a=b("three");a.OrbitControls=function(v,h){var w,L,G,k,D;h===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),h===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=v,this.domElement=h,this.enabled=!0,this.target=new a.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:a.MOUSE.ROTATE,MIDDLE:a.MOUSE.DOLLY,RIGHT:a.MOUSE.PAN},this.touches={ONE:a.TOUCH.ROTATE,TWO:a.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return ee.phi},this.getAzimuthalAngle=function(){return ee.theta},this.saveState=function(){f.target0.copy(f.target),f.position0.copy(f.object.position),f.zoom0=f.object.zoom},this.resetStatusValue=function(){R=V.NONE},this.reset=function(){f.target.copy(f.target0),f.object.position.copy(f.position0),f.object.zoom=f.zoom0,f.object.updateProjectionMatrix(),f.dispatchEvent(O),f.update(),R=V.NONE},this.update=(w=new a.Vector3,L=new a.Quaternion().setFromUnitVectors(v.up,new a.Vector3(0,1,0)),G=L.clone().inverse(),k=new a.Vector3,D=new a.Quaternion,function(){var yt=f.object.position;return w.copy(yt).sub(f.target),w.applyQuaternion(L),ee.setFromVector3(w),f.autoRotate&&R===V.NONE&&ne(2*Math.PI/60/60*f.autoRotateSpeed),f.enableDamping?(ee.theta+=F.theta*f.dampingFactor,ee.phi+=F.phi*f.dampingFactor):(ee.theta+=F.theta,ee.phi+=F.phi),ee.theta=Math.max(f.minAzimuthAngle,Math.min(f.maxAzimuthAngle,ee.theta)),ee.phi=Math.max(f.minPolarAngle,Math.min(f.maxPolarAngle,ee.phi)),ee.makeSafe(),ee.radius*=_,ee.radius=Math.max(f.minDistance,Math.min(f.maxDistance,ee.radius)),f.enableDamping===!0?f.target.addScaledVector(J,f.dampingFactor):f.target.add(J),w.setFromSpherical(ee),w.applyQuaternion(G),yt.copy(f.target).add(w),f.object.lookAt(f.target),f.enableDamping===!0?(F.theta*=1-f.dampingFactor,F.phi*=1-f.dampingFactor,J.multiplyScalar(1-f.dampingFactor)):(F.set(0,0,0),J.set(0,0,0)),_=1,!(!(T||k.distanceToSquared(f.object.position)>M||8*(1-D.dot(f.object.quaternion))>M)||(f.dispatchEvent(O),k.copy(f.object.position),D.copy(f.object.quaternion),T=!1))}),this.dispose=function(){f.domElement.removeEventListener("contextmenu",Xn,!1),f.domElement.removeEventListener("mousedown",nt,!1),f.domElement.removeEventListener("wheel",Ct,!1),f.domElement.removeEventListener("touchstart",Bt,!1),f.domElement.removeEventListener("touchend",rn,!1),f.domElement.removeEventListener("touchmove",Ln,!1),document.removeEventListener("mousemove",ht,!1),document.removeEventListener("mouseup",Tt,!1),f.domElement.removeEventListener("keydown",We,!1)};var f=this,O={type:"change"},C={type:"start"},j={type:"end"},V={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},R=V.NONE,M=1e-6,ee=new a.Spherical,F=new a.Spherical,_=1,J=new a.Vector3,T=!1,B=new a.Vector2,N=new a.Vector2,u=new a.Vector2,c=new a.Vector2,m=new a.Vector2,E=new a.Vector2,U=new a.Vector2,X=new a.Vector2,W=new a.Vector2;function te(){return Math.pow(.95,f.zoomSpeed)}function ne(yt){F.theta-=yt}function ce(yt){F.phi-=yt}var we,Ie,xe,Be=(we=new a.Vector3,function(yt,ze){we.setFromMatrixColumn(ze,0),we.multiplyScalar(-yt),J.add(we)}),q=(Ie=new a.Vector3,function(yt,ze){f.screenSpacePanning===!0?Ie.setFromMatrixColumn(ze,1):(Ie.setFromMatrixColumn(ze,0),Ie.crossVectors(f.object.up,Ie)),Ie.multiplyScalar(yt),J.add(Ie)}),ge=(xe=new a.Vector3,function(yt,ze){var Zt=f.domElement;if(f.object.isPerspectiveCamera){var An=f.object.position;xe.copy(An).sub(f.target);var Yn=xe.length();Yn*=Math.tan(f.object.fov/2*Math.PI/180),Be(2*yt*Yn/Zt.clientHeight,f.object.matrix),q(2*ze*Yn/Zt.clientHeight,f.object.matrix)}else f.object.isOrthographicCamera?(Be(yt*(f.object.right-f.object.left)/f.object.zoom/Zt.clientWidth,f.object.matrix),q(ze*(f.object.top-f.object.bottom)/f.object.zoom/Zt.clientHeight,f.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),f.enablePan=!1)});function oe(yt){f.object.isPerspectiveCamera?_/=yt:f.object.isOrthographicCamera?(f.object.zoom=Math.max(f.minZoom,Math.min(f.maxZoom,f.object.zoom*yt)),f.object.updateProjectionMatrix(),T=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),f.enableZoom=!1)}function se(yt){B.set(yt.clientX,yt.clientY)}function Ae(yt){c.set(yt.clientX,yt.clientY)}function Ye(yt){if(yt.touches.length==1)B.set(yt.touches[0].pageX,yt.touches[0].pageY);else{var ze=.5*(yt.touches[0].pageX+yt.touches[1].pageX),Zt=.5*(yt.touches[0].pageY+yt.touches[1].pageY);B.set(ze,Zt)}}function Ge(yt){if(yt.touches.length==1)c.set(yt.touches[0].pageX,yt.touches[0].pageY);else{var ze=.5*(yt.touches[0].pageX+yt.touches[1].pageX),Zt=.5*(yt.touches[0].pageY+yt.touches[1].pageY);c.set(ze,Zt)}}function Ne(yt){var ze=yt.touches[0].pageX-yt.touches[1].pageX,Zt=yt.touches[0].pageY-yt.touches[1].pageY,An=Math.sqrt(ze*ze+Zt*Zt);U.set(0,An)}function le(yt){if(yt.touches.length==1)N.set(yt.touches[0].pageX,yt.touches[0].pageY);else{var ze=.5*(yt.touches[0].pageX+yt.touches[1].pageX),Zt=.5*(yt.touches[0].pageY+yt.touches[1].pageY);N.set(ze,Zt)}u.subVectors(N,B).multiplyScalar(f.rotateSpeed);var An=f.domElement;ne(2*Math.PI*u.x/An.clientHeight),ce(2*Math.PI*u.y/An.clientHeight),B.copy(N)}function ve(yt){if(yt.touches.length==1)m.set(yt.touches[0].pageX,yt.touches[0].pageY);else{var ze=.5*(yt.touches[0].pageX+yt.touches[1].pageX),Zt=.5*(yt.touches[0].pageY+yt.touches[1].pageY);m.set(ze,Zt)}E.subVectors(m,c).multiplyScalar(f.panSpeed),ge(E.x,E.y),c.copy(m)}function He(yt){var ze=yt.touches[0].pageX-yt.touches[1].pageX,Zt=yt.touches[0].pageY-yt.touches[1].pageY,An=Math.sqrt(ze*ze+Zt*Zt);X.set(0,An),W.set(0,Math.pow(X.y/U.y,f.zoomSpeed)),oe(W.y),U.copy(X)}function nt(yt){if(f.enabled!==!1){switch(yt.preventDefault(),f.domElement.focus?f.domElement.focus():window.focus(),yt.button){case 0:switch(f.mouseButtons.LEFT){case a.MOUSE.ROTATE:if(yt.ctrlKey||yt.metaKey||yt.shiftKey){if(f.enablePan===!1)return;Ae(yt),R=V.PAN}else{if(f.enableRotate===!1)return;se(yt),R=V.ROTATE}break;case a.MOUSE.PAN:if(yt.ctrlKey||yt.metaKey||yt.shiftKey){if(f.enableRotate===!1)return;se(yt),R=V.ROTATE}else{if(f.enablePan===!1)return;Ae(yt),R=V.PAN}break;default:R=V.NONE}break;case 1:switch(f.mouseButtons.MIDDLE){case a.MOUSE.DOLLY:if(f.enableZoom===!1)return;ze=yt,U.set(ze.clientX,ze.clientY),R=V.DOLLY;break;case a.MOUSE.PAN:if(f.enablePan===!1)return;Ae(yt),R=V.PAN;break;default:R=V.NONE}break;case 2:switch(f.mouseButtons.RIGHT){case a.MOUSE.ROTATE:if(f.enableRotate===!1)return;se(yt),R=V.ROTATE;break;case a.MOUSE.PAN:if(f.enablePan===!1)return;Ae(yt),R=V.PAN;break;default:R=V.NONE}}var ze;R!==V.NONE&&(document.addEventListener("mousemove",ht,!1),document.addEventListener("mouseup",Tt,!1),f.dispatchEvent(C))}}function ht(yt){var ze;if(f.enabled!==!1)switch(yt.preventDefault(),R){case V.ROTATE:if(f.enableRotate===!1)return;(function(Zt){N.set(Zt.clientX,Zt.clientY),u.subVectors(N,B).multiplyScalar(f.rotateSpeed);var An=f.domElement;ne(2*Math.PI*u.x/An.clientHeight),ce(2*Math.PI*u.y/An.clientHeight),B.copy(N),f.update()})(yt);break;case V.DOLLY:if(f.enableZoom===!1)return;(function(Zt){var An;X.set(Zt.clientX,Zt.clientY),W.subVectors(X,U),0<W.y?oe(te()):W.y<0&&(An=te(),f.object.isPerspectiveCamera?_*=An:f.object.isOrthographicCamera?(f.object.zoom=Math.max(f.minZoom,Math.min(f.maxZoom,f.object.zoom/An)),f.object.updateProjectionMatrix(),T=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),f.enableZoom=!1)),U.copy(X),f.update()})(yt);break;case V.PAN:if(f.enablePan===!1)return;ze=yt,m.set(ze.clientX,ze.clientY),E.subVectors(m,c).multiplyScalar(f.panSpeed),ge(E.x,E.y),c.copy(m),f.update()}}function Tt(yt){f.enabled!==!1&&(document.removeEventListener("mousemove",ht,!1),document.removeEventListener("mouseup",Tt,!1),f.dispatchEvent(j),R=V.NONE)}function Ct(yt){f.enabled===!1||f.enableZoom===!1||R!==V.NONE&&R!==V.ROTATE||(yt.preventDefault(),yt.stopPropagation(),f.dispatchEvent(C),function(ze){ze.deltaY<0?function(Zt,An){if(f.object.isPerspectiveCamera)lt*=Zt;else if(f.object.isOrthographicCamera){var Yn=f.domElement.clientWidth,pt=f.domElement.clientHeight,st=(f.object.near+f.object.far)/(f.object.near-f.object.far),qt=An.offsetX,xn=An.offsetY,nn=new a.Vector3(qt/Yn*2-1,-xn/pt*2+1,st);nn.applyMatrix4(f.object.projectionMatrixInverse);var er=new a.Vector3(-1,-1,st),kr=new a.Vector3(1,1,st);er.applyMatrix4(f.object.projectionMatrixInverse),kr.applyMatrix4(f.object.projectionMatrixInverse);var ct=Math.max(f.minZoom,Math.min(f.maxZoom,1/Zt)),Ue=new a.Matrix4;Ue.makeTranslation(-nn.x,-nn.y,0);var lt=new a.Matrix4().scale(new a.Vector3(1/ct,1/ct,1/ct)),Wt=new a.Matrix4;Wt.makeTranslation(nn.x,nn.y,0);var $e=new a.Matrix4().multiply(Wt).multiply(lt).multiply(Ue);er.applyMatrix4($e),kr.applyMatrix4($e),f.object.left=er.x,f.object.right=kr.x,f.object.top=kr.y,f.object.bottom=er.y,f.object.zoom=1,f.object.updateProjectionMatrix(),T=!0}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),f.enableZoom=!1}(te(),ze):0<ze.deltaY&&function(Zt,An){if(f.object.isPerspectiveCamera)lt/=Zt;else if(f.object.isOrthographicCamera){var Yn=f.domElement.clientWidth,pt=f.domElement.clientHeight,st=(f.object.near+f.object.far)/(f.object.near-f.object.far),qt=An.offsetX,xn=An.offsetY,nn=new a.Vector3(qt/Yn*2-1,-xn/pt*2+1,st);nn.applyMatrix4(f.object.projectionMatrixInverse);var er=new a.Vector3(-1,-1,st),kr=new a.Vector3(1,1,st);er.applyMatrix4(f.object.projectionMatrixInverse),kr.applyMatrix4(f.object.projectionMatrixInverse);var ct=Math.max(f.minZoom,Math.min(f.maxZoom,Zt)),Ue=new a.Matrix4;Ue.makeTranslation(-nn.x,-nn.y,0);var lt=new a.Matrix4().scale(new a.Vector3(1/ct,1/ct,1/ct)),Wt=new a.Matrix4;Wt.makeTranslation(nn.x,nn.y,0);var $e=new a.Matrix4().multiply(Wt).multiply(lt).multiply(Ue);er.applyMatrix4($e),kr.applyMatrix4($e),f.object.left=er.x,f.object.right=kr.x,f.object.top=kr.y,f.object.bottom=er.y,f.object.zoom=1,f.object.updateProjectionMatrix(),T=!0}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),f.enableZoom=!1}(te(),ze),f.update()}(yt),f.dispatchEvent(j))}function We(yt){f.enabled!==!1&&f.enableKeys!==!1&&f.enablePan!==!1&&function(ze){var Zt=!1;switch(ze.keyCode){case f.keys.UP:ge(0,f.keyPanSpeed),Zt=!0;break;case f.keys.BOTTOM:ge(0,-f.keyPanSpeed),Zt=!0;break;case f.keys.LEFT:ge(f.keyPanSpeed,0),Zt=!0;break;case f.keys.RIGHT:ge(-f.keyPanSpeed,0),Zt=!0}Zt&&(ze.preventDefault(),f.update())}(yt)}function It(yt){switch(yt.touches.length){case 1:switch(f.touches.ONE){case a.TOUCH.ROTATE:if(f.enableRotate===!1)return;Ye(yt),R=V.TOUCH_ROTATE;break;case a.TOUCH.PAN:if(f.enablePan===!1)return;Ge(yt),R=V.TOUCH_PAN;break;default:R=V.NONE}break;case 2:switch(f.touches.TWO){case a.TOUCH.DOLLY_PAN:if(f.enableZoom===!1&&f.enablePan===!1)return;Zt=yt,f.enableZoom&&Ne(Zt),f.enablePan&&Ge(Zt),R=V.TOUCH_DOLLY_PAN;break;case a.TOUCH.DOLLY_ROTATE:if(f.enableZoom===!1&&f.enableRotate===!1)return;ze=yt,f.enableZoom&&Ne(ze),f.enableRotate&&Ye(ze),R=V.TOUCH_DOLLY_ROTATE;break;default:R=V.NONE}break;default:R=V.NONE}var ze,Zt}function Bt(yt){f.enabled!==!1&&(yt.preventDefault(),It(yt),R!==V.NONE&&f.dispatchEvent(C))}function Ln(yt){var ze,Zt;if(f.enabled!==!1)switch(yt.preventDefault(),yt.stopPropagation(),R){case V.TOUCH_ROTATE:if(f.enableRotate===!1)return;le(yt),f.update();break;case V.TOUCH_PAN:if(f.enablePan===!1)return;ve(yt),f.update();break;case V.TOUCH_DOLLY_PAN:if(f.enableZoom===!1&&f.enablePan===!1)return;Zt=yt,f.enableZoom&&He(Zt),f.enablePan&&ve(Zt),f.update();break;case V.TOUCH_DOLLY_ROTATE:if(f.enableZoom===!1&&f.enableRotate===!1)return;ze=yt,f.enableZoom&&He(ze),f.enableRotate&&le(ze),f.update();break;default:It(yt)}}function rn(yt){f.enabled!==!1&&(f.dispatchEvent(j),R=V.NONE)}function Xn(yt){f.enabled!==!1&&yt.preventDefault()}f.domElement.addEventListener("contextmenu",Xn,!1),f.domElement.addEventListener("mousedown",nt,!1),f.domElement.addEventListener("wheel",Ct,!1),f.domElement.addEventListener("touchstart",Bt,!1),f.domElement.addEventListener("touchend",rn,!1),f.domElement.addEventListener("touchmove",Ln,!1),f.domElement.addEventListener("keydown",We,!1),f.domElement.tabIndex===-1&&(f.domElement.tabIndex=0),this.update()},a.OrbitControls.prototype=Object.create(a.EventDispatcher.prototype),a.OrbitControls.prototype.constructor=a.OrbitControls,a.MapControls=function(v,h){a.OrbitControls.call(this,v,h),this.mouseButtons.LEFT=a.MOUSE.PAN,this.mouseButtons.RIGHT=a.MOUSE.ROTATE,this.touches.ONE=a.TOUCH.PAN,this.touches.TWO=a.TOUCH.DOLLY_ROTATE},a.MapControls.prototype=Object.create(a.EventDispatcher.prototype),a.MapControls.prototype.constructor=a.MapControls,o!==void 0&&(r!==void 0&&r.exports&&(o=r.exports={OrbitControls:a.OrbitControls,MapControls:a.MapControls}),o.OrbitControls=a.OrbitControls,o.MapControls=a.MapControls)},{three:19}],18:[function(b,r,o){(function(){var a,v,h,w=b!==void 0,L=this.THREE||w&&b("three");if(!L)throw new Error("MeshLine requires three.js");function G(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new L.BufferGeometry,this.widthCallback=null,this.matrixWorld=new L.Matrix4}function k(f,O,C,j,V){var R;if(f=f.subarray||f.slice?f:f.buffer,C=C.subarray||C.slice?C:C.buffer,f=O?f.subarray?f.subarray(O,V&&O+V):f.slice(O,V&&O+V):f,C.set)C.set(f,j);else for(R=0;R<f.length;R++)C[R+j]=f[R];return C}function D(f){L.ShaderMaterial.call(this,{uniforms:Object.assign({},L.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new L.Color(16777215)},opacity:{value:1},resolution:{value:new L.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new L.Vector2(1,1)}}),vertexShader:L.ShaderChunk.meshline_vert,fragmentShader:L.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(O){this.uniforms.lineWidth.value=O}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(O){this.uniforms.map.value=O}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(O){this.uniforms.useMap.value=O}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(O){this.uniforms.alphaMap.value=O}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(O){this.uniforms.useAlphaMap.value=O}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(O){this.uniforms.color.value=O}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(O){this.uniforms.opacity.value=O}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(O){this.uniforms.resolution.value.copy(O)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(O){this.uniforms.sizeAttenuation.value=O}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(O){this.uniforms.near.value=O}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(O){this.uniforms.far.value=O}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(O){this.uniforms.dashArray.value=O,this.useDash=O!==0?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(O){this.uniforms.dashOffset.value=O}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(O){this.uniforms.dashRatio.value=O}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(O){this.uniforms.useDash.value=O}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(O){this.uniforms.visibility.value=O}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(O){this.uniforms.alphaTest.value=O}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(O){this.uniforms.repeat.value.copy(O)}}}),this.setValues(f)}G.prototype.setMatrixWorld=function(f){this.matrixWorld=f},G.prototype.setGeometry=function(f,O){if(this.widthCallback=O,this.positions=[],this.counters=[],f instanceof L.Geometry)for(var C=0;C<f.vertices.length;C++){var j=f.vertices[C];O=C/f.vertices.length,this.positions.push(j.x,j.y,j.z),this.positions.push(j.x,j.y,j.z),this.counters.push(O),this.counters.push(O)}if(L.BufferGeometry,f instanceof Float32Array||f instanceof Array)for(C=0;C<f.length;C+=3)O=C/f.length,this.positions.push(f[C],f[C+1],f[C+2]),this.positions.push(f[C],f[C+1],f[C+2]),this.counters.push(O),this.counters.push(O);this.process()},G.prototype.raycast=(a=new L.Matrix4,v=new L.Ray,h=new L.Sphere,function(f,O){var C=f.linePrecision,j=C*C,V=this.geometry;if(V.boundingSphere===null&&V.computeBoundingSphere(),h.copy(V.boundingSphere),h.applyMatrix4(this.matrixWorld),f.ray.intersectSphere(h)!==!1){a.getInverse(this.matrixWorld),v.copy(f.ray).applyMatrix4(a);var R=new L.Vector3,M=new L.Vector3,ee=new L.Vector3,F=new L.Vector3,_=this instanceof L.LineSegments?2:1;if(V instanceof L.BufferGeometry){var J=V.index,T=V.attributes;if(J!==null)for(var B=J.array,N=T.position.array,u=0,c=B.length-1;u<c;u+=_){var m=B[u],E=B[u+1];R.fromArray(N,3*m),M.fromArray(N,3*E),j<v.distanceSqToSegment(R,M,F,ee)||(F.applyMatrix4(this.matrixWorld),(W=f.ray.origin.distanceTo(F))<f.near||W>f.far||O.push({distance:W,point:ee.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}else for(u=0,c=(N=T.position.array).length/3-1;u<c;u+=_)R.fromArray(N,3*u),M.fromArray(N,3*u+3),j<v.distanceSqToSegment(R,M,F,ee)||(F.applyMatrix4(this.matrixWorld),(W=f.ray.origin.distanceTo(F))<f.near||W>f.far||O.push({distance:W,point:ee.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}else if(V instanceof L.Geometry){var U=V.vertices,X=U.length;for(u=0;u<X-1;u+=_){var W;j<v.distanceSqToSegment(U[u],U[u+1],F,ee)||(F.applyMatrix4(this.matrixWorld),(W=f.ray.origin.distanceTo(F))<f.near||W>f.far||O.push({distance:W,point:ee.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}}}}),G.prototype.compareV3=function(f,O){var C=6*f,j=6*O;return this.positions[C]===this.positions[j]&&this.positions[1+C]===this.positions[1+j]&&this.positions[2+C]===this.positions[2+j]},G.prototype.copyV3=function(f){var O=6*f;return[this.positions[O],this.positions[1+O],this.positions[2+O]]},G.prototype.process=function(){var f,O,C=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var j=0;j<C;j++)this.side.push(1),this.side.push(-1);for(j=0;j<C;j++)f=this.widthCallback?this.widthCallback(j/(C-1)):1,this.width.push(f),this.width.push(f);for(j=0;j<C;j++)this.uvs.push(j/(C-1),0),this.uvs.push(j/(C-1),1);for(O=this.compareV3(0,C-1)?this.copyV3(C-2):this.copyV3(0),this.previous.push(O[0],O[1],O[2]),this.previous.push(O[0],O[1],O[2]),j=0;j<C-1;j++)O=this.copyV3(j),this.previous.push(O[0],O[1],O[2]),this.previous.push(O[0],O[1],O[2]);for(j=1;j<C;j++)O=this.copyV3(j),this.next.push(O[0],O[1],O[2]),this.next.push(O[0],O[1],O[2]);for(O=this.compareV3(C-1,0)?this.copyV3(1):this.copyV3(C-1),this.next.push(O[0],O[1],O[2]),this.next.push(O[0],O[1],O[2]),j=0;j<C-1;j++){var V=2*j;this.indices_array.push(V,1+V,2+V),this.indices_array.push(2+V,1+V,3+V)}this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new L.BufferAttribute(new Float32Array(this.positions),3),previous:new L.BufferAttribute(new Float32Array(this.previous),3),next:new L.BufferAttribute(new Float32Array(this.next),3),side:new L.BufferAttribute(new Float32Array(this.side),1),width:new L.BufferAttribute(new Float32Array(this.width),1),uv:new L.BufferAttribute(new Float32Array(this.uvs),2),index:new L.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new L.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},G.prototype.advance=function(f){var O=this.attributes.position.array,C=this.attributes.previous.array,j=this.attributes.next.array,V=O.length;k(O,0,C,0,V),k(O,6,O,0,V-6),O[V-6]=f.x,O[V-5]=f.y,O[V-4]=f.z,O[V-3]=f.x,O[V-2]=f.y,O[V-1]=f.z,k(O,6,j,0,V-6),j[V-6]=f.x,j[V-5]=f.y,j[V-4]=f.z,j[V-3]=f.x,j[V-2]=f.y,j[V-1]=f.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},L.ShaderChunk.meshline_vert=["",L.ShaderChunk.logdepthbuf_pars_vertex,L.ShaderChunk.fog_pars_vertex,"","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute float counters;","","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","	 vCounters = counters;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","","    vColor = vec4( color, opacity );","    vUV = uv;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","    float w = lineWidth * width;","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec4 normal = vec4( -dir.y, dir.x, 0., 1. );","    normal.xy *= .5 * w;","    normal *= projectionMatrix;","    if( sizeAttenuation == 0. ) {","        normal.xy *= finalPosition.w;","        normal.xy /= ( vec4( resolution, 0., 1. ) * projectionMatrix ).xy;","    }","","    finalPosition.xy += normal.xy * side;","","    gl_Position = finalPosition;","",L.ShaderChunk.logdepthbuf_vertex,L.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",L.ShaderChunk.fog_vertex,"}"].join(`
`),L.ShaderChunk.meshline_frag=["",L.ShaderChunk.fog_pars_fragment,L.ShaderChunk.logdepthbuf_pars_fragment,"","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","void main() {","",L.ShaderChunk.logdepthbuf_fragment,"","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));","    }","    gl_FragColor = c;","    gl_FragColor.a *= step(vCounters, visibility);","",L.ShaderChunk.fog_fragment,"}"].join(`
`),((D.prototype=Object.create(L.ShaderMaterial.prototype)).constructor=D).prototype.isMeshLineMaterial=!0,D.prototype.copy=function(f){return L.ShaderMaterial.prototype.copy.call(this,f),this.lineWidth=f.lineWidth,this.map=f.map,this.useMap=f.useMap,this.alphaMap=f.alphaMap,this.useAlphaMap=f.useAlphaMap,this.color.copy(f.color),this.opacity=f.opacity,this.resolution.copy(f.resolution),this.sizeAttenuation=f.sizeAttenuation,this.near=f.near,this.far=f.far,this.dashArray.copy(f.dashArray),this.dashOffset.copy(f.dashOffset),this.dashRatio.copy(f.dashRatio),this.useDash=f.useDash,this.visibility=f.visibility,this.alphaTest=f.alphaTest,this.repeat.copy(f.repeat),this},o!==void 0?(r!==void 0&&r.exports&&(o=r.exports={MeshLine:G,MeshLineMaterial:D}),o.MeshLine=G,o.MeshLineMaterial=D):(this.MeshLine=G,this.MeshLineMaterial=D)}).call(this)},{three:19}],19:[function(b,r,o){var a,v;a=this,v=function(h){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!=null)for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(t[l]=i[l])}return t});var w=0,L=1,G=2,k=1,D=2,f=3,O=0,C=1,j=2,V=0,R=0,M=1,ee=2,F=3,_=4,J=5,T=100,B=101,N=102,u=103,c=104,m=200,E=201,U=202,X=203,W=204,te=205,ne=206,ce=207,we=208,Ie=209,xe=210,Be=0,q=1,ge=2,oe=3,se=4,Ae=5,Ye=6,Ge=7,Ne=0,le=1,ve=2,He=0,nt=1,ht=2,Tt=3,Ct=4,We=5,It=301,Bt=302,Ln=303,rn=304,Xn=305,yt=306,ze=307,Zt=1e3,An=1001,Yn=1002,pt=1003,st=1004,qt=1005,xn=1006,nn=1007,er=1008,kr=1009,ct=1010,Ue=1011,lt=1012,Wt=1013,$e=1014,Rt=1015,$t=1016,an=1017,hr=1018,_r=1019,qr=1020,Ur=1021,Gr=1022,Or=1023,Qi=1024,Pi=1025,si=Or,gr=1026,Wi=1027,H=1028,Hr=1029,Da=1030,$n=1031,oa=1032,No=1033,Fs=33776,es=33777,fs=33778,to=33779,ts=35840,sa=35841,Bo=35842,Ea=35843,ms=36196,Vs=37808,no=37809,gs=37810,Pa=37811,ys=37812,ro=37813,io=37814,Xr=37815,Sr=37816,ns=37817,vs=37818,rs=37819,Fo=37820,Ji=37821,jr=2300,K=2301,Ce=2400,ue=2401,Te=2402,Ke=3e3,vt=3001,Ft=3007,Xt=3002,In=3003,Gn=3004,or=3005,hi=3006,ao=3200,Ci=3201,vo=0,Co=1,oo=7680,Gs=519,Wr=35044,wa=35048;function Ia(){}Object.assign(Ia.prototype,{addEventListener:function(e,t){this._listeners===void 0&&(this._listeners={});var n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)},hasEventListener:function(e,t){if(this._listeners===void 0)return!1;var n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(this._listeners!==void 0){var n=this._listeners[e];if(n!==void 0){var i=n.indexOf(t);i!==-1&&n.splice(i,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var t=this._listeners[e.type];if(t!==void 0){e.target=this;for(var n=t.slice(0),i=0,l=n.length;i<l;i++)n[i].call(this,e)}}}});for(var ea=[],Vo=0;Vo<256;Vo++)ea[Vo]=(Vo<16?"0":"")+Vo.toString(16);var xs,vr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(ea[255&e]+ea[e>>8&255]+ea[e>>16&255]+ea[e>>24&255]+"-"+ea[255&t]+ea[t>>8&255]+"-"+ea[t>>16&15|64]+ea[t>>24&255]+"-"+ea[63&n|128]+ea[n>>8&255]+"-"+ea[n>>16&255]+ea[n>>24&255]+ea[255&i]+ea[i>>8&255]+ea[i>>16&255]+ea[i>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,l){return i+(e-t)*(l-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*vr.DEG2RAD},radToDeg:function(e){return e*vr.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)==0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,l){var d=Math.cos,g=Math.sin,x=d(n/2),A=g(n/2),I=d((t+i)/2),Y=g((t+i)/2),Q=d((t-i)/2),ie=g((t-i)/2),z=d((i-t)/2),he=g((i-t)/2);l==="XYX"?e.set(x*Y,A*Q,A*ie,x*I):l==="YZY"?e.set(A*ie,x*Y,A*Q,x*I):l==="ZXZ"?e.set(A*Q,A*ie,x*Y,x*I):l==="XZX"?e.set(x*Y,A*he,A*z,x*I):l==="YXY"?e.set(A*z,x*Y,A*he,x*I):l==="ZYZ"?e.set(A*he,A*z,x*Y,x*I):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function zt(e,t){this.x=e||0,this.y=t||0}function Si(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(zt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(zt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),l=this.x-e.x,d=this.y-e.y;return this.x=l*n-d*i+e.x,this.y=l*i+d*n+e.y,this}}),Object.assign(Si.prototype,{isMatrix3:!0,set:function(e,t,n,i,l,d,g,x,A){var I=this.elements;return I[0]=e,I[1]=i,I[2]=g,I[3]=t,I[4]=l,I[5]=x,I[6]=n,I[7]=d,I[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,l=this.elements,d=n[0],g=n[3],x=n[6],A=n[1],I=n[4],Y=n[7],Q=n[2],ie=n[5],z=n[8],he=i[0],me=i[3],ye=i[6],Ee=i[1],Re=i[4],Ve=i[7],et=i[2],Fe=i[5],at=i[8];return l[0]=d*he+g*Ee+x*et,l[3]=d*me+g*Re+x*Fe,l[6]=d*ye+g*Ve+x*at,l[1]=A*he+I*Ee+Y*et,l[4]=A*me+I*Re+Y*Fe,l[7]=A*ye+I*Ve+Y*at,l[2]=Q*he+ie*Ee+z*et,l[5]=Q*me+ie*Re+z*Fe,l[8]=Q*ye+ie*Ve+z*at,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],l=e[3],d=e[4],g=e[5],x=e[6],A=e[7],I=e[8];return t*d*I-t*g*A-n*l*I+n*g*x+i*l*A-i*d*x},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,l=n[0],d=n[1],g=n[2],x=n[3],A=n[4],I=n[5],Y=n[6],Q=n[7],ie=n[8],z=ie*A-I*Q,he=I*Y-ie*x,me=Q*x-A*Y,ye=l*z+d*he+g*me;if(ye==0){var Ee="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(Ee);return console.warn(Ee),this.identity()}var Re=1/ye;return i[0]=z*Re,i[1]=(g*Q-ie*d)*Re,i[2]=(I*d-g*A)*Re,i[3]=he*Re,i[4]=(ie*l-g*Y)*Re,i[5]=(g*x-I*l)*Re,i[6]=me*Re,i[7]=(d*Y-Q*l)*Re,i[8]=(A*l-d*x)*Re,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,l,d,g){var x=Math.cos(l),A=Math.sin(l);this.set(n*x,n*A,-n*(x*d+A*g)+d+e,-i*A,i*x,-i*(-A*d+x*g)+g+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,l=i[0],d=i[3],g=i[6],x=i[1],A=i[4],I=i[7];return i[0]=t*l+n*x,i[3]=t*d+n*A,i[6]=t*g+n*I,i[1]=-n*l+t*x,i[4]=-n*d+t*A,i[7]=-n*g+t*I,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Go={getDataURL:function(e){var t;if(typeof HTMLCanvasElement>"u")return e.src;if(e instanceof HTMLCanvasElement)t=e;else{xs===void 0&&(xs=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),xs.width=e.width,xs.height=e.height;var n=xs.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=xs}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},lu=0;function Yr(e,t,n,i,l,d,g,x,A,I){Object.defineProperty(this,"id",{value:lu++}),this.uuid=vr.generateUUID(),this.name="",this.image=e!==void 0?e:Yr.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=t!==void 0?t:Yr.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:An,this.wrapT=i!==void 0?i:An,this.magFilter=l!==void 0?l:xn,this.minFilter=d!==void 0?d:er,this.anisotropy=A!==void 0?A:1,this.format=g!==void 0?g:Or,this.internalFormat=null,this.type=x!==void 0?x:kr,this.offset=new zt(0,0),this.repeat=new zt(1,1),this.center=new zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Si,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=I!==void 0?I:Ke,this.version=0,this.onUpdate=null}function Jr(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=i!==void 0?i:1}function qi(e,t,n){this.width=e,this.height=t,this.scissor=new Jr(0,0,e,t),this.scissorTest=!1,this.viewport=new Jr(0,0,e,t),n=n||{},this.texture=new Yr(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=n.generateMipmaps!==void 0&&n.generateMipmaps,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:xn,this.depthBuffer=n.depthBuffer===void 0||n.depthBuffer,this.stencilBuffer=n.stencilBuffer===void 0||n.stencilBuffer,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}function zs(e,t,n){qi.call(this,e,t,n),this.samples=4}function Bi(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=i!==void 0?i:1}Yr.DEFAULT_IMAGE=void 0,Yr.DEFAULT_MAPPING=300,Yr.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Yr,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var i=this.image;if(i.uuid===void 0&&(i.uuid=vr.generateUUID()),!t&&e.images[i.uuid]===void 0){var l;if(Array.isArray(i)){l=[];for(var d=0,g=i.length;d<g;d++)l.push(Go.getDataURL(i[d]))}else l=Go.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:l}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case Zt:e.x=e.x-Math.floor(e.x);break;case An:e.x=e.x<0?0:1;break;case Yn:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case Zt:e.y=e.y-Math.floor(e.y);break;case An:e.y=e.y<0?0:1;break;case Yn:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Yr.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.defineProperties(Jr.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Jr.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,l=this.w,d=e.elements;return this.x=d[0]*t+d[4]*n+d[8]*i+d[12]*l,this.y=d[1]*t+d[5]*n+d[9]*i+d[13]*l,this.z=d[2]*t+d[6]*n+d[10]*i+d[14]*l,this.w=d[3]*t+d[7]*n+d[11]*i+d[15]*l,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,l,d=e.elements,g=d[0],x=d[4],A=d[8],I=d[1],Y=d[5],Q=d[9],ie=d[2],z=d[6],he=d[10];if(Math.abs(x-I)<.01&&Math.abs(A-ie)<.01&&Math.abs(Q-z)<.01){if(Math.abs(x+I)<.1&&Math.abs(A+ie)<.1&&Math.abs(Q+z)<.1&&Math.abs(g+Y+he-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var me=(g+1)/2,ye=(Y+1)/2,Ee=(he+1)/2,Re=(x+I)/4,Ve=(A+ie)/4,et=(Q+z)/4;return ye<me&&Ee<me?l=me<.01?(n=0,i=.707106781):(i=Re/(n=Math.sqrt(me)),Ve/n):Ee<ye?l=ye<.01?(i=0,n=.707106781):(n=Re/(i=Math.sqrt(ye)),et/i):Ee<.01?(i=n=.707106781,l=0):(n=Ve/(l=Math.sqrt(Ee)),i=et/l),this.set(n,i,l,t),this}var Fe=Math.sqrt((z-Q)*(z-Q)+(A-ie)*(A-ie)+(I-x)*(I-x));return Math.abs(Fe)<.001&&(Fe=1),this.x=(z-Q)/Fe,this.y=(A-ie)/Fe,this.z=(I-x)/Fe,this.w=Math.acos((g+Y+he-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),qi.prototype=Object.assign(Object.create(Ia.prototype),{constructor:qi,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),zs.prototype=Object.assign(Object.create(qi.prototype),{constructor:zs,isWebGLMultisampleRenderTarget:!0,copy:function(e){return qi.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Bi,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,l,d,g){var x=n[i+0],A=n[i+1],I=n[i+2],Y=n[i+3],Q=l[d+0],ie=l[d+1],z=l[d+2],he=l[d+3];if(Y!==he||x!==Q||A!==ie||I!==z){var me=1-g,ye=x*Q+A*ie+I*z+Y*he,Ee=0<=ye?1:-1,Re=1-ye*ye;if(Re>Number.EPSILON){var Ve=Math.sqrt(Re),et=Math.atan2(Ve,ye*Ee);me=Math.sin(me*et)/Ve,g=Math.sin(g*et)/Ve}var Fe=g*Ee;if(x=x*me+Q*Fe,A=A*me+ie*Fe,I=I*me+z*Fe,Y=Y*me+he*Fe,me===1-g){var at=1/Math.sqrt(x*x+A*A+I*I+Y*Y);x*=at,A*=at,I*=at,Y*=at}}e[t]=x,e[t+1]=A,e[t+2]=I,e[t+3]=Y}}),Object.defineProperties(Bi.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Bi.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,l=e._z,d=e.order,g=Math.cos,x=Math.sin,A=g(n/2),I=g(i/2),Y=g(l/2),Q=x(n/2),ie=x(i/2),z=x(l/2);return d==="XYZ"?(this._x=Q*I*Y+A*ie*z,this._y=A*ie*Y-Q*I*z,this._z=A*I*z+Q*ie*Y,this._w=A*I*Y-Q*ie*z):d==="YXZ"?(this._x=Q*I*Y+A*ie*z,this._y=A*ie*Y-Q*I*z,this._z=A*I*z-Q*ie*Y,this._w=A*I*Y+Q*ie*z):d==="ZXY"?(this._x=Q*I*Y-A*ie*z,this._y=A*ie*Y+Q*I*z,this._z=A*I*z+Q*ie*Y,this._w=A*I*Y-Q*ie*z):d==="ZYX"?(this._x=Q*I*Y-A*ie*z,this._y=A*ie*Y+Q*I*z,this._z=A*I*z-Q*ie*Y,this._w=A*I*Y+Q*ie*z):d==="YZX"?(this._x=Q*I*Y+A*ie*z,this._y=A*ie*Y+Q*I*z,this._z=A*I*z-Q*ie*Y,this._w=A*I*Y-Q*ie*z):d==="XZY"&&(this._x=Q*I*Y-A*ie*z,this._y=A*ie*Y-Q*I*z,this._z=A*I*z+Q*ie*Y,this._w=A*I*Y+Q*ie*z),t!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],l=n[4],d=n[8],g=n[1],x=n[5],A=n[9],I=n[2],Y=n[6],Q=n[10],ie=i+x+Q;return 0<ie?(t=.5/Math.sqrt(ie+1),this._w=.25/t,this._x=(Y-A)*t,this._y=(d-I)*t,this._z=(g-l)*t):x<i&&Q<i?(t=2*Math.sqrt(1+i-x-Q),this._w=(Y-A)/t,this._x=.25*t,this._y=(l+g)/t,this._z=(d+I)/t):Q<x?(t=2*Math.sqrt(1+x-i-Q),this._w=(d-I)/t,this._x=(l+g)/t,this._y=.25*t,this._z=(A+Y)/t):(t=2*Math.sqrt(1+Q-i-x),this._w=(g-l)/t,this._x=(d+I)/t,this._y=(A+Y)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(vr.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(n===0)return this;var i=Math.min(1,t/n);return this.slerp(e,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,l=e._z,d=e._w,g=t._x,x=t._y,A=t._z,I=t._w;return this._x=n*I+d*g+i*A-l*x,this._y=i*I+d*x+l*g-n*A,this._z=l*I+d*A+n*x-i*g,this._w=d*I-n*g-i*x-l*A,this._onChangeCallback(),this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var n=this._x,i=this._y,l=this._z,d=this._w,g=d*e._w+n*e._x+i*e._y+l*e._z;if(g<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,g=-g):this.copy(e),1<=g)return this._w=d,this._x=n,this._y=i,this._z=l,this;var x=1-g*g;if(x<=Number.EPSILON){var A=1-t;return this._w=A*d+t*this._w,this._x=A*n+t*this._x,this._y=A*i+t*this._y,this._z=A*l+t*this._z,this.normalize(),this._onChangeCallback(),this}var I=Math.sqrt(x),Y=Math.atan2(I,g),Q=Math.sin((1-t)*Y)/I,ie=Math.sin(t*Y)/I;return this._w=d*Q+this._w*ie,this._x=n*Q+this._x*ie,this._y=i*Q+this._y*ie,this._z=l*Q+this._z*ie,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return t===void 0&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var ws=new Oe,Us=new Bi;function Oe(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(Oe.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Us.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Us.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,l=e.elements;return this.x=l[0]*t+l[3]*n+l[6]*i,this.y=l[1]*t+l[4]*n+l[7]*i,this.z=l[2]*t+l[5]*n+l[8]*i,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,l=e.elements,d=1/(l[3]*t+l[7]*n+l[11]*i+l[15]);return this.x=(l[0]*t+l[4]*n+l[8]*i+l[12])*d,this.y=(l[1]*t+l[5]*n+l[9]*i+l[13])*d,this.z=(l[2]*t+l[6]*n+l[10]*i+l[14])*d,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,l=e.x,d=e.y,g=e.z,x=e.w,A=x*t+d*i-g*n,I=x*n+g*t-l*i,Y=x*i+l*n-d*t,Q=-l*t-d*n-g*i;return this.x=A*x+Q*-l+I*-g-Y*-d,this.y=I*x+Q*-d+Y*-l-A*-g,this.z=Y*x+Q*-g+A*-d-I*-l,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,i=this.z,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*i,this.y=l[1]*t+l[5]*n+l[9]*i,this.z=l[2]*t+l[6]*n+l[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,l=e.z,d=t.x,g=t.y,x=t.z;return this.x=i*x-l*g,this.y=l*d-n*x,this.z=n*g-i*d,this},projectOnVector:function(e){var t=e.lengthSq();if(t===0)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return ws.copy(this).projectOnVector(e),this.sub(ws)},reflect:function(e){return this.sub(ws.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(vr.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var So=new Oe,ta=new fr,cu=new Oe(0,0,0),bs=new Oe(1,1,1),Do=new Oe,Hs=new Oe,ba=new Oe;function fr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(fr.prototype,{isMatrix4:!0,set:function(e,t,n,i,l,d,g,x,A,I,Y,Q,ie,z,he,me){var ye=this.elements;return ye[0]=e,ye[4]=t,ye[8]=n,ye[12]=i,ye[1]=l,ye[5]=d,ye[9]=g,ye[13]=x,ye[2]=A,ye[6]=I,ye[10]=Y,ye[14]=Q,ye[3]=ie,ye[7]=z,ye[11]=he,ye[15]=me,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new fr().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,i=1/So.setFromMatrixColumn(e,0).length(),l=1/So.setFromMatrixColumn(e,1).length(),d=1/So.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*l,t[5]=n[5]*l,t[6]=n[6]*l,t[7]=0,t[8]=n[8]*d,t[9]=n[9]*d,t[10]=n[10]*d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,l=e.z,d=Math.cos(n),g=Math.sin(n),x=Math.cos(i),A=Math.sin(i),I=Math.cos(l),Y=Math.sin(l);if(e.order==="XYZ"){var Q=d*I,ie=d*Y,z=g*I,he=g*Y;t[0]=x*I,t[4]=-x*Y,t[8]=A,t[1]=ie+z*A,t[5]=Q-he*A,t[9]=-g*x,t[2]=he-Q*A,t[6]=z+ie*A,t[10]=d*x}else if(e.order==="YXZ"){var me=x*I,ye=x*Y,Ee=A*I,Re=A*Y;t[0]=me+Re*g,t[4]=Ee*g-ye,t[8]=d*A,t[1]=d*Y,t[5]=d*I,t[9]=-g,t[2]=ye*g-Ee,t[6]=Re+me*g,t[10]=d*x}else if(e.order==="ZXY")me=x*I,ye=x*Y,Ee=A*I,Re=A*Y,t[0]=me-Re*g,t[4]=-d*Y,t[8]=Ee+ye*g,t[1]=ye+Ee*g,t[5]=d*I,t[9]=Re-me*g,t[2]=-d*A,t[6]=g,t[10]=d*x;else if(e.order==="ZYX")Q=d*I,ie=d*Y,z=g*I,he=g*Y,t[0]=x*I,t[4]=z*A-ie,t[8]=Q*A+he,t[1]=x*Y,t[5]=he*A+Q,t[9]=ie*A-z,t[2]=-A,t[6]=g*x,t[10]=d*x;else if(e.order==="YZX"){var Ve=d*x,et=d*A,Fe=g*x,at=g*A;t[0]=x*I,t[4]=at-Ve*Y,t[8]=Fe*Y+et,t[1]=Y,t[5]=d*I,t[9]=-g*I,t[2]=-A*I,t[6]=et*Y+Fe,t[10]=Ve-at*Y}else e.order==="XZY"&&(Ve=d*x,et=d*A,Fe=g*x,at=g*A,t[0]=x*I,t[4]=-Y,t[8]=A*I,t[1]=Ve*Y+at,t[5]=d*I,t[9]=et*Y-Fe,t[2]=Fe*Y-et,t[6]=g*I,t[10]=at*Y+Ve);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(cu,e,bs)},lookAt:function(e,t,n){var i=this.elements;return ba.subVectors(e,t),ba.lengthSq()===0&&(ba.z=1),ba.normalize(),Do.crossVectors(n,ba),Do.lengthSq()===0&&(Math.abs(n.z)===1?ba.x+=1e-4:ba.z+=1e-4,ba.normalize(),Do.crossVectors(n,ba)),Do.normalize(),Hs.crossVectors(ba,Do),i[0]=Do.x,i[4]=Hs.x,i[8]=ba.x,i[1]=Do.y,i[5]=Hs.y,i[9]=ba.y,i[2]=Do.z,i[6]=Hs.z,i[10]=ba.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,l=this.elements,d=n[0],g=n[4],x=n[8],A=n[12],I=n[1],Y=n[5],Q=n[9],ie=n[13],z=n[2],he=n[6],me=n[10],ye=n[14],Ee=n[3],Re=n[7],Ve=n[11],et=n[15],Fe=i[0],at=i[4],Je=i[8],xt=i[12],_t=i[1],Pt=i[5],Ot=i[9],Gt=i[13],Kt=i[2],Dt=i[6],Mt=i[10],dn=i[14],Mn=i[3],Zn=i[7],qn=i[11],Vn=i[15];return l[0]=d*Fe+g*_t+x*Kt+A*Mn,l[4]=d*at+g*Pt+x*Dt+A*Zn,l[8]=d*Je+g*Ot+x*Mt+A*qn,l[12]=d*xt+g*Gt+x*dn+A*Vn,l[1]=I*Fe+Y*_t+Q*Kt+ie*Mn,l[5]=I*at+Y*Pt+Q*Dt+ie*Zn,l[9]=I*Je+Y*Ot+Q*Mt+ie*qn,l[13]=I*xt+Y*Gt+Q*dn+ie*Vn,l[2]=z*Fe+he*_t+me*Kt+ye*Mn,l[6]=z*at+he*Pt+me*Dt+ye*Zn,l[10]=z*Je+he*Ot+me*Mt+ye*qn,l[14]=z*xt+he*Gt+me*dn+ye*Vn,l[3]=Ee*Fe+Re*_t+Ve*Kt+et*Mn,l[7]=Ee*at+Re*Pt+Ve*Dt+et*Zn,l[11]=Ee*Je+Re*Ot+Ve*Mt+et*qn,l[15]=Ee*xt+Re*Gt+Ve*dn+et*Vn,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],l=e[12],d=e[1],g=e[5],x=e[9],A=e[13],I=e[2],Y=e[6],Q=e[10],ie=e[14];return e[3]*(l*x*Y-i*A*Y-l*g*Q+n*A*Q+i*g*ie-n*x*ie)+e[7]*(t*x*ie-t*A*Q+l*d*Q-i*d*ie+i*A*I-l*x*I)+e[11]*(t*A*Y-t*g*ie-l*d*Y+n*d*ie+l*g*I-n*A*I)+e[15]*(-i*g*I-t*x*Y+t*g*Q+i*d*Y-n*d*Q+n*x*I)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this},getInverse:function(e,t){var n=this.elements,i=e.elements,l=i[0],d=i[1],g=i[2],x=i[3],A=i[4],I=i[5],Y=i[6],Q=i[7],ie=i[8],z=i[9],he=i[10],me=i[11],ye=i[12],Ee=i[13],Re=i[14],Ve=i[15],et=z*Re*Q-Ee*he*Q+Ee*Y*me-I*Re*me-z*Y*Ve+I*he*Ve,Fe=ye*he*Q-ie*Re*Q-ye*Y*me+A*Re*me+ie*Y*Ve-A*he*Ve,at=ie*Ee*Q-ye*z*Q+ye*I*me-A*Ee*me-ie*I*Ve+A*z*Ve,Je=ye*z*Y-ie*Ee*Y-ye*I*he+A*Ee*he+ie*I*Re-A*z*Re,xt=l*et+d*Fe+g*at+x*Je;if(xt==0){var _t="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(_t);return console.warn(_t),this.identity()}var Pt=1/xt;return n[0]=et*Pt,n[1]=(Ee*he*x-z*Re*x-Ee*g*me+d*Re*me+z*g*Ve-d*he*Ve)*Pt,n[2]=(I*Re*x-Ee*Y*x+Ee*g*Q-d*Re*Q-I*g*Ve+d*Y*Ve)*Pt,n[3]=(z*Y*x-I*he*x-z*g*Q+d*he*Q+I*g*me-d*Y*me)*Pt,n[4]=Fe*Pt,n[5]=(ie*Re*x-ye*he*x+ye*g*me-l*Re*me-ie*g*Ve+l*he*Ve)*Pt,n[6]=(ye*Y*x-A*Re*x-ye*g*Q+l*Re*Q+A*g*Ve-l*Y*Ve)*Pt,n[7]=(A*he*x-ie*Y*x+ie*g*Q-l*he*Q-A*g*me+l*Y*me)*Pt,n[8]=at*Pt,n[9]=(ye*z*x-ie*Ee*x-ye*d*me+l*Ee*me+ie*d*Ve-l*z*Ve)*Pt,n[10]=(A*Ee*x-ye*I*x+ye*d*Q-l*Ee*Q-A*d*Ve+l*I*Ve)*Pt,n[11]=(ie*I*x-A*z*x-ie*d*Q+l*z*Q+A*d*me-l*I*me)*Pt,n[12]=Je*Pt,n[13]=(ie*Ee*g-ye*z*g+ye*d*he-l*Ee*he-ie*d*Re+l*z*Re)*Pt,n[14]=(ye*I*g-A*Ee*g-ye*d*Y+l*Ee*Y+A*d*Re-l*I*Re)*Pt,n[15]=(A*z*g-ie*I*g+ie*d*Y-l*z*Y-A*d*he+l*I*he)*Pt,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,l=e.z;return t[0]*=n,t[4]*=i,t[8]*=l,t[1]*=n,t[5]*=i,t[9]*=l,t[2]*=n,t[6]*=i,t[10]*=l,t[3]*=n,t[7]*=i,t[11]*=l,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),l=1-n,d=e.x,g=e.y,x=e.z,A=l*d,I=l*g;return this.set(A*d+n,A*g-i*x,A*x+i*g,0,A*g+i*x,I*g+n,I*x-i*d,0,A*x-i*g,I*x+i*d,l*x*x+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var i=this.elements,l=t._x,d=t._y,g=t._z,x=t._w,A=l+l,I=d+d,Y=g+g,Q=l*A,ie=l*I,z=l*Y,he=d*I,me=d*Y,ye=g*Y,Ee=x*A,Re=x*I,Ve=x*Y,et=n.x,Fe=n.y,at=n.z;return i[0]=(1-(he+ye))*et,i[1]=(ie+Ve)*et,i[2]=(z-Re)*et,i[3]=0,i[4]=(ie-Ve)*Fe,i[5]=(1-(Q+ye))*Fe,i[6]=(me+Ee)*Fe,i[7]=0,i[8]=(z+Re)*at,i[9]=(me-Ee)*at,i[10]=(1-(Q+he))*at,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:function(e,t,n){var i=this.elements,l=So.set(i[0],i[1],i[2]).length(),d=So.set(i[4],i[5],i[6]).length(),g=So.set(i[8],i[9],i[10]).length();this.determinant()<0&&(l=-l),e.x=i[12],e.y=i[13],e.z=i[14],ta.copy(this);var x=1/l,A=1/d,I=1/g;return ta.elements[0]*=x,ta.elements[1]*=x,ta.elements[2]*=x,ta.elements[4]*=A,ta.elements[5]*=A,ta.elements[6]*=A,ta.elements[8]*=I,ta.elements[9]*=I,ta.elements[10]*=I,t.setFromRotationMatrix(ta),n.x=l,n.y=d,n.z=g,this},makePerspective:function(e,t,n,i,l,d){d===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var g=this.elements,x=2*l/(t-e),A=2*l/(n-i),I=(t+e)/(t-e),Y=(n+i)/(n-i),Q=-(d+l)/(d-l),ie=-2*d*l/(d-l);return g[0]=x,g[4]=0,g[8]=I,g[12]=0,g[1]=0,g[5]=A,g[9]=Y,g[13]=0,g[2]=0,g[6]=0,g[10]=Q,g[14]=ie,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makeOrthographic:function(e,t,n,i,l,d){var g=this.elements,x=1/(t-e),A=1/(n-i),I=1/(d-l),Y=(t+e)*x,Q=(n+i)*A,ie=(d+l)*I;return g[0]=2*x,g[4]=0,g[8]=0,g[12]=-Y,g[1]=0,g[5]=2*A,g[9]=0,g[13]=-Q,g[2]=0,g[6]=0,g[10]=-2*I,g[14]=-ie,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var _l=new fr,ac=new Bi;function y(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||y.DefaultOrder}function S(){this.mask=1}y.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],y.DefaultOrder="XYZ",Object.defineProperties(y.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(y.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=vr.clamp,l=e.elements,d=l[0],g=l[4],x=l[8],A=l[1],I=l[5],Y=l[9],Q=l[2],ie=l[6],z=l[10];return(t=t||this._order)==="XYZ"?(this._y=Math.asin(i(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(-Y,z),this._z=Math.atan2(-g,d)):(this._x=Math.atan2(ie,I),this._z=0)):t==="YXZ"?(this._x=Math.asin(-i(Y,-1,1)),Math.abs(Y)<.9999999?(this._y=Math.atan2(x,z),this._z=Math.atan2(A,I)):(this._y=Math.atan2(-Q,d),this._z=0)):t==="ZXY"?(this._x=Math.asin(i(ie,-1,1)),Math.abs(ie)<.9999999?(this._y=Math.atan2(-Q,z),this._z=Math.atan2(-g,I)):(this._y=0,this._z=Math.atan2(A,d))):t==="ZYX"?(this._y=Math.asin(-i(Q,-1,1)),Math.abs(Q)<.9999999?(this._x=Math.atan2(ie,z),this._z=Math.atan2(A,d)):(this._x=0,this._z=Math.atan2(-g,I))):t==="YZX"?(this._z=Math.asin(i(A,-1,1)),Math.abs(A)<.9999999?(this._x=Math.atan2(-Y,I),this._y=Math.atan2(-Q,d)):(this._x=0,this._y=Math.atan2(x,z))):t==="XZY"?(this._z=Math.asin(-i(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(ie,I),this._y=Math.atan2(x,d)):(this._x=Math.atan2(-Y,z),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return _l.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_l,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return ac.setFromEuler(this),this.setFromQuaternion(ac,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Oe(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(S.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!=0}});var Z=0,re=new Oe,de=new Bi,fe=new fr,_e=new Oe,Me=new Oe,Se=new Oe,je=new Bi,rt=new Oe(1,0,0),mt=new Oe(0,1,0),ut=new Oe(0,0,1),Lt={type:"added"},kn={type:"removed"};function At(){Object.defineProperty(this,"id",{value:Z++}),this.uuid=vr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=At.DefaultUp.clone();var e=new Oe,t=new y,n=new Bi,i=new Oe(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new fr},normalMatrix:{value:new Si}}),this.matrix=new fr,this.matrixWorld=new fr,this.matrixAutoUpdate=At.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new S,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Hn(){At.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}At.DefaultUp=new Oe(0,1,0),At.DefaultMatrixAutoUpdate=!0,At.prototype=Object.assign(Object.create(Ia.prototype),{constructor:At,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return de.setFromAxisAngle(e,t),this.quaternion.multiply(de),this},rotateOnWorldAxis:function(e,t){return de.setFromAxisAngle(e,t),this.quaternion.premultiply(de),this},rotateX:function(e){return this.rotateOnAxis(rt,e)},rotateY:function(e){return this.rotateOnAxis(mt,e)},rotateZ:function(e){return this.rotateOnAxis(ut,e)},translateOnAxis:function(e,t){return re.copy(e).applyQuaternion(this.quaternion),this.position.add(re.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(rt,e)},translateY:function(e){return this.translateOnAxis(mt,e)},translateZ:function(e){return this.translateOnAxis(ut,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(fe.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?_e.copy(e):_e.set(e,t,n);var i=this.parent;this.updateWorldMatrix(!0,!1),Me.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fe.lookAt(Me,_e,this.up):fe.lookAt(_e,Me,this.up),this.quaternion.setFromRotationMatrix(fe),i&&(fe.extractRotation(i.matrixWorld),de.setFromRotationMatrix(fe),this.quaternion.premultiply(de.inverse()))},add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),(e.parent=this).children.push(e),e.dispatchEvent(Lt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(kn)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),fe.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fe.multiply(e.parent.matrixWorld)),e.applyMatrix4(fe),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var l=this.children[n].getObjectByProperty(e,t);if(l!==void 0)return l}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Oe),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Bi),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Me,e,Se),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Oe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Me,je,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Oe),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0)for(var i=this.children,l=0,d=i.length;l<d;l++)i[l].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function l(ye,Ee){return ye[Ee.uuid]===void 0&&(ye[Ee.uuid]=Ee.toJSON(e)),Ee.uuid}if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=l(e.geometries,this.geometry);var d=this.geometry.parameters;if(d!==void 0&&d.shapes!==void 0){var g=d.shapes;if(Array.isArray(g))for(var x=0,A=g.length;x<A;x++){var I=g[x];l(e.shapes,I)}else l(e.shapes,g)}}if(this.material!==void 0)if(Array.isArray(this.material)){var Y=[];for(x=0,A=this.material.length;x<A;x++)Y.push(l(e.materials,this.material[x]));i.material=Y}else i.material=l(e.materials,this.material);if(0<this.children.length)for(i.children=[],x=0;x<this.children.length;x++)i.children.push(this.children[x].toJSON(e).object);if(t){var Q=me(e.geometries),ie=me(e.materials),z=me(e.textures),he=me(e.images);g=me(e.shapes),0<Q.length&&(n.geometries=Q),0<ie.length&&(n.materials=ie),0<z.length&&(n.textures=z),0<he.length&&(n.images=he),0<g.length&&(n.shapes=g)}return n.object=i,n;function me(ye){var Ee=[];for(var Re in ye){var Ve=ye[Re];delete Ve.metadata,Ee.push(Ve)}return Ee}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(t===void 0&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}}),Hn.prototype=Object.assign(Object.create(At.prototype),{constructor:Hn,isScene:!0,copy:function(e,t){return At.prototype.copy.call(this,e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=At.prototype.toJSON.call(this,e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.environment!==null&&(t.object.environment=this.environment.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Zr=[new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe],Fr=new Oe,la=new Xi,Ma=new Oe,dr=new Oe,_a=new Oe,xr=new Oe,Wn=new Oe,so=new Oe,zo=new Oe,ca=new Oe,Uo=new Oe,Ta=new Oe;function Xi(e,t){this.min=e!==void 0?e:new Oe(1/0,1/0,1/0),this.max=t!==void 0?t:new Oe(-1/0,-1/0,-1/0)}function lo(e,t,n,i,l){var d,g;for(d=0,g=e.length-3;d<=g;d+=3){Ta.fromArray(e,d);var x=l.x*Math.abs(Ta.x)+l.y*Math.abs(Ta.y)+l.z*Math.abs(Ta.z),A=t.dot(Ta),I=n.dot(Ta),Y=i.dot(Ta);if(Math.max(-Math.max(A,I,Y),Math.min(A,I,Y))>x)return!1}return!0}Object.assign(Xi.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,l=-1/0,d=-1/0,g=-1/0,x=0,A=e.length;x<A;x+=3){var I=e[x],Y=e[x+1],Q=e[x+2];I<t&&(t=I),Y<n&&(n=Y),Q<i&&(i=Q),l<I&&(l=I),d<Y&&(d=Y),g<Q&&(g=Q)}return this.min.set(t,n,i),this.max.set(l,d,g),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,l=-1/0,d=-1/0,g=-1/0,x=0,A=e.count;x<A;x++){var I=e.getX(x),Y=e.getY(x),Q=e.getZ(x);I<t&&(t=I),Y<n&&(n=Y),Q<i&&(i=Q),l<I&&(l=I),d<Y&&(d=Y),g<Q&&(g=Q)}return this.min.set(t,n,i),this.max.set(l,d,g),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=Fr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Oe),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Oe),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),la.copy(t.boundingBox),la.applyMatrix4(e.matrixWorld),this.expandByPoint(la.min),this.expandByPoint(la.max));for(var n=e.children,i=0,l=n.length;i<l;i++)this.expandByObject(n[i]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Oe),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Fr),Fr.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n;return n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(zo),ca.subVectors(this.max,zo),Ma.subVectors(e.a,zo),dr.subVectors(e.b,zo),_a.subVectors(e.c,zo),xr.subVectors(dr,Ma),Wn.subVectors(_a,dr),so.subVectors(Ma,_a);var t=[0,-xr.z,xr.y,0,-Wn.z,Wn.y,0,-so.z,so.y,xr.z,0,-xr.x,Wn.z,0,-Wn.x,so.z,0,-so.x,-xr.y,xr.x,0,-Wn.y,Wn.x,0,-so.y,so.x,0];return!!lo(t,Ma,dr,_a,ca)&&!!lo(t=[1,0,0,0,1,0,0,0,1],Ma,dr,_a,ca)&&(Uo.crossVectors(xr,Wn),lo(t=[Uo.x,Uo.y,Uo.z],Ma,dr,_a,ca))},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Oe),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Fr.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Fr).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(Zr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Zr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Zr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Zr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Zr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Zr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Zr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Zr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Zr)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Fi=new Xi;function Kr(e,t){this.center=e!==void 0?e:new Oe,this.radius=t!==void 0?t:0}Object.assign(Kr.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;t!==void 0?n.copy(t):Fi.setFromPoints(e).getCenter(n);for(var i=0,l=0,d=e.length;l<d;l++)i=Math.max(i,n.distanceToSquared(e[l]));return this.radius=Math.sqrt(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return t===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Oe),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Xi),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var $r=new Oe,Oi=new Oe,Ua=new Oe,wi=new Oe,Jn=new Oe,li=new Oe,ni=new Oe;function Ar(e,t){this.origin=e!==void 0?e:new Oe,this.direction=t!==void 0?t:new Oe(0,0,-1)}Object.assign(Ar.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return t===void 0&&(console.warn("THREE.Ray: .at() target is now required"),t=new Oe),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,$r)),this},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Oe),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=$r.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):($r.copy(this.direction).multiplyScalar(t).add(this.origin),$r.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,i){Oi.copy(e).add(t).multiplyScalar(.5),Ua.copy(t).sub(e).normalize(),wi.copy(this.origin).sub(Oi);var l,d,g,x,A=.5*e.distanceTo(t),I=-this.direction.dot(Ua),Y=wi.dot(this.direction),Q=-wi.dot(Ua),ie=wi.lengthSq(),z=Math.abs(1-I*I);if(0<z)if(d=I*Y-Q,x=A*z,0<=(l=I*Q-Y))if(-x<=d)if(d<=x){var he=1/z;g=(l*=he)*(l+I*(d*=he)+2*Y)+d*(I*l+d+2*Q)+ie}else d=A,g=-(l=Math.max(0,-(I*d+Y)))*l+d*(d+2*Q)+ie;else d=-A,g=-(l=Math.max(0,-(I*d+Y)))*l+d*(d+2*Q)+ie;else g=d<=-x?-(l=Math.max(0,-(-I*A+Y)))*l+(d=0<l?-A:Math.min(Math.max(-A,-Q),A))*(d+2*Q)+ie:d<=x?(l=0,(d=Math.min(Math.max(-A,-Q),A))*(d+2*Q)+ie):-(l=Math.max(0,-(I*A+Y)))*l+(d=0<l?A:Math.min(Math.max(-A,-Q),A))*(d+2*Q)+ie;else d=0<I?-A:A,g=-(l=Math.max(0,-(I*d+Y)))*l+d*(d+2*Q)+ie;return n&&n.copy(this.direction).multiplyScalar(l).add(this.origin),i&&i.copy(Ua).multiplyScalar(d).add(Oi),g},intersectSphere:function(e,t){$r.subVectors(e.center,this.origin);var n=$r.dot(this.direction),i=$r.dot($r)-n*n,l=e.radius*e.radius;if(l<i)return null;var d=Math.sqrt(l-i),g=n-d,x=n+d;return g<0&&x<0?null:g<0?this.at(x,t):this.at(g,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=n?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return n===null?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,i,l,d,g,x,A=1/this.direction.x,I=1/this.direction.y,Y=1/this.direction.z,Q=this.origin;return i=0<=A?(n=(e.min.x-Q.x)*A,(e.max.x-Q.x)*A):(n=(e.max.x-Q.x)*A,(e.min.x-Q.x)*A),(d=0<=I?(l=(e.min.y-Q.y)*I,(e.max.y-Q.y)*I):(l=(e.max.y-Q.y)*I,(e.min.y-Q.y)*I))<n||i<l?null:((n<l||n!=n)&&(n=l),(d<i||i!=i)&&(i=d),(x=0<=Y?(g=(e.min.z-Q.z)*Y,(e.max.z-Q.z)*Y):(g=(e.max.z-Q.z)*Y,(e.min.z-Q.z)*Y))<n||i<g?null:((n<g||n!=n)&&(n=g),(x<i||i!=i)&&(i=x),i<0?null:this.at(0<=n?n:i,t)))},intersectsBox:function(e){return this.intersectBox(e,$r)!==null},intersectTriangle:function(e,t,n,i,l){Jn.subVectors(t,e),li.subVectors(n,e),ni.crossVectors(Jn,li);var d,g=this.direction.dot(ni);if(0<g){if(i)return null;d=1}else{if(!(g<0))return null;d=-1,g=-g}wi.subVectors(this.origin,e);var x=d*this.direction.dot(li.crossVectors(wi,li));if(x<0)return null;var A=d*this.direction.dot(Jn.cross(wi));if(A<0||g<x+A)return null;var I=-d*wi.dot(ni);return I<0?null:this.at(I/g,l)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Ca=new Oe,Ms=new Oe,Tl=new Si;function na(e,t){this.normal=e!==void 0?e:new Oe(1,0,0),this.constant=t!==void 0?t:0}Object.assign(na.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){var i=Ca.subVectors(n,t).cross(Ms.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return t===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Oe),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){t===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Oe);var n=e.delta(Ca),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):void 0;var l=-(e.start.dot(this.normal)+this.constant)/i;return l<0||1<l?void 0:t.copy(n).multiplyScalar(l).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&0<n||n<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Oe),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var n=t||Tl.getNormalMatrix(e),i=this.coplanarPoint(Ca).applyMatrix4(e),l=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(l),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var ua=new Oe,Vi=new Oe,_s=new Oe,Ha=new Oe,xo=new Oe,Eo=new Oe,Cl=new Oe,di=new Oe,Ai=new Oe,Ws=new Oe;function Ri(e,t,n){this.a=e!==void 0?e:new Oe,this.b=t!==void 0?t:new Oe,this.c=n!==void 0?n:new Oe}Object.assign(Ri,{getNormal:function(e,t,n,i){i===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Oe),i.subVectors(n,t),ua.subVectors(e,t),i.cross(ua);var l=i.lengthSq();return 0<l?i.multiplyScalar(1/Math.sqrt(l)):i.set(0,0,0)},getBarycoord:function(e,t,n,i,l){ua.subVectors(i,t),Vi.subVectors(n,t),_s.subVectors(e,t);var d=ua.dot(ua),g=ua.dot(Vi),x=ua.dot(_s),A=Vi.dot(Vi),I=Vi.dot(_s),Y=d*A-g*g;if(l===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),l=new Oe),Y==0)return l.set(-2,-1,-1);var Q=1/Y,ie=(A*x-g*I)*Q,z=(d*I-g*x)*Q;return l.set(1-ie-z,z,ie)},containsPoint:function(e,t,n,i){return Ri.getBarycoord(e,t,n,i,Ha),0<=Ha.x&&0<=Ha.y&&Ha.x+Ha.y<=1},getUV:function(e,t,n,i,l,d,g,x){return this.getBarycoord(e,t,n,i,Ha),x.set(0,0),x.addScaledVector(l,Ha.x),x.addScaledVector(d,Ha.y),x.addScaledVector(g,Ha.z),x},isFrontFacing:function(e,t,n,i){return ua.subVectors(n,t),Vi.subVectors(e,t),ua.cross(Vi).dot(i)<0}}),Object.assign(Ri.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return ua.subVectors(this.c,this.b),Vi.subVectors(this.a,this.b),.5*ua.cross(Vi).length()},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Oe),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Ri.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new na),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Ri.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,i,l){return Ri.getUV(e,this.a,this.b,this.c,t,n,i,l)},containsPoint:function(e){return Ri.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Ri.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Oe);var n,i,l=this.a,d=this.b,g=this.c;xo.subVectors(d,l),Eo.subVectors(g,l),di.subVectors(e,l);var x=xo.dot(di),A=Eo.dot(di);if(x<=0&&A<=0)return t.copy(l);Ai.subVectors(e,d);var I=xo.dot(Ai),Y=Eo.dot(Ai);if(0<=I&&Y<=I)return t.copy(d);var Q=x*Y-I*A;if(Q<=0&&0<=x&&I<=0)return n=x/(x-I),t.copy(l).addScaledVector(xo,n);Ws.subVectors(e,g);var ie=xo.dot(Ws),z=Eo.dot(Ws);if(0<=z&&ie<=z)return t.copy(g);var he=ie*A-x*z;if(he<=0&&0<=A&&z<=0)return i=A/(A-z),t.copy(l).addScaledVector(Eo,i);var me=I*z-ie*Y;if(me<=0&&0<=Y-I&&0<=ie-z)return Cl.subVectors(g,d),i=(Y-I)/(Y-I+(ie-z)),t.copy(d).addScaledVector(Cl,i);var ye=1/(me+he+Q);return n=he*ye,i=Q*ye,t.copy(l).addScaledVector(xo,n).addScaledVector(Eo,i)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var Sl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Le={h:0,s:0,l:0},ot={h:0,s:0,l:0};function Qe(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}function St(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function jt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function gn(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function yn(e,t,n,i,l,d){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new Oe,this.vertexNormals=Array.isArray(i)?i:[],this.color=l&&l.isColor?l:new Qe,this.vertexColors=Array.isArray(l)?l:[],this.materialIndex=d!==void 0?d:0}Object.assign(Qe.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=vr.euclideanModulo(e,1),t=vr.clamp(t,0,1),n=vr.clamp(n,0,1),t===0)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,l=2*n-i;this.r=St(l,i,e+1/3),this.g=St(l,i,e),this.b=St(l,i,e-1/3)}return this},setStyle:function(e){function t(Q){Q!==void 0&&parseFloat(Q)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,l=n[1],d=n[2];switch(l){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var g=parseFloat(i[1])/360,x=parseInt(i[2],10)/100,A=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(g,x,A)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var I=n[1],Y=I.length;if(Y===3)return this.r=parseInt(I.charAt(0)+I.charAt(0),16)/255,this.g=parseInt(I.charAt(1)+I.charAt(1),16)/255,this.b=parseInt(I.charAt(2)+I.charAt(2),16)/255,this;if(Y===6)return this.r=parseInt(I.charAt(0)+I.charAt(1),16)/255,this.g=parseInt(I.charAt(2)+I.charAt(3),16)/255,this.b=parseInt(I.charAt(4)+I.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(e){var t=Sl[e];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return t===void 0&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){t===void 0&&(t=2);var n=0<t?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=jt(e.r),this.g=jt(e.g),this.b=jt(e.b),this},copyLinearToSRGB:function(e){return this.r=gn(e.r),this.g=gn(e.g),this.b=gn(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,i=this.r,l=this.g,d=this.b,g=Math.max(i,l,d),x=Math.min(i,l,d),A=(x+g)/2;if(x===g)n=t=0;else{var I=g-x;switch(n=A<=.5?I/(g+x):I/(2-g-x),g){case i:t=(l-d)/I+(l<d?6:0);break;case l:t=(d-i)/I+2;break;case d:t=(i-l)/I+4}t/=6}return e.h=t,e.s=n,e.l=A,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Le),Le.h+=e,Le.s+=t,Le.l+=n,this.setHSL(Le.h,Le.s,Le.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Le),e.getHSL(ot);var n=vr.lerp(Le.h,ot.h,t),i=vr.lerp(Le.s,ot.s,t),l=vr.lerp(Le.l,ot.l,t);return this.setHSL(n,i,l),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return t===void 0&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Qe.NAMES=Sl,Object.assign(yn.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Rn=0;function kt(){Object.defineProperty(this,"id",{value:Rn++}),this.uuid=vr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=M,this.side=O,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=V,this.opacity=1,this.transparent=!1,this.blendSrc=W,this.blendDst=te,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=oe,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Gs,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=oo,this.stencilZFail=oo,this.stencilZPass=oo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Mr(e){kt.call(this),this.type="MeshBasicMaterial",this.color=new Qe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}kt.prototype=Object.assign(Object.create(Ia.prototype),{constructor:kt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var t in e){var n=e[t];if(n!==void 0)if(t!=="shading"){var i=this[t];i!==void 0?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(g){var x=[];for(var A in g){var I=g[A];delete I.metadata,x.push(I)}return x}if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==M&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==O&&(n.side=this.side),this.vertexColors!==V&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),t){var l=i(e.textures),d=i(e.images);0<l.length&&(n.textures=l),0<d.length&&(n.images=d)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(t!==null){var i=t.length;n=new Array(i);for(var l=0;l!==i;++l)n[l]=t[l].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(kt.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),((Mr.prototype=Object.create(kt.prototype)).constructor=Mr).prototype.isMeshBasicMaterial=!0,Mr.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Cn=new Oe;function en(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=Wr,this.updateRange={offset:0,count:-1},this.version=0}function Rr(e,t,n){en.call(this,new Int8Array(e),t,n)}function tr(e,t,n){en.call(this,new Uint8Array(e),t,n)}function ci(e,t,n){en.call(this,new Uint8ClampedArray(e),t,n)}function bi(e,t,n){en.call(this,new Int16Array(e),t,n)}function pi(e,t,n){en.call(this,new Uint16Array(e),t,n)}function be(e,t,n){en.call(this,new Int32Array(e),t,n)}function Mi(e,t,n){en.call(this,new Uint32Array(e),t,n)}function on(e,t,n){en.call(this,new Float32Array(e),t,n)}function Tr(e,t,n){en.call(this,new Float64Array(e),t,n)}function wr(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Yi(e){if(e.length===0)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(en.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(en.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,l=this.itemSize;i<l;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,l=e.length;i<l;i++){var d=e[i];d===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),d=new Qe),t[n++]=d.r,t[n++]=d.g,t[n++]=d.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,l=e.length;i<l;i++){var d=e[i];d===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),d=new zt),t[n++]=d.x,t[n++]=d.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,l=e.length;i<l;i++){var d=e[i];d===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),d=new Oe),t[n++]=d.x,t[n++]=d.y,t[n++]=d.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,l=e.length;i<l;i++){var d=e[i];d===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),d=new Jr),t[n++]=d.x,t[n++]=d.y,t[n++]=d.z,t[n++]=d.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)Cn.x=this.getX(t),Cn.y=this.getY(t),Cn.z=this.getZ(t),Cn.applyMatrix3(e),this.setXYZ(t,Cn.x,Cn.y,Cn.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)Cn.x=this.getX(t),Cn.y=this.getY(t),Cn.z=this.getZ(t),Cn.applyMatrix4(e),this.setXYZ(t,Cn.x,Cn.y,Cn.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Cn.x=this.getX(t),Cn.y=this.getY(t),Cn.z=this.getZ(t),Cn.applyNormalMatrix(e),this.setXYZ(t,Cn.x,Cn.y,Cn.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Cn.x=this.getX(t),Cn.y=this.getY(t),Cn.z=this.getZ(t),Cn.transformDirection(e),this.setXYZ(t,Cn.x,Cn.y,Cn.z);return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.itemSize<3?0:this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,l){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=l,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(Rr.prototype=Object.create(en.prototype)).constructor=Rr,(tr.prototype=Object.create(en.prototype)).constructor=tr,(ci.prototype=Object.create(en.prototype)).constructor=ci,(bi.prototype=Object.create(en.prototype)).constructor=bi,(pi.prototype=Object.create(en.prototype)).constructor=pi,(be.prototype=Object.create(en.prototype)).constructor=be,(Mi.prototype=Object.create(en.prototype)).constructor=Mi,(on.prototype=Object.create(en.prototype)).constructor=on,(Tr.prototype=Object.create(en.prototype)).constructor=Tr,Object.assign(wr.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,l=e.faces,d=0;d<l.length;d++){var g=l[d];g.materialIndex!==i&&(i=g.materialIndex,t!==void 0&&(t.count=3*d-t.start,n.push(t)),t={start:3*d,materialIndex:i})}t!==void 0&&(t.count=3*d-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,i=e.vertices,l=e.faceVertexUvs,d=l[0]&&0<l[0].length,g=l[1]&&0<l[1].length,x=e.morphTargets,A=x.length;if(0<A){t=[];for(var I=0;I<A;I++)t[I]={name:x[I].name,data:[]};this.morphTargets.position=t}var Y,Q=e.morphNormals,ie=Q.length;if(0<ie){for(Y=[],I=0;I<ie;I++)Y[I]={name:Q[I].name,data:[]};this.morphTargets.normal=Y}var z=e.skinIndices,he=e.skinWeights,me=z.length===i.length,ye=he.length===i.length;for(0<i.length&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),I=0;I<n.length;I++){var Ee=n[I];this.vertices.push(i[Ee.a],i[Ee.b],i[Ee.c]);var Re=Ee.vertexNormals;if(Re.length===3)this.normals.push(Re[0],Re[1],Re[2]);else{var Ve=Ee.normal;this.normals.push(Ve,Ve,Ve)}var et,Fe=Ee.vertexColors;if(Fe.length===3)this.colors.push(Fe[0],Fe[1],Fe[2]);else{var at=Ee.color;this.colors.push(at,at,at)}d===!0&&((et=l[0][I])!==void 0?this.uvs.push(et[0],et[1],et[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",I),this.uvs.push(new zt,new zt,new zt))),g===!0&&((et=l[1][I])!==void 0?this.uvs2.push(et[0],et[1],et[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",I),this.uvs2.push(new zt,new zt,new zt)));for(var Je=0;Je<A;Je++){var xt=x[Je].vertices;t[Je].data.push(xt[Ee.a],xt[Ee.b],xt[Ee.c])}for(Je=0;Je<ie;Je++){var _t=Q[Je].vertexNormals[I];Y[Je].data.push(_t.a,_t.b,_t.c)}me&&this.skinIndices.push(z[Ee.a],z[Ee.b],z[Ee.c]),ye&&this.skinWeights.push(he[Ee.a],he[Ee.b],he[Ee.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});var Wa=2147483647,Gi=new fr,wo=new At,ha=new Oe,Ja=new Xi,Dl=new Xi,Li=new Oe;function Sn(){Object.defineProperty(this,"id",{value:Wa+=2}),this.uuid=vr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Sn.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Sn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<Yi(e)?Mi:pi)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(n!==void 0){var i=new Si().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}var l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(e),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return Gi.makeRotationX(e),this.applyMatrix4(Gi),this},rotateY:function(e){return Gi.makeRotationY(e),this.applyMatrix4(Gi),this},rotateZ:function(e){return Gi.makeRotationZ(e),this.applyMatrix4(Gi),this},translate:function(e,t,n){return Gi.makeTranslation(e,t,n),this.applyMatrix4(Gi),this},scale:function(e,t,n){return Gi.makeScale(e,t,n),this.applyMatrix4(Gi),this},lookAt:function(e){return wo.lookAt(e),wo.updateMatrix(),this.applyMatrix4(wo.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ha).negate(),this.translate(ha.x,ha.y,ha.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new on(3*t.vertices.length,3),i=new on(3*t.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var l=new on(t.lineDistances.length,1);this.setAttribute("lineDistance",l.copyArray(t.lineDistances))}t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var l=e[n];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new on(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var i=n.__directGeometry;if(n.elementsNeedUpdate===!0&&(i=void 0,n.elementsNeedUpdate=!1),i===void 0)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return n.verticesNeedUpdate===!0&&((t=this.attributes.position)!==void 0&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),n.normalsNeedUpdate===!0&&((t=this.attributes.normal)!==void 0&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),n.colorsNeedUpdate===!0&&((t=this.attributes.color)!==void 0&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&((t=this.attributes.uv)!==void 0&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&((t=this.attributes.lineDistance)!==void 0&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new wr().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new en(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var n=new Float32Array(3*e.normals.length);this.setAttribute("normal",new en(n,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var i=new Float32Array(3*e.colors.length);this.setAttribute("color",new en(i,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var l=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new en(l,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var d=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new en(d,2).copyVector2sArray(e.uvs2))}for(var g in this.groups=e.groups,e.morphTargets){for(var x=[],A=e.morphTargets[g],I=0,Y=A.length;I<Y;I++){var Q=A[I],ie=new on(3*Q.data.length,3);ie.name=Q.name,x.push(ie.copyVector3sArray(Q.data))}this.morphAttributes[g]=x}if(0<e.skinIndices.length){var z=new on(4*e.skinIndices.length,4);this.setAttribute("skinIndex",z.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var he=new on(4*e.skinWeights.length,4);this.setAttribute("skinWeight",he.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Xi);var e=this.attributes.position,t=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,i=t.length;n<i;n++){var l=t[n];Ja.setFromBufferAttribute(l),this.morphTargetsRelative?(Li.addVectors(this.boundingBox.min,Ja.min),this.boundingBox.expandByPoint(Li),Li.addVectors(this.boundingBox.max,Ja.max),this.boundingBox.expandByPoint(Li)):(this.boundingBox.expandByPoint(Ja.min),this.boundingBox.expandByPoint(Ja.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Kr);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(Ja.setFromBufferAttribute(e),t)for(var i=0,l=t.length;i<l;i++){var d=t[i];Dl.setFromBufferAttribute(d),this.morphTargetsRelative?(Li.addVectors(Ja.min,Dl.min),Ja.expandByPoint(Li),Li.addVectors(Ja.max,Dl.max),Ja.expandByPoint(Li)):(Ja.expandByPoint(Dl.min),Ja.expandByPoint(Dl.max))}Ja.getCenter(n);var g=0;for(i=0,l=e.count;i<l;i++)Li.fromBufferAttribute(e,i),g=Math.max(g,n.distanceToSquared(Li));if(t)for(i=0,l=t.length;i<l;i++){d=t[i];for(var x=this.morphTargetsRelative,A=0,I=d.count;A<I;A++)Li.fromBufferAttribute(d,A),x&&(ha.fromBufferAttribute(e,A),Li.add(ha)),g=Math.max(g,n.distanceToSquared(Li))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(t.normal===void 0)this.setAttribute("normal",new en(new Float32Array(n.length),3));else for(var i=t.normal.array,l=0,d=i.length;l<d;l++)i[l]=0;var g,x,A,I=t.normal.array,Y=new Oe,Q=new Oe,ie=new Oe,z=new Oe,he=new Oe;if(e){var me=e.array;for(l=0,d=e.count;l<d;l+=3)g=3*me[l+0],x=3*me[l+1],A=3*me[l+2],Y.fromArray(n,g),Q.fromArray(n,x),ie.fromArray(n,A),z.subVectors(ie,Q),he.subVectors(Y,Q),z.cross(he),I[g]+=z.x,I[1+g]+=z.y,I[2+g]+=z.z,I[x]+=z.x,I[1+x]+=z.y,I[2+x]+=z.z,I[A]+=z.x,I[1+A]+=z.y,I[2+A]+=z.z}else for(l=0,d=n.length;l<d;l+=9)Y.fromArray(n,l),Q.fromArray(n,l+3),ie.fromArray(n,l+6),z.subVectors(ie,Q),he.subVectors(Y,Q),z.cross(he),I[l]=z.x,I[l+1]=z.y,I[l+2]=z.z,I[l+3]=z.x,I[l+4]=z.y,I[l+5]=z.z,I[l+6]=z.x,I[l+7]=z.y,I[l+8]=z.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(e.attributes[i]!==void 0)for(var l=n[i].array,d=e.attributes[i],g=d.array,x=d.itemSize*t,A=Math.min(g.length,l.length-x),I=0,Y=x;I<A;I++,Y++)l[Y]=g[I];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Li.x=e.getX(t),Li.y=e.getY(t),Li.z=e.getZ(t),Li.normalize(),e.setXYZ(t,Li.x,Li.y,Li.z)},toNonIndexed:function(){function e(he,me){for(var ye=he.array,Ee=he.itemSize,Re=new ye.constructor(me.length*Ee),Ve=0,et=0,Fe=0,at=me.length;Fe<at;Fe++){Ve=me[Fe]*Ee;for(var Je=0;Je<Ee;Je++)Re[et++]=ye[Ve++]}return new en(Re,Ee)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Sn,n=this.index.array,i=this.attributes;for(var l in i){var d=e(i[l],n);t.setAttribute(l,d)}var g=this.morphAttributes;for(l in g){for(var x=[],A=g[l],I=0,Y=A.length;I<Y;I++)d=e(A[I],n),x.push(d);t.morphAttributes[l]=x}t.morphTargetsRelative=this.morphTargetsRelative;for(var Q=this.groups,ie=(I=0,Q.length);I<ie;I++){var z=Q[I];t.addGroup(z.start,z.count,z.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var l=this.attributes;for(var n in l){var d=(ie=l[n]).toJSON();ie.name!==""&&(d.name=ie.name),e.data.attributes[n]=d}var g={},x=!1;for(var n in this.morphAttributes){for(var A=this.morphAttributes[n],I=[],Y=0,Q=A.length;Y<Q;Y++){var ie;d=(ie=A[Y]).toJSON(),ie.name!==""&&(d.name=ie.name),I.push(d)}0<I.length&&(g[n]=I,x=!0)}x&&(e.data.morphAttributes=g,e.data.morphTargetsRelative=this.morphTargetsRelative);var z=this.groups;0<z.length&&(e.data.groups=JSON.parse(JSON.stringify(z)));var he=this.boundingSphere;return he!==null&&(e.data.boundingSphere={center:he.center.toArray(),radius:he.radius}),e},clone:function(){return new Sn().copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var l=e.index;l!==null&&this.setIndex(l.clone());var d=e.attributes;for(t in d){var g=d[t];this.setAttribute(t,g.clone())}var x=e.morphAttributes;for(t in x){var A=[],I=x[t];for(n=0,i=I.length;n<i;n++)A.push(I[n].clone());this.morphAttributes[t]=A}this.morphTargetsRelative=e.morphTargetsRelative;var Y=e.groups;for(n=0,i=Y.length;n<i;n++){var Q=Y[n];this.addGroup(Q.start,Q.count,Q.materialIndex)}var ie=e.boundingBox;ie!==null&&(this.boundingBox=ie.clone());var z=e.boundingSphere;return z!==null&&(this.boundingSphere=z.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var oc=new fr,Js=new Ar,uu=new Kr,ka=new Oe,is=new Oe,co=new Oe,qa=new Oe,hu=new Oe,du=new Oe,Ts=new Oe,Po=new Oe,sc=new Oe,El=new zt,as=new zt,qs=new zt,zi=new Oe,Pl=new Oe;function _i(e,t){At.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new Sn,this.material=t!==void 0?t:new Mr,this.updateMorphTargets()}function Oo(e,t,n,i,l,d,g,x){if((t.side===C?i.intersectTriangle(g,d,l,!0,x):i.intersectTriangle(l,d,g,t.side!==j,x))===null)return null;Pl.copy(x),Pl.applyMatrix4(e.matrixWorld);var A=n.ray.origin.distanceTo(Pl);return A<n.near||A>n.far?null:{distance:A,point:Pl.clone(),object:e}}function Ol(e,t,n,i,l,d,g,x,A,I,Y,Q){ka.fromBufferAttribute(l,I),is.fromBufferAttribute(l,Y),co.fromBufferAttribute(l,Q);var ie=e.morphTargetInfluences;if(t.morphTargets&&d&&ie){Ts.set(0,0,0),Po.set(0,0,0),sc.set(0,0,0);for(var z=0,he=d.length;z<he;z++){var me=ie[z],ye=d[z];me!==0&&(qa.fromBufferAttribute(ye,I),hu.fromBufferAttribute(ye,Y),du.fromBufferAttribute(ye,Q),g?(Ts.addScaledVector(qa,me),Po.addScaledVector(hu,me),sc.addScaledVector(du,me)):(Ts.addScaledVector(qa.sub(ka),me),Po.addScaledVector(hu.sub(is),me),sc.addScaledVector(du.sub(co),me)))}ka.add(Ts),is.add(Po),co.add(sc)}var Ee=Oo(e,t,n,i,ka,is,co,zi);if(Ee){x&&(El.fromBufferAttribute(x,I),as.fromBufferAttribute(x,Y),qs.fromBufferAttribute(x,Q),Ee.uv=Ri.getUV(zi,ka,is,co,El,as,qs,new zt)),A&&(El.fromBufferAttribute(A,I),as.fromBufferAttribute(A,Y),qs.fromBufferAttribute(A,Q),Ee.uv2=Ri.getUV(zi,ka,is,co,El,as,qs,new zt));var Re=new yn(I,Y,Q);Ri.getNormal(ka,is,co,Re.normal),Ee.face=Re}return Ee}_i.prototype=Object.assign(Object.create(At.prototype),{constructor:_i,isMesh:!0,copy:function(e){return At.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var l=i.morphAttributes,d=Object.keys(l);if(0<d.length){var g=l[d[0]];if(g!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=g.length;e<t;e++)n=g[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var x=i.morphTargets;x!==void 0&&0<x.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,i=this.geometry,l=this.material,d=this.matrixWorld;if(l!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),uu.copy(i.boundingSphere),uu.applyMatrix4(d),e.ray.intersectsSphere(uu)!==!1&&(oc.getInverse(d),Js.copy(e.ray).applyMatrix4(oc),i.boundingBox===null||Js.intersectsBox(i.boundingBox)!==!1))){if(i.isBufferGeometry){var g,x,A,I,Y,Q,ie,z,he,me=i.index,ye=i.attributes.position,Ee=i.morphAttributes.position,Re=i.morphTargetsRelative,Ve=i.attributes.uv,et=i.attributes.uv2,Fe=i.groups,at=i.drawRange;if(me!==null)if(Array.isArray(l))for(I=0,Q=Fe.length;I<Q;I++)for(he=l[(z=Fe[I]).materialIndex],Y=Math.max(z.start,at.start),ie=Math.min(z.start+z.count,at.start+at.count);Y<ie;Y+=3)g=me.getX(Y),x=me.getX(Y+1),A=me.getX(Y+2),(n=Ol(this,he,e,Js,ye,Ee,Re,Ve,et,g,x,A))&&(n.faceIndex=Math.floor(Y/3),n.face.materialIndex=z.materialIndex,t.push(n));else for(I=Math.max(0,at.start),Q=Math.min(me.count,at.start+at.count);I<Q;I+=3)g=me.getX(I),x=me.getX(I+1),A=me.getX(I+2),(n=Ol(this,l,e,Js,ye,Ee,Re,Ve,et,g,x,A))&&(n.faceIndex=Math.floor(I/3),t.push(n));else if(ye!==void 0)if(Array.isArray(l))for(I=0,Q=Fe.length;I<Q;I++)for(he=l[(z=Fe[I]).materialIndex],Y=Math.max(z.start,at.start),ie=Math.min(z.start+z.count,at.start+at.count);Y<ie;Y+=3)(n=Ol(this,he,e,Js,ye,Ee,Re,Ve,et,g=Y,x=Y+1,A=Y+2))&&(n.faceIndex=Math.floor(Y/3),n.face.materialIndex=z.materialIndex,t.push(n));else for(I=Math.max(0,at.start),Q=Math.min(ye.count,at.start+at.count);I<Q;I+=3)(n=Ol(this,l,e,Js,ye,Ee,Re,Ve,et,g=I,x=I+1,A=I+2))&&(n.faceIndex=Math.floor(I/3),t.push(n))}else if(i.isGeometry){var Je,xt,_t,Pt,Ot=Array.isArray(l),Gt=i.vertices,Kt=i.faces,Dt=i.faceVertexUvs[0];0<Dt.length&&(Pt=Dt);for(var Mt=0,dn=Kt.length;Mt<dn;Mt++){var Mn=Kt[Mt],Zn=Ot?l[Mn.materialIndex]:l;if(Zn!==void 0&&(Je=Gt[Mn.a],xt=Gt[Mn.b],_t=Gt[Mn.c],n=Oo(this,Zn,e,Js,Je,xt,_t,zi))){if(Pt&&Pt[Mt]){var qn=Pt[Mt];El.copy(qn[0]),as.copy(qn[1]),qs.copy(qn[2]),n.uv=Ri.getUV(zi,Je,xt,_t,El,as,qs,new zt)}n.face=Mn,n.faceIndex=Mt,t.push(n)}}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var pu=0,Oa=new fr,fu=new At,da=new Oe;function sr(){Object.defineProperty(this,"id",{value:pu+=2}),this.uuid=vr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}sr.prototype=Object.assign(Object.create(Ia.prototype),{constructor:sr,isGeometry:!0,applyMatrix4:function(e){for(var t=new Si().getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(e);for(n=0,i=this.faces.length;n<i;n++){var l=this.faces[n];l.normal.applyMatrix3(t).normalize();for(var d=0,g=l.vertexNormals.length;d<g;d++)l.vertexNormals[d].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Oa.makeRotationX(e),this.applyMatrix4(Oa),this},rotateY:function(e){return Oa.makeRotationY(e),this.applyMatrix4(Oa),this},rotateZ:function(e){return Oa.makeRotationZ(e),this.applyMatrix4(Oa),this},translate:function(e,t,n){return Oa.makeTranslation(e,t,n),this.applyMatrix4(Oa),this},scale:function(e,t,n){return Oa.makeScale(e,t,n),this.applyMatrix4(Oa),this},lookAt:function(e){return fu.lookAt(e),fu.updateMatrix(),this.applyMatrix4(fu.matrix),this},fromBufferGeometry:function(e){var t=this,n=e.index!==null?e.index.array:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var l=i.position.array,d=i.normal!==void 0?i.normal.array:void 0,g=i.color!==void 0?i.color.array:void 0,x=i.uv!==void 0?i.uv.array:void 0,A=i.uv2!==void 0?i.uv2.array:void 0;A!==void 0&&(this.faceVertexUvs[1]=[]);for(var I=0;I<l.length;I+=3)t.vertices.push(new Oe().fromArray(l,I)),g!==void 0&&t.colors.push(new Qe().fromArray(g,I));function Y(ye,Ee,Re,Ve){var et=g===void 0?[]:[t.colors[ye].clone(),t.colors[Ee].clone(),t.colors[Re].clone()],Fe=new yn(ye,Ee,Re,d===void 0?[]:[new Oe().fromArray(d,3*ye),new Oe().fromArray(d,3*Ee),new Oe().fromArray(d,3*Re)],et,Ve);t.faces.push(Fe),x!==void 0&&t.faceVertexUvs[0].push([new zt().fromArray(x,2*ye),new zt().fromArray(x,2*Ee),new zt().fromArray(x,2*Re)]),A!==void 0&&t.faceVertexUvs[1].push([new zt().fromArray(A,2*ye),new zt().fromArray(A,2*Ee),new zt().fromArray(A,2*Re)])}var Q=e.groups;if(0<Q.length)for(I=0;I<Q.length;I++)for(var ie=Q[I],z=ie.start,he=z,me=z+ie.count;he<me;he+=3)n!==void 0?Y(n[he],n[he+1],n[he+2],ie.materialIndex):Y(he,he+1,he+2,ie.materialIndex);else if(n!==void 0)for(I=0;I<n.length;I+=3)Y(n[I],n[I+1],n[I+2]);else for(I=0;I<l.length/3;I+=3)Y(I,I+1,I+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(da).negate(),this.translate(da.x,da.y,da.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=t===0?1:1/t,i=new fr;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var e=new Oe,t=new Oe,n=0,i=this.faces.length;n<i;n++){var l=this.faces[n],d=this.vertices[l.a],g=this.vertices[l.b],x=this.vertices[l.c];e.subVectors(x,g),t.subVectors(d,g),e.cross(t),e.normalize(),l.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,l,d,g;for(e===void 0&&(e=!0),g=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)g[t]=new Oe;if(e){var x,A,I,Y=new Oe,Q=new Oe;for(i=0,l=this.faces.length;i<l;i++)d=this.faces[i],x=this.vertices[d.a],A=this.vertices[d.b],I=this.vertices[d.c],Y.subVectors(I,A),Q.subVectors(x,A),Y.cross(Q),g[d.a].add(Y),g[d.b].add(Y),g[d.c].add(Y)}else for(this.computeFaceNormals(),i=0,l=this.faces.length;i<l;i++)g[(d=this.faces[i]).a].add(d.normal),g[d.b].add(d.normal),g[d.c].add(d.normal);for(t=0,n=this.vertices.length;t<n;t++)g[t].normalize();for(i=0,l=this.faces.length;i<l;i++){var ie=(d=this.faces[i]).vertexNormals;ie.length===3?(ie[0].copy(g[d.a]),ie[1].copy(g[d.b]),ie[2].copy(g[d.c])):(ie[0]=g[d.a].clone(),ie[1]=g[d.b].clone(),ie[2]=g[d.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var i=(n=this.faces[e]).vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,l;for(n=0,i=this.faces.length;n<i;n++)for((l=this.faces[n]).__originalFaceNormal?l.__originalFaceNormal.copy(l.normal):l.__originalFaceNormal=l.normal.clone(),l.__originalVertexNormals||(l.__originalVertexNormals=[]),e=0,t=l.vertexNormals.length;e<t;e++)l.__originalVertexNormals[e]?l.__originalVertexNormals[e].copy(l.vertexNormals[e]):l.__originalVertexNormals[e]=l.vertexNormals[e].clone();var d=new sr;for(d.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var g=this.morphNormals[e].faceNormals,x=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)A=new Oe,I={a:new Oe,b:new Oe,c:new Oe},g.push(A),x.push(I)}var A,I,Y=this.morphNormals[e];for(d.vertices=this.morphTargets[e].vertices,d.computeFaceNormals(),d.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)l=this.faces[n],A=Y.faceNormals[n],I=Y.vertexNormals[n],A.copy(l.normal),I.a.copy(l.vertexNormals[0]),I.b.copy(l.vertexNormals[1]),I.c.copy(l.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(l=this.faces[n]).normal=l.__originalFaceNormal,l.vertexNormals=l.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Xi),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Kr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,l=this.vertices.length,d=this.vertices,g=e.vertices,x=this.faces,A=e.faces,I=this.colors,Y=e.colors;n===void 0&&(n=0),t!==void 0&&(i=new Si().getNormalMatrix(t));for(var Q=0,ie=g.length;Q<ie;Q++){var z=g[Q].clone();t!==void 0&&z.applyMatrix4(t),d.push(z)}for(Q=0,ie=Y.length;Q<ie;Q++)I.push(Y[Q].clone());for(Q=0,ie=A.length;Q<ie;Q++){var he,me,ye,Ee=A[Q],Re=Ee.vertexNormals,Ve=Ee.vertexColors;(he=new yn(Ee.a+l,Ee.b+l,Ee.c+l)).normal.copy(Ee.normal),i!==void 0&&he.normal.applyMatrix3(i).normalize();for(var et=0,Fe=Re.length;et<Fe;et++)me=Re[et].clone(),i!==void 0&&me.applyMatrix3(i).normalize(),he.vertexNormals.push(me);for(he.color.copy(Ee.color),et=0,Fe=Ve.length;et<Fe;et++)ye=Ve[et],he.vertexColors.push(ye.clone());he.materialIndex=Ee.materialIndex+n,x.push(he)}for(Q=0,ie=e.faceVertexUvs.length;Q<ie;Q++){var at=e.faceVertexUvs[Q];for(this.faceVertexUvs[Q]===void 0&&(this.faceVertexUvs[Q]=[]),et=0,Fe=at.length;et<Fe;et++){for(var Je=at[et],xt=[],_t=0,Pt=Je.length;_t<Pt;_t++)xt.push(Je[_t].clone());this.faceVertexUvs[Q].push(xt)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,l,d,g,x,A={},I=[],Y=[],Q=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],A[t=Math.round(e.x*Q)+"_"+Math.round(e.y*Q)+"_"+Math.round(e.z*Q)]===void 0?(A[t]=n,I.push(this.vertices[n]),Y[n]=I.length-1):Y[n]=Y[A[t]];var ie=[];for(n=0,i=this.faces.length;n<i;n++){(l=this.faces[n]).a=Y[l.a],l.b=Y[l.b],l.c=Y[l.c],d=[l.a,l.b,l.c];for(var z=0;z<3;z++)if(d[z]===d[(z+1)%3]){ie.push(n);break}}for(n=ie.length-1;0<=n;n--){var he=ie[n];for(this.faces.splice(he,1),g=0,x=this.faceVertexUvs.length;g<x;g++)this.faceVertexUvs[g].splice(he,1)}var me=this.vertices.length-I.length;return this.vertices=I,me},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new Oe(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(A,I){return A.materialIndex-I.materialIndex});var i,l,d=this.faceVertexUvs[0],g=this.faceVertexUvs[1];for(d&&d.length===t&&(i=[]),g&&g.length===t&&(l=[]),n=0;n<t;n++){var x=e[n]._id;i&&i.push(d[x]),l&&l.push(g[x])}i&&(this.faceVertexUvs[0]=i),l&&(this.faceVertexUvs[1]=l)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}for(var i=[],l=0;l<this.vertices.length;l++){var d=this.vertices[l];i.push(d.x,d.y,d.z)}var g=[],x=[],A={},I=[],Y={},Q=[],ie={};for(l=0;l<this.faces.length;l++){var z=this.faces[l],he=this.faceVertexUvs[0][l]!==void 0,me=0<z.normal.length(),ye=0<z.vertexNormals.length,Ee=z.color.r!==1||z.color.g!==1||z.color.b!==1,Re=0<z.vertexColors.length,Ve=0;if(Ve=Je(Ve=Je(Ve=Je(Ve=Je(Ve=Je(Ve=Je(Ve=Je(Ve=Je(Ve,0,0),1,!0),2,!1),3,he),4,me),5,ye),6,Ee),7,Re),g.push(Ve),g.push(z.a,z.b,z.c),g.push(z.materialIndex),he){var et=this.faceVertexUvs[0][l];g.push(Pt(et[0]),Pt(et[1]),Pt(et[2]))}if(me&&g.push(xt(z.normal)),ye){var Fe=z.vertexNormals;g.push(xt(Fe[0]),xt(Fe[1]),xt(Fe[2]))}if(Ee&&g.push(_t(z.color)),Re){var at=z.vertexColors;g.push(_t(at[0]),_t(at[1]),_t(at[2]))}}function Je(Ot,Gt,Kt){return Kt?Ot|1<<Gt:Ot&~(1<<Gt)}function xt(Ot){var Gt=Ot.x.toString()+Ot.y.toString()+Ot.z.toString();return A[Gt]!==void 0||(A[Gt]=x.length/3,x.push(Ot.x,Ot.y,Ot.z)),A[Gt]}function _t(Ot){var Gt=Ot.r.toString()+Ot.g.toString()+Ot.b.toString();return Y[Gt]!==void 0||(Y[Gt]=I.length,I.push(Ot.getHex())),Y[Gt]}function Pt(Ot){var Gt=Ot.x.toString()+Ot.y.toString();return ie[Gt]!==void 0||(ie[Gt]=Q.length/2,Q.push(Ot.x,Ot.y)),ie[Gt]}return e.data={},e.data.vertices=i,e.data.normals=x,0<I.length&&(e.data.colors=I),0<Q.length&&(e.data.uvs=[Q]),e.data.faces=g,e},clone:function(){return new sr().copy(this)},copy:function(e){var t,n,i,l,d,g;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var x=e.vertices;for(t=0,n=x.length;t<n;t++)this.vertices.push(x[t].clone());var A=e.colors;for(t=0,n=A.length;t<n;t++)this.colors.push(A[t].clone());var I=e.faces;for(t=0,n=I.length;t<n;t++)this.faces.push(I[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var Y=e.faceVertexUvs[t];for(this.faceVertexUvs[t]===void 0&&(this.faceVertexUvs[t]=[]),i=0,l=Y.length;i<l;i++){var Q=Y[i],ie=[];for(d=0,g=Q.length;d<g;d++){var z=Q[d];ie.push(z.clone())}this.faceVertexUvs[t].push(ie)}}var he=e.morphTargets;for(t=0,n=he.length;t<n;t++){var me={};if(me.name=he[t].name,he[t].vertices!==void 0)for(me.vertices=[],i=0,l=he[t].vertices.length;i<l;i++)me.vertices.push(he[t].vertices[i].clone());if(he[t].normals!==void 0)for(me.normals=[],i=0,l=he[t].normals.length;i<l;i++)me.normals.push(he[t].normals[i].clone());this.morphTargets.push(me)}var ye=e.morphNormals;for(t=0,n=ye.length;t<n;t++){var Ee={};if(ye[t].vertexNormals!==void 0)for(Ee.vertexNormals=[],i=0,l=ye[t].vertexNormals.length;i<l;i++){var Re=ye[t].vertexNormals[i],Ve={};Ve.a=Re.a.clone(),Ve.b=Re.b.clone(),Ve.c=Re.c.clone(),Ee.vertexNormals.push(Ve)}if(ye[t].faceNormals!==void 0)for(Ee.faceNormals=[],i=0,l=ye[t].faceNormals.length;i<l;i++)Ee.faceNormals.push(ye[t].faceNormals[i].clone());this.morphNormals.push(Ee)}var et=e.skinWeights;for(t=0,n=et.length;t<n;t++)this.skinWeights.push(et[t].clone());var Fe=e.skinIndices;for(t=0,n=Fe.length;t<n;t++)this.skinIndices.push(Fe[t].clone());var at=e.lineDistances;for(t=0,n=at.length;t<n;t++)this.lineDistances.push(at[t]);var Je=e.boundingBox;Je!==null&&(this.boundingBox=Je.clone());var xt=e.boundingSphere;return xt!==null&&(this.boundingSphere=xt.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var oh=function(e){function t(n,i,l,d,g,x){e.call(this),this.type="BoxGeometry",this.parameters={width:n,height:i,depth:l,widthSegments:d,heightSegments:g,depthSegments:x},this.fromBufferGeometry(new lc(n,i,l,d,g,x)),this.mergeVertices()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(sr),lc=function(e){function t(n,i,l,d,g,x){e.call(this),this.type="BoxBufferGeometry",this.parameters={width:n,height:i,depth:l,widthSegments:d,heightSegments:g,depthSegments:x};var A=this;n=n||1,i=i||1,l=l||1,d=Math.floor(d)||1,g=Math.floor(g)||1;var I=[],Y=[],Q=[],ie=[],z=0,he=0;function me(ye,Ee,Re,Ve,et,Fe,at,Je,xt,_t,Pt){var Ot,Gt,Kt=Fe/xt,Dt=at/_t,Mt=Fe/2,dn=at/2,Mn=Je/2,Zn=xt+1,qn=_t+1,Vn=0,cr=0,Dn=new Oe;for(Gt=0;Gt<qn;Gt++){var ke=Gt*Dt-dn;for(Ot=0;Ot<Zn;Ot++){var tt=Ot*Kt-Mt;Dn[ye]=tt*Ve,Dn[Ee]=ke*et,Dn[Re]=Mn,Y.push(Dn.x,Dn.y,Dn.z),Dn[ye]=0,Dn[Ee]=0,Dn[Re]=0<Je?1:-1,Q.push(Dn.x,Dn.y,Dn.z),ie.push(Ot/xt),ie.push(1-Gt/_t),Vn+=1}}for(Gt=0;Gt<_t;Gt++)for(Ot=0;Ot<xt;Ot++){var Yt=z+Ot+Zn*Gt,Ht=z+Ot+Zn*(Gt+1),rr=z+(Ot+1)+Zn*(Gt+1),En=z+(Ot+1)+Zn*Gt;I.push(Yt,Ht,En),I.push(Ht,rr,En),cr+=6}A.addGroup(he,cr,Pt),he+=cr,z+=Vn}me("z","y","x",-1,-1,l,i,n,x=Math.floor(x)||1,g,0),me("z","y","x",1,-1,l,i,-n,x,g,1),me("x","z","y",1,1,n,l,i,d,x,2),me("x","z","y",1,-1,n,l,-i,d,x,3),me("x","y","z",1,-1,n,i,l,d,g,4),me("x","y","z",-1,-1,n,i,-l,d,g,5),this.setIndex(I),this.setAttribute("position",new on(Y,3)),this.setAttribute("normal",new on(Q,3)),this.setAttribute("uv",new on(ie,2))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Sn);function Cs(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var l=e[n][i];l&&(l.isColor||l.isMatrix3||l.isMatrix4||l.isVector2||l.isVector3||l.isVector4||l.isTexture)?t[n][i]=l.clone():Array.isArray(l)?t[n][i]=l.slice():t[n][i]=l}return t}function Zi(e){for(var t={},n=0;n<e.length;n++){var i=Cs(e[n]);for(var l in i)t[l]=i[l]}return t}var sh={clone:Cs,merge:Zi},cc=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,lh=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Xa(e){kt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=cc,this.fragmentShader=lh,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ao(){At.call(this),this.type="Camera",this.matrixWorldInverse=new fr,this.projectionMatrix=new fr,this.projectionMatrixInverse=new fr}function Ii(e,t,n,i){Ao.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=i!==void 0?i:2e3,this.focus=10,this.aspect=t!==void 0?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Xs(e,t,n,i){At.call(this),this.type="CubeCamera";var l=new Ii(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Oe(1,0,0)),this.add(l);var d=new Ii(90,1,e,t);d.up.set(0,-1,0),d.lookAt(new Oe(-1,0,0)),this.add(d);var g=new Ii(90,1,e,t);g.up.set(0,0,1),g.lookAt(new Oe(0,1,0)),this.add(g);var x=new Ii(90,1,e,t);x.up.set(0,0,-1),x.lookAt(new Oe(0,-1,0)),this.add(x);var A=new Ii(90,1,e,t);A.up.set(0,-1,0),A.lookAt(new Oe(0,0,1)),this.add(A);var I=new Ii(90,1,e,t);I.up.set(0,-1,0),I.lookAt(new Oe(0,0,-1)),this.add(I),i=i||{format:Gr,magFilter:xn,minFilter:xn},this.renderTarget=new Ys(n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(Y,Q){this.parent===null&&this.updateMatrixWorld();var ie=Y.getRenderTarget(),z=this.renderTarget,he=z.texture.generateMipmaps;z.texture.generateMipmaps=!1,Y.setRenderTarget(z,0),Y.render(Q,l),Y.setRenderTarget(z,1),Y.render(Q,d),Y.setRenderTarget(z,2),Y.render(Q,g),Y.setRenderTarget(z,3),Y.render(Q,x),Y.setRenderTarget(z,4),Y.render(Q,A),z.texture.generateMipmaps=he,Y.setRenderTarget(z,5),Y.render(Q,I),Y.setRenderTarget(ie)},this.clear=function(Y,Q,ie,z){for(var he=Y.getRenderTarget(),me=this.renderTarget,ye=0;ye<6;ye++)Y.setRenderTarget(me,ye),Y.clear(Q,ie,z);Y.setRenderTarget(he)}}function Ys(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),qi.call(this,e,e,t)}function Al(e,t,n,i,l,d,g,x,A,I,Y,Q){Yr.call(this,null,d,g,x,A,I,i,l,Y,Q),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=A!==void 0?A:pt,this.minFilter=I!==void 0?I:pt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}((Xa.prototype=Object.create(kt.prototype)).constructor=Xa).prototype.isShaderMaterial=!0,Xa.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cs(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Xa.prototype.toJSON=function(e){var t=kt.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var l={};for(var d in this.extensions)this.extensions[d]===!0&&(l[d]=!0);return 0<Object.keys(l).length&&(t.extensions=l),t},Ao.prototype=Object.assign(Object.create(At.prototype),{constructor:Ao,isCamera:!0,copy:function(e,t){return At.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Oe),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){At.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){At.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Ii.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Ii,isPerspectiveCamera:!0,copy:function(e,t){return Ao.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*vr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*vr.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*vr.RAD2DEG*Math.atan(Math.tan(.5*vr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,l,d){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*vr.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,l=-.5*i,d=this.view;if(this.view!==null&&this.view.enabled){var g=d.fullWidth,x=d.fullHeight;l+=d.offsetX*i/g,t-=d.offsetY*n/x,i*=d.width/g,n*=d.height/x}var A=this.filmOffset;A!==0&&(l+=e*A/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=At.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),(Xs.prototype=Object.create(At.prototype)).constructor=Xs,((Ys.prototype=Object.create(qi.prototype)).constructor=Ys).prototype.isWebGLCubeRenderTarget=!0,Ys.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new Hn,i={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","	vWorldDirection = transformDirection( position, modelMatrix );","	#include <begin_vertex>","	#include <project_vertex>","}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","	vec3 direction = normalize( vWorldDirection );","	vec2 sampleUV;","	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","	gl_FragColor = texture2D( tEquirect, sampleUV );","}"].join(`
`)},l=new Xa({type:"CubemapFromEquirect",uniforms:Cs(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:C,blending:R});l.uniforms.tEquirect.value=t;var d=new _i(new lc(5,5,5),l);n.add(d);var g=new Xs(1,10,1);return g.renderTarget=this,g.renderTarget.texture.name="CubeCameraTexture",g.update(e,n),d.geometry.dispose(),d.material.dispose(),this},((Al.prototype=Object.create(Yr.prototype)).constructor=Al).prototype.isDataTexture=!0;var Zs=new Kr,Ks=new Oe;function $s(e,t,n,i,l,d){this.planes=[e!==void 0?e:new na,t!==void 0?t:new na,n!==void 0?n:new na,i!==void 0?i:new na,l!==void 0?l:new na,d!==void 0?d:new na]}Object.assign($s.prototype,{set:function(e,t,n,i,l,d){var g=this.planes;return g[0].copy(e),g[1].copy(t),g[2].copy(n),g[3].copy(i),g[4].copy(l),g[5].copy(d),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],l=n[1],d=n[2],g=n[3],x=n[4],A=n[5],I=n[6],Y=n[7],Q=n[8],ie=n[9],z=n[10],he=n[11],me=n[12],ye=n[13],Ee=n[14],Re=n[15];return t[0].setComponents(g-i,Y-x,he-Q,Re-me).normalize(),t[1].setComponents(g+i,Y+x,he+Q,Re+me).normalize(),t[2].setComponents(g+l,Y+A,he+ie,Re+ye).normalize(),t[3].setComponents(g-l,Y-A,he-ie,Re-ye).normalize(),t[4].setComponents(g-d,Y-I,he-z,Re-Ee).normalize(),t[5].setComponents(g+d,Y+I,he+z,Re+Ee).normalize(),this},intersectsObject:function(e){var t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Zs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Zs)},intersectsSprite:function(e){return Zs.center.set(0,0,0),Zs.radius=.7071067811865476,Zs.applyMatrix4(e.matrixWorld),this.intersectsSphere(Zs)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,l=0;l<6;l++)if(t[l].distanceToPoint(n)<i)return!1;return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];if(Ks.x=0<i.normal.x?e.max.x:e.min.x,Ks.y=0<i.normal.y?e.max.y:e.min.y,Ks.z=0<i.normal.z?e.max.z:e.min.z,i.distanceToPoint(Ks)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var bn={common:{diffuse:{value:new Qe(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Si},uv2Transform:{value:new Si},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Qe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Qe(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Si}},sprite:{diffuse:{value:new Qe(15658734)},opacity:{value:1},center:{value:new zt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Si}}};function ch(){var e=null,t=!1,n=null;function i(l,d){t!==!1&&(n(l,d),e.requestAnimationFrame(i))}return{start:function(){t!==!0&&n!==null&&(e.requestAnimationFrame(i),t=!0)},stop:function(){t=!1},setAnimationLoop:function(l){n=l},setContext:function(l){e=l}}}function Rl(e,t,n,i){sr.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new Qs(e,t,n,i)),this.mergeVertices()}function Qs(e,t,n,i){Sn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};var l,d,g=(e=e||1)/2,x=(t=t||1)/2,A=Math.floor(n)||1,I=Math.floor(i)||1,Y=A+1,Q=I+1,ie=e/A,z=t/I,he=[],me=[],ye=[],Ee=[];for(d=0;d<Q;d++){var Re=d*z-x;for(l=0;l<Y;l++){var Ve=l*ie-g;me.push(Ve,-Re,0),ye.push(0,0,1),Ee.push(l/A),Ee.push(1-d/I)}}for(d=0;d<I;d++)for(l=0;l<A;l++){var et=l+Y*d,Fe=l+Y*(d+1),at=l+1+Y*(d+1),Je=l+1+Y*d;he.push(et,Fe,Je),he.push(Fe,at,Je)}this.setIndex(he),this.setAttribute("position",new on(me,3)),this.setAttribute("normal",new on(ye,3)),this.setAttribute("uv",new on(Ee,2))}(Rl.prototype=Object.create(sr.prototype)).constructor=Rl,(Qs.prototype=Object.create(Sn.prototype)).constructor=Qs;var Dr={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);
    } else if (face == 1.0) {
      uv = vec2(direction.x, -direction.z) / abs(direction.y);
    } else if (face == 2.0) {
      uv = direction.xy / abs(direction.z);
    } else if (face == 3.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);
    } else if (face == 4.0) {
      uv = direction.xz / abs(direction.y);
    } else {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);
    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_normalmap_pars_fragment:`#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},bo={basic:{uniforms:Zi([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.fog]),vertexShader:Dr.meshbasic_vert,fragmentShader:Dr.meshbasic_frag},lambert:{uniforms:Zi([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.fog,bn.lights,{emissive:{value:new Qe(0)}}]),vertexShader:Dr.meshlambert_vert,fragmentShader:Dr.meshlambert_frag},phong:{uniforms:Zi([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new Qe(0)},specular:{value:new Qe(1118481)},shininess:{value:30}}]),vertexShader:Dr.meshphong_vert,fragmentShader:Dr.meshphong_frag},standard:{uniforms:Zi([bn.common,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.roughnessmap,bn.metalnessmap,bn.fog,bn.lights,{emissive:{value:new Qe(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},toon:{uniforms:Zi([bn.common,bn.specularmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.gradientmap,bn.fog,bn.lights,{emissive:{value:new Qe(0)},specular:{value:new Qe(1118481)},shininess:{value:30}}]),vertexShader:Dr.meshtoon_vert,fragmentShader:Dr.meshtoon_frag},matcap:{uniforms:Zi([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,{matcap:{value:null}}]),vertexShader:Dr.meshmatcap_vert,fragmentShader:Dr.meshmatcap_frag},points:{uniforms:Zi([bn.points,bn.fog]),vertexShader:Dr.points_vert,fragmentShader:Dr.points_frag},dashed:{uniforms:Zi([bn.common,bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Dr.linedashed_vert,fragmentShader:Dr.linedashed_frag},depth:{uniforms:Zi([bn.common,bn.displacementmap]),vertexShader:Dr.depth_vert,fragmentShader:Dr.depth_frag},normal:{uniforms:Zi([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,{opacity:{value:1}}]),vertexShader:Dr.normal_vert,fragmentShader:Dr.normal_frag},sprite:{uniforms:Zi([bn.sprite,bn.fog]),vertexShader:Dr.sprite_vert,fragmentShader:Dr.sprite_frag},background:{uniforms:{uvTransform:{value:new Si},t2D:{value:null}},vertexShader:Dr.background_vert,fragmentShader:Dr.background_frag},cube:{uniforms:Zi([bn.envmap,{opacity:{value:1}}]),vertexShader:Dr.cube_vert,fragmentShader:Dr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Dr.equirect_vert,fragmentShader:Dr.equirect_frag},distanceRGBA:{uniforms:Zi([bn.common,bn.displacementmap,{referencePosition:{value:new Oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Dr.distanceRGBA_vert,fragmentShader:Dr.distanceRGBA_frag},shadow:{uniforms:Zi([bn.lights,bn.fog,{color:{value:new Qe(0)},opacity:{value:1}}]),vertexShader:Dr.shadow_vert,fragmentShader:Dr.shadow_frag}};function Lr(e,t,n,i){var l,d,g=new Qe(0),x=0,A=null,I=0,Y=null;function Q(ie,z){t.buffers.color.setClear(ie.r,ie.g,ie.b,z,i)}return{getClearColor:function(){return g},setClearColor:function(ie,z){g.set(ie),Q(g,x=z!==void 0?z:1)},getClearAlpha:function(){return x},setClearAlpha:function(ie){Q(g,x=ie)},render:function(ie,z,he,me){var ye=z.background,Ee=e.xr,Re=Ee.getSession&&Ee.getSession();if(Re&&Re.environmentBlendMode==="additive"&&(ye=null),ye===null?Q(g,x):ye&&ye.isColor&&(Q(ye,1),me=!0),(e.autoClear||me)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),ye&&(ye.isCubeTexture||ye.isWebGLCubeRenderTarget||ye.mapping===yt)){d===void 0&&((d=new _i(new lc(1,1,1),new Xa({type:"BackgroundCubeMaterial",uniforms:Cs(bo.cube.uniforms),vertexShader:bo.cube.vertexShader,fragmentShader:bo.cube.fragmentShader,side:C,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(et,Fe,at){this.matrixWorld.copyPosition(at.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(d));var Ve=ye.isWebGLCubeRenderTarget?ye.texture:ye;d.material.uniforms.envMap.value=Ve,d.material.uniforms.flipEnvMap.value=Ve.isCubeTexture?-1:1,A===ye&&I===Ve.version&&Y===e.toneMapping||(d.material.needsUpdate=!0,A=ye,I=Ve.version,Y=e.toneMapping),ie.unshift(d,d.geometry,d.material,0,0,null)}else ye&&ye.isTexture&&(l===void 0&&((l=new _i(new Qs(2,2),new Xa({type:"BackgroundMaterial",uniforms:Cs(bo.background.uniforms),vertexShader:bo.background.vertexShader,fragmentShader:bo.background.fragmentShader,side:O,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(l)),(l.material.uniforms.t2D.value=ye).matrixAutoUpdate===!0&&ye.updateMatrix(),l.material.uniforms.uvTransform.value.copy(ye.matrix),A===ye&&I===ye.version&&Y===e.toneMapping||(l.material.needsUpdate=!0,I=(A=ye).version,Y=e.toneMapping),ie.unshift(l,l.geometry,l.material,0,0,null))}}}function uc(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ss(e,t,n,i,l,d,g,x,A,I){Yr.call(this,e=e!==void 0?e:[],t=t!==void 0?t:It,n,i,l,d,g=g!==void 0?g:Gr,x,A,I),this.flipY=!1}function mu(e,t,n,i){Yr.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=pt,this.minFilter=pt,this.wrapR=An,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function ja(e,t,n,i){Yr.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=pt,this.minFilter=pt,this.wrapR=An,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}bo.physical={uniforms:Zi([bo.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Qe(0)},clearcoatNormalScale:{value:new zt(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},((Ss.prototype=Object.create(Yr.prototype)).constructor=Ss).prototype.isCubeTexture=!0,Object.defineProperty(Ss.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),((mu.prototype=Object.create(Yr.prototype)).constructor=mu).prototype.isDataTexture2DArray=!0,((ja.prototype=Object.create(Yr.prototype)).constructor=ja).prototype.isDataTexture3D=!0;var Gh=new Yr,gu=new mu,uh=new ja,hh=new Ss,dh=[],Ya=[],os=new Float32Array(16),yu=new Float32Array(9),ph=new Float32Array(4);function ss(e,t,n){var i=e[0];if(i<=0||0<i)return e;var l=t*n,d=dh[l];if(d===void 0&&(d=new Float32Array(l),dh[l]=d),t!==0){i.toArray(d,0);for(var g=1,x=0;g!==t;++g)x+=n,e[g].toArray(d,x)}return d}function uo(e,t){if(e.length===t.length){for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return;return 1}}function Na(e,t){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}function fh(e,t){var n=Ya[t];n===void 0&&(n=new Int32Array(t),Ya[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function mh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function gh(e,t){var n=this.cache;if(t.x!==void 0)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(uo(n,t))return;e.uniform2fv(this.addr,t),Na(n,t)}}function Ds(e,t){var n=this.cache;if(t.x!==void 0)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(uo(n,t))return;e.uniform3fv(this.addr,t),Na(n,t)}}function Wd(e,t){var n=this.cache;if(t.x!==void 0)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(uo(n,t))return;e.uniform4fv(this.addr,t),Na(n,t)}}function Es(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(uo(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Na(n,t)}else{if(uo(n,i))return;ph.set(i),e.uniformMatrix2fv(this.addr,!1,ph),Na(n,i)}}function zh(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(uo(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Na(n,t)}else{if(uo(n,i))return;yu.set(i),e.uniformMatrix3fv(this.addr,!1,yu),Na(n,i)}}function Uh(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(uo(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Na(n,t)}else{if(uo(n,i))return;os.set(i),e.uniformMatrix4fv(this.addr,!1,os),Na(n,i)}}function yh(e,t,n){var i=this.cache,l=n.allocateTextureUnit();i[0]!==l&&(e.uniform1i(this.addr,l),i[0]=l),n.safeSetTexture2D(t||Gh,l)}function Hh(e,t,n){var i=this.cache,l=n.allocateTextureUnit();i[0]!==l&&(e.uniform1i(this.addr,l),i[0]=l),n.setTexture2DArray(t||gu,l)}function Wh(e,t,n){var i=this.cache,l=n.allocateTextureUnit();i[0]!==l&&(e.uniform1i(this.addr,l),i[0]=l),n.setTexture3D(t||uh,l)}function Jh(e,t,n){var i=this.cache,l=n.allocateTextureUnit();i[0]!==l&&(e.uniform1i(this.addr,l),i[0]=l),n.safeSetTextureCube(t||hh,l)}function qh(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Za(e,t){var n=this.cache;uo(n,t)||(e.uniform2iv(this.addr,t),Na(n,t))}function Ho(e,t){var n=this.cache;uo(n,t)||(e.uniform3iv(this.addr,t),Na(n,t))}function vu(e,t){var n=this.cache;uo(n,t)||(e.uniform4iv(this.addr,t),Na(n,t))}function Ll(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Xh(e,t){e.uniform1fv(this.addr,t)}function Yh(e,t){e.uniform1iv(this.addr,t)}function Zh(e,t){e.uniform2iv(this.addr,t)}function Il(e,t){e.uniform3iv(this.addr,t)}function hc(e,t){e.uniform4iv(this.addr,t)}function Kh(e,t){var n=ss(t,this.size,2);e.uniform2fv(this.addr,n)}function $h(e,t){var n=ss(t,this.size,3);e.uniform3fv(this.addr,n)}function xu(e,t){var n=ss(t,this.size,4);e.uniform4fv(this.addr,n)}function Qh(e,t){var n=ss(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function wu(e,t){var n=ss(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function vh(e,t){var n=ss(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function bu(e,t,n){var i=t.length,l=fh(n,i);e.uniform1iv(this.addr,l);for(var d=0;d!==i;++d)n.safeSetTexture2D(t[d]||Gh,l[d])}function ed(e,t,n){var i=t.length,l=fh(n,i);e.uniform1iv(this.addr,l);for(var d=0;d!==i;++d)n.safeSetTextureCube(t[d]||hh,l[d])}function Mu(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(i){switch(t.type){case 5126:return mh;case 35664:return gh;case 35665:return Ds;case 35666:return Wd;case 35674:return Es;case 35675:return zh;case 35676:return Uh;case 5124:case 35670:return qh;case 35667:case 35671:return Za;case 35668:case 35672:return Ho;case 35669:case 35673:return vu;case 5125:return Ll;case 35678:case 36198:case 36298:case 36306:case 35682:return yh;case 35679:case 36299:case 36307:return Wh;case 35680:case 36300:case 36308:case 36293:return Jh;case 36289:case 36303:case 36311:case 36292:return Hh}}()}function xh(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(i){switch(t.type){case 5126:return Xh;case 35664:return Kh;case 35665:return $h;case 35666:return xu;case 35674:return Qh;case 35675:return wu;case 35676:return vh;case 5124:case 35670:return Yh;case 35667:case 35671:return Zh;case 35668:case 35672:return Il;case 35669:case 35673:return hc;case 35678:case 36198:case 36298:case 36306:case 35682:return bu;case 35680:case 36300:case 36308:case 36293:return ed}}()}function _u(e){this.id=e,this.seq=[],this.map={}}xh.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Na(t,e)},_u.prototype.setValue=function(e,t,n){for(var i=this.seq,l=0,d=i.length;l!==d;++l){var g=i[l];g.setValue(e,t[g.id],n)}};var wh=/([\w\d_]+)(\])?(\[|\.)?/g;function bh(e,t){e.seq.push(t),e.map[t.id]=t}function ls(e,t,n){var i=e.name,l=i.length;for(wh.lastIndex=0;;){var d=wh.exec(i),g=wh.lastIndex,x=d[1],A=d[2]==="]",I=d[3];if(A&&(x|=0),I===void 0||I==="["&&g+2===l){bh(n,new(I===void 0?Mu:xh)(x,e,t));break}var Y=n.map[x];Y===void 0&&bh(n,Y=new _u(x)),n=Y}}function cs(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),i=0;i<n;++i){var l=e.getActiveUniform(t,i);ls(l,e.getUniformLocation(t,l.name),this)}}function Mh(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}cs.prototype.setValue=function(e,t,n,i){var l=this.map[t];l!==void 0&&l.setValue(e,n,i)},cs.prototype.setOptional=function(e,t,n){var i=t[n];i!==void 0&&this.setValue(e,n,i)},cs.upload=function(e,t,n,i){for(var l=0,d=t.length;l!==d;++l){var g=t[l],x=n[g.id];x.needsUpdate!==!1&&g.setValue(e,x.value,i)}},cs.seqWithValue=function(e,t){for(var n=[],i=0,l=e.length;i!==l;++i){var d=e[i];d.id in t&&n.push(d)}return n};var Jd=0;function _h(e){switch(e){case Ke:return["Linear","( value )"];case vt:return["sRGB","( value )"];case Xt:return["RGBE","( value )"];case Gn:return["RGBM","( value, 7.0 )"];case or:return["RGBM","( value, 16.0 )"];case hi:return["RGBD","( value, 256.0 )"];case Ft:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case In:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function Wo(e,t,n){var i=e.getShaderParameter(t,35713),l=e.getShaderInfoLog(t).trim();return i&&l===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+l+function(d){for(var g=d.split(`
`),x=0;x<g.length;x++)g[x]=x+1+": "+g[x];return g.join(`
`)}(e.getShaderSource(t))}function el(e,t){var n=_h(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function tl(e){return e!==""}function Tu(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function dc(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var kl=/^[ \t]*#include +<([\w\d./]+)>/gm;function nr(e){return e.replace(kl,Cu)}function Cu(e,t){var n=Dr[t];if(n===void 0)throw new Error("Can not resolve #include <"+t+">");return nr(n)}var Th=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Ps(e){return e.replace(Th,Ch)}function Ch(e,t,n,i){for(var l="",d=parseInt(t);d<parseInt(n);d++)l+=i.replace(/\[ i \]/g,"[ "+d+" ]").replace(/UNROLLED_LOOP_INDEX/g,d);return l}function Sh(e){var t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Aa(e,t,n){var i,l,d,g,x,A,I,Y=e.getContext(),Q=n.defines,ie=n.vertexShader,z=n.fragmentShader,he=(l="SHADOWMAP_TYPE_BASIC",(i=n).shadowMapType===k?l="SHADOWMAP_TYPE_PCF":i.shadowMapType===D?l="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===f&&(l="SHADOWMAP_TYPE_VSM"),l),me=function(cr){var Dn="ENVMAP_TYPE_CUBE";if(cr.envMap)switch(cr.envMapMode){case It:case Bt:Dn="ENVMAP_TYPE_CUBE";break;case yt:case ze:Dn="ENVMAP_TYPE_CUBE_UV";break;case Ln:case rn:Dn="ENVMAP_TYPE_EQUIREC";break;case Xn:Dn="ENVMAP_TYPE_SPHERE"}return Dn}(n),ye=function(cr){var Dn="ENVMAP_MODE_REFLECTION";if(cr.envMap)switch(cr.envMapMode){case Bt:case rn:Dn="ENVMAP_MODE_REFRACTION"}return Dn}(n),Ee=function(cr){var Dn="ENVMAP_BLENDING_NONE";if(cr.envMap)switch(cr.combine){case Ne:Dn="ENVMAP_BLENDING_MULTIPLY";break;case le:Dn="ENVMAP_BLENDING_MIX";break;case ve:Dn="ENVMAP_BLENDING_ADD"}return Dn}(n),Re=0<e.gammaFactor?e.gammaFactor:1,Ve=n.isWebGL2?"":[(d=n).extensionDerivatives||d.envMapCubeUV||d.bumpMap||d.tangentSpaceNormalMap||d.clearcoatNormalMap||d.flatShading||d.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(d.extensionFragDepth||d.logarithmicDepthBuffer)&&d.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",d.extensionDrawBuffers&&d.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(d.extensionShaderTextureLOD||d.envMap)&&d.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(tl).join(`
`),et=function(cr){var Dn=[];for(var ke in cr){var tt=cr[ke];tt!==!1&&Dn.push("#define "+ke+" "+tt)}return Dn.join(`
`)}(Q),Fe=Y.createProgram(),at=n.numMultiviewViews;if(n.isRawShaderMaterial?(0<(g=[et].filter(tl).join(`
`)).length&&(g+=`
`),0<(x=[Ve,et].filter(tl).join(`
`)).length&&(x+=`
`)):(g=[Sh(n),"#define SHADER_NAME "+n.shaderName,et,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Re,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+ye:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+he:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(tl).join(`
`),x=[Ve,Sh(n),"#define SHADER_NAME "+n.shaderName,et,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+Re,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+me:"",n.envMap?"#define "+ye:"",n.envMap?"#define "+Ee:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+he:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==He?"#define TONE_MAPPING":"",n.toneMapping!==He?Dr.tonemapping_pars_fragment:"",n.toneMapping!==He?function(cr,Dn){var ke;switch(Dn){case nt:ke="Linear";break;case ht:ke="Reinhard";break;case Tt:ke="Uncharted2";break;case Ct:ke="OptimizedCineon";break;case We:ke="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+Dn)}return"vec3 toneMapping( vec3 color ) { return "+ke+"ToneMapping( color ); }"}(0,n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Dr.encodings_pars_fragment:"",n.mapEncoding?el("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?el("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?el("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?el("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?el("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(A=n.outputEncoding,I=_h(A),"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+I[0]+I[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(tl).join(`
`)),ie=dc(ie=Tu(ie=nr(ie),n),n),z=dc(z=Tu(z=nr(z),n),n),ie=Ps(ie),z=Ps(z),n.isWebGL2&&!n.isRawShaderMaterial){var Je=!1,xt=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&ie.match(xt)!==null&&z.match(xt)!==null&&(Je=!0,ie=ie.replace(xt,""),z=z.replace(xt,"")),g=[`#version 300 es
`,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,x=[`#version 300 es
`,"#define varying in",Je?"":"out highp vec4 pc_fragColor;",Je?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x,0<at&&(g=(g=g.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","layout(num_views = "+at+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+at+"];","uniform mat4 projectionMatrices["+at+"];","uniform mat4 viewMatrices["+at+"];","uniform mat3 normalMatrices["+at+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),x=(x=x.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+at+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`)))}var _t,Pt,Ot=x+z,Gt=Mh(Y,35633,g+ie),Kt=Mh(Y,35632,Ot);if(Y.attachShader(Fe,Gt),Y.attachShader(Fe,Kt),n.index0AttributeName!==void 0?Y.bindAttribLocation(Fe,0,n.index0AttributeName):n.morphTargets===!0&&Y.bindAttribLocation(Fe,0,"position"),Y.linkProgram(Fe),e.debug.checkShaderErrors){var Dt=Y.getProgramInfoLog(Fe).trim(),Mt=Y.getShaderInfoLog(Gt).trim(),dn=Y.getShaderInfoLog(Kt).trim(),Mn=!0,Zn=!0;if(Y.getProgramParameter(Fe,35714)===!1){Mn=!1;var qn=Wo(Y,Gt,"vertex"),Vn=Wo(Y,Kt,"fragment");console.error("THREE.WebGLProgram: shader error: ",Y.getError(),"35715",Y.getProgramParameter(Fe,35715),"gl.getProgramInfoLog",Dt,qn,Vn)}else Dt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Dt):Mt!==""&&dn!==""||(Zn=!1);Zn&&(this.diagnostics={runnable:Mn,programLog:Dt,vertexShader:{log:Mt,prefix:g},fragmentShader:{log:dn,prefix:x}})}return Y.deleteShader(Gt),Y.deleteShader(Kt),this.getUniforms=function(){return _t===void 0&&(_t=new cs(Y,Fe)),_t},this.getAttributes=function(){return Pt===void 0&&(Pt=function(cr,Dn){for(var ke={},tt=cr.getProgramParameter(Dn,35721),Yt=0;Yt<tt;Yt++){var Ht=cr.getActiveAttrib(Dn,Yt).name;ke[Ht]=cr.getAttribLocation(Dn,Ht)}return ke}(Y,Fe)),Pt},this.destroy=function(){Y.deleteProgram(Fe),this.program=void 0},this.name=n.shaderName,this.id=Jd++,this.cacheKey=t,this.usedTimes=1,this.program=Fe,this.vertexShader=Gt,this.fragmentShader=Kt,this.numMultiviewViews=at,this}function td(e,t,n){var i=[],l=n.isWebGL2,d=n.logarithmicDepthBuffer,g=n.floatVertexTextures,x=n.precision,A=n.maxVertexUniforms,I=n.vertexTextures,Y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Q=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function ie(z){var he;return z?z.isTexture?he=z.encoding:z.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),he=z.texture.encoding):he=Ke,he}this.getParameters=function(z,he,me,ye,Ee,Re,Ve){var et=ye.fog,Fe=z.isMeshStandardMaterial?ye.environment:null,at=z.envMap||Fe,Je=Y[z.type],xt=Ve.isSkinnedMesh?function(Gt){var Kt=Ve.skeleton.bones;if(g)return 1024;var Dt=A,Mt=Math.floor((Dt-20)/4),dn=Math.min(Mt,Kt.length);return dn<Kt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Kt.length+" bones. This GPU supports "+dn+"."),0):dn}():0;z.precision!==null&&(x=n.getMaxPrecision(z.precision))!==z.precision&&console.warn("THREE.WebGLProgram.getParameters:",z.precision,"not supported, using",x,"instead.");var _t=function(Gt,Kt){var Dt;if(Je){var Mt=bo[Je];Dt={name:Gt.type,uniforms:sh.clone(Mt.uniforms),vertexShader:Mt.vertexShader,fragmentShader:Mt.fragmentShader}}else Dt={name:Gt.type,uniforms:Gt.uniforms,vertexShader:Gt.vertexShader,fragmentShader:Gt.fragmentShader};return Dt}(z);z.onBeforeCompile(_t,e);var Pt=e.getRenderTarget(),Ot=Pt&&Pt.isWebGLMultiviewRenderTarget?Pt.numViews:0;return{isWebGL2:l,shaderID:Je,shaderName:_t.name,uniforms:_t.uniforms,vertexShader:_t.vertexShader,fragmentShader:_t.fragmentShader,defines:z.defines,isRawShaderMaterial:z.isRawShaderMaterial,isShaderMaterial:z.isShaderMaterial,precision:x,instancing:Ve.isInstancedMesh===!0,supportsVertexTextures:I,numMultiviewViews:Ot,outputEncoding:Pt!==null?ie(Pt.texture):e.outputEncoding,map:!!z.map,mapEncoding:ie(z.map),matcap:!!z.matcap,matcapEncoding:ie(z.matcap),envMap:!!at,envMapMode:at&&at.mapping,envMapEncoding:ie(at),envMapCubeUV:!!at&&(at.mapping===yt||at.mapping===ze),lightMap:!!z.lightMap,lightMapEncoding:ie(z.lightMap),aoMap:!!z.aoMap,emissiveMap:!!z.emissiveMap,emissiveMapEncoding:ie(z.emissiveMap),bumpMap:!!z.bumpMap,normalMap:!!z.normalMap,objectSpaceNormalMap:z.normalMapType===Co,tangentSpaceNormalMap:z.normalMapType===vo,clearcoatNormalMap:!!z.clearcoatNormalMap,displacementMap:!!z.displacementMap,roughnessMap:!!z.roughnessMap,metalnessMap:!!z.metalnessMap,specularMap:!!z.specularMap,alphaMap:!!z.alphaMap,gradientMap:!!z.gradientMap,sheen:!!z.sheen,combine:z.combine,vertexTangents:z.normalMap&&z.vertexTangents,vertexColors:z.vertexColors,vertexUvs:!!(z.map||z.bumpMap||z.normalMap||z.specularMap||z.alphaMap||z.emissiveMap||z.roughnessMap||z.metalnessMap||z.clearcoatNormalMap||z.displacementMap),uvsVertexOnly:!(z.map||z.bumpMap||z.normalMap||z.specularMap||z.alphaMap||z.emissiveMap||z.roughnessMap||z.metalnessMap||z.clearcoatNormalMap||!z.displacementMap),fog:!!et,useFog:z.fog,fogExp2:et&&et.isFogExp2,flatShading:z.flatShading,sizeAttenuation:z.sizeAttenuation,logarithmicDepthBuffer:d,skinning:z.skinning&&0<xt,maxBones:xt,useVertexTexture:g,morphTargets:z.morphTargets,morphNormals:z.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:he.directional.length,numPointLights:he.point.length,numSpotLights:he.spot.length,numRectAreaLights:he.rectArea.length,numHemiLights:he.hemi.length,numDirLightShadows:he.directionalShadowMap.length,numPointLightShadows:he.pointShadowMap.length,numSpotLightShadows:he.spotShadowMap.length,numClippingPlanes:Ee,numClipIntersection:Re,dithering:z.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<me.length,shadowMapType:e.shadowMap.type,toneMapping:z.toneMapped?e.toneMapping:He,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:z.premultipliedAlpha,alphaTest:z.alphaTest,doubleSided:z.side===j,flipSided:z.side===C,depthPacking:z.depthPacking!==void 0&&z.depthPacking,index0AttributeName:z.index0AttributeName,extensionDerivatives:z.extensions&&z.extensions.derivatives,extensionFragDepth:z.extensions&&z.extensions.frawbuffers,extensionDrawbuffers:z.extensions&&z.extensions.drawbuffers,extensionShaderTextureLOD:z.extensions&&z.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||t.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:l||t.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:l||t.get("EXT_shader_texture_lod")!==null,onBeforeCompile:z.onBeforeCompile}},this.getProgramCacheKey=function(z){var he=[];if(z.shaderID?he.push(z.shaderID):(he.push(z.fragmentShader),he.push(z.vertexShader)),z.defines!==void 0)for(var me in z.defines)he.push(me),he.push(z.defines[me]);if(z.isRawShaderMaterial===void 0){for(var ye=0;ye<Q.length;ye++)he.push(z[Q[ye]]);he.push(e.outputEncoding),he.push(e.gammaFactor)}return he.push(z.onBeforeCompile.toString()),he.join()},this.acquireProgram=function(z,he){for(var me,ye=0,Ee=i.length;ye<Ee;ye++){var Re=i[ye];if(Re.cacheKey===he){++(me=Re).usedTimes;break}}return me===void 0&&(me=new Aa(e,he,z),i.push(me)),me},this.releaseProgram=function(z){if(--z.usedTimes==0){var he=i.indexOf(z);i[he]=i[i.length-1],i.pop(),z.destroy()}},this.programs=i}function nd(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function qd(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Jo(){var e=[],t=0,n=[],i=[],l={id:-1};function d(g,x,A,I,Y,Q){var ie=e[t];return ie===void 0?(ie={id:g.id,object:g,geometry:x,material:A,program:A.program||l,groupOrder:I,renderOrder:g.renderOrder,z:Y,group:Q},e[t]=ie):(ie.id=g.id,ie.object=g,ie.geometry=x,ie.material=A,ie.program=A.program||l,ie.groupOrder=I,ie.renderOrder=g.renderOrder,ie.z=Y,ie.group=Q),t++,ie}return{opaque:n,transparent:i,init:function(){t=0,n.length=0,i.length=0},push:function(g,x,A,I,Y,Q){var ie=d(g,x,A,I,Y,Q);(A.transparent===!0?i:n).push(ie)},unshift:function(g,x,A,I,Y,Q){var ie=d(g,x,A,I,Y,Q);(A.transparent===!0?i:n).unshift(ie)},sort:function(g,x){1<n.length&&n.sort(g||nd),1<i.length&&i.sort(x||qd)}}}var Ba=0;function Dh(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Eh(){for(var e=new function(){var g={};return{get:function(x){if(g[x.id]!==void 0)return g[x.id];var A;switch(x.type){case"DirectionalLight":A={direction:new Oe,color:new Qe,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"SpotLight":A={position:new Oe,direction:new Oe,color:new Qe,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"PointLight":A={position:new Oe,color:new Qe,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":A={direction:new Oe,skyColor:new Qe,groundColor:new Qe};break;case"RectAreaLight":A={color:new Qe,position:new Oe,halfWidth:new Oe,halfHeight:new Oe}}return g[x.id]=A}}},t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;n<9;n++)t.probe.push(new Oe);var i=new Oe,l=new fr,d=new fr;return{setup:function(g,x,A){for(var I=0,Y=0,Q=0,ie=0;ie<9;ie++)t.probe[ie].set(0,0,0);var z=0,he=0,me=0,ye=0,Ee=0,Re=0,Ve=0,et=0,Fe=A.matrixWorldInverse;g.sort(Dh),ie=0;for(var at=g.length;ie<at;ie++){var Je=g[ie],xt=Je.color,_t=Je.intensity,Pt=Je.distance,Ot=Je.shadow&&Je.shadow.map?Je.shadow.map.texture:null;if(Je.isAmbientLight)I+=xt.r*_t,Y+=xt.g*_t,Q+=xt.b*_t;else if(Je.isLightProbe)for(var Gt=0;Gt<9;Gt++)t.probe[Gt].addScaledVector(Je.sh.coefficients[Gt],_t);else if(Je.isDirectionalLight){if((Dt=e.get(Je)).color.copy(Je.color).multiplyScalar(Je.intensity),Dt.direction.setFromMatrixPosition(Je.matrixWorld),i.setFromMatrixPosition(Je.target.matrixWorld),Dt.direction.sub(i),Dt.direction.transformDirection(Fe),Dt.shadow=Je.castShadow,Je.castShadow){var Kt=Je.shadow;Dt.shadowBias=Kt.bias,Dt.shadowRadius=Kt.radius,Dt.shadowMapSize=Kt.mapSize,t.directionalShadowMap[z]=Ot,t.directionalShadowMatrix[z]=Je.shadow.matrix,Re++}t.directional[z]=Dt,z++}else if(Je.isSpotLight)(Dt=e.get(Je)).position.setFromMatrixPosition(Je.matrixWorld),Dt.position.applyMatrix4(Fe),Dt.color.copy(xt).multiplyScalar(_t),Dt.distance=Pt,Dt.direction.setFromMatrixPosition(Je.matrixWorld),i.setFromMatrixPosition(Je.target.matrixWorld),Dt.direction.sub(i),Dt.direction.transformDirection(Fe),Dt.coneCos=Math.cos(Je.angle),Dt.penumbraCos=Math.cos(Je.angle*(1-Je.penumbra)),Dt.decay=Je.decay,Dt.shadow=Je.castShadow,Je.castShadow&&(Kt=Je.shadow,Dt.shadowBias=Kt.bias,Dt.shadowRadius=Kt.radius,Dt.shadowMapSize=Kt.mapSize,t.spotShadowMap[me]=Ot,t.spotShadowMatrix[me]=Je.shadow.matrix,et++),t.spot[me]=Dt,me++;else if(Je.isRectAreaLight)(Dt=e.get(Je)).color.copy(xt).multiplyScalar(_t),Dt.position.setFromMatrixPosition(Je.matrixWorld),Dt.position.applyMatrix4(Fe),d.identity(),l.copy(Je.matrixWorld),l.premultiply(Fe),d.extractRotation(l),Dt.halfWidth.set(.5*Je.width,0,0),Dt.halfHeight.set(0,.5*Je.height,0),Dt.halfWidth.applyMatrix4(d),Dt.halfHeight.applyMatrix4(d),t.rectArea[ye]=Dt,ye++;else if(Je.isPointLight)(Dt=e.get(Je)).position.setFromMatrixPosition(Je.matrixWorld),Dt.position.applyMatrix4(Fe),Dt.color.copy(Je.color).multiplyScalar(Je.intensity),Dt.distance=Je.distance,Dt.decay=Je.decay,Dt.shadow=Je.castShadow,Je.castShadow&&(Kt=Je.shadow,Dt.shadowBias=Kt.bias,Dt.shadowRadius=Kt.radius,Dt.shadowMapSize=Kt.mapSize,Dt.shadowCameraNear=Kt.camera.near,Dt.shadowCameraFar=Kt.camera.far,t.pointShadowMap[he]=Ot,t.pointShadowMatrix[he]=Je.shadow.matrix,Ve++),t.point[he]=Dt,he++;else if(Je.isHemisphereLight){var Dt;(Dt=e.get(Je)).direction.setFromMatrixPosition(Je.matrixWorld),Dt.direction.transformDirection(Fe),Dt.direction.normalize(),Dt.skyColor.copy(Je.color).multiplyScalar(_t),Dt.groundColor.copy(Je.groundColor).multiplyScalar(_t),t.hemi[Ee]=Dt,Ee++}}t.ambient[0]=I,t.ambient[1]=Y,t.ambient[2]=Q;var Mt=t.hash;Mt.directionalLength===z&&Mt.pointLength===he&&Mt.spotLength===me&&Mt.rectAreaLength===ye&&Mt.hemiLength===Ee&&Mt.numDirectionalShadows===Re&&Mt.numPointShadows===Ve&&Mt.numSpotShadows===et||(t.directional.length=z,t.spot.length=me,t.rectArea.length=ye,t.point.length=he,t.hemi.length=Ee,t.directionalShadowMap.length=Re,t.pointShadowMap.length=Ve,t.spotShadowMap.length=et,t.directionalShadowMatrix.length=Re,t.pointShadowMatrix.length=Ve,t.spotShadowMatrix.length=et,Mt.directionalLength=z,Mt.pointLength=he,Mt.spotLength=me,Mt.rectAreaLength=ye,Mt.hemiLength=Ee,Mt.numDirectionalShadows=Re,Mt.numPointShadows=Ve,Mt.numSpotShadows=et,t.version=Ba++)},state:t}}function rd(){var e=new Eh,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(i){e.setup(t,n,i)},pushLight:function(i){t.push(i)},pushShadow:function(i){n.push(i)}}}function qo(e){kt.call(this),this.type="MeshDepthMaterial",this.depthPacking=ao,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function nl(e){kt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Oe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}((qo.prototype=Object.create(kt.prototype)).constructor=qo).prototype.isMeshDepthMaterial=!0,qo.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},((nl.prototype=Object.create(kt.prototype)).constructor=nl).prototype.isMeshDistanceMaterial=!0,nl.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var id=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,ad=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function Ph(e,t,n){var i=new $s,l=new zt,d=new zt,g=new Jr,x=[],A=[],I={},Y={0:C,1:O,2:j},Q=new Xa({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new zt},radius:{value:4}},vertexShader:ad,fragmentShader:id}),ie=Q.clone();ie.defines.HORIZONAL_PASS=1;var z=new Sn;z.setAttribute("position",new en(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var he=new _i(z,Q),me=this;function ye(Fe,at){var Je=t.update(he);Q.uniforms.shadow_pass.value=Fe.map.texture,Q.uniforms.resolution.value=Fe.mapSize,Q.uniforms.radius.value=Fe.radius,e.setRenderTarget(Fe.mapPass),e.clear(),e.renderBufferDirect(at,null,Je,Q,he,null),ie.uniforms.shadow_pass.value=Fe.mapPass.texture,ie.uniforms.resolution.value=Fe.mapSize,ie.uniforms.radius.value=Fe.radius,e.setRenderTarget(Fe.map),e.clear(),e.renderBufferDirect(at,null,Je,ie,he,null)}function Ee(Fe,at,Je){var xt=Fe<<0|at<<1|Je<<2,_t=x[xt];return _t===void 0&&(_t=new qo({depthPacking:Ci,morphTargets:Fe,skinning:at}),x[xt]=_t),_t}function Re(Fe,at,Je){var xt=Fe<<0|at<<1|Je<<2,_t=A[xt];return _t===void 0&&(_t=new nl({morphTargets:Fe,skinning:at}),A[xt]=_t),_t}function Ve(Fe,at,Je,xt,_t,Pt){var Ot=Fe.geometry,Gt=null,Kt=Ee,Dt=Fe.customDepthMaterial;if(Je.isPointLight===!0&&(Kt=Re,Dt=Fe.customDistanceMaterial),Dt===void 0){var Mt=!1;at.morphTargets===!0&&(Ot.isBufferGeometry===!0?Mt=Ot.morphAttributes&&Ot.morphAttributes.position&&0<Ot.morphAttributes.position.length:Ot.isGeometry===!0&&(Mt=Ot.morphTargets&&0<Ot.morphTargets.length));var dn=!1;Fe.isSkinnedMesh===!0&&(at.skinning===!0?dn=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Fe)),Gt=Kt(Mt,dn,Fe.isInstancedMesh===!0)}else Gt=Dt;if(e.localClippingEnabled&&at.clipShadows===!0&&at.clippingPlanes.length!==0){var Mn=Gt.uuid,Zn=at.uuid,qn=I[Mn];qn===void 0&&(qn={},I[Mn]=qn);var Vn=qn[Zn];Vn===void 0&&(Vn=Gt.clone(),qn[Zn]=Vn),Gt=Vn}return Gt.visible=at.visible,Gt.wireframe=at.wireframe,Gt.side=Pt===f?at.shadowSide!==null?at.shadowSide:at.side:at.shadowSide!==null?at.shadowSide:Y[at.side],Gt.clipShadows=at.clipShadows,Gt.clippingPlanes=at.clippingPlanes,Gt.clipIntersection=at.clipIntersection,Gt.wireframeLinewidth=at.wireframeLinewidth,Gt.linewidth=at.linewidth,Je.isPointLight===!0&&Gt.isMeshDistanceMaterial===!0&&(Gt.referencePosition.setFromMatrixPosition(Je.matrixWorld),Gt.nearDistance=xt,Gt.farDistance=_t),Gt}function et(Fe,at,Je,xt,_t){if(Fe.visible!==!1){if(Fe.layers.test(at.layers)&&(Fe.isMesh||Fe.isLine||Fe.isPoints)&&(Fe.castShadow||Fe.receiveShadow&&_t===f)&&(!Fe.frustumCulled||i.intersectsObject(Fe))){Fe.modelViewMatrix.multiplyMatrices(Je.matrixWorldInverse,Fe.matrixWorld);var Pt=t.update(Fe),Ot=Fe.material;if(Array.isArray(Ot))for(var Gt=Pt.groups,Kt=0,Dt=Gt.length;Kt<Dt;Kt++){var Mt=Gt[Kt],dn=Ot[Mt.materialIndex];if(dn&&dn.visible){var Mn=Ve(Fe,dn,xt,Je.near,Je.far,_t);e.renderBufferDirect(Je,null,Pt,Mn,Fe,Mt)}}else Ot.visible&&(Mn=Ve(Fe,Ot,xt,Je.near,Je.far,_t),e.renderBufferDirect(Je,null,Pt,Mn,Fe,null))}for(var Zn=Fe.children,qn=0,Vn=Zn.length;qn<Vn;qn++)et(Zn[qn],at,Je,xt,_t)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=k,this.render=function(Fe,at,Je){if(me.enabled!==!1&&(me.autoUpdate!==!1||me.needsUpdate!==!1)&&Fe.length!==0){var xt=e.getRenderTarget(),_t=e.getActiveCubeFace(),Pt=e.getActiveMipmapLevel(),Ot=e.state;Ot.setBlending(R),Ot.buffers.color.setClear(1,1,1,1),Ot.buffers.depth.setTest(!0),Ot.setScissorTest(!1);for(var Gt=0,Kt=Fe.length;Gt<Kt;Gt++){var Dt=Fe[Gt],Mt=Dt.shadow;if(Mt!==void 0){l.copy(Mt.mapSize);var dn=Mt.getFrameExtents();if(l.multiply(dn),d.copy(Mt.mapSize),(l.x>n||l.y>n)&&(console.warn("THREE.WebGLShadowMap:",Dt,"has shadow exceeding max texture size, reducing"),l.x>n&&(d.x=Math.floor(n/dn.x),l.x=d.x*dn.x,Mt.mapSize.x=d.x),l.y>n&&(d.y=Math.floor(n/dn.y),l.y=d.y*dn.y,Mt.mapSize.y=d.y)),Mt.map===null&&!Mt.isPointLightShadow&&this.type===f){var Mn={minFilter:xn,magFilter:xn,format:Or};Mt.map=new qi(l.x,l.y,Mn),Mt.map.texture.name=Dt.name+".shadowMap",Mt.mapPass=new qi(l.x,l.y,Mn),Mt.camera.updateProjectionMatrix()}Mt.map===null&&(Mn={minFilter:pt,magFilter:pt,format:Or},Mt.map=new qi(l.x,l.y,Mn),Mt.map.texture.name=Dt.name+".shadowMap",Mt.camera.updateProjectionMatrix()),e.setRenderTarget(Mt.map),e.clear();for(var Zn=Mt.getViewportCount(),qn=0;qn<Zn;qn++){var Vn=Mt.getViewport(qn);g.set(d.x*Vn.x,d.y*Vn.y,d.x*Vn.z,d.y*Vn.w),Ot.viewport(g),Mt.updateMatrices(Dt,qn),i=Mt.getFrustum(),et(at,Je,Mt.camera,Dt,this.type)}Mt.isPointLightShadow||this.type!==f||ye(Mt,Je)}else console.warn("THREE.WebGLShadowMap:",Dt,"has no shadow.")}me.needsUpdate=!1,e.setRenderTarget(xt,_t,Pt)}}}function Oh(e,t,n){var i=n.isWebGL2,l=new function(){var ft=!1,_n=new Jr,Tn=null,ir=new Jr(0,0,0,0);return{setMask:function(un){Tn===un||ft||(e.colorMask(un,un,un,un),Tn=un)},setLocked:function(un){ft=un},setClear:function(un,br,Pr,vi,mo){mo===!0&&(un*=vi,br*=vi,Pr*=vi),_n.set(un,br,Pr,vi),ir.equals(_n)===!1&&(e.clearColor(un,br,Pr,vi),ir.copy(_n))},reset:function(){ft=!1,Tn=null,ir.set(-1,0,0,0)}}},d=new function(){var ft=!1,_n=null,Tn=null,ir=null;return{setTest:function(un){(un?Dn:ke)(2929)},setMask:function(un){_n===un||ft||(e.depthMask(un),_n=un)},setFunc:function(un){if(Tn!==un){if(un)switch(un){case Be:e.depthFunc(512);break;case q:e.depthFunc(519);break;case ge:e.depthFunc(513);break;case oe:e.depthFunc(515);break;case se:e.depthFunc(514);break;case Ae:e.depthFunc(518);break;case Ye:e.depthFunc(516);break;case Ge:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);Tn=un}},setLocked:function(un){ft=un},setClear:function(un){ir!==un&&(e.clearDepth(un),ir=un)},reset:function(){ft=!1,ir=Tn=_n=null}}},g=new function(){var ft=!1,_n=null,Tn=null,ir=null,un=null,br=null,Pr=null,vi=null,mo=null;return{setTest:function(Nr){ft||(Nr?Dn:ke)(2960)},setMask:function(Nr){_n===Nr||ft||(e.stencilMask(Nr),_n=Nr)},setFunc:function(Nr,Ei,Ir){Tn===Nr&&ir===Ei&&un===Ir||(e.stencilFunc(Nr,Ei,Ir),Tn=Nr,ir=Ei,un=Ir)},setOp:function(Nr,Ei,Ir){br===Nr&&Pr===Ei&&vi===Ir||(e.stencilOp(Nr,Ei,Ir),br=Nr,Pr=Ei,vi=Ir)},setLocked:function(Nr){ft=Nr},setClear:function(Nr){mo!==Nr&&(e.clearStencil(Nr),mo=Nr)},reset:function(){ft=!1,mo=vi=Pr=br=un=ir=Tn=_n=null}}},x=e.getParameter(34921),A=new Uint8Array(x),I=new Uint8Array(x),Y=new Uint8Array(x),Q={},ie=null,z=null,he=null,me=null,ye=null,Ee=null,Re=null,Ve=null,et=null,Fe=!1,at=null,Je=null,xt=null,_t=null,Pt=null,Ot=e.getParameter(35661),Gt=!1,Kt=0,Dt=e.getParameter(7938);Dt.indexOf("WebGL")!==-1?(Kt=parseFloat(/^WebGL\ ([0-9])/.exec(Dt)[1]),Gt=1<=Kt):Dt.indexOf("OpenGL ES")!==-1&&(Kt=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Dt)[1]),Gt=2<=Kt);var Mt=null,dn={},Mn=new Jr,Zn=new Jr;function qn(ft,_n,Tn){var ir=new Uint8Array(4),un=e.createTexture();e.bindTexture(ft,un),e.texParameteri(ft,10241,9728),e.texParameteri(ft,10240,9728);for(var br=0;br<Tn;br++)e.texImage2D(_n+br,0,6408,1,1,0,6408,5121,ir);return un}var Vn={};function cr(ft,_n){A[ft]=1,I[ft]===0&&(e.enableVertexAttribArray(ft),I[ft]=1),Y[ft]!==_n&&((i?e:t.get("ANGLE_instanced_arrays"))[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ft,_n),Y[ft]=_n)}function Dn(ft){Q[ft]!==!0&&(e.enable(ft),Q[ft]=!0)}function ke(ft){Q[ft]!==!1&&(e.disable(ft),Q[ft]=!1)}Vn[3553]=qn(3553,3553,1),Vn[34067]=qn(34067,34069,6),l.setClear(0,0,0,1),d.setClear(1),g.setClear(0),Dn(2929),d.setFunc(oe),En(!1),Et(L),Dn(2884),rr(R);var tt={};if(tt[T]=32774,tt[B]=32778,tt[N]=32779,i)tt[u]=32775,tt[c]=32776;else{var Yt=t.get("EXT_blend_minmax");Yt!==null&&(tt[u]=Yt.MIN_EXT,tt[c]=Yt.MAX_EXT)}var Ht={};function rr(ft,_n,Tn,ir,un,br,Pr,vi){if(ft!==R){if(z||(Dn(3042),z=!0),ft===J)un=un||_n,br=br||Tn,Pr=Pr||ir,_n===me&&un===Re||(e.blendEquationSeparate(tt[_n],tt[un]),me=_n,Re=un),Tn===ye&&ir===Ee&&br===Ve&&Pr===et||(e.blendFuncSeparate(Ht[Tn],Ht[ir],Ht[br],Ht[Pr]),ye=Tn,Ee=ir,Ve=br,et=Pr),he=ft,Fe=null;else if(ft!==he||vi!==Fe){if(me===T&&Re===T||(e.blendEquation(32774),Re=me=T),vi)switch(ft){case M:e.blendFuncSeparate(1,771,1,771);break;case ee:e.blendFunc(1,1);break;case F:e.blendFuncSeparate(0,0,769,771);break;case _:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ft)}else switch(ft){case M:e.blendFuncSeparate(770,771,1,771);break;case ee:e.blendFunc(770,1);break;case F:e.blendFunc(0,769);break;case _:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ft)}et=Ve=Ee=ye=null,he=ft,Fe=vi}}else z&&(ke(3042),z=!1)}function En(ft){at!==ft&&(ft?e.frontFace(2304):e.frontFace(2305),at=ft)}function Et(ft){ft!==w?(Dn(2884),ft!==Je&&(ft===L?e.cullFace(1029):ft===G?e.cullFace(1028):e.cullFace(1032))):ke(2884),Je=ft}function Pn(ft,_n,Tn){ft?(Dn(32823),_t===_n&&Pt===Tn||(e.polygonOffset(_n,Tn),_t=_n,Pt=Tn)):ke(32823)}function ur(ft){ft===void 0&&(ft=33984+Ot-1),Mt!==ft&&(e.activeTexture(ft),Mt=ft)}return Ht[m]=0,Ht[E]=1,Ht[U]=768,Ht[W]=770,Ht[xe]=776,Ht[we]=774,Ht[ne]=772,Ht[X]=769,Ht[te]=771,Ht[Ie]=775,Ht[ce]=773,{buffers:{color:l,depth:d,stencil:g},initAttributes:function(){for(var ft=0,_n=A.length;ft<_n;ft++)A[ft]=0},enableAttribute:function(ft){cr(ft,0)},enableAttributeAndDivisor:cr,disableUnusedAttributes:function(){for(var ft=0,_n=I.length;ft!==_n;++ft)I[ft]!==A[ft]&&(e.disableVertexAttribArray(ft),I[ft]=0)},enable:Dn,disable:ke,useProgram:function(ft){return ie!==ft&&(e.useProgram(ft),ie=ft,!0)},setBlending:rr,setMaterial:function(ft,_n){(ft.side===j?ke:Dn)(2884);var Tn=ft.side===C;_n&&(Tn=!Tn),En(Tn),ft.blending===M&&ft.transparent===!1?rr(R):rr(ft.blending,ft.blendEquation,ft.blendSrc,ft.blendDst,ft.blendEquationAlpha,ft.blendSrcAlpha,ft.blendDstAlpha,ft.premultipliedAlpha),d.setFunc(ft.depthFunc),d.setTest(ft.depthTest),d.setMask(ft.depthWrite),l.setMask(ft.colorWrite);var ir=ft.stencilWrite;g.setTest(ir),ir&&(g.setMask(ft.stencilWriteMask),g.setFunc(ft.stencilFunc,ft.stencilRef,ft.stencilFuncMask),g.setOp(ft.stencilFail,ft.stencilZFail,ft.stencilZPass)),Pn(ft.polygonOffset,ft.polygonOffsetFactor,ft.polygonOffsetUnits)},setFlipSided:En,setCullFace:Et,setLineWidth:function(ft){ft!==xt&&(Gt&&e.lineWidth(ft),xt=ft)},setPolygonOffset:Pn,setScissorTest:function(ft){(ft?Dn:ke)(3089)},activeTexture:ur,bindTexture:function(ft,_n){Mt===null&&ur();var Tn=dn[Mt];Tn===void 0&&(Tn={type:void 0,texture:void 0},dn[Mt]=Tn),Tn.type===ft&&Tn.texture===_n||(e.bindTexture(ft,_n||Vn[ft]),Tn.type=ft,Tn.texture=_n)},unbindTexture:function(){var ft=dn[Mt];ft!==void 0&&ft.type!==void 0&&(e.bindTexture(ft.type,null),ft.type=void 0,ft.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},scissor:function(ft){Mn.equals(ft)===!1&&(e.scissor(ft.x,ft.y,ft.z,ft.w),Mn.copy(ft))},viewport:function(ft){Zn.equals(ft)===!1&&(e.viewport(ft.x,ft.y,ft.z,ft.w),Zn.copy(ft))},reset:function(){for(var ft=0;ft<I.length;ft++)I[ft]===1&&(e.disableVertexAttribArray(ft),I[ft]=0);Q={},dn={},Je=at=he=ie=Mt=null,l.reset(),d.reset(),g.reset()}}}function od(e,t,n,i,l,d,g){var x,A=l.isWebGL2,I=l.maxTextures,Y=l.maxCubemapSize,Q=l.maxTextureSize,ie=l.maxSamples,z=new WeakMap,he=!1;try{he=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function me(ke,tt){return he?new OffscreenCanvas(ke,tt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function ye(ke,tt,Yt,Ht){var rr=1;if((ke.width>Ht||ke.height>Ht)&&(rr=Ht/Math.max(ke.width,ke.height)),rr<1||tt===!0){if(typeof HTMLImageElement<"u"&&ke instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ke instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ke instanceof ImageBitmap){var En=tt?vr.floorPowerOfTwo:Math.floor,Et=En(rr*ke.width),Pn=En(rr*ke.height);x===void 0&&(x=me(Et,Pn));var ur=Yt?me(Et,Pn):x;return ur.width=Et,ur.height=Pn,ur.getContext("2d").drawImage(ke,0,0,Et,Pn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ke.width+"x"+ke.height+") to ("+Et+"x"+Pn+")."),ur}return"data"in ke&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ke.width+"x"+ke.height+")."),ke}return ke}function Ee(ke){return vr.isPowerOfTwo(ke.width)&&vr.isPowerOfTwo(ke.height)}function Re(ke,tt){return ke.generateMipmaps&&tt&&ke.minFilter!==pt&&ke.minFilter!==xn}function Ve(ke,tt,Yt,Ht){e.generateMipmap(ke),i.get(tt).__maxMipLevel=Math.log(Math.max(Yt,Ht))*Math.LOG2E}function et(ke,tt,Yt){if(A===!1)return tt;if(ke!==null){if(e[ke]!==void 0)return e[ke];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ke+"'")}var Ht=tt;return tt===6403&&(Yt===5126&&(Ht=33326),Yt===5131&&(Ht=33325),Yt===5121&&(Ht=33321)),tt===6407&&(Yt===5126&&(Ht=34837),Yt===5131&&(Ht=34843),Yt===5121&&(Ht=32849)),tt===6408&&(Yt===5126&&(Ht=34836),Yt===5131&&(Ht=34842),Yt===5121&&(Ht=32856)),Ht===33325||Ht===33326||Ht===34842||Ht===34836?t.get("EXT_color_buffer_float"):Ht!==34843&&Ht!==34837||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),Ht}function Fe(ke){return ke===pt||ke===st||ke===qt?9728:9729}function at(ke){var tt=ke.target;tt.removeEventListener("dispose",at),function(Yt){var Ht=i.get(Yt);Ht.__webglInit!==void 0&&(e.deleteTexture(Ht.__webglTexture),i.remove(Yt))}(tt),tt.isVideoTexture&&z.delete(tt),g.memory.textures--}function Je(ke){var tt=ke.target;tt.removeEventListener("dispose",Je),function(Yt){var Ht=i.get(Yt),rr=i.get(Yt.texture);if(Yt){if(rr.__webglTexture!==void 0&&e.deleteTexture(rr.__webglTexture),Yt.depthTexture&&Yt.depthTexture.dispose(),Yt.isWebGLCubeRenderTarget)for(var En=0;En<6;En++)e.deleteFramebuffer(Ht.__webglFramebuffer[En]),Ht.__webglDepthbuffer&&e.deleteRenderbuffer(Ht.__webglDepthbuffer[En]);else e.deleteFramebuffer(Ht.__webglFramebuffer),Ht.__webglDepthbuffer&&e.deleteRenderbuffer(Ht.__webglDepthbuffer);if(Yt.isWebGLMultiviewRenderTarget){e.deleteTexture(Ht.__webglColorTexture),e.deleteTexture(Ht.__webglDepthStencilTexture),g.memory.textures-=2,En=0;for(var Et=Ht.__webglViewFramebuffers.length;En<Et;En++)e.deleteFramebuffer(Ht.__webglViewFramebuffers[En])}i.remove(Yt.texture),i.remove(Yt)}}(tt),g.memory.textures--}var xt=0;function _t(ke,tt){var Yt,Ht,rr=i.get(ke);if(ke.isVideoTexture&&(Yt=ke,Ht=g.render.frame,z.get(Yt)!==Ht&&(z.set(Yt,Ht),Yt.update())),0<ke.version&&rr.__version!==ke.version){var En=ke.image;if(En===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(En.complete!==!1)return void dn(rr,ke,tt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+tt),n.bindTexture(3553,rr.__webglTexture)}function Pt(ke,tt){if(ke.image.length===6){var Yt=i.get(ke);if(0<ke.version&&Yt.__version!==ke.version){Mt(Yt,ke),n.activeTexture(33984+tt),n.bindTexture(34067,Yt.__webglTexture),e.pixelStorei(37440,ke.flipY);for(var Ht=ke&&(ke.isCompressedTexture||ke.image[0].isCompressedTexture),rr=ke.image[0]&&ke.image[0].isDataTexture,En=[],Et=0;Et<6;Et++)En[Et]=Ht||rr?rr?ke.image[Et].image:ke.image[Et]:ye(ke.image[Et],!1,!0,Y);var Pn,ur=En[0],ft=Ee(ur)||A,_n=d.convert(ke.format),Tn=d.convert(ke.type),ir=et(ke.internalFormat,_n,Tn);if(Dt(34067,ke,ft),Ht){for(Et=0;Et<6;Et++){Pn=En[Et].mipmaps;for(var un=0;un<Pn.length;un++){var br=Pn[un];ke.format!==Or&&ke.format!==Gr?_n!==null?n.compressedTexImage2D(34069+Et,un,ir,br.width,br.height,0,br.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+Et,un,ir,br.width,br.height,0,_n,Tn,br.data)}}Yt.__maxMipLevel=Pn.length-1}else{for(Pn=ke.mipmaps,Et=0;Et<6;Et++)if(rr)for(n.texImage2D(34069+Et,0,ir,En[Et].width,En[Et].height,0,_n,Tn,En[Et].data),un=0;un<Pn.length;un++){var Pr=(br=Pn[un]).image[Et].image;n.texImage2D(34069+Et,un+1,ir,Pr.width,Pr.height,0,_n,Tn,Pr.data)}else for(n.texImage2D(34069+Et,0,ir,_n,Tn,En[Et]),un=0;un<Pn.length;un++)br=Pn[un],n.texImage2D(34069+Et,un+1,ir,_n,Tn,br.image[Et]);Yt.__maxMipLevel=Pn.length}Re(ke,ft)&&Ve(34067,ke,ur.width,ur.height),Yt.__version=ke.version,ke.onUpdate&&ke.onUpdate(ke)}else n.activeTexture(33984+tt),n.bindTexture(34067,Yt.__webglTexture)}}function Ot(ke,tt){n.activeTexture(33984+tt),n.bindTexture(34067,i.get(ke).__webglTexture)}var Gt={};Gt[Zt]=10497,Gt[An]=33071,Gt[Yn]=33648;var Kt={};function Dt(ke,tt,Yt){Yt?(e.texParameteri(ke,10242,Gt[tt.wrapS]),e.texParameteri(ke,10243,Gt[tt.wrapT]),ke!==32879&&ke!==35866||e.texParameteri(ke,32882,Gt[tt.wrapR]),e.texParameteri(ke,10240,Kt[tt.magFilter]),e.texParameteri(ke,10241,Kt[tt.minFilter])):(e.texParameteri(ke,10242,33071),e.texParameteri(ke,10243,33071),ke!==32879&&ke!==35866||e.texParameteri(ke,32882,33071),tt.wrapS===An&&tt.wrapT===An||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(ke,10240,Fe(tt.magFilter)),e.texParameteri(ke,10241,Fe(tt.minFilter)),tt.minFilter!==pt&&tt.minFilter!==xn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var Ht=t.get("EXT_texture_filter_anisotropic");if(Ht){if(tt.type===Rt&&t.get("OES_texture_float_linear")===null||tt.type===$t&&(A||t.get("OES_texture_half_float_linear"))===null)return;(1<tt.anisotropy||i.get(tt).__currentAnisotropy)&&(e.texParameterf(ke,Ht.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(tt.anisotropy,l.getMaxAnisotropy())),i.get(tt).__currentAnisotropy=tt.anisotropy)}}function Mt(ke,tt){ke.__webglInit===void 0&&(ke.__webglInit=!0,tt.addEventListener("dispose",at),ke.__webglTexture=e.createTexture(),g.memory.textures++)}function dn(ke,tt,Yt){var Ht=3553;tt.isDataTexture2DArray&&(Ht=35866),tt.isDataTexture3D&&(Ht=32879),Mt(ke,tt),n.activeTexture(33984+Yt),n.bindTexture(Ht,ke.__webglTexture),e.pixelStorei(37440,tt.flipY),e.pixelStorei(37441,tt.premultiplyAlpha),e.pixelStorei(3317,tt.unpackAlignment);var rr,En=(rr=tt,!A&&(rr.wrapS!==An||rr.wrapT!==An||rr.minFilter!==pt&&rr.minFilter!==xn)&&Ee(tt.image)===!1),Et=ye(tt.image,En,!1,Q),Pn=Ee(Et)||A,ur=d.convert(tt.format),ft=d.convert(tt.type),_n=et(tt.internalFormat,ur,ft);Dt(Ht,tt,Pn);var Tn,ir=tt.mipmaps;if(tt.isDepthTexture){if(_n=6402,tt.type===Rt){if(A===!1)throw new Error("Float Depth Texture only supported in WebGL2.0");_n=36012}else A&&(_n=33189);tt.format===gr&&_n===6402&&tt.type!==lt&&tt.type!==$e&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),tt.type=lt,ft=d.convert(tt.type)),tt.format===Wi&&(_n=34041,tt.type!==qr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),tt.type=qr,ft=d.convert(tt.type))),n.texImage2D(3553,0,_n,Et.width,Et.height,0,ur,ft,null)}else if(tt.isDataTexture)if(0<ir.length&&Pn){for(var un=0,br=ir.length;un<br;un++)Tn=ir[un],n.texImage2D(3553,un,_n,Tn.width,Tn.height,0,ur,ft,Tn.data);tt.generateMipmaps=!1,ke.__maxMipLevel=ir.length-1}else n.texImage2D(3553,0,_n,Et.width,Et.height,0,ur,ft,Et.data),ke.__maxMipLevel=0;else if(tt.isCompressedTexture){for(un=0,br=ir.length;un<br;un++)Tn=ir[un],tt.format!==Or&&tt.format!==Gr?ur!==null?n.compressedTexImage2D(3553,un,_n,Tn.width,Tn.height,0,Tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,un,_n,Tn.width,Tn.height,0,ur,ft,Tn.data);ke.__maxMipLevel=ir.length-1}else if(tt.isDataTexture2DArray)n.texImage3D(35866,0,_n,Et.width,Et.height,Et.depth,0,ur,ft,Et.data),ke.__maxMipLevel=0;else if(tt.isDataTexture3D)n.texImage3D(32879,0,_n,Et.width,Et.height,Et.depth,0,ur,ft,Et.data),ke.__maxMipLevel=0;else if(0<ir.length&&Pn){for(un=0,br=ir.length;un<br;un++)Tn=ir[un],n.texImage2D(3553,un,_n,ur,ft,Tn);tt.generateMipmaps=!1,ke.__maxMipLevel=ir.length-1}else n.texImage2D(3553,0,_n,ur,ft,Et),ke.__maxMipLevel=0;Re(tt,Pn)&&Ve(Ht,tt,Et.width,Et.height),ke.__version=tt.version,tt.onUpdate&&tt.onUpdate(tt)}function Mn(ke,tt,Yt,Ht){var rr=d.convert(tt.texture.format),En=d.convert(tt.texture.type),Et=et(tt.texture.internalFormat,rr,En);n.texImage2D(Ht,0,Et,tt.width,tt.height,0,rr,En,null),e.bindFramebuffer(36160,ke),e.framebufferTexture2D(36160,Yt,Ht,i.get(tt.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Zn(ke,tt,Yt){if(e.bindRenderbuffer(36161,ke),tt.depthBuffer&&!tt.stencilBuffer){if(Yt){var Ht=Vn(tt);e.renderbufferStorageMultisample(36161,Ht,33189,tt.width,tt.height)}else e.renderbufferStorage(36161,33189,tt.width,tt.height);e.framebufferRenderbuffer(36160,36096,36161,ke)}else if(tt.depthBuffer&&tt.stencilBuffer)Yt?(Ht=Vn(tt),e.renderbufferStorageMultisample(36161,Ht,35056,tt.width,tt.height)):e.renderbufferStorage(36161,34041,tt.width,tt.height),e.framebufferRenderbuffer(36160,33306,36161,ke);else{var rr=d.convert(tt.texture.format),En=d.convert(tt.texture.type),Et=et(tt.texture.internalFormat,rr,En);Yt?(Ht=Vn(tt),e.renderbufferStorageMultisample(36161,Ht,Et,tt.width,tt.height)):e.renderbufferStorage(36161,Et,tt.width,tt.height)}e.bindRenderbuffer(36161,null)}function qn(ke){var tt=i.get(ke),Yt=ke.isWebGLCubeRenderTarget===!0;if(ke.depthTexture){if(Yt)throw new Error("target.depthTexture not supported in Cube render targets");(function(rr,En){if(En&&En.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,rr),!En.depthTexture||!En.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(En.depthTexture).__webglTexture&&En.depthTexture.image.width===En.width&&En.depthTexture.image.height===En.height||(En.depthTexture.image.width=En.width,En.depthTexture.image.height=En.height,En.depthTexture.needsUpdate=!0),_t(En.depthTexture,0);var Et=i.get(En.depthTexture).__webglTexture;if(En.depthTexture.format===gr)e.framebufferTexture2D(36160,36096,3553,Et,0);else{if(En.depthTexture.format!==Wi)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,Et,0)}})(tt.__webglFramebuffer,ke)}else if(Yt){tt.__webglDepthbuffer=[];for(var Ht=0;Ht<6;Ht++)e.bindFramebuffer(36160,tt.__webglFramebuffer[Ht]),tt.__webglDepthbuffer[Ht]=e.createRenderbuffer(),Zn(tt.__webglDepthbuffer[Ht],ke)}else e.bindFramebuffer(36160,tt.__webglFramebuffer),tt.__webglDepthbuffer=e.createRenderbuffer(),Zn(tt.__webglDepthbuffer,ke);e.bindFramebuffer(36160,null)}function Vn(ke){return A&&ke.isWebGLMultisampleRenderTarget?Math.min(ie,ke.samples):0}Kt[pt]=9728,Kt[st]=9984,Kt[qt]=9986,Kt[xn]=9729,Kt[nn]=9985;var cr=!(Kt[er]=9987),Dn=!1;this.allocateTextureUnit=function(){var ke=xt;return I<=ke&&console.warn("THREE.WebGLTextures: Trying to use "+ke+" texture units while this GPU supports only "+I),xt+=1,ke},this.resetTextureUnits=function(){xt=0},this.setTexture2D=_t,this.setTexture2DArray=function(ke,tt){var Yt=i.get(ke);0<ke.version&&Yt.__version!==ke.version?dn(Yt,ke,tt):(n.activeTexture(33984+tt),n.bindTexture(35866,Yt.__webglTexture))},this.setTexture3D=function(ke,tt){var Yt=i.get(ke);0<ke.version&&Yt.__version!==ke.version?dn(Yt,ke,tt):(n.activeTexture(33984+tt),n.bindTexture(32879,Yt.__webglTexture))},this.setTextureCube=Pt,this.setTextureCubeDynamic=Ot,this.setupRenderTarget=function(ke){var tt=i.get(ke),Yt=i.get(ke.texture);ke.addEventListener("dispose",Je),Yt.__webglTexture=e.createTexture(),g.memory.textures++;var Ht=ke.isWebGLCubeRenderTarget===!0,rr=ke.isWebGLMultisampleRenderTarget===!0,En=ke.isWebGLMultiviewRenderTarget===!0,Et=Ee(ke)||A;if(Ht){tt.__webglFramebuffer=[];for(var Pn=0;Pn<6;Pn++)tt.__webglFramebuffer[Pn]=e.createFramebuffer()}else if(tt.__webglFramebuffer=e.createFramebuffer(),rr)if(A){tt.__webglMultisampledFramebuffer=e.createFramebuffer(),tt.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,tt.__webglColorRenderbuffer);var ur=d.convert(ke.texture.format),ft=d.convert(ke.texture.type),_n=et(ke.texture.internalFormat,ur,ft),Tn=Vn(ke);e.renderbufferStorageMultisample(36161,Tn,_n,ke.width,ke.height),e.bindFramebuffer(36160,tt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,tt.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),ke.depthBuffer&&(tt.__webglDepthRenderbuffer=e.createRenderbuffer(),Zn(tt.__webglDepthRenderbuffer,ke,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(En){var ir=ke.width,un=ke.height,br=ke.numViews;e.bindFramebuffer(36160,tt.__webglFramebuffer);var Pr=t.get("OVR_multiview2");g.memory.textures+=2;var vi=e.createTexture();e.bindTexture(35866,vi),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,32856,ir,un,br,0,6408,5121,null),Pr.framebufferTextureMultiviewOVR(36160,36064,vi,0,0,br);var mo=e.createTexture();e.bindTexture(35866,mo),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,35056,ir,un,br,0,34041,34042,null),Pr.framebufferTextureMultiviewOVR(36160,33306,mo,0,0,br);var Nr=new Array(br);for(Pn=0;Pn<br;++Pn)Nr[Pn]=e.createFramebuffer(),e.bindFramebuffer(36160,Nr[Pn]),e.framebufferTextureLayer(36160,36064,vi,0,Pn);tt.__webglColorTexture=vi,tt.__webglDepthStencilTexture=mo,tt.__webglViewFramebuffers=Nr,e.bindFramebuffer(36160,null),e.bindTexture(35866,null)}if(Ht){for(n.bindTexture(34067,Yt.__webglTexture),Dt(34067,ke.texture,Et),Pn=0;Pn<6;Pn++)Mn(tt.__webglFramebuffer[Pn],ke,36064,34069+Pn);Re(ke.texture,Et)&&Ve(34067,ke.texture,ke.width,ke.height),n.bindTexture(34067,null)}else En||(n.bindTexture(3553,Yt.__webglTexture),Dt(3553,ke.texture,Et),Mn(tt.__webglFramebuffer,ke,36064,3553),Re(ke.texture,Et)&&Ve(3553,ke.texture,ke.width,ke.height),n.bindTexture(3553,null));ke.depthBuffer&&qn(ke)},this.updateRenderTargetMipmap=function(ke){var tt=ke.texture;if(Re(tt,Ee(ke)||A)){var Yt=ke.isWebGLCubeRenderTarget?34067:3553,Ht=i.get(tt).__webglTexture;n.bindTexture(Yt,Ht),Ve(Yt,tt,ke.width,ke.height),n.bindTexture(Yt,null)}},this.updateMultisampleRenderTarget=function(ke){if(ke.isWebGLMultisampleRenderTarget)if(A){var tt=i.get(ke);e.bindFramebuffer(36008,tt.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,tt.__webglFramebuffer);var Yt=ke.width,Ht=ke.height,rr=16384;ke.depthBuffer&&(rr|=256),ke.stencilBuffer&&(rr|=1024),e.blitFramebuffer(0,0,Yt,Ht,0,0,Yt,Ht,rr,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(ke,tt){ke&&ke.isWebGLRenderTarget&&(cr===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),cr=!0),ke=ke.texture),_t(ke,tt)},this.safeSetTextureCube=function(ke,tt){ke&&ke.isWebGLCubeRenderTarget&&(Dn===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Dn=!0),ke=ke.texture),(ke&&ke.isCubeTexture||Array.isArray(ke.image)&&ke.image.length===6?Pt:Ot)(ke,tt)}}function jl(e,t,n){var i=n.isWebGL2;return{convert:function(l){var d;if(l===kr)return 5121;if(l===an)return 32819;if(l===hr)return 32820;if(l===_r)return 33635;if(l===ct)return 5120;if(l===Ue)return 5122;if(l===lt)return 5123;if(l===Wt)return 5124;if(l===$e)return 5125;if(l===Rt)return 5126;if(l===$t)return i?5131:(d=t.get("OES_texture_half_float"))!==null?d.HALF_FLOAT_OES:null;if(l===Ur)return 6406;if(l===Gr)return 6407;if(l===Or)return 6408;if(l===Qi)return 6409;if(l===Pi)return 6410;if(l===gr)return 6402;if(l===Wi)return 34041;if(l===H)return 6403;if(l===Hr)return 36244;if(l===Da)return 33319;if(l===$n)return 33320;if(l===oa)return 36248;if(l===No)return 36249;if(l===Fs||l===es||l===fs||l===to){if((d=t.get("WEBGL_compressed_texture_s3tc"))===null)return null;if(l===Fs)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===es)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===fs)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===to)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(l===ts||l===sa||l===Bo||l===Ea){if((d=t.get("WEBGL_compressed_texture_pvrtc"))===null)return null;if(l===ts)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===sa)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===Bo)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===Ea)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return l===ms?(d=t.get("WEBGL_compressed_texture_etc1"))!==null?d.COMPRESSED_RGB_ETC1_WEBGL:null:l===Vs||l===no||l===gs||l===Pa||l===ys||l===ro||l===io||l===Xr||l===Sr||l===ns||l===vs||l===rs||l===Fo||l===Ji?(d=t.get("WEBGL_compressed_texture_astc"))!==null?l:null:l===qr?i?34042:(d=t.get("WEBGL_depth_texture"))!==null?d.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function pc(e,t,n,i){qi.call(this,e,t,i),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}function fc(e){Ii.call(this),this.cameras=e||[]}function rl(){At.call(this),this.type="Group"}function mc(e,t){var n=this,i=null,l=null,d="local-floor",g=null,x=[],A=new Map,I=new Ii;I.layers.enable(1),I.viewport=new Jr;var Y=new Ii;Y.layers.enable(2),Y.viewport=new Jr;var Q=new fc([I,Y]);Q.layers.enable(1),Q.layers.enable(2);var ie=null,z=null;function he(Je){var xt=A.get(Je.inputSource);xt&&(xt.targetRay&&xt.targetRay.dispatchEvent({type:Je.type}),xt.grip&&xt.grip.dispatchEvent({type:Je.type}))}function me(){A.forEach(function(Je,xt){Je.targetRay&&(Je.targetRay.dispatchEvent({type:"disconnected",data:xt}),Je.targetRay.visible=!1),Je.grip&&(Je.grip.dispatchEvent({type:"disconnected",data:xt}),Je.grip.visible=!1)}),A.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),at.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function ye(Je){l=Je,at.setContext(i),at.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function Ee(Je){for(var xt=i.inputSources,_t=0;_t<x.length;_t++)A.set(xt[_t],x[_t]);for(_t=0;_t<Je.removed.length;_t++){var Pt=Je.removed[_t];(Ot=A.get(Pt))&&(Ot.targetRay&&Ot.targetRay.dispatchEvent({type:"disconnected",data:Pt}),Ot.grip&&Ot.grip.dispatchEvent({type:"disconnected",data:Pt}),A.delete(Pt))}for(_t=0;_t<Je.added.length;_t++){var Ot;Pt=Je.added[_t],(Ot=A.get(Pt))&&(Ot.targetRay&&Ot.targetRay.dispatchEvent({type:"connected",data:Pt}),Ot.grip&&Ot.grip.dispatchEvent({type:"connected",data:Pt}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(Je){var xt=x[Je];return xt===void 0&&(xt={},x[Je]=xt),xt.targetRay===void 0&&(xt.targetRay=new rl,xt.targetRay.matrixAutoUpdate=!1,xt.targetRay.visible=!1),xt.targetRay},this.getControllerGrip=function(Je){var xt=x[Je];return xt===void 0&&(xt={},x[Je]=xt),xt.grip===void 0&&(xt.grip=new rl,xt.grip.matrixAutoUpdate=!1,xt.grip.visible=!1),xt.grip},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(Je){d=Je},this.getReferenceSpace=function(){return l},this.getSession=function(){return i},this.setSession=function(Je){if((i=Je)!==null){i.addEventListener("select",he),i.addEventListener("selectstart",he),i.addEventListener("selectend",he),i.addEventListener("squeeze",he),i.addEventListener("squeezestart",he),i.addEventListener("squeezeend",he),i.addEventListener("end",me);var xt=t.getContextAttributes(),_t={antialias:xt.antialias,alpha:xt.alpha,depth:xt.depth,stencil:xt.stencil},Pt=new XRWebGLLayer(i,t,_t);i.updateRenderState({baseLayer:Pt}),i.requestReferenceSpace(d).then(ye),i.addEventListener("inputsourceschange",Ee)}};var Re=new Oe,Ve=new Oe;function et(Je,xt){xt===null?Je.matrixWorld.copy(Je.matrix):Je.matrixWorld.multiplyMatrices(xt.matrixWorld,Je.matrix),Je.matrixWorldInverse.getInverse(Je.matrixWorld)}this.getCamera=function(Je){Q.near=Y.near=I.near=Je.near,Q.far=Y.far=I.far=Je.far,ie===Q.near&&z===Q.far||(i.updateRenderState({depthNear:Q.near,depthFar:Q.far}),ie=Q.near,z=Q.far);var xt=Je.parent,_t=Q.cameras;et(Q,xt);for(var Pt=0;Pt<_t.length;Pt++)et(_t[Pt],xt);Je.matrixWorld.copy(Q.matrixWorld);for(var Ot=Je.children,Gt=(Pt=0,Ot.length);Pt<Gt;Pt++)Ot[Pt].updateMatrixWorld(!0);return function(Kt,Dt,Mt){Re.setFromMatrixPosition(Dt.matrixWorld),Ve.setFromMatrixPosition(Mt.matrixWorld);var dn=Re.distanceTo(Ve),Mn=Dt.projectionMatrix.elements,Zn=Mt.projectionMatrix.elements,qn=Mn[14]/(Mn[10]-1),Vn=Mn[14]/(Mn[10]+1),cr=(Mn[9]+1)/Mn[5],Dn=(Mn[9]-1)/Mn[5],ke=(Mn[8]-1)/Mn[0],tt=(Zn[8]+1)/Zn[0],Yt=qn*ke,Ht=qn*tt,rr=dn/(tt-ke),En=rr*-ke;Dt.matrixWorld.decompose(Kt.position,Kt.quaternion,Kt.scale),Kt.translateX(En),Kt.translateZ(rr),Kt.matrixWorld.compose(Kt.position,Kt.quaternion,Kt.scale),Kt.matrixWorldInverse.getInverse(Kt.matrixWorld);var Et=qn+rr,Pn=Vn+rr,ur=Yt-En,ft=dn-En+Ht,_n=cr*Vn/Pn*Et,Tn=Dn*Vn/Pn*Et;Kt.projectionMatrix.makePerspective(ur,ft,_n,Tn,Et,Pn)}(Q,I,Y),Q};var Fe=null,at=new ch;at.setAnimationLoop(function(Je,xt){if((g=xt.getViewerPose(l))!==null){var _t=g.views,Pt=i.renderState.baseLayer;e.setFramebuffer(Pt.framebuffer);for(var Ot=0;Ot<_t.length;Ot++){var Gt=_t[Ot],Kt=Pt.getViewport(Gt),Dt=Q.cameras[Ot];Dt.matrix.fromArray(Gt.transform.matrix),Dt.projectionMatrix.fromArray(Gt.projectionMatrix),Dt.viewport.set(Kt.x,Kt.y,Kt.width,Kt.height),Ot===0&&Q.matrix.copy(Dt.matrix)}}var Mt=i.inputSources;for(Ot=0;Ot<x.length;Ot++){var dn=x[Ot],Mn=Mt[Ot],Zn=null,qn=null;Mn&&(dn.targetRay&&(Zn=xt.getPose(Mn.targetRaySpace,l))!==null&&(dn.targetRay.matrix.fromArray(Zn.transform.matrix),dn.targetRay.matrix.decompose(dn.targetRay.position,dn.targetRay.rotation,dn.targetRay.scale)),dn.grip&&Mn.gripSpace&&(qn=xt.getPose(Mn.gripSpace,l))!==null&&(dn.grip.matrix.fromArray(qn.transform.matrix),dn.grip.matrix.decompose(dn.grip.position,dn.grip.rotation,dn.grip.scale))),dn.targetRay&&(dn.targetRay.visible=Zn!==null),dn.grip&&(dn.grip.visible=qn!==null)}Fe&&Fe(Je,xt)}),this.setAnimationLoop=function(Je){Fe=Je},this.dispose=function(){}}function Su(e){var t=(e=e||{}).canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=e.context!==void 0?e.context:null,i=e.alpha!==void 0&&e.alpha,l=e.depth===void 0||e.depth,d=e.stencil===void 0||e.stencil,g=e.antialias!==void 0&&e.antialias,x=e.premultipliedAlpha===void 0||e.premultipliedAlpha,A=e.preserveDrawingBuffer!==void 0&&e.preserveDrawingBuffer,I=e.powerPreference!==void 0?e.powerPreference:"default",Y=e.failIfMajorPerformanceCaveat!==void 0&&e.failIfMajorPerformanceCaveat,Q=null,ie=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ke,this.physicallyCorrectLights=!1,this.toneMapping=nt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var z,he,me,ye,Ee,Re,Ve,et,Fe,at,Je,xt,_t,Pt,Ot,Gt,Kt,Dt,Mt=this,dn=!1,Mn=null,Zn=0,qn=0,Vn=null,cr=null,Dn=-1,ke={geometry:null,program:null,wireframe:!1},tt=null,Yt=null,Ht=new Jr,rr=new Jr,En=null,Et=t.width,Pn=t.height,ur=1,ft=null,_n=null,Tn=new Jr(0,0,Et,Pn),ir=new Jr(0,0,Et,Pn),un=!1,br=new $s,Pr=new function(){var De=this,Ze=null,qe=0,dt=!1,bt=!1,fn=new na,mn=new Si,cn={value:null,needsUpdate:!1};function vn(){cn.value!==Ze&&(cn.value=Ze,cn.needsUpdate=0<qe),De.numPlanes=qe,De.numIntersection=0}function Vt(tn,Fn,Un,hn){var ln=tn!==null?tn.length:0,Kn=null;if(ln!==0){if(Kn=cn.value,hn!==!0||Kn===null){var ar=Un+4*ln,mr=Fn.matrixWorldInverse;mn.getNormalMatrix(mr),(Kn===null||Kn.length<ar)&&(Kn=new Float32Array(ar));for(var ii=0,Br=Un;ii!==ln;++ii,Br+=4)fn.copy(tn[ii]).applyMatrix4(mr,mn),fn.normal.toArray(Kn,Br),Kn[Br+3]=fn.constant}cn.value=Kn,cn.needsUpdate=!0}return De.numPlanes=ln,Kn}this.uniform=cn,this.numPlanes=0,this.numIntersection=0,this.init=function(tn,Fn,Un){var hn=tn.length!==0||Fn||qe!==0||dt;return dt=Fn,Ze=Vt(tn,Un,0),qe=tn.length,hn},this.beginShadows=function(){bt=!0,Vt(null)},this.endShadows=function(){bt=!1,vn()},this.setState=function(tn,Fn,Un,hn,ln,Kn){if(!dt||tn===null||tn.length===0||bt&&!Un)bt?Vt(null):vn();else{var ar=bt?0:qe,mr=4*ar,ii=ln.clippingState||null;cn.value=ii,ii=Vt(tn,hn,mr,Kn);for(var Br=0;Br!==mr;++Br)ii[Br]=Ze[Br];ln.clippingState=ii,this.numIntersection=Fn?this.numPlanes:0,this.numPlanes+=ar}}},vi=!1,mo=!1,Nr=new fr,Ei=new Oe;function Ir(){return Vn===null?ur:1}try{var oi={alpha:i,depth:l,stencil:d,antialias:g,premultipliedAlpha:x,preserveDrawingBuffer:A,powerPreference:I,failIfMajorPerformanceCaveat:Y,xrCompatible:!0};t.addEventListener("webglcontextlost",go,!1),t.addEventListener("webglcontextrestored",ps,!1);var xi="webgl";if(e.webgl2===!0&&(xi="webgl2"),(z=n||t.getContext(xi,oi)||t.getContext("experimental-webgl",oi))===null)throw t.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");e.retver=xi,z.getShaderPrecisionFormat===void 0&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(De){throw console.error("THREE.WebGLRenderer: "+De.message),De}function aa(){he=new function(De){var Ze={};return{get:function(qe){if(Ze[qe]!==void 0)return Ze[qe];var dt;switch(qe){case"WEBGL_depth_texture":dt=De.getExtension("WEBGL_depth_texture")||De.getExtension("MOZ_WEBGL_depth_texture")||De.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":dt=De.getExtension("EXT_texture_filter_anisotropic")||De.getExtension("MOZ_EXT_texture_filter_anisotropic")||De.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":dt=De.getExtension("WEBGL_compressed_texture_s3tc")||De.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||De.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":dt=De.getExtension("WEBGL_compressed_texture_pvrtc")||De.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:dt=De.getExtension(qe)}return dt===null&&console.warn("THREE.WebGLRenderer: "+qe+" extension not supported."),Ze[qe]=dt}}}(z),(me=new function(De,Ze,qe){var dt;function bt(Br){if(Br==="highp"){if(0<De.getShaderPrecisionFormat(35633,36338).precision&&0<De.getShaderPrecisionFormat(35632,36338).precision)return"highp";Br="mediump"}return Br==="mediump"&&0<De.getShaderPrecisionFormat(35633,36337).precision&&0<De.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var fn=typeof WebGL2RenderingContext<"u"&&De instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&De instanceof WebGL2ComputeRenderingContext,mn=qe.precision!==void 0?qe.precision:"highp",cn=bt(mn);cn!==mn&&(console.warn("THREE.WebGLRenderer:",mn,"not supported, using",cn,"instead."),mn=cn);var vn=qe.logarithmicDepthBuffer===!0,Vt=De.getParameter(34930),tn=De.getParameter(35660),Fn=De.getParameter(3379),Un=De.getParameter(34076),hn=De.getParameter(34921),ln=De.getParameter(36347),Kn=De.getParameter(36348),ar=De.getParameter(36349),mr=0<tn,ii=fn||!!Ze.get("OES_texture_float");return{isWebGL2:fn,getMaxAnisotropy:function(){if(dt!==void 0)return dt;var Br=Ze.get("EXT_texture_filter_anisotropic");return dt=Br!==null?De.getParameter(Br.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:bt,precision:mn,logarithmicDepthBuffer:vn,maxTextures:Vt,maxVertexTextures:tn,maxTextureSize:Fn,maxCubemapSize:Un,maxAttributes:hn,maxVertexUniforms:ln,maxVaryings:Kn,maxFragmentUniforms:ar,vertexTextures:mr,floatFragmentTextures:ii,floatVertexTextures:mr&&ii,maxSamples:fn?De.getParameter(36183):0}}(z,he,e)).isWebGL2===!1&&(he.get("WEBGL_depth_texture"),he.get("OES_texture_float"),he.get("OES_texture_half_float"),he.get("OES_texture_half_float_linear"),he.get("OES_standard_derivatives"),he.get("OES_element_index_uint"),he.get("ANGLE_instanced_arrays")),he.get("OES_texture_float_linear"),Dt=new jl(0,he,me),(ye=new Oh(z,he,me)).scissor(rr.copy(ir).multiplyScalar(ur).floor()),ye.viewport(Ht.copy(Tn).multiplyScalar(ur).floor()),Ee=new function(De){var Ze={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:Ze,programs:null,autoReset:!0,reset:function(){Ze.frame++,Ze.calls=0,Ze.triangles=0,Ze.points=0,Ze.lines=0},update:function(qe,dt,bt){switch(bt=bt||1,Ze.calls++,dt){case 4:Ze.triangles+=bt*(qe/3);break;case 1:Ze.lines+=bt*(qe/2);break;case 3:Ze.lines+=bt*(qe-1);break;case 2:Ze.lines+=bt*qe;break;case 0:Ze.points+=bt*qe;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",dt)}}}},Re=new function(){var De=new WeakMap;return{get:function(Ze){var qe=De.get(Ze);return qe===void 0&&(qe={},De.set(Ze,qe)),qe},remove:function(Ze){De.delete(Ze)},update:function(Ze,qe,dt){De.get(Ze)[qe]=dt},dispose:function(){De=new WeakMap}}},Ve=new od(z,he,ye,Re,me,Dt,Ee),et=new function(De,Ze){var qe=Ze.isWebGL2,dt=new WeakMap;return{get:function(bt){return bt.isInterleavedBufferAttribute&&(bt=bt.data),dt.get(bt)},remove:function(bt){bt.isInterleavedBufferAttribute&&(bt=bt.data);var fn=dt.get(bt);fn&&(De.deleteBuffer(fn.buffer),dt.delete(bt))},update:function(bt,fn){bt.isInterleavedBufferAttribute&&(bt=bt.data);var mn,cn,vn,Vt,tn,Fn=dt.get(bt);Fn===void 0?dt.set(bt,function(Un,hn){var ln=Un.array,Kn=Un.usage,ar=De.createBuffer();De.bindBuffer(hn,ar),De.bufferData(hn,ln,Kn),Un.onUploadCallback();var mr=5126;return ln instanceof Float32Array?mr=5126:ln instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):ln instanceof Uint16Array?mr=5123:ln instanceof Int16Array?mr=5122:ln instanceof Uint32Array?mr=5125:ln instanceof Int32Array?mr=5124:ln instanceof Int8Array?mr=5120:ln instanceof Uint8Array&&(mr=5121),{buffer:ar,type:mr,bytesPerElement:ln.BYTES_PER_ELEMENT,version:Un.version}}(bt,fn)):Fn.version<bt.version&&(mn=Fn.buffer,vn=fn,Vt=(cn=bt).array,tn=cn.updateRange,De.bindBuffer(vn,mn),tn.count===-1?De.bufferSubData(vn,0,Vt):(qe?De.bufferSubData(vn,tn.offset*Vt.BYTES_PER_ELEMENT,Vt,tn.offset,tn.count):De.bufferSubData(vn,tn.offset*Vt.BYTES_PER_ELEMENT,Vt.subarray(tn.offset,tn.offset+tn.count)),tn.count=-1),Fn.version=bt.version)}}}(z,me),Fe=new function(De,Ze,qe){var dt=new WeakMap,bt=new WeakMap;function fn(cn){var vn=cn.target,Vt=dt.get(vn);for(var tn in Vt.index!==null&&Ze.remove(Vt.index),Vt.attributes)Ze.remove(Vt.attributes[tn]);vn.removeEventListener("dispose",fn),dt.delete(vn);var Fn=bt.get(Vt);Fn&&(Ze.remove(Fn),bt.delete(Vt)),qe.memory.geometries--}function mn(cn){var vn=[],Vt=cn.index,tn=cn.attributes.position,Fn=0;if(Vt!==null){var Un=Vt.array;Fn=Vt.version;for(var hn=0,ln=Un.length;hn<ln;hn+=3){var Kn=Un[hn+0],ar=Un[hn+1],mr=Un[hn+2];vn.push(Kn,ar,ar,mr,mr,Kn)}}else for(Un=tn.array,Fn=tn.version,hn=0,ln=Un.length/3-1;hn<ln;hn+=3)Kn=hn+0,ar=hn+1,mr=hn+2,vn.push(Kn,ar,ar,mr,mr,Kn);var ii=new(65535<Yi(vn)?Mi:pi)(vn,1);ii.version=Fn,Ze.update(ii,34963);var Br=bt.get(cn);Br&&Ze.remove(Br),bt.set(cn,ii)}return{get:function(cn,vn){var Vt=dt.get(vn);return Vt||(vn.addEventListener("dispose",fn),vn.isBufferGeometry?Vt=vn:vn.isGeometry&&(vn._bufferGeometry===void 0&&(vn._bufferGeometry=new Sn().setFromObject(cn)),Vt=vn._bufferGeometry),dt.set(vn,Vt),qe.memory.geometries++,Vt)},update:function(cn){var vn=cn.index,Vt=cn.attributes;for(var tn in vn!==null&&Ze.update(vn,34963),Vt)Ze.update(Vt[tn],34962);var Fn=cn.morphAttributes;for(var tn in Fn)for(var Un=Fn[tn],hn=0,ln=Un.length;hn<ln;hn++)Ze.update(Un[hn],34962)},getWireframeAttribute:function(cn){var vn=bt.get(cn);if(vn){var Vt=cn.index;Vt!==null&&vn.version<Vt.version&&mn(cn)}else mn(cn);return bt.get(cn)}}}(0,et,Ee),at=new function(De,Ze,qe,dt){var bt={};return{update:function(fn){var mn=dt.render.frame,cn=fn.geometry,vn=Ze.get(fn,cn);return bt[vn.id]!==mn&&(cn.isGeometry&&vn.updateFromObject(fn),Ze.update(vn),bt[vn.id]=mn),fn.isInstancedMesh&&qe.update(fn.instanceMatrix,34962),vn},dispose:function(){bt={}}}}(0,Fe,et,Ee),Ot=new function(De){var Ze={},qe=new Float32Array(8);return{update:function(dt,bt,fn,mn){var cn=dt.morphTargetInfluences,vn=cn===void 0?0:cn.length,Vt=Ze[bt.id];if(Vt===void 0){Vt=[];for(var tn=0;tn<vn;tn++)Vt[tn]=[tn,0];Ze[bt.id]=Vt}var Fn=fn.morphTargets&&bt.morphAttributes.position,Un=fn.morphNormals&&bt.morphAttributes.normal;for(tn=0;tn<vn;tn++)(ln=Vt[tn])[1]!==0&&(Fn&&bt.deleteAttribute("morphTarget"+tn),Un&&bt.deleteAttribute("morphNormal"+tn));for(tn=0;tn<vn;tn++)(ln=Vt[tn])[0]=tn,ln[1]=cn[tn];Vt.sort(uc);var hn=0;for(tn=0;tn<8;tn++){var ln;if(ln=Vt[tn]){var Kn=ln[0],ar=ln[1];if(ar){Fn&&bt.setAttribute("morphTarget"+tn,Fn[Kn]),Un&&bt.setAttribute("morphNormal"+tn,Un[Kn]),hn+=qe[tn]=ar;continue}}qe[tn]=0}var mr=bt.morphTargetsRelative?1:1-hn;mn.getUniforms().setValue(De,"morphTargetBaseInfluence",mr),mn.getUniforms().setValue(De,"morphTargetInfluences",qe)}}}(z),Je=new td(Mt,he,me),xt=new function(){var De=new WeakMap;function Ze(qe){var dt=qe.target;dt.removeEventListener("dispose",Ze),De.delete(dt)}return{get:function(qe,dt){var bt,fn=De.get(qe);return fn===void 0?(bt=new Jo,De.set(qe,new WeakMap),De.get(qe).set(dt,bt),qe.addEventListener("dispose",Ze)):(bt=fn.get(dt))===void 0&&(bt=new Jo,fn.set(dt,bt)),bt},dispose:function(){De=new WeakMap}}},_t=new function(){var De=new WeakMap;function Ze(qe){var dt=qe.target;dt.removeEventListener("dispose",Ze),De.delete(dt)}return{get:function(qe,dt){var bt;return De.has(qe)===!1?(bt=new rd,De.set(qe,new WeakMap),De.get(qe).set(dt,bt),qe.addEventListener("dispose",Ze)):De.get(qe).has(dt)===!1?(bt=new rd,De.get(qe).set(dt,bt)):bt=De.get(qe).get(dt),bt},dispose:function(){De=new WeakMap}}},Pt=new Lr(Mt,ye,at,x),Gt=new function(De,Ze,qe,dt){var bt,fn=dt.isWebGL2;this.setMode=function(mn){bt=mn},this.render=function(mn,cn){De.drawArrays(bt,mn,cn),qe.update(cn,bt)},this.renderInstances=function(mn,cn,vn,Vt){if(Vt!==0){var tn,Fn;if(fn)tn=De,Fn="drawArraysInstanced";else if(Fn="drawArraysInstancedANGLE",(tn=Ze.get("ANGLE_instanced_arrays"))===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");tn[Fn](bt,cn,vn,Vt),qe.update(vn,bt,Vt)}}}(z,he,Ee,me),Kt=new function(De,Ze,qe,dt){var bt,fn,mn,cn=dt.isWebGL2;this.setMode=function(vn){bt=vn},this.setIndex=function(vn){fn=vn.type,mn=vn.bytesPerElement},this.render=function(vn,Vt){De.drawElements(bt,Vt,fn,vn*mn),qe.update(Vt,bt)},this.renderInstances=function(vn,Vt,tn,Fn){if(Fn!==0){var Un,hn;if(cn)Un=De,hn="drawElementsInstanced";else if(hn="drawElementsInstancedANGLE",(Un=Ze.get("ANGLE_instanced_arrays"))===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Un[hn](bt,tn,fn,Vt*mn,Fn),qe.update(tn,bt,Fn)}}}(z,he,Ee,me),Ee.programs=Je.programs,Mt.capabilities=me,Mt.extensions=he,Mt.properties=Re,Mt.renderLists=xt,Mt.state=ye,Mt.info=Ee}aa();var ei=new mc(Mt,z);this.xr=ei;var $i=new function(De,Ze){var qe,dt,bt,fn,mn,cn,vn,Vt=De.extensions,tn=De.properties,Fn=0;function Un(hn){return hn.isArrayCamera?hn.cameras:(mn[0]=hn,mn)}this.isAvailable=function(){if(vn===void 0){var hn=Vt.get("OVR_multiview2");if(vn=hn!==null&&Ze.getContextAttributes().antialias===!1){Fn=Ze.getParameter(hn.MAX_VIEWS_OVR),qe=new pc(0,0,2),cn=new zt,fn=[],bt=[],mn=[];for(var ln=0;ln<Fn;ln++)fn[ln]=new fr,bt[ln]=new Si}}return vn},this.attachCamera=function(hn){(function(ln){if(ln.isArrayCamera===void 0)return!0;var Kn=ln.cameras;if(Kn.length>Fn)return!1;for(var ar=1,mr=Kn.length;ar<mr;ar++)if(Kn[0].viewport.z!==Kn[ar].viewport.z||Kn[0].viewport.w!==Kn[ar].viewport.w)return!1;return!0})(hn)!==!1&&(dt=De.getRenderTarget(),function(ln){if(dt?cn.set(dt.width,dt.height):De.getDrawingBufferSize(cn),ln.isArrayCamera){var Kn=ln.cameras[0].viewport;qe.setSize(Kn.z,Kn.w),qe.setNumViews(ln.cameras.length)}else qe.setSize(cn.x,cn.y),qe.setNumViews(2)}(hn),De.setRenderTarget(qe))},this.detachCamera=function(hn){qe===De.getRenderTarget()&&(De.setRenderTarget(dt),function(ln){var Kn=qe,ar=Kn.numViews,mr=tn.get(Kn).__webglViewFramebuffers,ii=Kn.width,Br=Kn.height;if(ln.isArrayCamera)for(var La=0;La<ar;La++){var $o=ln.cameras[La].viewport,Qo=$o.x,Ml=$o.y,yo=Qo+$o.z,Ni=Ml+$o.w;Ze.bindFramebuffer(36008,mr[La]),Ze.blitFramebuffer(0,0,ii,Br,Qo,Ml,yo,Ni,16384,9728)}else Ze.bindFramebuffer(36008,mr[0]),Ze.blitFramebuffer(0,0,ii,Br,0,0,cn.x,cn.y,16384,9728)}(hn))},this.updateCameraProjectionMatricesUniform=function(hn,ln){for(var Kn=Un(hn),ar=0;ar<Kn.length;ar++)fn[ar].copy(Kn[ar].projectionMatrix);ln.setValue(Ze,"projectionMatrices",fn)},this.updateCameraViewMatricesUniform=function(hn,ln){for(var Kn=Un(hn),ar=0;ar<Kn.length;ar++)fn[ar].copy(Kn[ar].matrixWorldInverse);ln.setValue(Ze,"viewMatrices",fn)},this.updateObjectMatricesUniforms=function(hn,ln,Kn){for(var ar=Un(ln),mr=0;mr<ar.length;mr++)fn[mr].multiplyMatrices(ar[mr].matrixWorldInverse,hn.matrixWorld),bt[mr].getNormalMatrix(fn[mr]);Kn.setValue(Ze,"modelViewMatrices",fn),Kn.setValue(Ze,"normalMatrices",bt)}}(Mt,z),eo=new Ph(Mt,at,me.maxTextureSize);function go(De){De.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),dn=!0}function ps(){console.log("THREE.WebGLRenderer: Context Restored."),dn=!1,aa()}function Bs(De){var Ze,qe=De.target;qe.removeEventListener("dispose",Bs),nh(Ze=qe),Re.remove(Ze)}function nh(De){var Ze=Re.get(De).program;(De.program=void 0)!==Ze&&Je.releaseProgram(Ze)}this.shadowMap=eo,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){var De=he.get("WEBGL_lose_context");De&&De.loseContext()},this.forceContextRestore=function(){var De=he.get("WEBGL_lose_context");De&&De.restoreContext()},this.getPixelRatio=function(){return ur},this.setPixelRatio=function(De){De!==void 0&&(ur=De,this.setSize(Et,Pn,!1))},this.getSize=function(De){return De===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),De=new zt),De.set(Et,Pn)},this.setSize=function(De,Ze,qe){ei.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Et=De,Pn=Ze,t.width=Math.floor(De*ur),t.height=Math.floor(Ze*ur),qe!==!1&&(t.style.width=De+"px",t.style.height=Ze+"px"),this.setViewport(0,0,De,Ze))},this.getDrawingBufferSize=function(De){return De===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),De=new zt),De.set(Et*ur,Pn*ur).floor()},this.setDrawingBufferSize=function(De,Ze,qe){Et=De,Pn=Ze,ur=qe,t.width=Math.floor(De*qe),t.height=Math.floor(Ze*qe),this.setViewport(0,0,De,Ze)},this.getCurrentViewport=function(De){return De===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),De=new Jr),De.copy(Ht)},this.getViewport=function(De){return De.copy(Tn)},this.setViewport=function(De,Ze,qe,dt){De.isVector4?Tn.set(De.x,De.y,De.z,De.w):Tn.set(De,Ze,qe,dt),ye.viewport(Ht.copy(Tn).multiplyScalar(ur).floor())},this.getScissor=function(De){return De.copy(ir)},this.setScissor=function(De,Ze,qe,dt){De.isVector4?ir.set(De.x,De.y,De.z,De.w):ir.set(De,Ze,qe,dt),ye.scissor(rr.copy(ir).multiplyScalar(ur).floor())},this.getScissorTest=function(){return un},this.setScissorTest=function(De){ye.setScissorTest(un=De)},this.setOpaqueSort=function(De){ft=De},this.setTransparentSort=function(De){_n=De},this.getClearColor=function(){return Pt.getClearColor()},this.setClearColor=function(){Pt.setClearColor.apply(Pt,arguments)},this.getClearAlpha=function(){return Pt.getClearAlpha()},this.setClearAlpha=function(){Pt.setClearAlpha.apply(Pt,arguments)},this.clear=function(De,Ze,qe){var dt=0;De!==void 0&&!De||(dt|=16384),Ze!==void 0&&!Ze||(dt|=256),qe!==void 0&&!qe||(dt|=1024),z.clear(dt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",go,!1),t.removeEventListener("webglcontextrestored",ps,!1),xt.dispose(),_t.dispose(),Re.dispose(),at.dispose(),ei.dispose(),nu.stop()},this.renderBufferImmediate=function(De,Ze){ye.initAttributes();var qe=Re.get(De);De.hasPositions&&!qe.position&&(qe.position=z.createBuffer()),De.hasNormals&&!qe.normal&&(qe.normal=z.createBuffer()),De.hasUvs&&!qe.uv&&(qe.uv=z.createBuffer()),De.hasColors&&!qe.color&&(qe.color=z.createBuffer());var dt=Ze.getAttributes();De.hasPositions&&(z.bindBuffer(34962,qe.position),z.bufferData(34962,De.positionArray,35048),ye.enableAttribute(dt.position),z.vertexAttribPointer(dt.position,3,5126,!1,0,0)),De.hasNormals&&(z.bindBuffer(34962,qe.normal),z.bufferData(34962,De.normalArray,35048),ye.enableAttribute(dt.normal),z.vertexAttribPointer(dt.normal,3,5126,!1,0,0)),De.hasUvs&&(z.bindBuffer(34962,qe.uv),z.bufferData(34962,De.uvArray,35048),ye.enableAttribute(dt.uv),z.vertexAttribPointer(dt.uv,2,5126,!1,0,0)),De.hasColors&&(z.bindBuffer(34962,qe.color),z.bufferData(34962,De.colorArray,35048),ye.enableAttribute(dt.color),z.vertexAttribPointer(dt.color,3,5126,!1,0,0)),ye.disableUnusedAttributes(),z.drawArrays(4,0,De.count),De.count=0};var kp=new Hn;this.renderBufferDirect=function(De,Ze,qe,dt,bt,fn){Ze===null&&(Ze=kp);var mn=bt.isMesh&&bt.matrixWorld.determinant()<0,cn=Vh(De,Ze,dt,bt);ye.setMaterial(dt,mn);var vn=!1;ke.geometry===qe.id&&ke.program===cn.id&&ke.wireframe===(dt.wireframe===!0)||(ke.geometry=qe.id,ke.program=cn.id,ke.wireframe=dt.wireframe===!0,vn=!0),(dt.morphTargets||dt.morphNormals)&&(Ot.update(bt,qe,dt,cn),vn=!0);var Vt=qe.index,tn=qe.attributes.position;if(Vt===null){if(tn===void 0||tn.count===0)return}else if(Vt.count===0)return;var Fn,Un=1;dt.wireframe===!0&&(Vt=Fe.getWireframeAttribute(qe),Un=2);var hn=Gt;Vt!==null&&((Fn=et.get(Vt))?(hn=Kt).setIndex(Fn):(console.log("mx attribute == null"),Vt=null)),vn&&(function(Ml,yo,Ni,ti){if(me.isWebGL2!==!1||!Ml.isInstancedMesh&&!yo.isInstancedBufferGeometry||he.get("ANGLE_instanced_arrays")!==null){ye.initAttributes();var Ud=yo.attributes,ko=ti.getAttributes(),Hd=Ni.defaultAttributeValues;for(var To in ko){var Hi=ko[To];if(0<=Hi){var jo=Ud[To];if(jo!==void 0){var pn=jo.normalized,Jt=jo.itemSize;if((su=et.get(jo))===void 0)continue;var xa=su.buffer,ou=su.type,_f=su.bytesPerElement;if(jo.isInterleavedBufferAttribute){var ih=jo.data,Ff=ih.stride,Vf=jo.offset;ih&&ih.isInstancedInterleavedBuffer?(ye.enableAttributeAndDivisor(Hi,ih.meshPerAttribute),yo.maxInstancedCount===void 0&&(yo.maxInstancedCount=ih.meshPerAttribute*ih.count)):ye.enableAttribute(Hi),z.bindBuffer(34962,xa),z.vertexAttribPointer(Hi,Jt,ou,pn,Ff*_f,Vf*_f)}else jo.isInstancedBufferAttribute?(ye.enableAttributeAndDivisor(Hi,jo.meshPerAttribute),yo.maxInstancedCount===void 0&&(yo.maxInstancedCount=jo.meshPerAttribute*jo.count)):ye.enableAttribute(Hi),z.bindBuffer(34962,xa),z.vertexAttribPointer(Hi,Jt,ou,pn,0,0)}else if(To==="instanceMatrix"){var su;if((su=et.get(Ml.instanceMatrix))===void 0)continue;xa=su.buffer,ou=su.type,ye.enableAttributeAndDivisor(Hi+0,1),ye.enableAttributeAndDivisor(Hi+1,1),ye.enableAttributeAndDivisor(Hi+2,1),ye.enableAttributeAndDivisor(Hi+3,1),z.bindBuffer(34962,xa),z.vertexAttribPointer(Hi+0,4,ou,!1,64,0),z.vertexAttribPointer(Hi+1,4,ou,!1,64,16),z.vertexAttribPointer(Hi+2,4,ou,!1,64,32),z.vertexAttribPointer(Hi+3,4,ou,!1,64,48)}else if(Hd!==void 0){var ah=Hd[To];if(ah!==void 0)switch(ah.length){case 2:z.vertexAttrib2fv(Hi,ah);break;case 3:z.vertexAttrib3fv(Hi,ah);break;case 4:z.vertexAttrib4fv(Hi,ah);break;default:z.vertexAttrib1fv(Hi,ah)}}}}ye.disableUnusedAttributes()}}(bt,qe,dt,cn),Vt!==null&&z.bindBuffer(34963,Fn.buffer));var ln=Vt!==null?Vt.count:tn.count,Kn=qe.drawRange.start*Un,ar=qe.drawRange.count*Un,mr=fn!==null?fn.start*Un:0,ii=fn!==null?fn.count*Un:1/0,Br=Math.max(Kn,mr),La=Math.min(ln,Kn+ar,mr+ii)-1,$o=Math.max(0,La-Br+1);if($o!==0){if(bt.isMesh)dt.wireframe===!0?(ye.setLineWidth(dt.wireframeLinewidth*Ir()),hn.setMode(1)):hn.setMode(4);else if(bt.isLine){var Qo=dt.linewidth;Qo===void 0&&(Qo=1),ye.setLineWidth(Qo*Ir()),bt.isLineSegments?hn.setMode(1):bt.isLineLoop?hn.setMode(2):hn.setMode(3)}else bt.isPoints?hn.setMode(0):bt.isSprite&&hn.setMode(4);bt.isInstancedMesh?hn.renderInstances(qe,Br,$o,bt.count):qe.isInstancedBufferGeometry?hn.renderInstances(qe,Br,$o,qe.maxInstancedCount):hn.render(Br,$o)}},this.compile=function(De,Ze){(ie=_t.get(De,Ze)).init(),De.traverse(function(dt){dt.isLight&&(ie.pushLight(dt),dt.castShadow&&ie.pushShadow(dt))}),ie.setupLights(Ze);var qe={};De.traverse(function(dt){if(dt.material)if(Array.isArray(dt.material))for(var bt=0;bt<dt.material.length;bt++)dt.material[bt].uuid in qe==0&&(au(dt.material[bt],De,dt),qe[dt.material[bt].uuid]=!0);else dt.material.uuid in qe==0&&(au(dt.material,De,dt),qe[dt.material.uuid]=!0)})};var rh=null,nu=new ch;function ru(De,Ze,qe,dt){for(var bt=0,fn=De.length;bt<fn;bt++){var mn=De[bt],cn=mn.object,vn=mn.geometry,Vt=dt===void 0?mn.material:dt,tn=mn.group;if(qe.isArrayCamera)if(Yt=qe,ei.enabled&&$i.isAvailable())iu(cn,Ze,qe,vn,Vt,tn);else for(var Fn=qe.cameras,Un=0,hn=Fn.length;Un<hn;Un++){var ln=Fn[Un];cn.layers.test(ln.layers)&&(ye.viewport(Ht.copy(ln.viewport)),ie.setupLights(ln),iu(cn,Ze,ln,vn,Vt,tn))}else Yt=null,iu(cn,Ze,qe,vn,Vt,tn)}}function iu(De,Ze,qe,dt,bt,fn){if(De.onBeforeRender(Mt,Ze,qe,dt,bt,fn),ie=_t.get(Ze,Yt||qe),De.modelViewMatrix.multiplyMatrices(qe.matrixWorldInverse,De.matrixWorld),De.normalMatrix.getNormalMatrix(De.modelViewMatrix),De.isImmediateRenderObject){var mn=Vh(qe,Ze,bt,De);ye.setMaterial(bt),ke.geometry=null,ke.program=null,ke.wireframe=!1,cn=mn,De.render(function(vn){Mt.renderBufferImmediate(vn,cn)})}else Mt.renderBufferDirect(qe,Ze,dt,bt,De,fn);var cn;De.onAfterRender(Mt,Ze,qe,dt,bt,fn),ie=_t.get(Ze,Yt||qe)}function au(De,Ze,qe){var dt=Re.get(De),bt=ie.state.lights,fn=ie.state.shadowsArray,mn=bt.state.version,cn=Je.getParameters(De,bt.state,fn,Ze,Pr.numPlanes,Pr.numIntersection,qe),vn=Je.getProgramCacheKey(cn),Vt=dt.program,tn=!0;if(Vt===void 0)De.addEventListener("dispose",Bs);else if(Vt.cacheKey!==vn)nh(De);else if(dt.lightsStateVersion!==mn)dt.lightsStateVersion=mn,tn=!1;else{if(cn.shaderID!==void 0)return;tn=!1}tn&&(Vt=Je.acquireProgram(cn,vn),dt.program=Vt,dt.uniforms=cn.uniforms,dt.environment=De.isMeshStandardMaterial?Ze.environment:null,dt.outputEncoding=Mt.outputEncoding,De.program=Vt);var Fn=Vt.getAttributes();if(De.morphTargets)for(var Un=De.numSupportedMorphTargets=0;Un<Mt.maxMorphTargets;Un++)0<=Fn["morphTarget"+Un]&&De.numSupportedMorphTargets++;if(De.morphNormals)for(Un=De.numSupportedMorphNormals=0;Un<Mt.maxMorphNormals;Un++)0<=Fn["morphNormal"+Un]&&De.numSupportedMorphNormals++;var hn,ln=dt.uniforms;(De.isShaderMaterial||De.isRawShaderMaterial)&&De.clipping!==!0||(dt.numClippingPlanes=Pr.numPlanes,dt.numIntersection=Pr.numIntersection,ln.clippingPlanes=Pr.uniform),dt.fog=Ze.fog,dt.needsLights=(hn=De).isMeshLambertMaterial||hn.isMeshToonMaterial||hn.isMeshPhongMaterial||hn.isMeshStandardMaterial||hn.isShadowMaterial||hn.isShaderMaterial&&hn.lights===!0,dt.lightsStateVersion=mn,dt.needsLights&&(ln.ambientLightColor.value=bt.state.ambient,ln.lightProbe.value=bt.state.probe,ln.directionalLights.value=bt.state.directional,ln.spotLights.value=bt.state.spot,ln.rectAreaLights.value=bt.state.rectArea,ln.pointLights.value=bt.state.point,ln.hemisphereLights.value=bt.state.hemi,ln.directionalShadowMap.value=bt.state.directionalShadowMap,ln.directionalShadowMatrix.value=bt.state.directionalShadowMatrix,ln.spotShadowMap.value=bt.state.spotShadowMap,ln.spotShadowMatrix.value=bt.state.spotShadowMatrix,ln.pointShadowMap.value=bt.state.pointShadowMap,ln.pointShadowMatrix.value=bt.state.pointShadowMatrix);var Kn=dt.program.getUniforms(),ar=cs.seqWithValue(Kn.seq,ln);dt.uniformsList=ar}function Vh(De,Ze,qe,dt){Ve.resetTextureUnits();var bt=Ze.fog,fn=qe.isMeshStandardMaterial?Ze.environment:null,mn=Re.get(qe),cn=ie.state.lights;if(vi&&(mo||De!==tt)){var vn=De===tt&&qe.id===Dn;Pr.setState(qe.clippingPlanes,qe.clipIntersection,qe.clipShadows,De,mn,vn)}qe.version===mn.__version?(mn.program===void 0||qe.fog&&mn.fog!==bt||mn.environment!==fn||mn.needsLights&&mn.lightsStateVersion!==cn.state.version||mn.numClippingPlanes!==void 0&&(mn.numClippingPlanes!==Pr.numPlanes||mn.numIntersection!==Pr.numIntersection)||mn.outputEncoding!==Mt.outputEncoding)&&au(qe,Ze,dt):(Re.update(qe,"uniforms",qe.uniforms),au(qe,Ze,dt),mn.__version=qe.version);var Vt,tn,Fn,Un,hn,ln,Kn,ar,mr,ii,Br,La,$o=!1,Qo=!1,Ml=!1,yo=mn.program,Ni=yo.getUniforms(),ti=mn.uniforms;if(ye.useProgram(yo.program)&&(Ml=Qo=$o=!0),qe.id!==Dn&&(Dn=qe.id,Qo=!0),$o||tt!==De){if(0<yo.numMultiviewViews?$i.updateCameraProjectionMatricesUniform(De,Ni):Ni.setValue(z,"projectionMatrix",De.projectionMatrix),me.logarithmicDepthBuffer&&Ni.setValue(z,"logDepthBufFC",2/(Math.log(De.far+1)/Math.LN2)),tt!==De&&(tt=De,Ml=Qo=!0),qe.isShaderMaterial||qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshStandardMaterial||qe.envMap){var Ud=Ni.map.cameraPosition;Ud!==void 0&&Ud.setValue(z,Ei.setFromMatrixPosition(De.matrixWorld))}(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial)&&Ni.setValue(z,"isOrthographic",De.isOrthographicCamera===!0),(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial||qe.skinning)&&(0<yo.numMultiviewViews?$i.updateCameraViewMatricesUniform(De,Ni):Ni.setValue(z,"viewMatrix",De.matrixWorldInverse))}if(qe.skinning){Ni.setOptional(z,dt,"bindMatrix"),Ni.setOptional(z,dt,"bindMatrixInverse");var ko=dt.skeleton;if(ko){var Hd=ko.bones;if(me.floatVertexTextures){if(ko.boneTexture===void 0){var To=Math.sqrt(4*Hd.length);To=vr.ceilPowerOfTwo(To),To=Math.max(To,4);var Hi=new Float32Array(To*To*4);Hi.set(ko.boneMatrices);var jo=new Al(Hi,To,To,Or,Rt);ko.boneMatrices=Hi,ko.boneTexture=jo,ko.boneTextureSize=To}Ni.setValue(z,"boneTexture",ko.boneTexture,Ve),Ni.setValue(z,"boneTextureSize",ko.boneTextureSize)}else Ni.setOptional(z,ko,"boneMatrices")}}return!Qo&&mn.receiveShadow===dt.receiveShadow||(mn.receiveShadow=dt.receiveShadow,Ni.setValue(z,"receiveShadow",dt.receiveShadow)),Qo&&(Ni.setValue(z,"toneMappingExposure",Mt.toneMappingExposure),Ni.setValue(z,"toneMappingWhitePoint",Mt.toneMappingWhitePoint),mn.needsLights&&(La=Ml,(Br=ti).ambientLightColor.needsUpdate=La,Br.lightProbe.needsUpdate=La,Br.directionalLights.needsUpdate=La,Br.pointLights.needsUpdate=La,Br.spotLights.needsUpdate=La,Br.rectAreaLights.needsUpdate=La,Br.hemisphereLights.needsUpdate=La),bt&&qe.fog&&(ii=bt,(mr=ti).fogColor.value.copy(ii.color),ii.isFog?(mr.fogNear.value=ii.near,mr.fogFar.value=ii.far):ii.isFogExp2&&(mr.fogDensity.value=ii.density)),qe.isMeshBasicMaterial?_o(ti,qe):qe.isMeshLambertMaterial?(_o(ti,qe),Kn=ti,(ar=qe).emissiveMap&&(Kn.emissiveMap.value=ar.emissiveMap)):qe.isMeshToonMaterial?(_o(ti,qe),function(pn,Jt){pn.specular.value.copy(Jt.specular),pn.shininess.value=Math.max(Jt.shininess,1e-4),Jt.gradientMap&&(pn.gradientMap.value=Jt.gradientMap),Jt.emissiveMap&&(pn.emissiveMap.value=Jt.emissiveMap),Jt.bumpMap&&(pn.bumpMap.value=Jt.bumpMap,pn.bumpScale.value=Jt.bumpScale,Jt.side===C&&(pn.bumpScale.value*=-1)),Jt.normalMap&&(pn.normalMap.value=Jt.normalMap,pn.normalScale.value.copy(Jt.normalScale),Jt.side===C&&pn.normalScale.value.negate()),Jt.displacementMap&&(pn.displacementMap.value=Jt.displacementMap,pn.displacementScale.value=Jt.displacementScale,pn.displacementBias.value=Jt.displacementBias)}(ti,qe)):qe.isMeshPhongMaterial?(_o(ti,qe),function(pn,Jt){pn.specular.value.copy(Jt.specular),pn.shininess.value=Math.max(Jt.shininess,1e-4),Jt.emissiveMap&&(pn.emissiveMap.value=Jt.emissiveMap),Jt.bumpMap&&(pn.bumpMap.value=Jt.bumpMap,pn.bumpScale.value=Jt.bumpScale,Jt.side===C&&(pn.bumpScale.value*=-1)),Jt.normalMap&&(pn.normalMap.value=Jt.normalMap,pn.normalScale.value.copy(Jt.normalScale),Jt.side===C&&pn.normalScale.value.negate()),Jt.displacementMap&&(pn.displacementMap.value=Jt.displacementMap,pn.displacementScale.value=Jt.displacementScale,pn.displacementBias.value=Jt.displacementBias)}(ti,qe)):qe.isMeshStandardMaterial?(_o(ti,qe,fn),(qe.isMeshPhysicalMaterial?function(pn,Jt,xa){Mf(pn,Jt,xa),pn.reflectivity.value=Jt.reflectivity,pn.clearcoat.value=Jt.clearcoat,pn.clearcoatRoughness.value=Jt.clearcoatRoughness,Jt.sheen&&pn.sheen.value.copy(Jt.sheen),Jt.clearcoatNormalMap&&(pn.clearcoatNormalScale.value.copy(Jt.clearcoatNormalScale),pn.clearcoatNormalMap.value=Jt.clearcoatNormalMap,Jt.side===C&&pn.clearcoatNormalScale.value.negate()),pn.transparency.value=Jt.transparency}:Mf)(ti,qe,fn)):qe.isMeshMatcapMaterial?(_o(ti,qe),function(pn,Jt){Jt.matcap&&(pn.matcap.value=Jt.matcap),Jt.bumpMap&&(pn.bumpMap.value=Jt.bumpMap,pn.bumpScale.value=Jt.bumpScale,Jt.side===C&&(pn.bumpScale.value*=-1)),Jt.normalMap&&(pn.normalMap.value=Jt.normalMap,pn.normalScale.value.copy(Jt.normalScale),Jt.side===C&&pn.normalScale.value.negate()),Jt.displacementMap&&(pn.displacementMap.value=Jt.displacementMap,pn.displacementScale.value=Jt.displacementScale,pn.displacementBias.value=Jt.displacementBias)}(ti,qe)):qe.isMeshDepthMaterial?(_o(ti,qe),hn=ti,(ln=qe).displacementMap&&(hn.displacementMap.value=ln.displacementMap,hn.displacementScale.value=ln.displacementScale,hn.displacementBias.value=ln.displacementBias)):qe.isMeshDistanceMaterial?(_o(ti,qe),function(pn,Jt){Jt.displacementMap&&(pn.displacementMap.value=Jt.displacementMap,pn.displacementScale.value=Jt.displacementScale,pn.displacementBias.value=Jt.displacementBias),pn.referencePosition.value.copy(Jt.referencePosition),pn.nearDistance.value=Jt.nearDistance,pn.farDistance.value=Jt.farDistance}(ti,qe)):qe.isMeshNormalMaterial?(_o(ti,qe),function(pn,Jt){Jt.bumpMap&&(pn.bumpMap.value=Jt.bumpMap,pn.bumpScale.value=Jt.bumpScale,Jt.side===C&&(pn.bumpScale.value*=-1)),Jt.normalMap&&(pn.normalMap.value=Jt.normalMap,pn.normalScale.value.copy(Jt.normalScale),Jt.side===C&&pn.normalScale.value.negate()),Jt.displacementMap&&(pn.displacementMap.value=Jt.displacementMap,pn.displacementScale.value=Jt.displacementScale,pn.displacementBias.value=Jt.displacementBias)}(ti,qe)):qe.isLineBasicMaterial?(Un=qe,(Fn=ti).diffuse.value.copy(Un.color),Fn.opacity.value=Un.opacity,qe.isLineDashedMaterial&&(tn=qe,(Vt=ti).dashSize.value=tn.dashSize,Vt.totalSize.value=tn.dashSize+tn.gapSize,Vt.scale.value=tn.scale)):qe.isPointsMaterial?function(pn,Jt){var xa;pn.diffuse.value.copy(Jt.color),pn.opacity.value=Jt.opacity,pn.size.value=Jt.size*ur,pn.scale.value=.5*Pn,Jt.map&&(pn.map.value=Jt.map),Jt.alphaMap&&(pn.alphaMap.value=Jt.alphaMap),Jt.map?xa=Jt.map:Jt.alphaMap&&(xa=Jt.alphaMap),xa!==void 0&&(xa.matrixAutoUpdate===!0&&xa.updateMatrix(),pn.uvTransform.value.copy(xa.matrix))}(ti,qe):qe.isSpriteMaterial?function(pn,Jt){var xa;pn.diffuse.value.copy(Jt.color),pn.opacity.value=Jt.opacity,pn.rotation.value=Jt.rotation,Jt.map&&(pn.map.value=Jt.map),Jt.alphaMap&&(pn.alphaMap.value=Jt.alphaMap),Jt.map?xa=Jt.map:Jt.alphaMap&&(xa=Jt.alphaMap),xa!==void 0&&(xa.matrixAutoUpdate===!0&&xa.updateMatrix(),pn.uvTransform.value.copy(xa.matrix))}(ti,qe):qe.isShadowMaterial&&(ti.color.value.copy(qe.color),ti.opacity.value=qe.opacity),ti.ltc_1!==void 0&&(ti.ltc_1.value=bn.LTC_1),ti.ltc_2!==void 0&&(ti.ltc_2.value=bn.LTC_2),cs.upload(z,mn.uniformsList,ti,Ve),qe.isShaderMaterial&&(qe.uniformsNeedUpdate=!1)),qe.isShaderMaterial&&qe.uniformsNeedUpdate===!0&&(cs.upload(z,mn.uniformsList,ti,Ve),qe.uniformsNeedUpdate=!1),qe.isSpriteMaterial&&Ni.setValue(z,"center",dt.center),0<yo.numMultiviewViews?$i.updateObjectMatricesUniforms(dt,De,Ni):(Ni.setValue(z,"modelViewMatrix",dt.modelViewMatrix),Ni.setValue(z,"normalMatrix",dt.normalMatrix)),Ni.setValue(z,"modelMatrix",dt.matrixWorld),yo}function _o(De,Ze,qe){De.opacity.value=Ze.opacity,Ze.color&&De.diffuse.value.copy(Ze.color),Ze.emissive&&De.emissive.value.copy(Ze.emissive).multiplyScalar(Ze.emissiveIntensity),Ze.map&&(De.map.value=Ze.map),Ze.alphaMap&&(De.alphaMap.value=Ze.alphaMap),Ze.specularMap&&(De.specularMap.value=Ze.specularMap);var dt,bt,fn=Ze.envMap||qe;fn&&(De.envMap.value=fn,De.flipEnvMap.value=fn.isCubeTexture?-1:1,De.reflectivity.value=Ze.reflectivity,De.refractionRatio.value=Ze.refractionRatio,De.maxMipLevel.value=Re.get(fn).__maxMipLevel),Ze.lightMap&&(De.lightMap.value=Ze.lightMap,De.lightMapIntensity.value=Ze.lightMapIntensity),Ze.aoMap&&(De.aoMap.value=Ze.aoMap,De.aoMapIntensity.value=Ze.aoMapIntensity),Ze.map?dt=Ze.map:Ze.specularMap?dt=Ze.specularMap:Ze.displacementMap?dt=Ze.displacementMap:Ze.normalMap?dt=Ze.normalMap:Ze.bumpMap?dt=Ze.bumpMap:Ze.roughnessMap?dt=Ze.roughnessMap:Ze.metalnessMap?dt=Ze.metalnessMap:Ze.alphaMap?dt=Ze.alphaMap:Ze.emissiveMap&&(dt=Ze.emissiveMap),dt!==void 0&&(dt.isWebGLRenderTarget&&(dt=dt.texture),dt.matrixAutoUpdate===!0&&dt.updateMatrix(),De.uvTransform.value.copy(dt.matrix)),Ze.aoMap?bt=Ze.aoMap:Ze.lightMap&&(bt=Ze.lightMap),bt!==void 0&&(bt.isWebGLRenderTarget&&(bt=bt.texture),bt.matrixAutoUpdate===!0&&bt.updateMatrix(),De.uv2Transform.value.copy(bt.matrix))}function Mf(De,Ze,qe){De.roughness.value=Ze.roughness,De.metalness.value=Ze.metalness,Ze.roughnessMap&&(De.roughnessMap.value=Ze.roughnessMap),Ze.metalnessMap&&(De.metalnessMap.value=Ze.metalnessMap),Ze.emissiveMap&&(De.emissiveMap.value=Ze.emissiveMap),Ze.bumpMap&&(De.bumpMap.value=Ze.bumpMap,De.bumpScale.value=Ze.bumpScale,Ze.side===C&&(De.bumpScale.value*=-1)),Ze.normalMap&&(De.normalMap.value=Ze.normalMap,De.normalScale.value.copy(Ze.normalScale),Ze.side===C&&De.normalScale.value.negate()),Ze.displacementMap&&(De.displacementMap.value=Ze.displacementMap,De.displacementScale.value=Ze.displacementScale,De.displacementBias.value=Ze.displacementBias),(Ze.envMap||qe)&&(De.envMapIntensity.value=Ze.envMapIntensity)}nu.setAnimationLoop(function(De){ei.isPresenting||rh&&rh(De)}),typeof window<"u"&&nu.setContext(window),this.setAnimationLoop=function(De){rh=De,ei.setAnimationLoop(De),nu.start()},this.render=function(De,Ze){var qe,dt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),qe=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),dt=arguments[3]),Ze&&Ze.isCamera){if(!dn){ke.geometry=null,ke.program=null,ke.wireframe=!1,Dn=-1,!(tt=null)===De.autoUpdate&&De.updateMatrixWorld(),Ze.parent===null&&Ze.updateMatrixWorld(),ei.enabled&&ei.isPresenting&&(Ze=ei.getCamera(Ze)),(ie=_t.get(De,Ze)).init(),De.onBeforeRender(Mt,De,Ze,qe||Vn),Nr.multiplyMatrices(Ze.projectionMatrix,Ze.matrixWorldInverse),br.setFromProjectionMatrix(Nr),mo=this.localClippingEnabled,vi=Pr.init(this.clippingPlanes,mo,Ze),(Q=xt.get(De,Ze)).init(),function vn(Vt,tn,Fn,Un){if(Vt.visible!==!1){if(Vt.layers.test(tn.layers)){if(Vt.isGroup)Fn=Vt.renderOrder;else if(Vt.isLOD)Vt.autoUpdate===!0&&Vt.update(tn);else if(Vt.isLight)ie.pushLight(Vt),Vt.castShadow&&ie.pushShadow(Vt);else if(Vt.isSprite){if(!Vt.frustumCulled||br.intersectsSprite(Vt)){Un&&Ei.setFromMatrixPosition(Vt.matrixWorld).applyMatrix4(Nr);var hn=at.update(Vt);(ln=Vt.material).visible&&Q.push(Vt,hn,ln,Fn,Ei.z,null)}}else if(Vt.isImmediateRenderObject)Un&&Ei.setFromMatrixPosition(Vt.matrixWorld).applyMatrix4(Nr),Q.push(Vt,null,Vt.material,Fn,Ei.z,null);else if((Vt.isMesh||Vt.isLine||Vt.isPoints)&&(Vt.isSkinnedMesh&&Vt.skeleton.frame!==Ee.render.frame&&(Vt.skeleton.update(),Vt.skeleton.frame=Ee.render.frame),!Vt.frustumCulled||br.intersectsObject(Vt))){Un&&Ei.setFromMatrixPosition(Vt.matrixWorld).applyMatrix4(Nr),hn=at.update(Vt);var ln=Vt.material;if(Array.isArray(ln))for(var Kn=hn.groups,ar=0,mr=Kn.length;ar<mr;ar++){var ii=Kn[ar],Br=ln[ii.materialIndex];Br&&Br.visible&&Q.push(Vt,hn,Br,Fn,Ei.z,ii)}else ln.visible&&Q.push(Vt,hn,ln,Fn,Ei.z,null)}}var La=Vt.children;for(ar=0,mr=La.length;ar<mr;ar++)vn(La[ar],tn,Fn,Un)}}(De,Ze,0,Mt.sortObjects),Mt.sortObjects===!0&&Q.sort(ft,_n),vi&&Pr.beginShadows();var bt=ie.state.shadowsArray;eo.render(bt,De,Ze),ie.setupLights(Ze),vi&&Pr.endShadows(),this.info.autoReset&&this.info.reset(),qe!==void 0&&this.setRenderTarget(qe),ei.enabled&&$i.isAvailable()&&$i.attachCamera(Ze),Pt.render(Q,De,Ze,dt);var fn=Q.opaque,mn=Q.transparent;if(De.overrideMaterial){var cn=De.overrideMaterial;fn.length&&ru(fn,De,Ze,cn),mn.length&&ru(mn,De,Ze,cn)}else fn.length&&ru(fn,De,Ze),mn.length&&ru(mn,De,Ze);De.onAfterRender(Mt,De,Ze),Vn!==null&&(Ve.updateRenderTargetMipmap(Vn),Ve.updateMultisampleRenderTarget(Vn)),ye.buffers.depth.setTest(!0),ye.buffers.depth.setMask(!0),ye.buffers.color.setMask(!0),ye.setPolygonOffset(!1),ei.enabled&&$i.isAvailable()&&$i.detachCamera(Ze),ie=Q=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.mxRenderObject=function(De,Ze,qe,dt,bt){iu(De,Ze,qe,at.update(De),dt,bt)},this.setFramebuffer=function(De){Mn!==De&&Vn===null&&z.bindFramebuffer(36160,De),Mn=De},this.getActiveCubeFace=function(){return Zn},this.getActiveMipmapLevel=function(){return qn},this.getRenderTarget=function(){return Vn},this.setRenderTarget=function(De,Ze,qe){Zn=Ze,qn=qe,(Vn=De)&&Re.get(De).__webglFramebuffer===void 0&&Ve.setupRenderTarget(De);var dt=Mn,bt=!1;if(De){var fn=Re.get(De).__webglFramebuffer;De.isWebGLCubeRenderTarget?(dt=fn[Ze||0],bt=!0):dt=De.isWebGLMultisampleRenderTarget?Re.get(De).__webglMultisampledFramebuffer:fn,Ht.copy(De.viewport),rr.copy(De.scissor),En=De.scissorTest}else Ht.copy(Tn).multiplyScalar(ur).floor(),rr.copy(ir).multiplyScalar(ur).floor(),En=un;if(cr!==dt&&(z.bindFramebuffer(36160,dt),cr=dt),ye.viewport(Ht),ye.scissor(rr),ye.setScissorTest(En),bt){var mn=Re.get(De.texture);z.framebufferTexture2D(36160,36064,34069+(Ze||0),mn.__webglTexture,qe||0)}},this.readRenderTargetPixels=function(De,Ze,qe,dt,bt,fn,mn){if(De&&De.isWebGLRenderTarget){var cn=Re.get(De).__webglFramebuffer;if(De.isWebGLCubeRenderTarget&&mn!==void 0&&(cn=cn[mn]),cn){var vn=!1;cn!==cr&&(z.bindFramebuffer(36160,cn),vn=!0);try{var Vt=De.texture,tn=Vt.format,Fn=Vt.type;if(tn!==Or&&Dt.convert(tn)!==z.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(Fn===kr||Dt.convert(Fn)===z.getParameter(35738)||Fn===Rt&&(me.isWebGL2||he.get("OES_texture_float")||he.get("WEBGL_color_buffer_float"))||Fn===$t&&(me.isWebGL2?he.get("EXT_color_buffer_float"):he.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");z.checkFramebufferStatus(36160)===36053?0<=Ze&&Ze<=De.width-dt&&0<=qe&&qe<=De.height-bt&&z.readPixels(Ze,qe,dt,bt,Dt.convert(tn),Dt.convert(Fn),fn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{vn&&z.bindFramebuffer(36160,cr)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(De,Ze,qe){qe===void 0&&(qe=0);var dt=Math.pow(2,-qe),bt=Math.floor(Ze.image.width*dt),fn=Math.floor(Ze.image.height*dt),mn=Dt.convert(Ze.format);Ve.setTexture2D(Ze,0),z.copyTexImage2D(3553,qe,mn,De.x,De.y,bt,fn,0),ye.unbindTexture()},this.copyTextureToTexture=function(De,Ze,qe,dt){var bt=Ze.image.width,fn=Ze.image.height,mn=Dt.convert(qe.format),cn=Dt.convert(qe.type);Ve.setTexture2D(qe,0),Ze.isDataTexture?z.texSubImage2D(3553,dt||0,De.x,De.y,bt,fn,mn,cn,Ze.image.data):z.texSubImage2D(3553,dt||0,De.x,De.y,mn,cn,Ze.image),ye.unbindTexture()},this.initTexture=function(De){Ve.setTexture2D(De,0),ye.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ho(e,t){this.name="",this.color=new Qe(e),this.density=t!==void 0?t:25e-5}function Xo(e,t,n){this.name="",this.color=new Qe(e),this.near=t!==void 0?t:1,this.far=n!==void 0?n:1e3}function Yo(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Wr,this.updateRange={offset:0,count:-1},this.version=0}pc.prototype=Object.assign(Object.create(qi.prototype),{constructor:pc,isWebGLMultiviewRenderTarget:!0,copy:function(e){return qi.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}}),fc.prototype=Object.assign(Object.create(Ii.prototype),{constructor:fc,isArrayCamera:!0}),rl.prototype=Object.assign(Object.create(At.prototype),{constructor:rl,isGroup:!0}),Object.assign(mc.prototype,Ia.prototype),Object.assign(ho.prototype,{isFogExp2:!0,clone:function(){return new ho(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Xo.prototype,{isFog:!0,clone:function(){return new Xo(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Yo.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Yo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,l=this.stride;i<l;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var Nl,il=new Oe;function gc(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}function al(e){kt.call(this),this.type="SpriteMaterial",this.color=new Qe(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(gc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(gc.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)il.x=this.getX(t),il.y=this.getY(t),il.z=this.getZ(t),il.applyMatrix4(e),this.setXYZ(t,il.x,il.y,il.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=l,this}}),((al.prototype=Object.create(kt.prototype)).constructor=al).prototype.isSpriteMaterial=!0,al.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Bl=new Oe,ol=new Oe,sl=new Oe,Fl=new zt,yc=new zt,sd=new fr,Fa=new Oe,vc=new Oe,xc=new Oe,ld=new zt,wc=new zt,cd=new zt;function bc(e){if(At.call(this),this.type="Sprite",Nl===void 0){Nl=new Sn;var t=new Yo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Nl.setIndex([0,1,2,0,2,3]),Nl.setAttribute("position",new gc(t,3,0,!1)),Nl.setAttribute("uv",new gc(t,2,3,!1))}this.geometry=Nl,this.material=e!==void 0?e:new al,this.center=new zt(.5,.5)}function Du(e,t,n,i,l,d){Fl.subVectors(e,n).addScalar(.5).multiply(i),l!==void 0?(yc.x=d*Fl.x-l*Fl.y,yc.y=l*Fl.x+d*Fl.y):yc.copy(Fl),e.copy(t),e.x+=yc.x,e.y+=yc.y,e.applyMatrix4(sd)}bc.prototype=Object.assign(Object.create(At.prototype),{constructor:bc,isSprite:!0,raycast:function(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ol.setFromMatrixScale(this.matrixWorld),sd.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),sl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ol.multiplyScalar(-sl.z);var n,i,l=this.material.rotation;l!==0&&(i=Math.cos(l),n=Math.sin(l));var d=this.center;Du(Fa.set(-.5,-.5,0),sl,d,ol,n,i),Du(vc.set(.5,-.5,0),sl,d,ol,n,i),Du(xc.set(.5,.5,0),sl,d,ol,n,i),ld.set(0,0),wc.set(1,0),cd.set(1,1);var g=e.ray.intersectTriangle(Fa,vc,xc,!1,Bl);if(g!==null||(Du(vc.set(-.5,.5,0),sl,d,ol,n,i),wc.set(0,1),(g=e.ray.intersectTriangle(Fa,xc,vc,!1,Bl))!==null)){var x=e.ray.origin.distanceTo(Bl);x<e.near||x>e.far||t.push({distance:x,point:Bl.clone(),uv:Ri.getUV(Bl,Fa,vc,xc,ld,wc,cd,new zt),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return At.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});var Vl=new Oe,Ah=new Oe;function Mc(){At.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function _c(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),_i.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new fr,this.bindMatrixInverse=new fr}Mc.prototype=Object.assign(Object.create(At.prototype),{constructor:Mc,isLOD:!0,copy:function(e){At.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var l=t[n];this.addLevel(l.object.clone(),l.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){t===void 0&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){var t=this.levels;if(0<t.length){for(var n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(0<this.levels.length){Vl.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Vl);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){var t=this.levels;if(1<t.length){Vl.setFromMatrixPosition(e.matrixWorld),Ah.setFromMatrixPosition(this.matrixWorld);var n=Vl.distanceTo(Ah);t[0].object.visible=!0;for(var i=1,l=t.length;i<l&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(;i<l;i++)t[i].object.visible=!1}},toJSON:function(e){var t=At.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,i=0,l=n.length;i<l;i++){var d=n[i];t.object.levels.push({object:d.object.uuid,distance:d.distance})}return t}}),_c.prototype=Object.assign(Object.create(_i.prototype),{constructor:_c,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Jr,t=this.geometry.attributes.skinWeight,n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var l=1/e.manhattanLength();l!=1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){_i.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ud=new fr,Xd=new fr;function Eu(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,t===void 0)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new fr)}}function Rh(){At.call(this),this.type="Bone"}Object.assign(Eu.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new fr;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,l=0,d=e.length;l<d;l++){var g=e[l]?e[l].matrixWorld:Xd;ud.multiplyMatrices(g,t[l]),ud.toArray(n,16*l)}i!==void 0&&(i.needsUpdate=!0)},clone:function(){return new Eu(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),Rh.prototype=Object.assign(Object.create(At.prototype),{constructor:Rh,isBone:!0});var Lh=new fr,Tc=new fr,Gl=[],Cc=new _i;function Pu(e,t,n){_i.call(this,e,t),this.instanceMatrix=new en(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function ki(e){kt.call(this),this.type="LineBasicMaterial",this.color=new Qe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}Pu.prototype=Object.assign(Object.create(_i.prototype),{constructor:Pu,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,i=this.count;if(Cc.geometry=this.geometry,Cc.material=this.material,Cc.material!==void 0)for(var l=0;l<i;l++)this.getMatrixAt(l,Lh),Tc.multiplyMatrices(n,Lh),Cc.matrixWorld=Tc,Cc.raycast(e,Gl),0<Gl.length&&(Gl[0].instanceId=l,Gl[0].object=this,t.push(Gl[0]),Gl.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),((ki.prototype=Object.create(kt.prototype)).constructor=ki).prototype.isLineBasicMaterial=!0,ki.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var Ih=new Oe,kh=new Oe,hd=new fr,Ou=new Ar,Au=new Kr;function Ra(e,t,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),At.call(this),this.type="Line",this.geometry=e!==void 0?e:new Sn,this.material=t!==void 0?t:new ki}Ra.prototype=Object.assign(Object.create(At.prototype),{constructor:Ra,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[0],i=1,l=t.count;i<l;i++)Ih.fromBufferAttribute(t,i-1),kh.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Ih.distanceTo(kh);e.setAttribute("lineDistance",new on(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var d=e.vertices;for((n=e.lineDistances)[0]=0,i=1,l=d.length;i<l;i++)n[i]=n[i-1],n[i]+=d[i-1].distanceTo(d[i])}return this},raycast:function(e,t){var n=e.linePrecision,i=this.geometry,l=this.matrixWorld;if(i.boundingSphere===null&&i.computeBoundingSphere(),Au.copy(i.boundingSphere),Au.applyMatrix4(l),Au.radius+=n,e.ray.intersectsSphere(Au)!==!1){hd.getInverse(l),Ou.copy(e.ray).applyMatrix4(hd);var d=n/((this.scale.x+this.scale.y+this.scale.z)/3),g=d*d,x=new Oe,A=new Oe,I=new Oe,Y=new Oe,Q=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var ie=i.index,z=i.attributes.position.array;if(ie!==null)for(var he=ie.array,me=0,ye=he.length-1;me<ye;me+=Q){var Ee=he[me],Re=he[me+1];x.fromArray(z,3*Ee),A.fromArray(z,3*Re),g<Ou.distanceSqToSegment(x,A,Y,I)||(Y.applyMatrix4(this.matrixWorld),(Fe=e.ray.origin.distanceTo(Y))<e.near||Fe>e.far||t.push({distance:Fe,point:I.clone().applyMatrix4(this.matrixWorld),index:me,face:null,faceIndex:null,object:this}))}else for(me=0,ye=z.length/3-1;me<ye;me+=Q)x.fromArray(z,3*me),A.fromArray(z,3*me+3),g<Ou.distanceSqToSegment(x,A,Y,I)||(Y.applyMatrix4(this.matrixWorld),(Fe=e.ray.origin.distanceTo(Y))<e.near||Fe>e.far||t.push({distance:Fe,point:I.clone().applyMatrix4(this.matrixWorld),index:me,face:null,faceIndex:null,object:this}))}else if(i.isGeometry){var Ve=i.vertices,et=Ve.length;for(me=0;me<et-1;me+=Q){var Fe;g<Ou.distanceSqToSegment(Ve[me],Ve[me+1],Y,I)||(Y.applyMatrix4(this.matrixWorld),(Fe=e.ray.origin.distanceTo(Y))<e.near||Fe>e.far||t.push({distance:Fe,point:I.clone().applyMatrix4(this.matrixWorld),index:me,face:null,faceIndex:null,object:this}))}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ru=new Oe,Lu=new Oe;function fi(e,t){Ra.call(this,e,t),this.type="LineSegments"}function Sc(e,t){Ra.call(this,e,t),this.type="LineLoop"}function Zo(e){kt.call(this),this.type="PointsMaterial",this.color=new Qe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}fi.prototype=Object.assign(Object.create(Ra.prototype),{constructor:fi,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[],i=0,l=t.count;i<l;i+=2)Ru.fromBufferAttribute(t,i),Lu.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Ru.distanceTo(Lu);e.setAttribute("lineDistance",new on(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var d=e.vertices;for(n=e.lineDistances,i=0,l=d.length;i<l;i+=2)Ru.copy(d[i]),Lu.copy(d[i+1]),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Ru.distanceTo(Lu)}return this}}),Sc.prototype=Object.assign(Object.create(Ra.prototype),{constructor:Sc,isLineLoop:!0}),((Zo.prototype=Object.create(kt.prototype)).constructor=Zo).prototype.isPointsMaterial=!0,Zo.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Iu=new fr,ku=new Ar,Dc=new Kr,ju=new Oe;function zl(e,t){At.call(this),this.type="Points",this.geometry=e!==void 0?e:new Sn,this.material=t!==void 0?t:new Zo,this.updateMorphTargets()}function Ul(e,t,n,i,l,d,g){var x=ku.distanceSqToPoint(e);if(x<n){var A=new Oe;ku.closestPointToPoint(e,A),A.applyMatrix4(i);var I=l.ray.origin.distanceTo(A);if(I<l.near||I>l.far)return;d.push({distance:I,distanceToRay:Math.sqrt(x),point:A,index:t,face:null,object:g})}}function Hl(e,t,n,i,l,d,g,x,A){Yr.call(this,e,t,n,i,l,d,g,x,A),this.format=g!==void 0?g:Gr,this.minFilter=d!==void 0?d:xn,this.magFilter=l!==void 0?l:xn,this.generateMipmaps=!1}function Nu(e,t,n,i,l,d,g,x,A,I,Y,Q){Yr.call(this,null,d,g,x,A,I,i,l,Y,Q),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Ec(e,t,n,i,l,d,g,x,A){Yr.call(this,e,t,n,i,l,d,g,x,A),this.needsUpdate=!0}function Bu(e,t,n,i,l,d,g,x,A,I){if((I=I!==void 0?I:gr)!==gr&&I!==Wi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&I===gr&&(n=lt),n===void 0&&I===Wi&&(n=qr),Yr.call(this,null,i,l,d,g,x,I,n,A),this.image={width:e,height:t},this.magFilter=g!==void 0?g:pt,this.minFilter=x!==void 0?x:pt,this.flipY=!1,this.generateMipmaps=!1}function Pc(e){Sn.call(this),this.type="WireframeGeometry";var t,n,i,l,d,g,x,A,I,Y,Q=[],ie=[0,0],z={},he=["a","b","c"];if(e&&e.isGeometry){var me=e.faces;for(t=0,i=me.length;t<i;t++){var ye=me[t];for(n=0;n<3;n++)x=ye[he[n]],A=ye[he[(n+1)%3]],ie[0]=Math.min(x,A),ie[1]=Math.max(x,A),z[I=ie[0]+","+ie[1]]===void 0&&(z[I]={index1:ie[0],index2:ie[1]})}for(I in z)g=z[I],Y=e.vertices[g.index1],Q.push(Y.x,Y.y,Y.z),Y=e.vertices[g.index2],Q.push(Y.x,Y.y,Y.z)}else if(e&&e.isBufferGeometry){var Ee,Re,Ve,et,Fe,at;if(Y=new Oe,e.index!==null){for(Ee=e.attributes.position,Re=e.index,(Ve=e.groups).length===0&&(Ve=[{start:0,count:Re.count,materialIndex:0}]),l=0,d=Ve.length;l<d;++l)for(i=(t=(et=Ve[l]).start)+et.count;t<i;t+=3)for(n=0;n<3;n++)x=Re.getX(t+n),A=Re.getX(t+(n+1)%3),ie[0]=Math.min(x,A),ie[1]=Math.max(x,A),z[I=ie[0]+","+ie[1]]===void 0&&(z[I]={index1:ie[0],index2:ie[1]});for(I in z)g=z[I],Y.fromBufferAttribute(Ee,g.index1),Q.push(Y.x,Y.y,Y.z),Y.fromBufferAttribute(Ee,g.index2),Q.push(Y.x,Y.y,Y.z)}else for(t=0,i=(Ee=e.attributes.position).count/3;t<i;t++)for(n=0;n<3;n++)Fe=3*t+n,Y.fromBufferAttribute(Ee,Fe),Q.push(Y.x,Y.y,Y.z),at=3*t+(n+1)%3,Y.fromBufferAttribute(Ee,at),Q.push(Y.x,Y.y,Y.z)}this.setAttribute("position",new on(Q,3))}function Ka(e,t,n){sr.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Oc(e,t,n)),this.mergeVertices()}function Oc(e,t,n){Sn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i,l,d=[],g=[],x=[],A=[],I=new Oe,Y=new Oe,Q=new Oe,ie=new Oe,z=new Oe;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var he=t+1;for(i=0;i<=n;i++){var me=i/n;for(l=0;l<=t;l++){var ye=l/t;e(ye,me,Y),g.push(Y.x,Y.y,Y.z),0<=ye-1e-5?(e(ye-1e-5,me,Q),ie.subVectors(Y,Q)):(e(1e-5+ye,me,Q),ie.subVectors(Q,Y)),0<=me-1e-5?(e(ye,me-1e-5,Q),z.subVectors(Y,Q)):(e(ye,1e-5+me,Q),z.subVectors(Q,Y)),I.crossVectors(ie,z).normalize(),x.push(I.x,I.y,I.z),A.push(ye,me)}}for(i=0;i<n;i++)for(l=0;l<t;l++){var Ee=i*he+l,Re=i*he+l+1,Ve=(i+1)*he+l+1,et=(i+1)*he+l;d.push(Ee,Re,et),d.push(Re,Ve,et)}this.setIndex(d),this.setAttribute("position",new on(g,3)),this.setAttribute("normal",new on(x,3)),this.setAttribute("uv",new on(A,2))}function Fu(e,t,n,i){sr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new ra(e,t,n,i)),this.mergeVertices()}function ra(e,t,n,i){Sn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1;var l=[],d=[];function g(Q,ie,z,he){var me,ye,Ee=Math.pow(2,he),Re=[];for(me=0;me<=Ee;me++){Re[me]=[];var Ve=Q.clone().lerp(z,me/Ee),et=ie.clone().lerp(z,me/Ee),Fe=Ee-me;for(ye=0;ye<=Fe;ye++)Re[me][ye]=ye===0&&me===Ee?Ve:Ve.clone().lerp(et,ye/Fe)}for(me=0;me<Ee;me++)for(ye=0;ye<2*(Ee-me)-1;ye++){var at=Math.floor(ye/2);ye%2==0?(x(Re[me][at+1]),x(Re[me+1][at]),x(Re[me][at])):(x(Re[me][at+1]),x(Re[me+1][at+1]),x(Re[me+1][at]))}}function x(Q){l.push(Q.x,Q.y,Q.z)}function A(Q,ie){var z=3*Q;ie.x=e[0+z],ie.y=e[1+z],ie.z=e[2+z]}function I(Q,ie,z,he){he<0&&Q.x===1&&(d[ie]=Q.x-1),z.x===0&&z.z===0&&(d[ie]=he/2/Math.PI+.5)}function Y(Q){return Math.atan2(Q.z,-Q.x)}(function(Q){for(var ie=new Oe,z=new Oe,he=new Oe,me=0;me<t.length;me+=3)A(t[me+0],ie),A(t[me+1],z),A(t[me+2],he),g(ie,z,he,Q)})(i=i||0),function(Q){for(var ie=new Oe,z=0;z<l.length;z+=3)ie.x=l[z+0],ie.y=l[z+1],ie.z=l[z+2],ie.normalize().multiplyScalar(Q),l[z+0]=ie.x,l[z+1]=ie.y,l[z+2]=ie.z}(n),function(){for(var Q=new Oe,ie=0;ie<l.length;ie+=3){Q.x=l[ie+0],Q.y=l[ie+1],Q.z=l[ie+2];var z=Y(Q)/2/Math.PI+.5,he=(me=Q,Math.atan2(-me.y,Math.sqrt(me.x*me.x+me.z*me.z))/Math.PI+.5);d.push(z,1-he)}var me;(function(){for(var ye=new Oe,Ee=new Oe,Re=new Oe,Ve=new Oe,et=new zt,Fe=new zt,at=new zt,Je=0,xt=0;Je<l.length;Je+=9,xt+=6){ye.set(l[Je+0],l[Je+1],l[Je+2]),Ee.set(l[Je+3],l[Je+4],l[Je+5]),Re.set(l[Je+6],l[Je+7],l[Je+8]),et.set(d[xt+0],d[xt+1]),Fe.set(d[xt+2],d[xt+3]),at.set(d[xt+4],d[xt+5]),Ve.copy(ye).add(Ee).add(Re).divideScalar(3);var _t=Y(Ve);I(et,xt+0,ye,_t),I(Fe,xt+2,Ee,_t),I(at,xt+4,Re,_t)}})(),function(){for(var ye=0;ye<d.length;ye+=6){var Ee=d[ye+0],Re=d[ye+2],Ve=d[ye+4],et=Math.max(Ee,Re,Ve),Fe=Math.min(Ee,Re,Ve);.9<et&&Fe<.1&&(Ee<.2&&(d[ye+0]+=1),Re<.2&&(d[ye+2]+=1),Ve<.2&&(d[ye+4]+=1))}}()}(),this.setAttribute("position",new on(l,3)),this.setAttribute("normal",new on(l.slice(),3)),this.setAttribute("uv",new on(d,2)),i===0?this.computeVertexNormals():this.normalizeNormals()}function yr(e,t){sr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ac(e,t)),this.mergeVertices()}function Ac(e,t){ra.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Sa(e,t){sr.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new mi(e,t)),this.mergeVertices()}function mi(e,t){ra.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ro(e,t){sr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Rc(e,t)),this.mergeVertices()}function Rc(e,t){var n=(1+Math.sqrt(5))/2;ra.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Wl(e,t){sr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new po(e,t)),this.mergeVertices()}function po(e,t){var n=(1+Math.sqrt(5))/2,i=1/n;ra.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Lc(e,t,n,i,l,d){sr.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:l},d!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var g=new Os(e,t,n,i,l);this.tangents=g.tangents,this.normals=g.normals,this.binormals=g.binormals,this.fromBufferGeometry(g),this.mergeVertices()}function Os(e,t,n,i,l){Sn.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:l},t=t||64,n=n||1,i=i||8,l=l||!1;var d=e.computeFrenetFrames(t,l);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;var g,x,A=new Oe,I=new Oe,Y=new zt,Q=new Oe,ie=[],z=[],he=[],me=[];function ye(Ee){Q=e.getPointAt(Ee/t,Q);var Re=d.normals[Ee],Ve=d.binormals[Ee];for(x=0;x<=i;x++){var et=x/i*Math.PI*2,Fe=Math.sin(et),at=-Math.cos(et);I.x=at*Re.x+Fe*Ve.x,I.y=at*Re.y+Fe*Ve.y,I.z=at*Re.z+Fe*Ve.z,I.normalize(),z.push(I.x,I.y,I.z),A.x=Q.x+n*I.x,A.y=Q.y+n*I.y,A.z=Q.z+n*I.z,ie.push(A.x,A.y,A.z)}}(function(){for(g=0;g<t;g++)ye(g);ye(l===!1?t:0),function(){for(g=0;g<=t;g++)for(x=0;x<=i;x++)Y.x=g/t,Y.y=x/i,he.push(Y.x,Y.y)}(),function(){for(x=1;x<=t;x++)for(g=1;g<=i;g++){var Ee=(i+1)*(x-1)+(g-1),Re=(i+1)*x+(g-1),Ve=(i+1)*x+g,et=(i+1)*(x-1)+g;me.push(Ee,Re,et),me.push(Re,Ve,et)}}()})(),this.setIndex(me),this.setAttribute("position",new on(ie,3)),this.setAttribute("normal",new on(z,3)),this.setAttribute("uv",new on(he,2))}function gi(e,t,n,i,l,d,g){sr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:l,q:d},g!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new yi(e,t,n,i,l,d)),this.mergeVertices()}function yi(e,t,n,i,l,d){Sn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:l,q:d},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,l=l||2,d=d||3;var g,x,A=[],I=[],Y=[],Q=[],ie=new Oe,z=new Oe,he=new Oe,me=new Oe,ye=new Oe,Ee=new Oe,Re=new Oe;for(g=0;g<=n;++g){var Ve=g/n*l*Math.PI*2;for(Ot(Ve,l,d,e,he),Ot(.01+Ve,l,d,e,me),Ee.subVectors(me,he),Re.addVectors(me,he),ye.crossVectors(Ee,Re),Re.crossVectors(ye,Ee),ye.normalize(),Re.normalize(),x=0;x<=i;++x){var et=x/i*Math.PI*2,Fe=-t*Math.cos(et),at=t*Math.sin(et);ie.x=he.x+(Fe*Re.x+at*ye.x),ie.y=he.y+(Fe*Re.y+at*ye.y),ie.z=he.z+(Fe*Re.z+at*ye.z),I.push(ie.x,ie.y,ie.z),z.subVectors(ie,he).normalize(),Y.push(z.x,z.y,z.z),Q.push(g/n),Q.push(x/i)}}for(x=1;x<=n;x++)for(g=1;g<=i;g++){var Je=(i+1)*(x-1)+(g-1),xt=(i+1)*x+(g-1),_t=(i+1)*x+g,Pt=(i+1)*(x-1)+g;A.push(Je,xt,Pt),A.push(xt,_t,Pt)}function Ot(Gt,Kt,Dt,Mt,dn){var Mn=Math.cos(Gt),Zn=Math.sin(Gt),qn=Dt/Kt*Gt,Vn=Math.cos(qn);dn.x=Mt*(2+Vn)*.5*Mn,dn.y=Mt*(2+Vn)*Zn*.5,dn.z=Mt*Math.sin(qn)*.5}this.setIndex(A),this.setAttribute("position",new on(I,3)),this.setAttribute("normal",new on(Y,3)),this.setAttribute("uv",new on(Q,2))}function Ic(e,t,n,i,l){sr.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:l},this.fromBufferGeometry(new Jl(e,t,n,i,l)),this.mergeVertices()}function Jl(e,t,n,i,l){Sn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:l},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,l=l||2*Math.PI;var d,g,x=[],A=[],I=[],Y=[],Q=new Oe,ie=new Oe,z=new Oe;for(d=0;d<=n;d++)for(g=0;g<=i;g++){var he=g/i*l,me=d/n*Math.PI*2;ie.x=(e+t*Math.cos(me))*Math.cos(he),ie.y=(e+t*Math.cos(me))*Math.sin(he),ie.z=t*Math.sin(me),A.push(ie.x,ie.y,ie.z),Q.x=e*Math.cos(he),Q.y=e*Math.sin(he),z.subVectors(ie,Q).normalize(),I.push(z.x,z.y,z.z),Y.push(g/i),Y.push(d/n)}for(d=1;d<=n;d++)for(g=1;g<=i;g++){var ye=(i+1)*d+g-1,Ee=(i+1)*(d-1)+g-1,Re=(i+1)*(d-1)+g,Ve=(i+1)*d+g;x.push(ye,Ee,Ve),x.push(Ee,Re,Ve)}this.setIndex(x),this.setAttribute("position",new on(A,3)),this.setAttribute("normal",new on(I,3)),this.setAttribute("uv",new on(Y,2))}function ql(e,t,n,i,l){var d,g;if(l===0<function(x,A,I,Y){for(var Q=0,ie=A,z=I-Y;ie<I;ie+=Y)Q+=(x[z]-x[ie])*(x[ie+1]+x[z+1]),z=ie;return Q}(e,t,n,i))for(d=t;d<n;d+=i)g=jc(d,e[d],e[d+1],g);else for(d=n-i;t<=d;d-=i)g=jc(d,e[d],e[d+1],g);return g&&As(g,g.next)&&(Nc(g),g=g.next),g}function ll(e,t){if(!e)return e;t=t||e;var n,i=e;do if(n=!1,i.steiner||!As(i,i.next)&&ai(i.prev,i,i.next)!==0)i=i.next;else{if(Nc(i),(i=t=i.prev)===i.next)break;n=!0}while(n||i!==t);return t}function Xl(e,t,n,i,l,d,g){if(e){!g&&d&&function(Y,Q,ie,z){for(var he=Y;he.z===null&&(he.z=Lo(he.x,he.y,Q,ie,z)),he.prevZ=he.prev,he.nextZ=he.next,(he=he.next)!==Y;);he.prevZ.nextZ=null,he.prevZ=null,function(me){var ye,Ee,Re,Ve,et,Fe,at,Je,xt=1;do{for(Ee=me,et=me=null,Fe=0;Ee;){for(Fe++,Re=Ee,ye=at=0;ye<xt&&(at++,Re=Re.nextZ);ye++);for(Je=xt;0<at||0<Je&&Re;)at!==0&&(Je===0||!Re||Ee.z<=Re.z)?(Ee=(Ve=Ee).nextZ,at--):(Re=(Ve=Re).nextZ,Je--),et?et.nextZ=Ve:me=Ve,Ve.prevZ=et,et=Ve;Ee=Re}et.nextZ=null,xt*=2}while(1<Fe)}(he)}(e,i,l,d);for(var x,A,I=e;e.prev!==e.next;)if(x=e.prev,A=e.next,d?fo(e,i,l,d):Vu(e))t.push(x.i/n),t.push(e.i/n),t.push(A.i/n),Nc(e),e=A.next,I=A.next;else if((e=A)===I){g?g===1?Xl(e=Yl(e,t,n),t,n,i,l,d,2):g===2&&Yd(e,t,n,i,l,d):Xl(ll(e),t,n,i,l,d,1);break}}}function Vu(e){var t=e.prev,n=e,i=e.next;if(!(0<=ai(t,n,i))){for(var l=e.next.next;l!==e.prev;){if(cl(t.x,t.y,n.x,n.y,i.x,i.y,l.x,l.y)&&0<=ai(l.prev,l,l.next))return;l=l.next}return 1}}function fo(e,t,n,i){var l=e.prev,d=e,g=e.next;if(!(0<=ai(l,d,g))){for(var x=l.x<d.x?l.x<g.x?l.x:g.x:d.x<g.x?d.x:g.x,A=l.y<d.y?l.y<g.y?l.y:g.y:d.y<g.y?d.y:g.y,I=l.x>d.x?l.x>g.x?l.x:g.x:d.x>g.x?d.x:g.x,Y=l.y>d.y?l.y>g.y?l.y:g.y:d.y>g.y?d.y:g.y,Q=Lo(x,A,t,n,i),ie=Lo(I,Y,t,n,i),z=e.prevZ,he=e.nextZ;z&&z.z>=Q&&he&&he.z<=ie;){if(z!==e.prev&&z!==e.next&&cl(l.x,l.y,d.x,d.y,g.x,g.y,z.x,z.y)&&0<=ai(z.prev,z,z.next)||(z=z.prevZ,he!==e.prev&&he!==e.next&&cl(l.x,l.y,d.x,d.y,g.x,g.y,he.x,he.y)&&0<=ai(he.prev,he,he.next)))return;he=he.nextZ}for(;z&&z.z>=Q;){if(z!==e.prev&&z!==e.next&&cl(l.x,l.y,d.x,d.y,g.x,g.y,z.x,z.y)&&0<=ai(z.prev,z,z.next))return;z=z.prevZ}for(;he&&he.z<=ie;){if(he!==e.prev&&he!==e.next&&cl(l.x,l.y,d.x,d.y,g.x,g.y,he.x,he.y)&&0<=ai(he.prev,he,he.next))return;he=he.nextZ}return 1}}function Yl(e,t,n){var i=e;do{var l=i.prev,d=i.next.next;!As(l,d)&&Qr(l,i,i.next,d)&&kc(l,d)&&kc(d,l)&&(t.push(l.i/n),t.push(i.i/n),t.push(d.i/n),Nc(i),Nc(i.next),i=e=d),i=i.next}while(i!==e);return i}function Yd(e,t,n,i,l,d){var g,x,A=e;do{for(var I=A.next.next;I!==A.prev;){if(A.i!==I.i&&(x=I,(g=A).next.i!==x.i&&g.prev.i!==x.i&&!function(Q,ie){var z=Q;do{if(z.i!==Q.i&&z.next.i!==Q.i&&z.i!==ie.i&&z.next.i!==ie.i&&Qr(z,z.next,Q,ie))return 1;z=z.next}while(z!==Q)}(g,x)&&kc(g,x)&&kc(x,g)&&function(Q,ie){for(var z=Q,he=!1,me=(Q.x+ie.x)/2,ye=(Q.y+ie.y)/2;z.y>ye!=z.next.y>ye&&z.next.y!==z.y&&me<(z.next.x-z.x)*(ye-z.y)/(z.next.y-z.y)+z.x&&(he=!he),(z=z.next)!==Q;);return he}(g,x))){var Y=jh(A,I);return A=ll(A,A.next),Y=ll(Y,Y.next),Xl(A,t,n,i,l,d),void Xl(Y,t,n,i,l,d)}I=I.next}A=A.next}while(A!==e)}function Zd(e,t){return e.x-t.x}function dd(e,t){if(t=function(i,l){var d,g=l,x=i.x,A=i.y,I=-1/0;do{if(A<=g.y&&A>=g.next.y&&g.next.y!==g.y){var Y=g.x+(A-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(Y<=x&&I<Y){if((I=Y)===x){if(A===g.y)return g;if(A===g.next.y)return g.next}d=g.x<g.next.x?g:g.next}}g=g.next}while(g!==l);if(!d)return null;if(x===I)return d.prev;var Q,ie=d,z=d.x,he=d.y,me=1/0;for(g=d.next;g!==ie;)x>=g.x&&g.x>=z&&x!==g.x&&cl(A<he?x:I,A,z,he,A<he?I:x,A,g.x,g.y)&&((Q=Math.abs(A-g.y)/(x-g.x))<me||Q===me&&g.x>d.x)&&kc(g,i)&&(d=g,me=Q),g=g.next;return d}(e,t)){var n=jh(t,e);ll(n,n.next)}}function Lo(e,t,n,i,l){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*l)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*l)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Cr(e){for(var t=e,n=e;(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),(t=t.next)!==e;);return n}function cl(e,t,n,i,l,d,g,x){return 0<=(l-g)*(t-x)-(e-g)*(d-x)&&0<=(e-g)*(i-x)-(n-g)*(t-x)&&0<=(n-g)*(d-x)-(l-g)*(i-x)}function ai(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function As(e,t){return e.x===t.x&&e.y===t.y}function Qr(e,t,n,i){return As(e,n)&&As(t,i)||As(e,i)&&As(n,t)||0<ai(e,t,n)!=0<ai(e,t,i)&&0<ai(n,i,e)!=0<ai(n,i,t)}function kc(e,t){return ai(e.prev,e,e.next)<0?0<=ai(e,t,e.next)&&0<=ai(e,e.prev,t):ai(e,t,e.prev)<0||ai(e,e.next,t)<0}function jh(e,t){var n=new Nh(e.i,e.x,e.y),i=new Nh(t.i,t.x,t.y),l=e.next,d=t.prev;return(e.next=t).prev=e,(n.next=l).prev=n,(i.next=n).prev=i,(d.next=i).prev=d,i}function jc(e,t,n,i){var l=new Nh(e,t,n);return i?(l.next=i.next,(l.prev=i).next.prev=l,i.next=l):(l.prev=l).next=l,l}function Nc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Nh(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}zl.prototype=Object.assign(Object.create(At.prototype),{constructor:zl,isPoints:!0,raycast:function(e,t){var n=this.geometry,i=this.matrixWorld,l=e.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),Dc.copy(n.boundingSphere),Dc.applyMatrix4(i),Dc.radius+=l,e.ray.intersectsSphere(Dc)!==!1){Iu.getInverse(i),ku.copy(e.ray).applyMatrix4(Iu);var d=l/((this.scale.x+this.scale.y+this.scale.z)/3),g=d*d;if(n.isBufferGeometry){var x=n.index,A=n.attributes.position.array;if(x!==null)for(var I=x.array,Y=0,Q=I.length;Y<Q;Y++){var ie=I[Y];ju.fromArray(A,3*ie),Ul(ju,ie,g,i,e,t,this)}else{Y=0;for(var z=A.length/3;Y<z;Y++)ju.fromArray(A,3*Y),Ul(ju,Y,g,i,e,t,this)}}else{var he=n.vertices;for(Y=0,z=he.length;Y<z;Y++)Ul(he[Y],Y,g,i,e,t,this)}}},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var l=i.morphAttributes,d=Object.keys(l);if(0<d.length){var g=l[d[0]];if(g!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=g.length;e<t;e++)n=g[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var x=i.morphTargets;x!==void 0&&0<x.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Hl.prototype=Object.assign(Object.create(Yr.prototype),{constructor:Hl,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((Nu.prototype=Object.create(Yr.prototype)).constructor=Nu).prototype.isCompressedTexture=!0,((Ec.prototype=Object.create(Yr.prototype)).constructor=Ec).prototype.isCanvasTexture=!0,((Bu.prototype=Object.create(Yr.prototype)).constructor=Bu).prototype.isDepthTexture=!0,(Pc.prototype=Object.create(Sn.prototype)).constructor=Pc,(Ka.prototype=Object.create(sr.prototype)).constructor=Ka,(Oc.prototype=Object.create(Sn.prototype)).constructor=Oc,(Fu.prototype=Object.create(sr.prototype)).constructor=Fu,(ra.prototype=Object.create(Sn.prototype)).constructor=ra,(yr.prototype=Object.create(sr.prototype)).constructor=yr,(Ac.prototype=Object.create(ra.prototype)).constructor=Ac,(Sa.prototype=Object.create(sr.prototype)).constructor=Sa,(mi.prototype=Object.create(ra.prototype)).constructor=mi,(Ro.prototype=Object.create(sr.prototype)).constructor=Ro,(Rc.prototype=Object.create(ra.prototype)).constructor=Rc,(Wl.prototype=Object.create(sr.prototype)).constructor=Wl,(po.prototype=Object.create(ra.prototype)).constructor=po,(Lc.prototype=Object.create(sr.prototype)).constructor=Lc,((Os.prototype=Object.create(Sn.prototype)).constructor=Os).prototype.toJSON=function(){var e=Sn.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},(gi.prototype=Object.create(sr.prototype)).constructor=gi,(yi.prototype=Object.create(Sn.prototype)).constructor=yi,(Ic.prototype=Object.create(sr.prototype)).constructor=Ic,(Jl.prototype=Object.create(Sn.prototype)).constructor=Jl;var us={area:function(e){for(var t=e.length,n=0,i=t-1,l=0;l<t;i=l++)n+=e[i].x*e[l].y-e[l].x*e[i].y;return .5*n},isClockWise:function(e){return us.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],l=[];pd(e),Gu(n,e);var d=e.length;t.forEach(pd);for(var g=0;g<t.length;g++)i.push(d),d+=t[g].length,Gu(n,t[g]);var x=function(A,I,Y){Y=Y||2;var Q,ie,z,he,me,ye,Ee,Re=I&&I.length,Ve=Re?I[0]*Y:A.length,et=ql(A,0,Ve,Y,!0),Fe=[];if(!et||et.next===et.prev)return Fe;if(Re&&(et=function(Je,xt,_t,Pt){var Ot,Gt,Kt,Dt=[];for(Ot=0,Gt=xt.length;Ot<Gt;Ot++)(Kt=ql(Je,xt[Ot]*Pt,Ot<Gt-1?xt[Ot+1]*Pt:Je.length,Pt,!1))===Kt.next&&(Kt.steiner=!0),Dt.push(Cr(Kt));for(Dt.sort(Zd),Ot=0;Ot<Dt.length;Ot++)dd(Dt[Ot],_t),_t=ll(_t,_t.next);return _t}(A,I,et,Y)),A.length>80*Y){Q=z=A[0],ie=he=A[1];for(var at=Y;at<Ve;at+=Y)(me=A[at])<Q&&(Q=me),(ye=A[at+1])<ie&&(ie=ye),z<me&&(z=me),he<ye&&(he=ye);Ee=(Ee=Math.max(z-Q,he-ie))!==0?1/Ee:0}return Xl(et,Fe,Y,Q,ie,Ee),Fe}(n,i);for(g=0;g<x.length;g+=3)l.push(x.slice(g,g+3));return l}};function pd(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Gu(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function ul(e,t){sr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Rs(e,t)),this.mergeVertices()}function Rs(e,t){Sn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t};for(var n=this,i=[],l=[],d=0,g=(e=Array.isArray(e)?e:[e]).length;d<g;d++)x(e[d]);function x(A){var I=[],Y=t.curveSegments!==void 0?t.curveSegments:12,Q=t.steps!==void 0?t.steps:1,ie=t.depth!==void 0?t.depth:100,z=t.bevelEnabled===void 0||t.bevelEnabled,he=t.bevelThickness!==void 0?t.bevelThickness:6,me=t.bevelSize!==void 0?t.bevelSize:he-2,ye=t.bevelOffset!==void 0?t.bevelOffset:0,Ee=t.bevelSegments!==void 0?t.bevelSegments:3,Re=t.extrudePath,Ve=t.UVGenerator!==void 0?t.UVGenerator:Kd;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ie=t.amount);var et,Fe,at,Je,xt,_t,Pt,Ot,Gt=!1;Re&&(et=Re.getSpacedPoints(Q),z=!(Gt=!0),Fe=Re.computeFrenetFrames(Q,!1),at=new Oe,Je=new Oe,xt=new Oe),z||(ye=me=he=Ee=0);var Kt=A.extractPoints(Y),Dt=Kt.shape,Mt=Kt.holes;if(!us.isClockWise(Dt))for(Dt=Dt.reverse(),Pt=0,Ot=Mt.length;Pt<Ot;Pt++)_t=Mt[Pt],us.isClockWise(_t)&&(Mt[Pt]=_t.reverse());var dn=us.triangulateShape(Dt,Mt),Mn=Dt;for(Pt=0,Ot=Mt.length;Pt<Ot;Pt++)_t=Mt[Pt],Dt=Dt.concat(_t);function Zn(Ir,oi,xi){return oi||console.error("THREE.ExtrudeGeometry: vec does not exist"),oi.clone().multiplyScalar(xi).add(Ir)}var qn,Vn,cr,Dn,ke,tt,Yt=Dt.length,Ht=dn.length;function rr(Ir,oi,xi){var aa,ei,$i,eo=Ir.x-oi.x,go=Ir.y-oi.y,ps=xi.x-Ir.x,Bs=xi.y-Ir.y,nh=eo*eo+go*go,kp=eo*Bs-go*ps;if(Math.abs(kp)>Number.EPSILON){var rh=Math.sqrt(nh),nu=Math.sqrt(ps*ps+Bs*Bs),ru=oi.x-go/rh,iu=oi.y+eo/rh,au=((xi.x-Bs/nu-ru)*Bs-(xi.y+ps/nu-iu)*ps)/(eo*Bs-go*ps),Vh=(aa=ru+eo*au-Ir.x)*aa+(ei=iu+go*au-Ir.y)*ei;if(Vh<=2)return new zt(aa,ei);$i=Math.sqrt(Vh/2)}else{var _o=!1;eo>Number.EPSILON?ps>Number.EPSILON&&(_o=!0):eo<-Number.EPSILON?ps<-Number.EPSILON&&(_o=!0):Math.sign(go)===Math.sign(Bs)&&(_o=!0),$i=_o?(aa=-go,ei=eo,Math.sqrt(nh)):(aa=eo,ei=go,Math.sqrt(nh/2))}return new zt(aa/$i,ei/$i)}for(var En=[],Et=0,Pn=Mn.length,ur=Pn-1,ft=Et+1;Et<Pn;Et++,ur++,ft++)ur===Pn&&(ur=0),ft===Pn&&(ft=0),En[Et]=rr(Mn[Et],Mn[ur],Mn[ft]);var _n,Tn,ir=[],un=En.concat();for(Pt=0,Ot=Mt.length;Pt<Ot;Pt++){for(_t=Mt[Pt],_n=[],Et=0,ur=(Pn=_t.length)-1,ft=Et+1;Et<Pn;Et++,ur++,ft++)ur===Pn&&(ur=0),ft===Pn&&(ft=0),_n[Et]=rr(_t[Et],_t[ur],_t[ft]);ir.push(_n),un=un.concat(_n)}for(qn=0;qn<Ee;qn++){for(cr=qn/Ee,Dn=he*Math.cos(cr*Math.PI/2),Vn=me*Math.sin(cr*Math.PI/2)+ye,Et=0,Pn=Mn.length;Et<Pn;Et++)Pr((ke=Zn(Mn[Et],En[Et],Vn)).x,ke.y,-Dn);for(Pt=0,Ot=Mt.length;Pt<Ot;Pt++)for(_t=Mt[Pt],_n=ir[Pt],Et=0,Pn=_t.length;Et<Pn;Et++)Pr((ke=Zn(_t[Et],_n[Et],Vn)).x,ke.y,-Dn)}for(Vn=me+ye,Et=0;Et<Yt;Et++)ke=z?Zn(Dt[Et],un[Et],Vn):Dt[Et],Gt?(Je.copy(Fe.normals[0]).multiplyScalar(ke.x),at.copy(Fe.binormals[0]).multiplyScalar(ke.y),xt.copy(et[0]).add(Je).add(at),Pr(xt.x,xt.y,xt.z)):Pr(ke.x,ke.y,0);for(Tn=1;Tn<=Q;Tn++)for(Et=0;Et<Yt;Et++)ke=z?Zn(Dt[Et],un[Et],Vn):Dt[Et],Gt?(Je.copy(Fe.normals[Tn]).multiplyScalar(ke.x),at.copy(Fe.binormals[Tn]).multiplyScalar(ke.y),xt.copy(et[Tn]).add(Je).add(at),Pr(xt.x,xt.y,xt.z)):Pr(ke.x,ke.y,ie/Q*Tn);for(qn=Ee-1;0<=qn;qn--){for(cr=qn/Ee,Dn=he*Math.cos(cr*Math.PI/2),Vn=me*Math.sin(cr*Math.PI/2)+ye,Et=0,Pn=Mn.length;Et<Pn;Et++)Pr((ke=Zn(Mn[Et],En[Et],Vn)).x,ke.y,ie+Dn);for(Pt=0,Ot=Mt.length;Pt<Ot;Pt++)for(_t=Mt[Pt],_n=ir[Pt],Et=0,Pn=_t.length;Et<Pn;Et++)ke=Zn(_t[Et],_n[Et],Vn),Gt?Pr(ke.x,ke.y+et[Q-1].y,et[Q-1].x+Dn):Pr(ke.x,ke.y,ie+Dn)}function br(Ir,oi){var xi,aa;for(Et=Ir.length;0<=--Et;){(aa=(xi=Et)-1)<0&&(aa=Ir.length-1);var ei=0,$i=Q+2*Ee;for(ei=0;ei<$i;ei++){var eo=Yt*ei,go=Yt*(ei+1);mo(oi+xi+eo,oi+aa+eo,oi+aa+go,oi+xi+go)}}}function Pr(Ir,oi,xi){I.push(Ir),I.push(oi),I.push(xi)}function vi(Ir,oi,xi){Nr(Ir),Nr(oi),Nr(xi);var aa=i.length/3,ei=Ve.generateTopUV(n,i,aa-3,aa-2,aa-1);Ei(ei[0]),Ei(ei[1]),Ei(ei[2])}function mo(Ir,oi,xi,aa){Nr(Ir),Nr(oi),Nr(aa),Nr(oi),Nr(xi),Nr(aa);var ei=i.length/3,$i=Ve.generateSideWallUV(n,i,ei-6,ei-3,ei-2,ei-1);Ei($i[0]),Ei($i[1]),Ei($i[3]),Ei($i[1]),Ei($i[2]),Ei($i[3])}function Nr(Ir){i.push(I[3*Ir+0]),i.push(I[3*Ir+1]),i.push(I[3*Ir+2])}function Ei(Ir){l.push(Ir.x),l.push(Ir.y)}(function(){var Ir=i.length/3;if(z){var oi=0,xi=Yt*oi;for(Et=0;Et<Ht;Et++)vi((tt=dn[Et])[2]+xi,tt[1]+xi,tt[0]+xi);for(xi=Yt*(oi=Q+2*Ee),Et=0;Et<Ht;Et++)vi((tt=dn[Et])[0]+xi,tt[1]+xi,tt[2]+xi)}else{for(Et=0;Et<Ht;Et++)vi((tt=dn[Et])[2],tt[1],tt[0]);for(Et=0;Et<Ht;Et++)vi((tt=dn[Et])[0]+Yt*Q,tt[1]+Yt*Q,tt[2]+Yt*Q)}n.addGroup(Ir,i.length/3-Ir,0)})(),function(){var Ir=i.length/3,oi=0;for(br(Mn,oi),oi+=Mn.length,Pt=0,Ot=Mt.length;Pt<Ot;Pt++)br(_t=Mt[Pt],oi),oi+=_t.length;n.addGroup(Ir,i.length/3-Ir,1)}()}this.setAttribute("position",new on(i,3)),this.setAttribute("uv",new on(l,2)),this.computeVertexNormals()}((ul.prototype=Object.create(sr.prototype)).constructor=ul).prototype.toJSON=function(){var e=sr.prototype.toJSON.call(this);return fd(this.parameters.shapes,this.parameters.options,e)},((Rs.prototype=Object.create(Sn.prototype)).constructor=Rs).prototype.toJSON=function(){var e=Sn.prototype.toJSON.call(this);return fd(this.parameters.shapes,this.parameters.options,e)};var Kd={generateTopUV:function(e,t,n,i,l){var d=t[3*n],g=t[3*n+1],x=t[3*i],A=t[3*i+1],I=t[3*l],Y=t[3*l+1];return[new zt(d,g),new zt(x,A),new zt(I,Y)]},generateSideWallUV:function(e,t,n,i,l,d){var g=t[3*n],x=t[3*n+1],A=t[3*n+2],I=t[3*i],Y=t[3*i+1],Q=t[3*i+2],ie=t[3*l],z=t[3*l+1],he=t[3*l+2],me=t[3*d],ye=t[3*d+1],Ee=t[3*d+2];return Math.abs(x-Y)<.01?[new zt(g,1-A),new zt(I,1-Q),new zt(ie,1-he),new zt(me,1-Ee)]:[new zt(x,1-A),new zt(Y,1-Q),new zt(z,1-he),new zt(ye,1-Ee)]}};function fd(e,t,n){if(n.shapes=[],Array.isArray(e))for(var i=0,l=e.length;i<l;i++){var d=e[i];n.shapes.push(d.uuid)}else n.shapes.push(e.uuid);return t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Ui(e,t){sr.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new pa(e,t)),this.mergeVertices()}function pa(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new sr;var i=n.generateShapes(e,t.size);t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),Rs.call(this,i,t),this.type="TextBufferGeometry"}function zu(e,t,n,i,l,d,g){sr.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:l,thetaStart:d,thetaLength:g},this.fromBufferGeometry(new hl(e,t,n,i,l,d,g)),this.mergeVertices()}function hl(e,t,n,i,l,d,g){Sn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:l,thetaStart:d,thetaLength:g},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=i!==void 0?i:0,l=l!==void 0?l:2*Math.PI,d=d!==void 0?d:0,g=g!==void 0?g:Math.PI;var x,A,I=Math.min(d+g,Math.PI),Y=0,Q=[],ie=new Oe,z=new Oe,he=[],me=[],ye=[],Ee=[];for(A=0;A<=n;A++){var Re=[],Ve=A/n,et=0;for(A==0&&d==0?et=.5/t:A==n&&I==Math.PI&&(et=-.5/t),x=0;x<=t;x++){var Fe=x/t;ie.x=-e*Math.cos(i+Fe*l)*Math.sin(d+Ve*g),ie.y=e*Math.cos(d+Ve*g),ie.z=e*Math.sin(i+Fe*l)*Math.sin(d+Ve*g),me.push(ie.x,ie.y,ie.z),z.copy(ie).normalize(),ye.push(z.x,z.y,z.z),Ee.push(Fe+et,1-Ve),Re.push(Y++)}Q.push(Re)}for(A=0;A<n;A++)for(x=0;x<t;x++){var at=Q[A][x+1],Je=Q[A][x],xt=Q[A+1][x],_t=Q[A+1][x+1];(A!==0||0<d)&&he.push(at,Je,_t),(A!==n-1||I<Math.PI)&&he.push(Je,xt,_t)}this.setIndex(he),this.setAttribute("position",new on(me,3)),this.setAttribute("normal",new on(ye,3)),this.setAttribute("uv",new on(Ee,2))}function Uu(e,t,n,i,l,d){sr.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:l,thetaLength:d},this.fromBufferGeometry(new Bc(e,t,n,i,l,d)),this.mergeVertices()}function Bc(e,t,n,i,l,d){Sn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:l,thetaLength:d},e=e||.5,t=t||1,l=l!==void 0?l:0,d=d!==void 0?d:2*Math.PI,n=n!==void 0?Math.max(3,n):8;var g,x,A,I=[],Y=[],Q=[],ie=[],z=e,he=(t-e)/(i=i!==void 0?Math.max(1,i):1),me=new Oe,ye=new zt;for(x=0;x<=i;x++){for(A=0;A<=n;A++)g=l+A/n*d,me.x=z*Math.cos(g),me.y=z*Math.sin(g),Y.push(me.x,me.y,me.z),Q.push(0,0,1),ye.x=(me.x/t+1)/2,ye.y=(me.y/t+1)/2,ie.push(ye.x,ye.y);z+=he}for(x=0;x<i;x++){var Ee=x*(n+1);for(A=0;A<n;A++){var Re=g=A+Ee,Ve=g+n+1,et=g+n+2,Fe=g+1;I.push(Re,Ve,Fe),I.push(Ve,et,Fe)}}this.setIndex(I),this.setAttribute("position",new on(Y,3)),this.setAttribute("normal",new on(Q,3)),this.setAttribute("uv",new on(ie,2))}function Fc(e,t,n,i){sr.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new Zl(e,t,n,i)),this.mergeVertices()}function Zl(e,t,n,i){Sn.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=vr.clamp(i,0,2*Math.PI);var l,d,g,x=[],A=[],I=[],Y=1/t,Q=new Oe,ie=new zt;for(d=0;d<=t;d++){var z=n+d*Y*i,he=Math.sin(z),me=Math.cos(z);for(g=0;g<=e.length-1;g++)Q.x=e[g].x*he,Q.y=e[g].y,Q.z=e[g].x*me,A.push(Q.x,Q.y,Q.z),ie.x=d/t,ie.y=g/(e.length-1),I.push(ie.x,ie.y)}for(d=0;d<t;d++)for(g=0;g<e.length-1;g++){var ye=l=g+d*e.length,Ee=l+e.length,Re=l+e.length+1,Ve=l+1;x.push(ye,Ee,Ve),x.push(Ee,Re,Ve)}if(this.setIndex(x),this.setAttribute("position",new on(A,3)),this.setAttribute("uv",new on(I,2)),this.computeVertexNormals(),i===2*Math.PI){var et=this.attributes.normal.array,Fe=new Oe,at=new Oe,Je=new Oe;for(l=t*e.length*3,g=d=0;d<e.length;d++,g+=3)Fe.x=et[g+0],Fe.y=et[g+1],Fe.z=et[g+2],at.x=et[l+g+0],at.y=et[l+g+1],at.z=et[l+g+2],Je.addVectors(Fe,at).normalize(),et[g+0]=et[l+g+0]=Je.x,et[g+1]=et[l+g+1]=Je.y,et[g+2]=et[l+g+2]=Je.z}}function Kl(e,t){sr.call(this),this.type="ShapeGeometry",typeof t=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ko(e,t)),this.mergeVertices()}function Ko(e,t){Sn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],l=[],d=[],g=0,x=0;if(Array.isArray(e)===!1)I(e);else for(var A=0;A<e.length;A++)I(e[A]),this.addGroup(g,x,A),g+=x,x=0;function I(Y){var Q,ie,z,he=i.length/3,me=Y.extractPoints(t),ye=me.shape,Ee=me.holes;for(us.isClockWise(ye)===!1&&(ye=ye.reverse()),Q=0,ie=Ee.length;Q<ie;Q++)z=Ee[Q],us.isClockWise(z)===!0&&(Ee[Q]=z.reverse());var Re=us.triangulateShape(ye,Ee);for(Q=0,ie=Ee.length;Q<ie;Q++)z=Ee[Q],ye=ye.concat(z);for(Q=0,ie=ye.length;Q<ie;Q++){var Ve=ye[Q];i.push(Ve.x,Ve.y,0),l.push(0,0,1),d.push(Ve.x,Ve.y)}for(Q=0,ie=Re.length;Q<ie;Q++){var et=Re[Q],Fe=et[0]+he,at=et[1]+he,Je=et[2]+he;n.push(Fe,at,Je),x+=3}}this.setIndex(n),this.setAttribute("position",new on(i,3)),this.setAttribute("normal",new on(l,3)),this.setAttribute("uv",new on(d,2))}function md(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var l=e[n];t.shapes.push(l.uuid)}else t.shapes.push(e.uuid);return t}function $l(e,t){Sn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1;var n,i,l,d,g=[],x=Math.cos(vr.DEG2RAD*t),A=[0,0],I={},Y=["a","b","c"];e.isBufferGeometry?(d=new sr).fromBufferGeometry(e):d=e.clone(),d.mergeVertices(),d.computeFaceNormals();for(var Q=d.vertices,ie=d.faces,z=0,he=ie.length;z<he;z++)for(var me=ie[z],ye=0;ye<3;ye++)n=me[Y[ye]],i=me[Y[(ye+1)%3]],A[0]=Math.min(n,i),A[1]=Math.max(n,i),I[l=A[0]+","+A[1]]===void 0?I[l]={index1:A[0],index2:A[1],face1:z,face2:void 0}:I[l].face2=z;for(l in I){var Ee=I[l];if(Ee.face2===void 0||ie[Ee.face1].normal.dot(ie[Ee.face2].normal)<=x){var Re=Q[Ee.index1];g.push(Re.x,Re.y,Re.z),Re=Q[Ee.index2],g.push(Re.x,Re.y,Re.z)}}this.setAttribute("position",new on(g,3))}function dl(e,t,n,i,l,d,g,x){sr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:l,openEnded:d,thetaStart:g,thetaLength:x},this.fromBufferGeometry(new Ls(e,t,n,i,l,d,g,x)),this.mergeVertices()}function Ls(e,t,n,i,l,d,g,x){Sn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:l,openEnded:d,thetaStart:g,thetaLength:x};var A=this;e=e!==void 0?e:1,t=t!==void 0?t:1,n=n||1,i=Math.floor(i)||8,l=Math.floor(l)||1,d=d!==void 0&&d,g=g!==void 0?g:0,x=x!==void 0?x:2*Math.PI;var I=[],Y=[],Q=[],ie=[],z=0,he=[],me=n/2,ye=0;function Ee(Re){var Ve,et,Fe,at=new zt,Je=new Oe,xt=0,_t=Re===!0?e:t,Pt=Re===!0?1:-1;for(et=z,Ve=1;Ve<=i;Ve++)Y.push(0,me*Pt,0),Q.push(0,Pt,0),ie.push(.5,.5),z++;for(Fe=z,Ve=0;Ve<=i;Ve++){var Ot=Ve/i*x+g,Gt=Math.cos(Ot),Kt=Math.sin(Ot);Je.x=_t*Kt,Je.y=me*Pt,Je.z=_t*Gt,Y.push(Je.x,Je.y,Je.z),Q.push(0,Pt,0),at.x=.5*Gt+.5,at.y=.5*Kt*Pt+.5,ie.push(at.x,at.y),z++}for(Ve=0;Ve<i;Ve++){var Dt=et+Ve,Mt=Fe+Ve;Re===!0?I.push(Mt,Mt+1,Dt):I.push(Mt+1,Mt,Dt),xt+=3}A.addGroup(ye,xt,Re===!0?1:2),ye+=xt}(function(){var Re,Ve,et=new Oe,Fe=new Oe,at=0,Je=(t-e)/n;for(Ve=0;Ve<=l;Ve++){var xt=[],_t=Ve/l,Pt=_t*(t-e)+e;for(Re=0;Re<=i;Re++){var Ot=Re/i,Gt=Ot*x+g,Kt=Math.sin(Gt),Dt=Math.cos(Gt);Fe.x=Pt*Kt,Fe.y=-_t*n+me,Fe.z=Pt*Dt,Y.push(Fe.x,Fe.y,Fe.z),et.set(Kt,Je,Dt).normalize(),Q.push(et.x,et.y,et.z),ie.push(Ot,1-_t),xt.push(z++)}he.push(xt)}for(Re=0;Re<i;Re++)for(Ve=0;Ve<l;Ve++){var Mt=he[Ve][Re],dn=he[Ve+1][Re],Mn=he[Ve+1][Re+1],Zn=he[Ve][Re+1];I.push(Mt,dn,Zn),I.push(dn,Mn,Zn),at+=6}A.addGroup(ye,at,0),ye+=at})(),d===!1&&(0<e&&Ee(!0),0<t&&Ee(!1)),this.setIndex(I),this.setAttribute("position",new on(Y,3)),this.setAttribute("normal",new on(Q,3)),this.setAttribute("uv",new on(ie,2))}function Hu(e,t,n,i,l,d,g){dl.call(this,0,e,t,n,i,l,d,g),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:l,thetaStart:d,thetaLength:g}}function Wu(e,t,n,i,l,d,g){Ls.call(this,0,e,t,n,i,l,d,g),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:l,thetaStart:d,thetaLength:g}}function Ju(e,t,n,i){sr.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Vc(e,t,n,i)),this.mergeVertices()}function Vc(e,t,n,i){Sn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=t!==void 0?Math.max(3,t):8,n=n!==void 0?n:0,i=i!==void 0?i:2*Math.PI;var l,d,g=[],x=[],A=[],I=[],Y=new Oe,Q=new zt;for(x.push(0,0,0),A.push(0,0,1),I.push(.5,.5),d=0,l=3;d<=t;d++,l+=3){var ie=n+d/t*i;Y.x=e*Math.cos(ie),Y.y=e*Math.sin(ie),x.push(Y.x,Y.y,Y.z),A.push(0,0,1),Q.x=(x[l]/e+1)/2,Q.y=(x[l+1]/e+1)/2,I.push(Q.x,Q.y)}for(l=1;l<=t;l++)g.push(l,l+1,0);this.setIndex(g),this.setAttribute("position",new on(x,3)),this.setAttribute("normal",new on(A,3)),this.setAttribute("uv",new on(I,2))}(Ui.prototype=Object.create(sr.prototype)).constructor=Ui,(pa.prototype=Object.create(Rs.prototype)).constructor=pa,(zu.prototype=Object.create(sr.prototype)).constructor=zu,(hl.prototype=Object.create(Sn.prototype)).constructor=hl,(Uu.prototype=Object.create(sr.prototype)).constructor=Uu,(Bc.prototype=Object.create(Sn.prototype)).constructor=Bc,(Fc.prototype=Object.create(sr.prototype)).constructor=Fc,(Zl.prototype=Object.create(Sn.prototype)).constructor=Zl,((Kl.prototype=Object.create(sr.prototype)).constructor=Kl).prototype.toJSON=function(){var e=sr.prototype.toJSON.call(this);return md(this.parameters.shapes,e)},((Ko.prototype=Object.create(Sn.prototype)).constructor=Ko).prototype.toJSON=function(){var e=Sn.prototype.toJSON.call(this);return md(this.parameters.shapes,e)},($l.prototype=Object.create(Sn.prototype)).constructor=$l,(dl.prototype=Object.create(sr.prototype)).constructor=dl,(Ls.prototype=Object.create(Sn.prototype)).constructor=Ls,(Hu.prototype=Object.create(dl.prototype)).constructor=Hu,(Wu.prototype=Object.create(Ls.prototype)).constructor=Wu,(Ju.prototype=Object.create(sr.prototype)).constructor=Ju,(Vc.prototype=Object.create(Sn.prototype)).constructor=Vc;var Va=Object.freeze({__proto__:null,WireframeGeometry:Pc,ParametricGeometry:Ka,ParametricBufferGeometry:Oc,TetrahedronGeometry:yr,TetrahedronBufferGeometry:Ac,OctahedronGeometry:Sa,OctahedronBufferGeometry:mi,IcosahedronGeometry:Ro,IcosahedronBufferGeometry:Rc,DodecahedronGeometry:Wl,DodecahedronBufferGeometry:po,PolyhedronGeometry:Fu,PolyhedronBufferGeometry:ra,TubeGeometry:Lc,TubeBufferGeometry:Os,TorusKnotGeometry:gi,TorusKnotBufferGeometry:yi,TorusGeometry:Ic,TorusBufferGeometry:Jl,TextGeometry:Ui,TextBufferGeometry:pa,SphereGeometry:zu,SphereBufferGeometry:hl,RingGeometry:Uu,RingBufferGeometry:Bc,PlaneGeometry:Rl,PlaneBufferGeometry:Qs,LatheGeometry:Fc,LatheBufferGeometry:Zl,ShapeGeometry:Kl,ShapeBufferGeometry:Ko,ExtrudeGeometry:ul,ExtrudeBufferGeometry:Rs,EdgesGeometry:$l,ConeGeometry:Hu,ConeBufferGeometry:Wu,CylinderGeometry:dl,CylinderBufferGeometry:Ls,CircleGeometry:Ju,CircleBufferGeometry:Vc,BoxGeometry:oh,BoxBufferGeometry:lc});function pl(e){kt.call(this),this.type="ShadowMaterial",this.color=new Qe(0),this.transparent=!0,this.setValues(e)}function Is(e){Xa.call(this,e),this.type="RawShaderMaterial"}function hs(e){kt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Qe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Gc(e){hs.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new zt(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}function ks(e){kt.call(this),this.type="MeshPhongMaterial",this.color=new Qe(16777215),this.specular=new Qe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function zc(e){kt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Qe(16777215),this.specular=new Qe(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Uc(e){kt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function fa(e){kt.call(this),this.type="MeshLambertMaterial",this.color=new Qe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function fl(e){kt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Qe(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Hc(e){ki.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}((pl.prototype=Object.create(kt.prototype)).constructor=pl).prototype.isShadowMaterial=!0,pl.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this},((Is.prototype=Object.create(Xa.prototype)).constructor=Is).prototype.isRawShaderMaterial=!0,((hs.prototype=Object.create(kt.prototype)).constructor=hs).prototype.isMeshStandardMaterial=!0,hs.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Gc.prototype=Object.create(hs.prototype)).constructor=Gc).prototype.isMeshPhysicalMaterial=!0,Gc.prototype.copy=function(e){return hs.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new Qe).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this},((ks.prototype=Object.create(kt.prototype)).constructor=ks).prototype.isMeshPhongMaterial=!0,ks.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((zc.prototype=Object.create(kt.prototype)).constructor=zc).prototype.isMeshToonMaterial=!0,zc.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Uc.prototype=Object.create(kt.prototype)).constructor=Uc).prototype.isMeshNormalMaterial=!0,Uc.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((fa.prototype=Object.create(kt.prototype)).constructor=fa).prototype.isMeshLambertMaterial=!0,fa.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((fl.prototype=Object.create(kt.prototype)).constructor=fl).prototype.isMeshMatcapMaterial=!0,fl.prototype.copy=function(e){return kt.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Hc.prototype=Object.create(ki.prototype)).constructor=Hc).prototype.isLineDashedMaterial=!0,Hc.prototype.copy=function(e){return ki.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var $d=Object.freeze({__proto__:null,ShadowMaterial:pl,SpriteMaterial:al,RawShaderMaterial:Is,ShaderMaterial:Xa,PointsMaterial:Zo,MeshPhysicalMaterial:Gc,MeshStandardMaterial:hs,MeshPhongMaterial:ks,MeshToonMaterial:zc,MeshNormalMaterial:Uc,MeshLambertMaterial:fa,MeshDepthMaterial:qo,MeshDistanceMaterial:nl,MeshBasicMaterial:Mr,MeshMatcapMaterial:fl,LineDashedMaterial:Hc,LineBasicMaterial:ki,Material:kt}),Di={arraySlice:function(e,t,n){return Di.isTypedArray(e)?new e.constructor(e.subarray(t,n!==void 0?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),i=0;i!==t;++i)n[i]=i;return n.sort(function(l,d){return e[l]-e[d]}),n},sortedArray:function(e,t,n){for(var i=e.length,l=new e.constructor(i),d=0,g=0;g!==i;++d)for(var x=n[d]*t,A=0;A!==t;++A)l[g++]=e[x+A];return l},flattenJSON:function(e,t,n,i){for(var l=1,d=e[0];d!==void 0&&d[i]===void 0;)d=e[l++];if(d!==void 0){var g=d[i];if(g!==void 0)if(Array.isArray(g))for(;(g=d[i])!==void 0&&(t.push(d.time),n.push.apply(n,g)),(d=e[l++])!==void 0;);else if(g.toArray!==void 0)for(;(g=d[i])!==void 0&&(t.push(d.time),g.toArray(n,n.length)),(d=e[l++])!==void 0;);else for(;(g=d[i])!==void 0&&(t.push(d.time),n.push(g)),(d=e[l++])!==void 0;);}},subclip:function(e,t,n,i,l){l=l||30;var d=e.clone();d.name=t;for(var g=[],x=0;x<d.tracks.length;++x){for(var A=d.tracks[x],I=A.getValueSize(),Y=[],Q=[],ie=0;ie<A.times.length;++ie){var z=A.times[ie]*l;if(!(z<n||i<=z)){Y.push(A.times[ie]);for(var he=0;he<I;++he)Q.push(A.values[ie*I+he])}}Y.length!==0&&(A.times=Di.convertArray(Y,A.times.constructor),A.values=Di.convertArray(Q,A.values.constructor),g.push(A))}d.tracks=g;var me=1/0;for(x=0;x<d.tracks.length;++x)me>d.tracks[x].times[0]&&(me=d.tracks[x].times[0]);for(x=0;x<d.tracks.length;++x)d.tracks[x].shift(-1*me);return d.resetDuration(),d}};function Ga(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function qu(e,t,n,i){Ga.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Wc(e,t,n,i){Ga.call(this,e,t,n,i)}function Xu(e,t,n,i){Ga.call(this,e,t,n,i)}function ma(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Di.convertArray(t,this.TimeBufferType),this.values=Di.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function Yu(e,t,n){ma.call(this,e,t,n)}function Zu(e,t,n,i){ma.call(this,e,t,n,i)}function js(e,t,n,i){ma.call(this,e,t,n,i)}function Ql(e,t,n,i){Ga.call(this,e,t,n,i)}function ml(e,t,n,i){ma.call(this,e,t,n,i)}function Ku(e,t,n,i){ma.call(this,e,t,n,i)}function ec(e,t,n,i){ma.call(this,e,t,n,i)}function Mo(e,t,n){this.name=e,this.tracks=n,this.duration=t!==void 0?t:-1,this.uuid=vr.generateUUID(),this.duration<0&&this.resetDuration()}function Qd(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return js;case"vector":case"vector2":case"vector3":case"vector4":return ec;case"color":return Zu;case"quaternion":return ml;case"bool":case"boolean":return Yu;case"string":return Ku}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}(e.type);if(e.times===void 0){var n=[],i=[];Di.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Ga.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],l=t[n-1];e:{t:{var d;n:{a:if(!(e<i)){for(var g=n+2;;){if(i===void 0){if(e<l)break a;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,l)}if(n===g)break;if(l=i,e<(i=t[++n]))break t}d=t.length;break n}if(l<=e)break e;var x=t[1];for(e<x&&(n=2,l=x),g=n-2;;){if(l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===g)break;if(i=l,(l=t[--n-1])<=e)break t}d=n,n=0}for(;n<d;){var A=n+d>>>1;e<t[A]?d=A:n=1+A}if(i=t[n],(l=t[n-1])===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,l,e)}this._cachedIndex=n,this.intervalChanged_(n,l,i)}return this.interpolate_(n,l,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,l=e*i,d=0;d!==i;++d)t[d]=n[l+d];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ga.prototype,{beforeStart_:Ga.prototype.copySampleValue_,afterEnd_:Ga.prototype.copySampleValue_}),qu.prototype=Object.assign(Object.create(Ga.prototype),{constructor:qu,DefaultSettings_:{endingStart:Ce,endingEnd:Ce},intervalChanged_:function(e,t,n){var i=this.parameterPositions,l=e-2,d=e+1,g=i[l],x=i[d];if(g===void 0)switch(this.getSettings_().endingStart){case ue:l=e,g=2*t-n;break;case Te:g=t+i[l=i.length-2]-i[l+1];break;default:l=e,g=n}if(x===void 0)switch(this.getSettings_().endingEnd){case ue:d=e,x=2*n-t;break;case Te:x=n+i[d=1]-i[0];break;default:d=e-1,x=t}var A=.5*(n-t),I=this.valueSize;this._weightPrev=A/(t-g),this._weightNext=A/(x-n),this._offsetPrev=l*I,this._offsetNext=d*I},interpolate_:function(e,t,n,i){for(var l=this.resultBuffer,d=this.sampleValues,g=this.valueSize,x=e*g,A=x-g,I=this._offsetPrev,Y=this._offsetNext,Q=this._weightPrev,ie=this._weightNext,z=(n-t)/(i-t),he=z*z,me=he*z,ye=-Q*me+2*Q*he-Q*z,Ee=(1+Q)*me+(-1.5-2*Q)*he+(-.5+Q)*z+1,Re=(-1-ie)*me+(1.5+ie)*he+.5*z,Ve=ie*me-ie*he,et=0;et!==g;++et)l[et]=ye*d[I+et]+Ee*d[A+et]+Re*d[x+et]+Ve*d[Y+et];return l}}),Wc.prototype=Object.assign(Object.create(Ga.prototype),{constructor:Wc,interpolate_:function(e,t,n,i){for(var l=this.resultBuffer,d=this.sampleValues,g=this.valueSize,x=e*g,A=x-g,I=(n-t)/(i-t),Y=1-I,Q=0;Q!==g;++Q)l[Q]=d[A+Q]*Y+d[x+Q]*I;return l}}),Xu.prototype=Object.assign(Object.create(Ga.prototype),{constructor:Xu,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(ma,{toJSON:function(e){var t,n=e.constructor;if(n.toJSON!==void 0)t=n.toJSON(e);else{t={name:e.name,times:Di.convertArray(e.times,Array),values:Di.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t}}),Object.assign(ma.prototype,{constructor:ma,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:K,InterpolantFactoryMethodDiscrete:function(e){return new Xu(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Wc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new qu(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case jr:t=this.InterpolantFactoryMethodDiscrete;break;case K:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(t!==void 0)return this.createInterpolant=t,this;var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jr;case this.InterpolantFactoryMethodLinear:return K;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(e!==1)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,l=0,d=i-1;l!==i&&n[l]<e;)++l;for(;d!==-1&&n[d]>t;)--d;if(++d,l!==0||d!==i){d<=l&&(l=(d=Math.max(d,1))-1);var g=this.getValueSize();this.times=Di.arraySlice(n,l,d),this.values=Di.arraySlice(this.values,l*g,d*g)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,l=n.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var d=null,g=0;g!==l;g++){var x=n[g];if(typeof x=="number"&&isNaN(x)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,g,x),e=!1;break}if(d!==null&&x<d){console.error("THREE.KeyframeTrack: Out of order keys.",this,g,x,d),e=!1;break}d=x}if(i!==void 0&&Di.isTypedArray(i)){g=0;for(var A=i.length;g!==A;++g){var I=i[g];if(isNaN(I)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,g,I),e=!1;break}}}return e},optimize:function(){for(var e=Di.arraySlice(this.times),t=Di.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===2302,l=1,d=e.length-1,g=1;g<d;++g){var x=!1,A=e[g];if(A!==e[g+1]&&(g!==1||A!==A[0]))if(i)x=!0;else for(var I=g*n,Y=I-n,Q=I+n,ie=0;ie!==n;++ie){var z=t[I+ie];if(z!==t[Y+ie]||z!==t[Q+ie]){x=!0;break}}if(x){if(g!==l){e[l]=e[g];var he=g*n,me=l*n;for(ie=0;ie!==n;++ie)t[me+ie]=t[he+ie]}++l}}if(0<d){for(e[l]=e[d],he=d*n,me=l*n,ie=0;ie!==n;++ie)t[me+ie]=t[he+ie];++l}return l!==e.length?(this.times=Di.arraySlice(e,0,l),this.values=Di.arraySlice(t,0,l*n)):(this.times=e,this.values=t),this},clone:function(){var e=Di.arraySlice(this.times,0),t=Di.arraySlice(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Yu.prototype=Object.assign(Object.create(ma.prototype),{constructor:Yu,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:jr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Zu.prototype=Object.assign(Object.create(ma.prototype),{constructor:Zu,ValueTypeName:"color"}),js.prototype=Object.assign(Object.create(ma.prototype),{constructor:js,ValueTypeName:"number"}),Ql.prototype=Object.assign(Object.create(Ga.prototype),{constructor:Ql,interpolate_:function(e,t,n,i){for(var l=this.resultBuffer,d=this.sampleValues,g=this.valueSize,x=e*g,A=(n-t)/(i-t),I=x+g;x!==I;x+=4)Bi.slerpFlat(l,0,d,x-g,d,x,A);return l}}),ml.prototype=Object.assign(Object.create(ma.prototype),{constructor:ml,ValueTypeName:"quaternion",DefaultInterpolation:K,InterpolantFactoryMethodLinear:function(e){return new Ql(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ku.prototype=Object.assign(Object.create(ma.prototype),{constructor:Ku,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:jr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ec.prototype=Object.assign(Object.create(ma.prototype),{constructor:ec,ValueTypeName:"vector"}),Object.assign(Mo,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),l=0,d=n.length;l!==d;++l)t.push(Qd(n[l]).scale(i));return new Mo(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},l=0,d=n.length;l!==d;++l)t.push(ma.toJSON(n[l]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var l=t.length,d=[],g=0;g<l;g++){var x=[],A=[];x.push((g+l-1)%l,g,(g+1)%l),A.push(0,1,0);var I=Di.getKeyframeOrder(x);x=Di.sortedArray(x,1,I),A=Di.sortedArray(A,1,I),i||x[0]!==0||(x.push(l),A.push(A[0])),d.push(new js(".morphTargetInfluences["+t[g].name+"]",x,A).scale(1/n))}return new Mo(e,-1,d)},findByName:function(e,t){var n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},l=/^([\w-]*?)([\d]+)$/,d=0,g=e.length;d<g;d++){var x=e[d],A=x.name.match(l);if(A&&1<A.length){var I=i[Q=A[1]];I||(i[Q]=I=[]),I.push(x)}}var Y=[];for(var Q in i)Y.push(Mo.CreateFromMorphTargetSequence(Q,i[Q],t,n));return Y},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(Re,Ve,et,Fe,at){if(et.length!==0){var Je=[],xt=[];Di.flattenJSON(et,Je,xt,Fe),Je.length!==0&&at.push(new Re(Ve,Je,xt))}},i=[],l=e.name||"default",d=e.length||-1,g=e.fps||30,x=e.hierarchy||[],A=0;A<x.length;A++){var I=x[A].keys;if(I&&I.length!==0)if(I[0].morphTargets){for(var Y={},Q=0;Q<I.length;Q++)if(I[Q].morphTargets)for(var ie=0;ie<I[Q].morphTargets.length;ie++)Y[I[Q].morphTargets[ie]]=-1;for(var z in Y){var he=[],me=[];for(ie=0;ie!==I[Q].morphTargets.length;++ie){var ye=I[Q];he.push(ye.time),me.push(ye.morphTarget===z?1:0)}i.push(new js(".morphTargetInfluence["+z+"]",he,me))}d=Y.length*(g||1)}else{var Ee=".bones["+t[A].name+"]";n(ec,Ee+".position",I,"pos",i),n(ml,Ee+".quaternion",I,"rot",i),n(ec,Ee+".scale",I,"scl",i)}}return i.length===0?null:new Mo(l,d,i)}}),Object.assign(Mo.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Mo(this.name,this.duration,e)}});var gl={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Bh(e,t,n){var i=this,l=!1,d=0,g=0,x=void 0,A=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(I){g++,l===!1&&i.onStart!==void 0&&i.onStart(I,d,g),l=!0},this.itemEnd=function(I){d++,i.onProgress!==void 0&&i.onProgress(I,d,g),d===g&&(l=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(I){i.onError!==void 0&&i.onError(I)},this.resolveURL=function(I){return x?x(I):I},this.setURLModifier=function(I){return x=I,this},this.addHandler=function(I,Y){return A.push(I,Y),this},this.removeHandler=function(I){var Y=A.indexOf(I);return Y!==-1&&A.splice(Y,2),this},this.getHandler=function(I){for(var Y=0,Q=A.length;Y<Q;Y+=2){var ie=A[Y],z=A[Y+1];if(ie.global&&(ie.lastIndex=0),ie.test(I))return z}return null}}var gd=new Bh;function s(e){this.manager=e!==void 0?e:gd,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(s.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var p={};function P(e){s.call(this,e)}function ae(e){s.call(this,e)}function pe(e){s.call(this,e)}function Pe(e){s.call(this,e)}function Xe(e){s.call(this,e)}function it(e){s.call(this,e)}function wt(e){s.call(this,e)}function gt(){this.type="Curve",this.arcLengthDivisions=200}function Nt(e,t,n,i,l,d,g,x){gt.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=l||0,this.aEndAngle=d||2*Math.PI,this.aClockwise=g||!1,this.aRotation=x||0}function Qt(e,t,n,i,l,d){Nt.call(this,e,t,n,n,i,l,d),this.type="ArcCurve"}function On(){var e=0,t=0,n=0,i=0;function l(d,g,x,A){n=-3*(e=d)+3*g-2*(t=x)-A,i=2*d-2*g+x+A}return{initCatmullRom:function(d,g,x,A,I){l(g,x,I*(x-d),I*(A-g))},initNonuniformCatmullRom:function(d,g,x,A,I,Y,Q){var ie=(g-d)/I-(x-d)/(I+Y)+(x-g)/Y,z=(x-g)/Y-(A-g)/(Y+Q)+(A-x)/Q;l(g,x,ie*=Y,z*=Y)},calc:function(d){var g=d*d;return e+t*d+n*g+i*(g*d)}}}P.prototype=Object.assign(Object.create(s.prototype),{constructor:P,load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,d=gl.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(d),l.manager.itemEnd(e)},0),d;if(p[e]===void 0){var g=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){var x=g[1],A=!!g[2],I=g[3];I=decodeURIComponent(I),A&&(I=atob(I));try{var Y,Q=(this.responseType||"").toLowerCase();switch(Q){case"arraybuffer":case"blob":for(var ie=new Uint8Array(I.length),z=0;z<I.length;z++)ie[z]=I.charCodeAt(z);Y=Q==="blob"?new Blob([ie.buffer],{type:x}):ie.buffer;break;case"document":var he=new DOMParser;Y=he.parseFromString(I,x);break;case"json":Y=JSON.parse(I);break;default:Y=I}setTimeout(function(){t&&t(Y),l.manager.itemEnd(e)},0)}catch(Ee){setTimeout(function(){i&&i(Ee),l.manager.itemError(e),l.manager.itemEnd(e)},0)}}else{p[e]=[],p[e].push({onLoad:t,onProgress:n,onError:i});var me=new XMLHttpRequest;for(var ye in me.open("GET",e,!0),me.addEventListener("load",function(Ee){var Re=this.response,Ve=p[e];if(delete p[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),gl.add(e,Re);for(var et=0,Fe=Ve.length;et<Fe;et++)(at=Ve[et]).onLoad&&at.onLoad(Re);l.manager.itemEnd(e)}else{for(et=0,Fe=Ve.length;et<Fe;et++){var at;(at=Ve[et]).onError&&at.onError(Ee)}l.manager.itemError(e),l.manager.itemEnd(e)}},!1),me.addEventListener("progress",function(Ee){for(var Re=p[e],Ve=0,et=Re.length;Ve<et;Ve++){var Fe=Re[Ve];Fe.onProgress&&Fe.onProgress(Ee)}},!1),me.addEventListener("error",function(Ee){var Re=p[e];delete p[e];for(var Ve=0,et=Re.length;Ve<et;Ve++){var Fe=Re[Ve];Fe.onError&&Fe.onError(Ee)}l.manager.itemError(e),l.manager.itemEnd(e)},!1),me.addEventListener("abort",function(Ee){var Re=p[e];delete p[e];for(var Ve=0,et=Re.length;Ve<et;Ve++){var Fe=Re[Ve];Fe.onError&&Fe.onError(Ee)}l.manager.itemError(e),l.manager.itemEnd(e)},!1),this.responseType!==void 0&&(me.responseType=this.responseType),this.withCredentials!==void 0&&(me.withCredentials=this.withCredentials),me.overrideMimeType&&me.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain"),this.requestHeader)me.setRequestHeader(ye,this.requestHeader[ye]);me.send(null)}return l.manager.itemStart(e),me}p[e].push({onLoad:t,onProgress:n,onError:i})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),ae.prototype=Object.assign(Object.create(s.prototype),{constructor:ae,load:function(e,t,n,i){var l=this,d=new P(l.manager);d.setPath(l.path),d.load(e,function(g){t(l.parse(JSON.parse(g)))},n,i)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var i=Mo.parse(e[n]);t.push(i)}return t}}),pe.prototype=Object.assign(Object.create(s.prototype),{constructor:pe,load:function(e,t,n,i){var l=this,d=[],g=new Nu;g.image=d;var x=new P(this.manager);function A(ie){x.load(e[ie],function(z){var he=l.parse(z,!0);d[ie]={width:he.width,height:he.height,format:he.format,mipmaps:he.mipmaps},(I+=1)===6&&(he.mipmapCount===1&&(g.minFilter=xn),g.format=he.format,g.needsUpdate=!0,t&&t(g))},n,i)}if(x.setPath(this.path),x.setResponseType("arraybuffer"),Array.isArray(e))for(var I=0,Y=0,Q=e.length;Y<Q;++Y)A(Y);else x.load(e,function(ie){var z=l.parse(ie,!0);if(z.isCubemap)for(var he=z.mipmaps.length/z.mipmapCount,me=0;me<he;me++){d[me]={mipmaps:[]};for(var ye=0;ye<z.mipmapCount;ye++)d[me].mipmaps.push(z.mipmaps[me*z.mipmapCount+ye]),d[me].format=z.format,d[me].width=z.width,d[me].height=z.height}else g.image.width=z.width,g.image.height=z.height,g.mipmaps=z.mipmaps;z.mipmapCount===1&&(g.minFilter=xn),g.format=z.format,g.needsUpdate=!0,t&&t(g)},n,i);return g}}),Pe.prototype=Object.assign(Object.create(s.prototype),{constructor:Pe,load:function(e,t,n,i){var l=this,d=new Al,g=new P(this.manager);return g.setResponseType("arraybuffer"),g.setPath(this.path),g.load(e,function(x){var A=l.parse(x);A&&(A.image!==void 0?d.image=A.image:A.data!==void 0&&(d.image.width=A.width,d.image.height=A.height,d.image.data=A.data),d.wrapS=A.wrapS!==void 0?A.wrapS:An,d.wrapT=A.wrapT!==void 0?A.wrapT:An,d.magFilter=A.magFilter!==void 0?A.magFilter:xn,d.minFilter=A.minFilter!==void 0?A.minFilter:xn,d.anisotropy=A.anisotropy!==void 0?A.anisotropy:1,A.format!==void 0&&(d.format=A.format),A.type!==void 0&&(d.type=A.type),A.mipmaps!==void 0&&(d.mipmaps=A.mipmaps,d.minFilter=er),A.mipmapCount===1&&(d.minFilter=xn),d.needsUpdate=!0,t&&t(d,A))},n,i),d}}),Xe.prototype=Object.assign(Object.create(s.prototype),{constructor:Xe,load:function(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,d=gl.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(d),l.manager.itemEnd(e)},0),d;var g=document.createElementNS("http://www.w3.org/1999/xhtml","img");function x(){g.removeEventListener("load",x,!1),g.removeEventListener("error",A,!1),gl.add(e,this),t&&t(this),l.manager.itemEnd(e)}function A(I){g.removeEventListener("load",x,!1),g.removeEventListener("error",A,!1),i&&i(I),l.manager.itemError(e),l.manager.itemEnd(e)}return g.addEventListener("load",x,!1),g.addEventListener("error",A,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(g.crossOrigin=this.crossOrigin),l.manager.itemStart(e),g.src=e,g}}),it.prototype=Object.assign(Object.create(s.prototype),{constructor:it,load:function(e,t,n,i){var l=new Ss,d=new Xe(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);var g=0;function x(I){d.load(e[I],function(Y){l.images[I]=Y,++g==6&&(l.needsUpdate=!0,t&&t(l))},void 0,i)}for(var A=0;A<e.length;++A)x(A);return l}}),wt.prototype=Object.assign(Object.create(s.prototype),{constructor:wt,load:function(e,t,n,i){var l=new Yr,d=new Xe(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(g){l.image=g;var x=0<e.search(/\.jpe?g($|\?)/i)||e.search(/^data\:image\/jpeg/)===0;l.format=x?Gr:Or,l.needsUpdate=!0,t!==void 0&&t(l)},n,i),l}}),Object.assign(gt.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],l=this.getPoint(0),d=0;for(i.push(0),n=1;n<=e;n++)d+=(t=this.getPoint(n/e)).distanceTo(l),i.push(d),l=t;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,i=this.getLengths(),l=0,d=i.length;n=t||e*i[d-1];for(var g,x=0,A=d-1;x<=A;)if((g=i[l=Math.floor(x+(A-x)/2)]-n)<0)x=l+1;else{if(!(0<g)){A=l;break}A=l-1}if(i[l=A]===n)return l/(d-1);var I=i[l];return(l+(n-I)/(i[l+1]-I))/(d-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),1<n&&(n=1);var i=this.getPoint(t);return this.getPoint(n).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,i,l,d=new Oe,g=[],x=[],A=[],I=new Oe,Y=new fr;for(n=0;n<=e;n++)i=n/e,g[n]=this.getTangentAt(i),g[n].normalize();x[0]=new Oe,A[0]=new Oe;var Q=Number.MAX_VALUE,ie=Math.abs(g[0].x),z=Math.abs(g[0].y),he=Math.abs(g[0].z);for(ie<=Q&&(Q=ie,d.set(1,0,0)),z<=Q&&(Q=z,d.set(0,1,0)),he<=Q&&d.set(0,0,1),I.crossVectors(g[0],d).normalize(),x[0].crossVectors(g[0],I),A[0].crossVectors(g[0],x[0]),n=1;n<=e;n++)x[n]=x[n-1].clone(),A[n]=A[n-1].clone(),I.crossVectors(g[n-1],g[n]),I.length()>Number.EPSILON&&(I.normalize(),l=Math.acos(vr.clamp(g[n-1].dot(g[n]),-1,1)),x[n].applyMatrix4(Y.makeRotationAxis(I,l))),A[n].crossVectors(g[n],x[n]);if(t===!0)for(l=Math.acos(vr.clamp(x[0].dot(x[e]),-1,1)),l/=e,0<g[0].dot(I.crossVectors(x[0],x[e]))&&(l=-l),n=1;n<=e;n++)x[n].applyMatrix4(Y.makeRotationAxis(g[n],l*n)),A[n].crossVectors(g[n],x[n]);return{tangents:g,normals:x,binormals:A}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),((Nt.prototype=Object.create(gt.prototype)).constructor=Nt).prototype.isEllipseCurve=!0,Nt.prototype.getPoint=function(e,t){for(var n=t||new zt,i=2*Math.PI,l=this.aEndAngle-this.aStartAngle,d=Math.abs(l)<Number.EPSILON;l<0;)l+=i;for(;i<l;)l-=i;l<Number.EPSILON&&(l=d?0:i),this.aClockwise!==!0||d||(l===i?l=-i:l-=i);var g=this.aStartAngle+e*l,x=this.aX+this.xRadius*Math.cos(g),A=this.aY+this.yRadius*Math.sin(g);if(this.aRotation!==0){var I=Math.cos(this.aRotation),Y=Math.sin(this.aRotation),Q=x-this.aX,ie=A-this.aY;x=Q*I-ie*Y+this.aX,A=Q*Y+ie*I+this.aY}return n.set(x,A)},Nt.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Nt.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Nt.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},((Qt.prototype=Object.create(Nt.prototype)).constructor=Qt).prototype.isArcCurve=!0;var jn=new Oe,Qn=new On,Ut=new On,sn=new On;function Nn(e,t,n,i){gt.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function wn(e,t,n,i,l){var d=.5*(i-t),g=.5*(l-n),x=e*e;return(2*n-2*i+d+g)*(e*x)+(-3*n+3*i-2*d-g)*x+d*e+n}function pr(e,t,n,i){return(g=1-e)*g*t+2*(1-(d=e))*d*n+(l=e)*l*i;var l,d,g}function lr(e,t,n,i,l){return(I=1-e)*I*I*t+3*(A=1-(x=e))*A*x*n+3*(1-(g=e))*g*g*i+(d=e)*d*d*l;var d,g,x,A,I}function Er(e,t,n,i){gt.call(this),this.type="CubicBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt,this.v3=i||new zt}function Bn(e,t,n,i){gt.call(this),this.type="CubicBezierCurve3",this.v0=e||new Oe,this.v1=t||new Oe,this.v2=n||new Oe,this.v3=i||new Oe}function zn(e,t){gt.call(this),this.type="LineCurve",this.v1=e||new zt,this.v2=t||new zt}function ui(e,t){gt.call(this),this.type="LineCurve3",this.v1=e||new Oe,this.v2=t||new Oe}function ri(e,t,n){gt.call(this),this.type="QuadraticBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt}function ji(e,t,n){gt.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Oe,this.v1=t||new Oe,this.v2=n||new Oe}function zr(e){gt.call(this),this.type="SplineCurve",this.points=e||[]}((Nn.prototype=Object.create(gt.prototype)).constructor=Nn).prototype.isCatmullRomCurve3=!0,Nn.prototype.getPoint=function(e,t){var n,i,l,d,g=t||new Oe,x=this.points,A=x.length,I=(A-(this.closed?0:1))*e,Y=Math.floor(I),Q=I-Y;if(this.closed?Y+=0<Y?0:(Math.floor(Math.abs(Y)/A)+1)*A:Q===0&&Y===A-1&&(Y=A-2,Q=1),n=this.closed||0<Y?x[(Y-1)%A]:(jn.subVectors(x[0],x[1]).add(x[0]),jn),i=x[Y%A],l=x[(Y+1)%A],d=this.closed||Y+2<A?x[(Y+2)%A]:(jn.subVectors(x[A-1],x[A-2]).add(x[A-1]),jn),this.curveType==="centripetal"||this.curveType==="chordal"){var ie=this.curveType==="chordal"?.5:.25,z=Math.pow(n.distanceToSquared(i),ie),he=Math.pow(i.distanceToSquared(l),ie),me=Math.pow(l.distanceToSquared(d),ie);he<1e-4&&(he=1),z<1e-4&&(z=he),me<1e-4&&(me=he),Qn.initNonuniformCatmullRom(n.x,i.x,l.x,d.x,z,he,me),Ut.initNonuniformCatmullRom(n.y,i.y,l.y,d.y,z,he,me),sn.initNonuniformCatmullRom(n.z,i.z,l.z,d.z,z,he,me)}else this.curveType==="catmullrom"&&(Qn.initCatmullRom(n.x,i.x,l.x,d.x,this.tension),Ut.initCatmullRom(n.y,i.y,l.y,d.y,this.tension),sn.initCatmullRom(n.z,i.z,l.z,d.z,this.tension));return g.set(Qn.calc(Q),Ut.calc(Q),sn.calc(Q)),g},Nn.prototype.copy=function(e){gt.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Nn.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Nn.prototype.fromJSON=function(e){gt.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new Oe().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},((Er.prototype=Object.create(gt.prototype)).constructor=Er).prototype.isCubicBezierCurve=!0,Er.prototype.getPoint=function(e,t){var n=t||new zt,i=this.v0,l=this.v1,d=this.v2,g=this.v3;return n.set(lr(e,i.x,l.x,d.x,g.x),lr(e,i.y,l.y,d.y,g.y)),n},Er.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Er.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Er.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((Bn.prototype=Object.create(gt.prototype)).constructor=Bn).prototype.isCubicBezierCurve3=!0,Bn.prototype.getPoint=function(e,t){var n=t||new Oe,i=this.v0,l=this.v1,d=this.v2,g=this.v3;return n.set(lr(e,i.x,l.x,d.x,g.x),lr(e,i.y,l.y,d.y,g.y),lr(e,i.z,l.z,d.z,g.z)),n},Bn.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Bn.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Bn.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((zn.prototype=Object.create(gt.prototype)).constructor=zn).prototype.isLineCurve=!0,zn.prototype.getPoint=function(e,t){var n=t||new zt;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},zn.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},zn.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},zn.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},zn.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},zn.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((ui.prototype=Object.create(gt.prototype)).constructor=ui).prototype.isLineCurve3=!0,ui.prototype.getPoint=function(e,t){var n=t||new Oe;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},ui.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ui.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ui.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ui.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((ri.prototype=Object.create(gt.prototype)).constructor=ri).prototype.isQuadraticBezierCurve=!0,ri.prototype.getPoint=function(e,t){var n=t||new zt,i=this.v0,l=this.v1,d=this.v2;return n.set(pr(e,i.x,l.x,d.x),pr(e,i.y,l.y,d.y)),n},ri.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ri.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ri.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((ji.prototype=Object.create(gt.prototype)).constructor=ji).prototype.isQuadraticBezierCurve3=!0,ji.prototype.getPoint=function(e,t){var n=t||new Oe,i=this.v0,l=this.v1,d=this.v2;return n.set(pr(e,i.x,l.x,d.x),pr(e,i.y,l.y,d.y),pr(e,i.z,l.z,d.z)),n},ji.prototype.copy=function(e){return gt.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ji.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ji.prototype.fromJSON=function(e){return gt.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((zr.prototype=Object.create(gt.prototype)).constructor=zr).prototype.isSplineCurve=!0,zr.prototype.getPoint=function(e,t){var n=t||new zt,i=this.points,l=(i.length-1)*e,d=Math.floor(l),g=l-d,x=i[d===0?d:d-1],A=i[d],I=i[d>i.length-2?i.length-1:d+1],Y=i[d>i.length-3?i.length-1:d+2];return n.set(wn(g,x.x,A.x,I.x,Y.x),wn(g,x.y,A.y,I.y,Y.y)),n},zr.prototype.copy=function(e){gt.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this},zr.prototype.toJSON=function(){var e=gt.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e},zr.prototype.fromJSON=function(e){gt.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new zt().fromArray(i))}return this};var ga=Object.freeze({__proto__:null,ArcCurve:Qt,CatmullRomCurve3:Nn,CubicBezierCurve:Er,CubicBezierCurve3:Bn,EllipseCurve:Nt,LineCurve:zn,LineCurve3:ui,QuadraticBezierCurve:ri,QuadraticBezierCurve3:ji,SplineCurve:zr});function ya(){gt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function va(e){ya.call(this),this.type="Path",this.currentPoint=new zt,e&&this.setFromPoints(e)}function $a(e){va.call(this,e),this.uuid=vr.generateUUID(),this.type="Shape",this.holes=[]}function Vr(e,t){At.call(this),this.type="Light",this.color=new Qe(e),this.intensity=t!==void 0?t:1,this.receiveShadow=void 0}function Jc(e,t,n){Vr.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(At.DefaultUp),this.updateMatrix(),this.groundColor=new Qe(t)}function Io(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new zt(512,512),this.map=null,this.mapPass=null,this.matrix=new fr,this._frustum=new $s,this._frameExtents=new zt(1,1),this._viewportCount=1,this._viewports=[new Jr(0,0,1,1)]}function yl(){Io.call(this,new Ii(50,1,.5,500))}function tc(e,t,n,i,l,d){Vr.call(this,e,t),this.type="SpotLight",this.position.copy(At.DefaultUp),this.updateMatrix(),this.target=new At,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(g){this.intensity=g/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=l!==void 0?l:0,this.decay=d!==void 0?d:1,this.shadow=new yl}function nc(){Io.call(this,new Ii(90,1,.5,500)),this._frameExtents=new zt(4,2),this._viewportCount=6,this._viewports=[new Jr(2,1,1,1),new Jr(0,1,1,1),new Jr(3,1,1,1),new Jr(1,1,1,1),new Jr(3,0,1,1),new Jr(1,0,1,1)],this._cubeDirections=[new Oe(1,0,0),new Oe(-1,0,0),new Oe(0,0,1),new Oe(0,0,-1),new Oe(0,1,0),new Oe(0,-1,0)],this._cubeUps=[new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,0,1),new Oe(0,0,-1)]}function vl(e,t,n,i){Vr.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(l){this.intensity=l/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=i!==void 0?i:1,this.shadow=new nc}function xl(e,t,n,i,l,d){Ao.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=t!==void 0?t:1,this.top=n!==void 0?n:1,this.bottom=i!==void 0?i:-1,this.near=l!==void 0?l:.1,this.far=d!==void 0?d:2e3,this.updateProjectionMatrix()}function wl(){Io.call(this,new xl(-5,5,5,-5,.5,500))}function bl(e,t){Vr.call(this,e,t),this.type="DirectionalLight",this.position.copy(At.DefaultUp),this.updateMatrix(),this.target=new At,this.shadow=new wl}function yd(e,t){Vr.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function vd(e,t,n,i){Vr.call(this,e,t),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=i!==void 0?i:10}function xd(e){s.call(this,e),this.textures={}}ya.prototype=Object.assign(Object.create(gt.prototype),{constructor:ya,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new zn(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var l=n[i]-t,d=this.curves[i],g=d.getLength(),x=g===0?0:1-l/g;return d.getPointAt(x)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],i=0,l=this.curves;i<l.length;i++)for(var d=l[i],g=d&&d.isEllipseCurve?2*e:d&&(d.isLineCurve||d.isLineCurve3)?1:d&&d.isSplineCurve?e*d.points.length:e,x=d.getPoints(g),A=0;A<x.length;A++){var I=x[A];t&&t.equals(I)||(n.push(I),t=I)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){gt.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=gt.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){gt.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(new ga[i.type]().fromJSON(i))}return this}}),va.prototype=Object.assign(Object.create(ya.prototype),{constructor:va,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new zn(this.currentPoint.clone(),new zt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,i){var l=new ri(this.currentPoint.clone(),new zt(e,t),new zt(n,i));return this.curves.push(l),this.currentPoint.set(n,i),this},bezierCurveTo:function(e,t,n,i,l,d){var g=new Er(this.currentPoint.clone(),new zt(e,t),new zt(n,i),new zt(l,d));return this.curves.push(g),this.currentPoint.set(l,d),this},splineThru:function(e){var t=new zr([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,i,l,d){var g=this.currentPoint.x,x=this.currentPoint.y;return this.absarc(e+g,t+x,n,i,l,d),this},absarc:function(e,t,n,i,l,d){return this.absellipse(e,t,n,n,i,l,d),this},ellipse:function(e,t,n,i,l,d,g,x){var A=this.currentPoint.x,I=this.currentPoint.y;return this.absellipse(e+A,t+I,n,i,l,d,g,x),this},absellipse:function(e,t,n,i,l,d,g,x){var A=new Nt(e,t,n,i,l,d,g,x);if(0<this.curves.length){var I=A.getPoint(0);I.equals(this.currentPoint)||this.lineTo(I.x,I.y)}this.curves.push(A);var Y=A.getPoint(1);return this.currentPoint.copy(Y),this},copy:function(e){return ya.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=ya.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return ya.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),$a.prototype=Object.assign(Object.create(va.prototype),{constructor:$a,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){va.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=va.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){va.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(new va().fromJSON(i))}return this}}),Vr.prototype=Object.assign(Object.create(At.prototype),{constructor:Vr,isLight:!0,copy:function(e){return At.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=At.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}),Jc.prototype=Object.assign(Object.create(Vr.prototype),{constructor:Jc,isHemisphereLight:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Io.prototype,{_projScreenMatrix:new fr,_lightPositionWorld:new Oe,_lookTarget:new Oe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,i=this._projScreenMatrix,l=this._lookTarget,d=this._lightPositionWorld;d.setFromMatrixPosition(e.matrixWorld),t.position.copy(d),l.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(l),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),yl.prototype=Object.assign(Object.create(Io.prototype),{constructor:yl,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*vr.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;n===t.fov&&i===t.aspect&&l===t.far||(t.fov=n,t.aspect=i,t.far=l,t.updateProjectionMatrix()),Io.prototype.updateMatrices.call(this,e)}}),tc.prototype=Object.assign(Object.create(Vr.prototype),{constructor:tc,isSpotLight:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),nc.prototype=Object.assign(Object.create(Io.prototype),{constructor:nc,isPointLightShadow:!0,updateMatrices:function(e,t){t===void 0&&(t=0);var n=this.camera,i=this.matrix,l=this._lightPositionWorld,d=this._lookTarget,g=this._projScreenMatrix;l.setFromMatrixPosition(e.matrixWorld),n.position.copy(l),d.copy(n.position),d.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(d),n.updateMatrixWorld(),i.makeTranslation(-l.x,-l.y,-l.z),g.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g)}}),vl.prototype=Object.assign(Object.create(Vr.prototype),{constructor:vl,isPointLight:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),xl.prototype=Object.assign(Object.create(Ao.prototype),{constructor:xl,isOrthographicCamera:!0,copy:function(e,t){return Ao.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,l,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,l=n-e,d=n+e,g=i+t,x=i-t;if(this.view!==null&&this.view.enabled){var A=(this.right-this.left)/this.view.fullWidth/this.zoom,I=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d=(l+=A*this.view.offsetX)+A*this.view.width,x=(g-=I*this.view.offsetY)-I*this.view.height}this.projectionMatrix.makeOrthographic(l,d,g,x,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=At.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}),wl.prototype=Object.assign(Object.create(Io.prototype),{constructor:wl,isDirectionalLightShadow:!0,updateMatrices:function(e){Io.prototype.updateMatrices.call(this,e)}}),bl.prototype=Object.assign(Object.create(Vr.prototype),{constructor:bl,isDirectionalLight:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),yd.prototype=Object.assign(Object.create(Vr.prototype),{constructor:yd,isAmbientLight:!0}),vd.prototype=Object.assign(Object.create(Vr.prototype),{constructor:vd,isRectAreaLight:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Vr.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),xd.prototype=Object.assign(Object.create(s.prototype),{constructor:xd,load:function(e,t,n,i){var l=this,d=new P(l.manager);d.setPath(l.path),d.load(e,function(g){t(l.parse(JSON.parse(g)))},n,i)},parse:function(e){var t=this.textures;function n(A){return t[A]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",A),t[A]}var i=new $d[e.type];if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=new Qe().setHex(e.sheen)),e.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular.setHex(e.specular),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.vertexColors!==void 0&&(i.vertexColors=e.vertexColors),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(i.skinning=e.skinning),e.morphTargets!==void 0&&(i.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(i.morphNormals=e.morphNormals),e.dithering!==void 0&&(i.dithering=e.dithering),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.uniforms!==void 0)for(var l in e.uniforms){var d=e.uniforms[l];switch(i.uniforms[l]={},d.type){case"t":i.uniforms[l].value=n(d.value);break;case"c":i.uniforms[l].value=new Qe().setHex(d.value);break;case"v2":i.uniforms[l].value=new zt().fromArray(d.value);break;case"v3":i.uniforms[l].value=new Oe().fromArray(d.value);break;case"v4":i.uniforms[l].value=new Jr().fromArray(d.value);break;case"m3":i.uniforms[l].value=new Si().fromArray(d.value);case"m4":i.uniforms[l].value=new fr().fromArray(d.value);break;default:i.uniforms[l].value=d.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var g in e.extensions)i.extensions[g]=e.extensions[g];if(e.shading!==void 0&&(i.flatShading=e.shading===1),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){var x=e.normalScale;Array.isArray(x)===!1&&(x=[x,x]),i.normalScale=new zt().fromArray(x)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new zt().fromArray(e.clearcoatNormalScale)),i},setTextures:function(e){return this.textures=e,this}});var ep={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}};function wd(){Sn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function bd(e,t,n,i){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),en.call(this,e,t,n),this.meshPerAttribute=i||1}function Md(e){s.call(this,e)}wd.prototype=Object.assign(Object.create(Sn.prototype),{constructor:wd,isInstancedBufferGeometry:!0,copy:function(e){return Sn.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=Sn.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),bd.prototype=Object.assign(Object.create(en.prototype),{constructor:bd,isInstancedBufferAttribute:!0,copy:function(e){return en.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=en.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Md.prototype=Object.assign(Object.create(s.prototype),{constructor:Md,load:function(e,t,n,i){var l=this,d=new P(l.manager);d.setPath(l.path),d.load(e,function(g){t(l.parse(JSON.parse(g)))},n,i)},parse:function(e){var t=new(e.isInstancedBufferGeometry?wd:Sn),n=e.data.index;if(n!==void 0){var i=new tp[n.type](n.array);t.setIndex(new en(i,1))}var l=e.data.attributes;for(var d in l){var g=l[d],x=(i=new tp[g.type](g.array),new(g.isInstancedBufferAttribute?bd:en)(i,g.itemSize,g.normalized));g.name!==void 0&&(x.name=g.name),t.setAttribute(d,x)}var A=e.data.morphAttributes;if(A)for(var d in A){for(var I=A[d],Y=[],Q=0,ie=I.length;Q<ie;Q++)g=I[Q],x=new en(i=new tp[g.type](g.array),g.itemSize,g.normalized),g.name!==void 0&&(x.name=g.name),Y.push(x);t.morphAttributes[d]=Y}e.data.morphTargetsRelative&&(t.morphTargetsRelative=!0);var z=e.data.groups||e.data.drawcalls||e.data.offsets;if(z!==void 0){Q=0;for(var he=z.length;Q!==he;++Q){var me=z[Q];t.addGroup(me.start,me.count,me.materialIndex)}}var ye=e.data.boundingSphere;if(ye!==void 0){var Ee=new Oe;ye.center!==void 0&&Ee.fromArray(ye.center),t.boundingSphere=new Kr(Ee,ye.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var tp={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function _d(e){s.call(this,e)}_d.prototype=Object.assign(Object.create(s.prototype),{constructor:_d,load:function(e,t,n,i){var l=this,d=this.path===""?ep.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;var g=new P(l.manager);g.setPath(this.path),g.load(e,function(x){var A=null;try{A=JSON.parse(x)}catch(Y){return i!==void 0&&i(Y),void console.error("THREE:ObjectLoader: Can't parse "+e+".",Y.message)}var I=A.metadata;I!==void 0&&I.type!==void 0&&I.type.toLowerCase()!=="geometry"?l.parse(A,t):console.error("THREE.ObjectLoader: Can't load "+e)},n,i)},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),l=this.parseImages(e.images,function(){t!==void 0&&t(x)}),d=this.parseTextures(e.textures,l),g=this.parseMaterials(e.materials,d),x=this.parseObject(e.object,i,g);return e.animations&&(x.animations=this.parseAnimations(e.animations)),e.images!==void 0&&e.images.length!==0||t!==void 0&&t(x),x},parseShape:function(e){var t={};if(e!==void 0)for(var n=0,i=e.length;n<i;n++){var l=new $a().fromJSON(e[n]);t[l.uuid]=l}return t},parseGeometries:function(e,t){var n={};if(e!==void 0)for(var i=new Md,l=0,d=e.length;l<d;l++){var g,x=e[l];switch(x.type){case"PlaneGeometry":case"PlaneBufferGeometry":g=new Va[x.type](x.width,x.height,x.widthSegments,x.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":g=new Va[x.type](x.width,x.height,x.depth,x.widthSegments,x.heightSegments,x.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":g=new Va[x.type](x.radius,x.segments,x.thetaStart,x.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":g=new Va[x.type](x.radiusTop,x.radiusBottom,x.height,x.radialSegments,x.heightSegments,x.openEnded,x.thetaStart,x.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":g=new Va[x.type](x.radius,x.height,x.radialSegments,x.heightSegments,x.openEnded,x.thetaStart,x.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":g=new Va[x.type](x.radius,x.widthSegments,x.heightSegments,x.phiStart,x.phiLength,x.thetaStart,x.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":g=new Va[x.type](x.radius,x.detail);break;case"RingGeometry":case"RingBufferGeometry":g=new Va[x.type](x.innerRadius,x.outerRadius,x.thetaSegments,x.phiSegments,x.thetaStart,x.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":g=new Va[x.type](x.radius,x.tube,x.radialSegments,x.tubularSegments,x.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":g=new Va[x.type](x.radius,x.tube,x.tubularSegments,x.radialSegments,x.p,x.q);break;case"TubeGeometry":case"TubeBufferGeometry":g=new Va[x.type](new ga[x.path.type]().fromJSON(x.path),x.tubularSegments,x.radius,x.radialSegments,x.closed);break;case"LatheGeometry":case"LatheBufferGeometry":g=new Va[x.type](x.points,x.segments,x.phiStart,x.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":g=new Va[x.type](x.vertices,x.indices,x.radius,x.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var A=[],I=0,Y=x.shapes.length;I<Y;I++){var Q=t[x.shapes[I]];A.push(Q)}g=new Va[x.type](A,x.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(A=[],I=0,Y=x.shapes.length;I<Y;I++)Q=t[x.shapes[I]],A.push(Q);var ie=x.options.extrudePath;ie!==void 0&&(x.options.extrudePath=new ga[ie.type]().fromJSON(ie)),g=new Va[x.type](A,x.options);break;case"BufferGeometry":case"InstancedBufferGeometry":g=i.parse(x);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?g=new THREE.LegacyJSONLoader().parse(x,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+x.type+'"');continue}g.uuid=x.uuid,x.name!==void 0&&(g.name=x.name),g.isBufferGeometry===!0&&x.userData!==void 0&&(g.userData=x.userData),n[x.uuid]=g}return n},parseMaterials:function(e,t){var n={},i={};if(e!==void 0){var l=new xd;l.setTextures(t);for(var d=0,g=e.length;d<g;d++){var x=e[d];if(x.type==="MultiMaterial"){for(var A=[],I=0;I<x.materials.length;I++){var Y=x.materials[I];n[Y.uuid]===void 0&&(n[Y.uuid]=l.parse(Y)),A.push(n[Y.uuid])}i[x.uuid]=A}else n[x.uuid]===void 0&&(n[x.uuid]=l.parse(x)),i[x.uuid]=n[x.uuid]}}return i},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],l=Mo.parse(i);i.uuid!==void 0&&(l.uuid=i.uuid),t.push(l)}return t},parseImages:function(e,t){var n=this,i={};function l(he){return n.manager.itemStart(he),d.load(he,function(){n.manager.itemEnd(he)},void 0,function(){n.manager.itemError(he),n.manager.itemEnd(he)})}if(e!==void 0&&0<e.length){var d=new Xe(new Bh(t));d.setCrossOrigin(this.crossOrigin);for(var g=0,x=e.length;g<x;g++){var A=e[g],I=A.url;if(Array.isArray(I)){i[A.uuid]=[];for(var Y=0,Q=I.length;Y<Q;Y++){var ie=I[Y],z=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ie)?ie:n.resourcePath+ie;i[A.uuid].push(l(z))}}else z=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(A.url)?A.url:n.resourcePath+A.url,i[A.uuid]=l(z)}}return i},parseTextures:function(e,t){function n(A,I){return typeof A=="number"?A:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",A),I[A])}var i={};if(e!==void 0)for(var l=0,d=e.length;l<d;l++){var g,x=e[l];x.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',x.uuid),t[x.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",x.image),(g=new(Array.isArray(t[x.image])?Ss:Yr)(t[x.image])).needsUpdate=!0,g.uuid=x.uuid,x.name!==void 0&&(g.name=x.name),x.mapping!==void 0&&(g.mapping=n(x.mapping,Tf)),x.offset!==void 0&&g.offset.fromArray(x.offset),x.repeat!==void 0&&g.repeat.fromArray(x.repeat),x.center!==void 0&&g.center.fromArray(x.center),x.rotation!==void 0&&(g.rotation=x.rotation),x.wrap!==void 0&&(g.wrapS=n(x.wrap[0],jp),g.wrapT=n(x.wrap[1],jp)),x.format!==void 0&&(g.format=x.format),x.type!==void 0&&(g.type=x.type),x.encoding!==void 0&&(g.encoding=x.encoding),x.minFilter!==void 0&&(g.minFilter=n(x.minFilter,Np)),x.magFilter!==void 0&&(g.magFilter=n(x.magFilter,Np)),x.anisotropy!==void 0&&(g.anisotropy=x.anisotropy),x.flipY!==void 0&&(g.flipY=x.flipY),x.premultiplyAlpha!==void 0&&(g.premultiplyAlpha=x.premultiplyAlpha),x.unpackAlignment!==void 0&&(g.unpackAlignment=x.unpackAlignment),i[x.uuid]=g}return i},parseObject:function(e,t,n){var i;function l(ye){return t[ye]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",ye),t[ye]}function d(ye){if(ye!==void 0){if(Array.isArray(ye)){for(var Ee=[],Re=0,Ve=ye.length;Re<Ve;Re++){var et=ye[Re];n[et]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",et),Ee.push(n[et])}return Ee}return n[ye]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ye),n[ye]}}switch(e.type){case"Scene":i=new Hn,e.background!==void 0&&Number.isInteger(e.background)&&(i.background=new Qe(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?i.fog=new Xo(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(i.fog=new ho(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new Ii(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(i.focus=e.focus),e.zoom!==void 0&&(i.zoom=e.zoom),e.filmGauge!==void 0&&(i.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(i.filmOffset=e.filmOffset),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new xl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(i.zoom=e.zoom),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new yd(e.color,e.intensity);break;case"DirectionalLight":i=new bl(e.color,e.intensity);break;case"PointLight":i=new vl(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new vd(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new tc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Jc(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var g=l(e.geometry),x=d(e.material);i=new(g.bones&&0<g.bones.length?_c:_i)(g,x);break;case"InstancedMesh":g=l(e.geometry),x=d(e.material);var A=e.count,I=e.instanceMatrix;(i=new Pu(g,x,A)).instanceMatrix=new en(new Float32Array(I.array),16);break;case"LOD":i=new Mc;break;case"Line":i=new Ra(l(e.geometry),d(e.material),e.mode);break;case"LineLoop":i=new Sc(l(e.geometry),d(e.material));break;case"LineSegments":i=new fi(l(e.geometry),d(e.material));break;case"PointCloud":case"Points":i=new zl(l(e.geometry),d(e.material));break;case"Sprite":i=new bc(d(e.material));break;case"Group":i=new rl;break;default:i=new At}if(i.uuid=e.uuid,e.name!==void 0&&(i.name=e.name),e.matrix!==void 0?(i.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(e.position!==void 0&&i.position.fromArray(e.position),e.rotation!==void 0&&i.rotation.fromArray(e.rotation),e.quaternion!==void 0&&i.quaternion.fromArray(e.quaternion),e.scale!==void 0&&i.scale.fromArray(e.scale)),e.castShadow!==void 0&&(i.castShadow=e.castShadow),e.receiveShadow!==void 0&&(i.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(i.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(i.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&i.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(i.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(i.visible=e.visible),e.frustumCulled!==void 0&&(i.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(i.renderOrder=e.renderOrder),e.userData!==void 0&&(i.userData=e.userData),e.layers!==void 0&&(i.layers.mask=e.layers),e.children!==void 0)for(var Y=e.children,Q=0;Q<Y.length;Q++)i.add(this.parseObject(Y[Q],t,n));if(e.type==="LOD"){e.autoUpdate!==void 0&&(i.autoUpdate=e.autoUpdate);for(var ie=e.levels,z=0;z<ie.length;z++){var he=ie[z],me=i.getObjectByProperty("uuid",he.object);me!==void 0&&i.addLevel(me,he.distance)}}return i}});var Td,Tf={UVMapping:300,CubeReflectionMapping:It,CubeRefractionMapping:Bt,EquirectangularReflectionMapping:Ln,EquirectangularRefractionMapping:rn,SphericalReflectionMapping:Xn,CubeUVReflectionMapping:yt,CubeUVRefractionMapping:ze},jp={RepeatWrapping:Zt,ClampToEdgeWrapping:An,MirroredRepeatWrapping:Yn},Np={NearestFilter:pt,NearestMipmapNearestFilter:st,NearestMipmapLinearFilter:qt,LinearFilter:xn,LinearMipmapNearestFilter:nn,LinearMipmapLinearFilter:er};function np(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),s.call(this,e),this.options=void 0}function rp(){this.type="ShapePath",this.color=new Qe,this.subPaths=[],this.currentPath=null}function ip(e){this.type="Font",this.data=e}function Cf(e,t,n,i,l){var d=l.glyphs[e]||l.glyphs["?"];if(d){var g,x,A,I,Y,Q,ie,z,he=new rp;if(d.o)for(var me=d._cachedOutline||(d._cachedOutline=d.o.split(" ")),ye=0,Ee=me.length;ye<Ee;)switch(me[ye++]){case"m":g=me[ye++]*t+n,x=me[ye++]*t+i,he.moveTo(g,x);break;case"l":g=me[ye++]*t+n,x=me[ye++]*t+i,he.lineTo(g,x);break;case"q":A=me[ye++]*t+n,I=me[ye++]*t+i,Y=me[ye++]*t+n,Q=me[ye++]*t+i,he.quadraticCurveTo(Y,Q,A,I);break;case"b":A=me[ye++]*t+n,I=me[ye++]*t+i,Y=me[ye++]*t+n,Q=me[ye++]*t+i,ie=me[ye++]*t+n,z=me[ye++]*t+i,he.bezierCurveTo(Y,Q,ie,z,A,I)}return{offsetX:d.ha*t,path:he}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+l.familyName+".")}function ap(e){s.call(this,e)}np.prototype=Object.assign(Object.create(s.prototype),{constructor:np,setOptions:function(e){return this.options=e,this},load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var l=this,d=gl.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(d),l.manager.itemEnd(e)},0),d;fetch(e).then(function(g){return g.blob()}).then(function(g){return l.options===void 0?createImageBitmap(g):createImageBitmap(g,l.options)}).then(function(g){gl.add(e,g),t&&t(g),l.manager.itemEnd(e)}).catch(function(g){i&&i(g),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}),Object.assign(rp.prototype,{moveTo:function(e,t){return this.currentPath=new va,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this},bezierCurveTo:function(e,t,n,i,l,d){return this.currentPath.bezierCurveTo(e,t,n,i,l,d),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(Mt){for(var dn=[],Mn=0,Zn=Mt.length;Mn<Zn;Mn++){var qn=Mt[Mn],Vn=new $a;Vn.curves=qn.curves,dn.push(Vn)}return dn}function i(Mt,dn){for(var Mn=dn.length,Zn=!1,qn=Mn-1,Vn=0;Vn<Mn;qn=Vn++){var cr=dn[qn],Dn=dn[Vn],ke=Dn.x-cr.x,tt=Dn.y-cr.y;if(Math.abs(tt)>Number.EPSILON){if(tt<0&&(cr=dn[Vn],ke=-ke,Dn=dn[qn],tt=-tt),Mt.y<cr.y||Mt.y>Dn.y)continue;if(Mt.y===cr.y){if(Mt.x===cr.x)return 1}else{var Yt=tt*(Mt.x-cr.x)-ke*(Mt.y-cr.y);if(Yt==0)return 1;if(Yt<0)continue;Zn=!Zn}}else{if(Mt.y!==cr.y)continue;if(Dn.x<=Mt.x&&Mt.x<=cr.x||cr.x<=Mt.x&&Mt.x<=Dn.x)return 1}}return Zn}var l=us.isClockWise,d=this.subPaths;if(d.length===0)return[];if(t===!0)return n(d);var g,x,A,I=[];if(d.length===1)return x=d[0],(A=new $a).curves=x.curves,I.push(A),I;var Y=!l(d[0].getPoints());Y=e?!Y:Y;var Q,ie,z=[],he=[],me=[],ye=0;he[ye]=void 0,me[ye]=[];for(var Ee=0,Re=d.length;Ee<Re;Ee++)g=l(Q=(x=d[Ee]).getPoints()),(g=e?!g:g)?(!Y&&he[ye]&&ye++,he[ye]={s:new $a,p:Q},he[ye].s.curves=x.curves,Y&&ye++,me[ye]=[]):me[ye].push({h:x,p:Q[0]});if(!he[0])return n(d);if(1<he.length){for(var Ve=!1,et=[],Fe=0,at=he.length;Fe<at;Fe++)z[Fe]=[];for(Fe=0,at=he.length;Fe<at;Fe++)for(var Je=me[Fe],xt=0;xt<Je.length;xt++){for(var _t=Je[xt],Pt=!0,Ot=0;Ot<he.length;Ot++)i(_t.p,he[Ot].p)&&(Fe!==Ot&&et.push({froms:Fe,tos:Ot,hole:xt}),Pt?(Pt=!1,z[Ot].push(_t)):Ve=!0);Pt&&z[Fe].push(_t)}0<et.length&&(Ve||(me=z))}Ee=0;for(var Gt=he.length;Ee<Gt;Ee++){A=he[Ee].s,I.push(A);for(var Kt=0,Dt=(ie=me[Ee]).length;Kt<Dt;Kt++)A.holes.push(ie[Kt].h)}return I}}),Object.assign(ip.prototype,{isFont:!0,generateShapes:function(e,t){t===void 0&&(t=100);for(var n=[],i=function(g,x,A){for(var I=Array.from?Array.from(g):String(g).split(""),Y=x/A.resolution,Q=(A.boundingBox.yMax-A.boundingBox.yMin+A.underlineThickness)*Y,ie=[],z=0,he=0,me=0;me<I.length;me++){var ye=I[me];if(ye===`
`)z=0,he-=Q;else{var Ee=Cf(ye,Y,z,he,A);z+=Ee.offsetX,ie.push(Ee.path)}}return ie}(e,t,this.data),l=0,d=i.length;l<d;l++)Array.prototype.push.apply(n,i[l].toShapes());return n}}),ap.prototype=Object.assign(Object.create(s.prototype),{constructor:ap,load:function(e,t,n,i){var l=this,d=new P(this.manager);d.setPath(this.path),d.load(e,function(g){var x;try{x=JSON.parse(g)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),x=JSON.parse(g.substring(65,g.length-2))}var A=l.parse(x);t&&t(A)},n,i)},parse:function(e){return new ip(e)}});var op={getContext:function(){return Td===void 0&&(Td=new(window.AudioContext||window.webkitAudioContext)),Td},setContext:function(e){Td=e}};function Cd(e){s.call(this,e)}function Sd(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Oe)}function ds(e,t){Vr.call(this,void 0,t),this.sh=e!==void 0?e:new Sd}function sp(e,t,n){ds.call(this,void 0,n);var i=new Qe().set(e),l=new Qe().set(t),d=new Oe(i.r,i.g,i.b),g=new Oe(l.r,l.g,l.b),x=Math.sqrt(Math.PI),A=x*Math.sqrt(.75);this.sh.coefficients[0].copy(d).add(g).multiplyScalar(x),this.sh.coefficients[1].copy(d).sub(g).multiplyScalar(A)}function lp(e,t){ds.call(this,void 0,t);var n=new Qe().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Cd.prototype=Object.assign(Object.create(s.prototype),{constructor:Cd,load:function(e,t,n,i){var l=new P(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.load(e,function(d){var g=d.slice(0);op.getContext().decodeAudioData(g,function(x){t(x)})},n,i)}}),Object.assign(Sd.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,i=e.y,l=e.z,d=this.coefficients;return t.copy(d[0]).multiplyScalar(.282095),t.addScale(d[1],.488603*i),t.addScale(d[2],.488603*l),t.addScale(d[3],.488603*n),t.addScale(d[4],n*i*1.092548),t.addScale(d[5],i*l*1.092548),t.addScale(d[6],.315392*(3*l*l-1)),t.addScale(d[7],n*l*1.092548),t.addScale(d[8],.546274*(n*n-i*i)),t},getIrradianceAt:function(e,t){var n=e.x,i=e.y,l=e.z,d=this.coefficients;return t.copy(d[0]).multiplyScalar(.886227),t.addScale(d[1],1.023328*i),t.addScale(d[2],1.023328*l),t.addScale(d[3],1.023328*n),t.addScale(d[4],.858086*n*i),t.addScale(d[5],.858086*i*l),t.addScale(d[6],.743125*l*l-.247708),t.addScale(d[7],.858086*n*l),t.addScale(d[8],.429043*(n*n-i*i)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){t===void 0&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}}),Object.assign(Sd,{getBasisAt:function(e,t){var n=e.x,i=e.y,l=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*l,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*n*l,t[8]=.546274*(n*n-i*i)}}),ds.prototype=Object.assign(Object.create(Vr.prototype),{constructor:ds,isLightProbe:!0,copy:function(e){return Vr.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Vr.prototype.toJSON.call(this,e)}}),sp.prototype=Object.assign(Object.create(ds.prototype),{constructor:sp,isHemisphereLightProbe:!0,copy:function(e){return ds.prototype.copy.call(this,e),this},toJSON:function(e){return ds.prototype.toJSON.call(this,e)}}),lp.prototype=Object.assign(Object.create(ds.prototype),{constructor:lp,isAmbientLightProbe:!0,copy:function(e){return ds.prototype.copy.call(this,e),this},toJSON:function(e){return ds.prototype.toJSON.call(this,e)}});var Bp=new fr,Fp=new fr;function Vp(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ii,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ii,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function cp(e){this.autoStart=e===void 0||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Vp.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,i,l=e.projectionMatrix.clone(),d=t.eyeSep/2,g=d*t.near/t.focus,x=t.near*Math.tan(vr.DEG2RAD*t.fov*.5)/t.zoom;Fp.elements[12]=-d,Bp.elements[12]=d,n=-x*t.aspect+g,i=x*t.aspect+g,l.elements[0]=2*t.near/(i-n),l.elements[8]=(i+n)/(i-n),this.cameraL.projectionMatrix.copy(l),n=-x*t.aspect-g,i=x*t.aspect-g,l.elements[0]=2*t.near/(i-n),l.elements[8]=(i+n)/(i-n),this.cameraR.projectionMatrix.copy(l)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Fp),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Bp)}}),Object.assign(cp.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=(typeof performance>"u"?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var qc=new Oe,Gp=new Bi,Sf=new Oe,Xc=new Oe;function up(){At.call(this),this.type="AudioListener",this.context=op.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new cp}function $u(e){At.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}up.prototype=Object.assign(Object.create(At.prototype),{constructor:up,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){At.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(qc,Gp,Sf),Xc.set(0,0,-1).applyQuaternion(Gp),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(qc.x,i),t.positionY.linearRampToValueAtTime(qc.y,i),t.positionZ.linearRampToValueAtTime(qc.z,i),t.forwardX.linearRampToValueAtTime(Xc.x,i),t.forwardY.linearRampToValueAtTime(Xc.y,i),t.forwardZ.linearRampToValueAtTime(Xc.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(qc.x,qc.y,qc.z),t.setOrientation(Xc.x,Xc.y,Xc.z,n.x,n.y,n.z)}}),$u.prototype=Object.assign(Object.create(At.prototype),{constructor:$u,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying!==!0){if(this.hasPlaybackControl!==!1){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(this.hasPlaybackControl!==!1)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e=e||[],this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var Yc=new Oe,zp=new Bi,Df=new Oe,Zc=new Oe;function hp(e){$u.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function dp(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t!==void 0?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function pp(e,t,n){this.binding=e,this.valueSize=n;var i,l=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":l=Array,i=this._select;break;default:i=this._lerp}this.buffer=new l(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}hp.prototype=Object.assign(Object.create($u.prototype),{constructor:hp,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(At.prototype.updateMatrixWorld.call(this,e),this.hasPlaybackControl!==!0||this.isPlaying!==!1){this.matrixWorld.decompose(Yc,zp,Df),Zc.set(0,0,1).applyQuaternion(zp);var t=this.panner;if(t.positionX){var n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Yc.x,n),t.positionY.linearRampToValueAtTime(Yc.y,n),t.positionZ.linearRampToValueAtTime(Yc.z,n),t.orientationX.linearRampToValueAtTime(Zc.x,n),t.orientationY.linearRampToValueAtTime(Zc.y,n),t.orientationZ.linearRampToValueAtTime(Zc.z,n)}else t.setPosition(Yc.x,Yc.y,Yc.z),t.setOrientation(Zc.x,Zc.y,Zc.z)}}}),Object.assign(dp.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(pp.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,l=e*i+i,d=this.cumulativeWeight;if(d===0){for(var g=0;g!==i;++g)n[l+g]=n[g];d=t}else{var x=t/(d+=t);this._mixBufferRegion(n,l,0,x,i)}this.cumulativeWeight=d},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,l=this.cumulativeWeight,d=this.binding;if(this.cumulativeWeight=0,l<1){var g=3*t;this._mixBufferRegion(n,i,g,1-l,t)}for(var x=t,A=t+t;x!==A;++x)if(n[x]!==n[x+t]){d.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=3*n;e.getValue(t,i);for(var l=n,d=i;l!==d;++l)t[l]=t[i+l%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,l){if(.5<=i)for(var d=0;d!==l;++d)e[t+d]=e[n+d]},_slerp:function(e,t,n,i){Bi.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,l){for(var d=1-i,g=0;g!==l;++g){var x=t+g;e[x]=e[x]*d+e[n+g]*i}}});var fp="\\[\\]\\.:\\/",Ef=new RegExp("["+fp+"]","g"),mp="[^"+fp+"]",Pf="[^"+fp.replace("\\.","")+"]",Of=/((?:WC+[\/:])*)/.source.replace("WC",mp),Af=/(WCOD+)?/.source.replace("WCOD",Pf),Rf=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",mp),Lf=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",mp),If=new RegExp("^"+Of+Af+Rf+Lf+"$"),kf=["material","materials","bones"];function Up(e,t,n){var i=n||Qa.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function Qa(e,t,n){this.path=t,this.parsedPath=n||Qa.parseTrackName(t),this.node=Qa.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Hp(){this.uuid=vr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Wp(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,l=i.length,d=new Array(l),g={endingStart:Ce,endingEnd:Ce},x=0;x!==l;++x){var A=i[x].createInterpolant(null);(d[x]=A).settings=g}this._interpolantSettings=g,this._interpolants=d,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function gp(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Dd(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function yp(e,t,n){Yo.call(this,e,t),this.meshPerAttribute=n||1}function Jp(e,t,n,i){this.ray=new Ar(e,t),this.near=n||0,this.far=i||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function qp(e,t){return e.distance-t.distance}function vp(e,t,n,i){if(e.visible!==!1&&(e.raycast(t,n),i===!0))for(var l=e.children,d=0,g=l.length;d<g;d++)vp(l[d],t,n,!0)}function Xp(e,t,n){return this.radius=e!==void 0?e:1,this.phi=t!==void 0?t:0,this.theta=n!==void 0?n:0,this}function Yp(e,t,n){return this.radius=e!==void 0?e:1,this.theta=t!==void 0?t:0,this.y=n!==void 0?n:0,this}Object.assign(Up.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,l=n.length;i!==l;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Qa,{Composite:Up,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Qa.Composite(e,t,n):new Qa(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Ef,"")},parseTrackName:function(e){var t=If.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var l=n.nodeName.substring(i+1);kf.indexOf(l)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=l)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||t===""||t==="root"||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){var i=function(d){for(var g=0;g<d.length;g++){var x=d[g];if(x.name===t||x.uuid===t)return x;var A=i(x.children);if(A)return A}return null},l=i(e.children);if(l)return l}return null}}),Object.assign(Qa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,l=n.length;i!==l;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,l=n.length;i!==l;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,l=n.length;i!==l;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,l=n.length;i!==l;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,l=t.propertyIndex;if(e||(e=Qa.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var d=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var g=0;g<e.length;g++)if(e[g].name===d){d=g;break}break;default:if(e[n]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(d!==void 0){if(e[d]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[d]}}var x=e[i];if(x!==void 0){var A=this.Versioning.None;(this.targetObject=e).needsUpdate!==void 0?A=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(A=this.Versioning.MatrixWorldNeedsUpdate);var I=this.BindingType.Direct;if(l!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(g=0;g<this.node.geometry.morphAttributes.position.length;g++)if(e.geometry.morphAttributes.position[g].name===l){l=g;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(g=0;g<this.node.geometry.morphTargets.length;g++)if(e.geometry.morphTargets[g].name===l){l=g;break}}}I=this.BindingType.ArrayElement,this.resolvedProperty=x,this.propertyIndex=l}else x.fromArray!==void 0&&x.toArray!==void 0?(I=this.BindingType.HasFromToArray,this.resolvedProperty=x):Array.isArray(x)?(I=this.BindingType.EntireArray,this.resolvedProperty=x):this.propertyName=i;this.getValue=this.GetterByBindingType[I],this.setValue=this.SetterByBindingTypeAndVersioning[I][A]}else{var Y=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+Y+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Qa.prototype,{_getValue_unbound:Qa.prototype.getValue,_setValue_unbound:Qa.prototype.setValue}),Object.assign(Hp.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,l=this._paths,d=this._parsedPaths,g=this._bindings,x=g.length,A=void 0,I=0,Y=arguments.length;I!==Y;++I){var Q=arguments[I],ie=Q.uuid,z=i[ie];if(z===void 0){z=t++,i[ie]=z,e.push(Q);for(var he=0,me=x;he!==me;++he)g[he].push(new Qa(Q,l[he],d[he]))}else if(z<n){A=e[z];var ye=--n,Ee=e[ye];for(e[i[Ee.uuid]=z]=Ee,e[i[ie]=ye]=Q,he=0,me=x;he!==me;++he){var Re=g[he],Ve=Re[ye],et=Re[z];Re[z]=Ve,et===void 0&&(et=new Qa(Q,l[he],d[he])),Re[ye]=et}}else e[z]!==A&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,l=i.length,d=0,g=arguments.length;d!==g;++d){var x=arguments[d],A=x.uuid,I=n[A];if(I!==void 0&&t<=I){var Y=t++,Q=e[Y];e[n[Q.uuid]=I]=Q,e[n[A]=Y]=x;for(var ie=0,z=l;ie!==z;++ie){var he=i[ie],me=he[Y],ye=he[I];he[I]=me,he[Y]=ye}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,l=this._bindings,d=l.length,g=0,x=arguments.length;g!==x;++g){var A=arguments[g].uuid,I=i[A];if(I!==void 0)if(delete i[A],I<n){var Y=--n,Q=e[Y],ie=e[Ee=--t];e[i[Q.uuid]=I]=Q,e[i[ie.uuid]=Y]=ie,e.pop();for(var z=0,he=d;z!==he;++z){var me=(Re=l[z])[Y],ye=Re[Ee];Re[I]=me,Re[Y]=ye,Re.pop()}}else{var Ee;for(e[i[(ie=e[Ee=--t]).uuid]=I]=ie,e.pop(),z=0,he=d;z!==he;++z){var Re;(Re=l[z])[I]=Re[Ee],Re.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],l=this._bindings;if(i!==void 0)return l[i];var d=this._paths,g=this._parsedPaths,x=this._objects,A=x.length,I=this.nCachedObjects_,Y=new Array(A);i=l.length,n[e]=i,d.push(e),g.push(t),l.push(Y);for(var Q=I,ie=x.length;Q!==ie;++Q){var z=x[Q];Y[Q]=new Qa(z,e,t)}return Y},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){var i=this._paths,l=this._parsedPaths,d=this._bindings,g=d.length-1,x=d[g];d[t[e[g]]=n]=x,d.pop(),l[n]=l[g],l.pop(),i[n]=i[g],i.pop()}}}),Object.assign(Wp.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,l=e._clip.duration,d=l/i,g=i/l;e.warp(1,d,t),this.warp(g,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,l=i.time,d=this._timeScaleInterpolant,g=this.timeScale;d===null&&(d=i._lendControlInterpolant(),this._timeScaleInterpolant=d);var x=d.parameterPositions,A=d.sampleValues;return x[0]=l,x[1]=l+n,A[0]=e/g,A[1]=t/g,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var l=this._startTime;if(l!==null){var d=(e-l)*n;if(d<0||n===0)return;this._startTime=null,t=n*d}t*=this._updateTimeScale(e);var g=this._updateTime(t),x=this._updateWeight(e);if(0<x)for(var A=this._interpolants,I=this._propertyBindings,Y=0,Q=A.length;Y!==Q;++Y)A[Y].evaluate(g),I[Y].accumulate(i,x)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(n!==null){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,i=this.loop,l=this._loopCount,d=i===2202;if(e===0)return l!==-1&&d&&(1&l)==1?n-t:t;if(i===2200){l===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=t)t=n;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(l===-1&&(0<=e?(l=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),n<=t||t<0){var g=Math.floor(t/n);t-=n*g,l+=Math.abs(g);var x=this.repetitions-l;if(x<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(x==1){var A=e<0;this._setEndings(A,!A,d)}else this._setEndings(!1,!1,d);this._loopCount=l,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:g})}}else this.time=t;if(d&&(1&l)==1)return n-t}return t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=ue,i.endingEnd=ue):(i.endingStart=e?this.zeroSlopeAtStart?ue:Ce:Te,i.endingEnd=t?this.zeroSlopeAtEnd?ue:Ce:Te)},_scheduleFading:function(e,t,n){var i=this._mixer,l=i.time,d=this._weightInterpolant;d===null&&(d=i._lendControlInterpolant(),this._weightInterpolant=d);var g=d.parameterPositions,x=d.sampleValues;return g[0]=l,x[0]=t,g[1]=l+e,x[1]=n,this}}),gp.prototype=Object.assign(Object.create(Ia.prototype),{constructor:gp,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,l=i.length,d=e._propertyBindings,g=e._interpolants,x=n.uuid,A=this._bindingsByRootAndName,I=A[x];I===void 0&&(I={},A[x]=I);for(var Y=0;Y!==l;++Y){var Q=i[Y],ie=Q.name,z=I[ie];if(z!==void 0)d[Y]=z;else{if((z=d[Y])!==void 0){z._cacheIndex===null&&(++z.referenceCount,this._addInactiveBinding(z,x,ie));continue}var he=t&&t._propertyBindings[Y].binding.parsedPath;++(z=new pp(Qa.create(n,ie,he),Q.ValueTypeName,Q.getValueSize())).referenceCount,this._addInactiveBinding(z,x,ie),d[Y]=z}g[Y].resultBuffer=z.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var l=e._propertyBindings,d=0,g=l.length;d!==g;++d){var x=l[d];x.useCount++==0&&(this._lendBinding(x),x.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var l=t[n];--l.useCount==0&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,l=this._actionsByClip,d=l[t];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[t]=d;else{var g=d.knownActions;e._byClipCacheIndex=g.length,g.push(e)}e._cacheIndex=i.length,i.push(e),d.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;t[n._cacheIndex=i]=n,t.pop(),e._cacheIndex=null;var l=e._clip.uuid,d=this._actionsByClip,g=d[l],x=g.knownActions,A=x[x.length-1],I=e._byClipCacheIndex;x[A._byClipCacheIndex=I]=A,x.pop(),e._byClipCacheIndex=null,delete g.actionByRoot[(e._localRoot||this._root).uuid],x.length===0&&delete d[l],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var l=t[n];--l.referenceCount==0&&this._removeInactiveBinding(l)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,l=t[i];t[e._cacheIndex=i]=e,t[l._cacheIndex=n]=l},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,l=t[i];t[e._cacheIndex=i]=e,t[l._cacheIndex=n]=l},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,l=i[t],d=this._bindings;l===void 0&&(l={},i[t]=l),(l[n]=e)._cacheIndex=d.length,d.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,l=n.path,d=this._bindingsByRootAndName,g=d[i],x=t[t.length-1],A=e._cacheIndex;t[x._cacheIndex=A]=x,t.pop(),delete g[l],Object.keys(g).length===0&&delete d[i]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,l=t[i];t[e._cacheIndex=i]=e,t[l._cacheIndex=n]=l},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,l=t[i];t[e._cacheIndex=i]=e,t[l._cacheIndex=n]=l},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(e[(n=new Wc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,l=t[i];t[e.__cacheIndex=i]=e,t[l.__cacheIndex=n]=l},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,l=typeof e=="string"?Mo.findByName(n,e):e,d=l!==null?l.uuid:e,g=this._actionsByClip[d],x=null;if(g!==void 0){var A=g.actionByRoot[i];if(A!==void 0)return A;x=g.knownActions[0],l===null&&(l=x._clip)}if(l===null)return null;var I=new Wp(this,l,t);return this._bindAction(I,x),this._addInactiveAction(I,d,i),I},existingAction:function(e,t){var n=t||this._root,i=n.uuid,l=typeof e=="string"?Mo.findByName(n,e):e,d=l?l.uuid:e,g=this._actionsByClip[d];return g!==void 0&&g.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0;for(var l=this._nActiveBindings=0;l!==t;++l)e[l].reset();for(l=0;l!==i;++l)n[l].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,l=Math.sign(e),d=this._accuIndex^=1,g=0;g!==n;++g)t[g]._update(i,e,l,d);var x=this._bindings,A=this._nActiveBindings;for(g=0;g!==A;++g)x[g].apply(d);return this},setTime:function(e){for(var t=this.time=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,l=i[n];if(l!==void 0){for(var d=l.knownActions,g=0,x=d.length;g!==x;++g){var A=d[g];this._deactivateAction(A);var I=A._cacheIndex,Y=t[t.length-1];A._cacheIndex=null,A._byClipCacheIndex=null,t[Y._cacheIndex=I]=Y,t.pop(),this._removeInactiveBindingsForAction(A)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var l=n[i].actionByRoot[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}var d=this._bindingsByRootAndName[t];if(d!==void 0)for(var g in d){var x=d[g];x.restoreOriginalState(),this._removeInactiveBinding(x)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Dd.prototype.clone=function(){return new Dd(this.value.clone===void 0?this.value:this.value.clone())},yp.prototype=Object.assign(Object.create(Yo.prototype),{constructor:yp,isInstancedInterleavedBuffer:!0,copy:function(e){return Yo.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Jp.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return vp(e,this,i,t),i.sort(qp),i},intersectObjects:function(e,t,n){var i=n||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var l=0,d=e.length;l<d;l++)vp(e[l],this,i,t);return i.sort(qp),i}}),Object.assign(Xp.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(vr.clamp(t/this.radius,-1,1))),this}}),Object.assign(Yp.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var Zp=new zt;function xp(e,t){this.min=e!==void 0?e:new zt(1/0,1/0),this.max=t!==void 0?t:new zt(-1/0,-1/0)}Object.assign(xp.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=Zp.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new zt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new zt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Zp.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Kp=new Oe,Ed=new Oe;function wp(e,t){this.start=e!==void 0?e:new Oe,this.end=t!==void 0?t:new Oe}function bp(e){At.call(this),this.material=e,this.render=function(){}}Object.assign(wp.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Oe),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Oe),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return t===void 0&&(console.warn("THREE.Line3: .at() target is now required"),t=new Oe),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Kp.subVectors(e,this.start),Ed.subVectors(this.end,this.start);var n=Ed.dot(Ed),i=Ed.dot(Kp)/n;return t&&(i=vr.clamp(i,0,1)),i},closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return n===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Oe),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),((bp.prototype=Object.create(At.prototype)).constructor=bp).prototype.isImmediateRenderObject=!0;var $p=new Oe;function Pd(e,t){At.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Sn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],l=0,d=1;l<32;l++,d++){var g=l/32*Math.PI*2,x=d/32*Math.PI*2;i.push(Math.cos(g),Math.sin(g),1,Math.cos(x),Math.sin(x),1)}n.setAttribute("position",new on(i,3));var A=new ki({fog:!1});this.cone=new fi(n,A),this.add(this.cone),this.update()}((Pd.prototype=Object.create(At.prototype)).constructor=Pd).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Pd.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),$p.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt($p),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var rc=new Oe,Od=new fr,Mp=new fr;function Ad(e){for(var t=function Y(Q){var ie=[];Q&&Q.isBone&&ie.push(Q);for(var z=0;z<Q.children.length;z++)ie.push.apply(ie,Y(Q.children[z]));return ie}(e),n=new Sn,i=[],l=[],d=new Qe(0,0,1),g=new Qe(0,1,0),x=0;x<t.length;x++){var A=t[x];A.parent&&A.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),l.push(d.r,d.g,d.b),l.push(g.r,g.g,g.b))}n.setAttribute("position",new on(i,3)),n.setAttribute("color",new on(l,3));var I=new ki({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});fi.call(this,n,I),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Rd(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new hl(t,4,2),l=new Mr({wireframe:!0,fog:!1});_i.call(this,i,l),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}((Ad.prototype=Object.create(fi.prototype)).constructor=Ad).prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");Mp.getInverse(this.root.matrixWorld);for(var l=0,d=0;l<t.length;l++){var g=t[l];g.parent&&g.parent.isBone&&(Od.multiplyMatrices(Mp,g.matrixWorld),rc.setFromMatrixPosition(Od),i.setXYZ(d,rc.x,rc.y,rc.z),Od.multiplyMatrices(Mp,g.parent.matrixWorld),rc.setFromMatrixPosition(Od),i.setXYZ(d+1,rc.x,rc.y,rc.z),d+=2)}n.getAttribute("position").needsUpdate=!0,At.prototype.updateMatrixWorld.call(this,e)},((Rd.prototype=Object.create(_i.prototype)).constructor=Rd).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Rd.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var jf=new Oe,Qp=new Qe,ef=new Qe;function Ld(e,t,n){At.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new mi(t);i.rotateY(.5*Math.PI),this.material=new Mr({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=2);var l=i.getAttribute("position"),d=new Float32Array(3*l.count);i.setAttribute("color",new en(d,3)),this.add(new _i(i,this.material)),this.update()}function Id(e,t,n,i){e=e||10,t=t||10,n=new Qe(n!==void 0?n:4473924),i=new Qe(i!==void 0?i:8947848);for(var l=t/2,d=e/t,g=e/2,x=[],A=[],I=0,Y=0,Q=-g;I<=t;I++,Q+=d){x.push(-g,0,Q,g,0,Q),x.push(Q,0,-g,Q,0,g);var ie=I===l?n:i;ie.toArray(A,Y),Y+=3,ie.toArray(A,Y),Y+=3,ie.toArray(A,Y),Y+=3,ie.toArray(A,Y),Y+=3}var z=new Sn;z.setAttribute("position",new on(x,3)),z.setAttribute("color",new on(A,3));var he=new ki({vertexColors:2});fi.call(this,z,he)}function _p(e,t,n,i,l,d){e=e||10,t=t||16,n=n||8,i=i||64,l=new Qe(l!==void 0?l:4473924),d=new Qe(d!==void 0?d:8947848);var g,x,A,I,Y,Q,ie,z=[],he=[];for(I=0;I<=t;I++)A=I/t*(2*Math.PI),g=Math.sin(A)*e,x=Math.cos(A)*e,z.push(0,0,0),z.push(g,0,x),ie=1&I?l:d,he.push(ie.r,ie.g,ie.b),he.push(ie.r,ie.g,ie.b);for(I=0;I<=n;I++)for(ie=1&I?l:d,Q=e-e/n*I,Y=0;Y<i;Y++)A=Y/i*(2*Math.PI),g=Math.sin(A)*Q,x=Math.cos(A)*Q,z.push(g,0,x),he.push(ie.r,ie.g,ie.b),A=(Y+1)/i*(2*Math.PI),g=Math.sin(A)*Q,x=Math.cos(A)*Q,z.push(g,0,x),he.push(ie.r,ie.g,ie.b);var me=new Sn;me.setAttribute("position",new on(z,3)),me.setAttribute("color",new on(he,3));var ye=new ki({vertexColors:2});fi.call(this,me,ye)}((Ld.prototype=Object.create(At.prototype)).constructor=Ld).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ld.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Qp.copy(this.light.color),ef.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var l=n<i/2?Qp:ef;t.setXYZ(n,l.r,l.g,l.b)}t.needsUpdate=!0}e.lookAt(jf.setFromMatrixPosition(this.light.matrixWorld).negate())},Id.prototype=Object.assign(Object.create(fi.prototype),{constructor:Id,copy:function(e){return fi.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),(_p.prototype=Object.create(fi.prototype)).constructor=_p;var tf=new Oe,kd=new Oe,nf=new Oe;function jd(e,t,n){At.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);var i=new Sn;i.setAttribute("position",new on([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var l=new ki({fog:!1});this.lightPlane=new Ra(i,l),this.add(this.lightPlane),(i=new Sn).setAttribute("position",new on([0,0,0,0,0,1],3)),this.targetLine=new Ra(i,l),this.add(this.targetLine),this.update()}((jd.prototype=Object.create(At.prototype)).constructor=jd).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},jd.prototype.update=function(){tf.setFromMatrixPosition(this.light.matrixWorld),kd.setFromMatrixPosition(this.light.target.matrixWorld),nf.subVectors(kd,tf),this.lightPlane.lookAt(kd),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(kd),this.targetLine.scale.z=nf.length()};var Nd=new Oe,Ki=new Ao;function Tp(e){var t=new Sn,n=new ki({color:16777215,vertexColors:1}),i=[],l=[],d={},g=new Qe(16755200),x=new Qe(16711680),A=new Qe(43775),I=new Qe(16777215),Y=new Qe(3355443);function Q(z,he,me){ie(z,me),ie(he,me)}function ie(z,he){i.push(0,0,0),l.push(he.r,he.g,he.b),d[z]===void 0&&(d[z]=[]),d[z].push(i.length/3-1)}Q("n1","n2",g),Q("n2","n4",g),Q("n4","n3",g),Q("n3","n1",g),Q("f1","f2",g),Q("f2","f4",g),Q("f4","f3",g),Q("f3","f1",g),Q("n1","f1",g),Q("n2","f2",g),Q("n3","f3",g),Q("n4","f4",g),Q("p","n1",x),Q("p","n2",x),Q("p","n3",x),Q("p","n4",x),Q("u1","u2",A),Q("u2","u3",A),Q("u3","u1",A),Q("c","t",I),Q("p","c",Y),Q("cn1","cn2",Y),Q("cn3","cn4",Y),Q("cf1","cf2",Y),Q("cf3","cf4",Y),t.setAttribute("position",new on(i,3)),t.setAttribute("color",new on(l,3)),fi.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update()}function ia(e,t,n,i,l,d,g){Nd.set(l,d,g).unproject(i);var x=t[e];if(x!==void 0)for(var A=n.getAttribute("position"),I=0,Y=x.length;I<Y;I++)A.setXYZ(x[I],Nd.x,Nd.y,Nd.z)}((Tp.prototype=Object.create(fi.prototype)).constructor=Tp).prototype.update=function(){var e=this.geometry,t=this.pointMap;Ki.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ia("c",t,e,Ki,0,0,-1),ia("t",t,e,Ki,0,0,1),ia("n1",t,e,Ki,-1,-1,-1),ia("n2",t,e,Ki,1,-1,-1),ia("n3",t,e,Ki,-1,1,-1),ia("n4",t,e,Ki,1,1,-1),ia("f1",t,e,Ki,-1,-1,1),ia("f2",t,e,Ki,1,-1,1),ia("f3",t,e,Ki,-1,1,1),ia("f4",t,e,Ki,1,1,1),ia("u1",t,e,Ki,.7,1.1,-1),ia("u2",t,e,Ki,-.7,1.1,-1),ia("u3",t,e,Ki,0,2,-1),ia("cf1",t,e,Ki,-1,0,1),ia("cf2",t,e,Ki,1,0,1),ia("cf3",t,e,Ki,0,-1,1),ia("cf4",t,e,Ki,0,1,1),ia("cn1",t,e,Ki,-1,0,-1),ia("cn2",t,e,Ki,1,0,-1),ia("cn3",t,e,Ki,0,-1,-1),ia("cn4",t,e,Ki,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Bd=new Xi;function Kc(e,t){this.object=e,t===void 0&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),l=new Sn;l.setIndex(new en(n,1)),l.setAttribute("position",new en(i,3)),fi.call(this,l,new ki({color:t})),this.matrixAutoUpdate=!1,this.update()}function Cp(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Sn;i.setIndex(new en(n,1)),i.setAttribute("position",new on([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),fi.call(this,i,new ki({color:t})),this.geometry.computeBoundingSphere()}function Sp(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=t===void 0?1:t;var i=n!==void 0?n:16776960,l=new Sn;l.setAttribute("position",new on([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),l.computeBoundingSphere(),Ra.call(this,l,new ki({color:i}));var d=new Sn;d.setAttribute("position",new on([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),d.computeBoundingSphere(),this.add(new _i(d,new Mr({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}((Kc.prototype=Object.create(fi.prototype)).constructor=Kc).prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Bd.setFromObject(this.object),!Bd.isEmpty()){var t=Bd.min,n=Bd.max,i=this.geometry.attributes.position,l=i.array;l[0]=n.x,l[1]=n.y,l[2]=n.z,l[3]=t.x,l[4]=n.y,l[5]=n.z,l[6]=t.x,l[7]=t.y,l[8]=n.z,l[9]=n.x,l[10]=t.y,l[11]=n.z,l[12]=n.x,l[13]=n.y,l[14]=t.z,l[15]=t.x,l[16]=n.y,l[17]=t.z,l[18]=t.x,l[19]=t.y,l[20]=t.z,l[21]=n.x,l[22]=t.y,l[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Kc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Kc.prototype.copy=function(e){return fi.prototype.copy.call(this,e),this.object=e.object,this},Kc.prototype.clone=function(){return new this.constructor().copy(this)},((Cp.prototype=Object.create(fi.prototype)).constructor=Cp).prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),At.prototype.updateMatrixWorld.call(this,e))},((Sp.prototype=Object.create(Ra.prototype)).constructor=Sp).prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?C:O,this.lookAt(this.plane.normal),At.prototype.updateMatrixWorld.call(this,e)};var Dp,rf,af=new Oe;function $c(e,t,n,i,l,d){At.call(this),e===void 0&&(e=new Oe(0,0,1)),t===void 0&&(t=new Oe(0,0,0)),n===void 0&&(n=1),i===void 0&&(i=16776960),l===void 0&&(l=.2*n),d===void 0&&(d=.2*l),Dp===void 0&&((Dp=new Sn).setAttribute("position",new on([0,0,0,0,1,0],3)),(rf=new Ls(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Ra(Dp,new ki({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new _i(rf,new Mr({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,l,d)}function Fd(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Sn;n.setAttribute("position",new on(t,3)),n.setAttribute("color",new on([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new ki({vertexColors:2});fi.call(this,n,i)}(($c.prototype=Object.create(At.prototype)).constructor=$c).prototype.setDirection=function(e){if(.99999<e.y)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{af.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(af,t)}},$c.prototype.setLength=function(e,t,n){t===void 0&&(t=.2*e),n===void 0&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},$c.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},$c.prototype.copy=function(e){return At.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},$c.prototype.clone=function(){return new this.constructor().copy(this)},(Fd.prototype=Object.create(fi.prototype)).constructor=Fd;var Qu=4,ic=8,Ns=Math.pow(2,ic),of=[.125,.215,.35,.446,.526,.582],sf=ic-Qu+1+of.length,eh=20,za={};za[Ke]=0,za[vt]=1,za[Xt]=2,za[Gn]=3,za[or]=4,za[hi]=5,za[Ft]=6;var lf,cf,Ep=new xl,Vd=((cf=new Is({defines:{n:lf=eh},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(lf)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new Oe(0,1,0)},inputEncoding:{value:za[Ke]},outputEncoding:{value:za[Ke]}},vertexShader:`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`,fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;


uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

void main() {
	gl_FragColor = vec4(0.0);
	for (int i = 0; i < n; i++) {
		if (i >= samples)
			break;
		for (int dir = -1; dir < 2; dir += 2) {
			if (i == 0 && dir == 1)
				continue;
			vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
			if (all(equal(axis, vec3(0.0))))
				axis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);
			axis = normalize(axis);
			float theta = dTheta * float(dir * i);
			float cosTheta = cos(theta);
			// Rodrigues' axis-angle rotation
			vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross(axis, vOutputDirection) * sin(theta)
					+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
			gl_FragColor.rgb +=
					weights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);
		}
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:R,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",cf),Qc=null,eu=null,Pp=function(){for(var e=[],t=[],n=[],i=ic,l=0;l<sf;l++){var d=Math.pow(2,i);t.push(d);var g=1/d;ic-Qu<l?g=of[l-ic+Qu-1]:l==0&&(g=0),n.push(g);for(var x=1/(d-1),A=-x/2,I=1+x/2,Y=[A,A,I,A,I,I,A,A,I,I,A,I],Q=new Float32Array(108),ie=new Float32Array(72),z=new Float32Array(36),he=0;he<6;he++){var me=he%3*2/3-1,ye=2<he?0:-1,Ee=[me,ye,0,me+2/3,ye,0,me+2/3,1+ye,0,me,ye,0,me+2/3,1+ye,0,me,1+ye,0];Q.set(Ee,18*he),ie.set(Y,12*he);var Re=[he,he,he,he,he,he];z.set(Re,6*he)}var Ve=new Sn;Ve.setAttribute("position",new en(Q,3)),Ve.setAttribute("uv",new en(ie,2)),Ve.setAttribute("faceIndex",new en(z,1)),e.push(Ve),Qu<i&&i--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}(),Fh=Pp._lodPlanes,uf=Pp._sizeLods,Gd=Pp._sigmas,zd=null,Ti=null,Op=null,tu=(1+Math.sqrt(5))/2,th=1/tu,hf=[new Oe(1,1,1),new Oe(-1,1,1),new Oe(1,1,-1),new Oe(-1,1,-1),new Oe(0,tu,th),new Oe(0,tu,-th),new Oe(th,0,tu),new Oe(-th,0,tu),new Oe(tu,th,0),new Oe(-tu,th,0)];function Ap(e){Ti=e,Rp(Vd)}function df(e){var t={magFilter:pt,minFilter:pt,generateMipmaps:!1,type:e?e.type:kr,format:e?e.format:si,encoding:e?e.encoding:Xt,depthBuffer:!1,stencilBuffer:!1},n=ff(t);return n.depthBuffer=!e,zd=ff(t),n}function pf(e){zd.dispose(),Ti.setRenderTarget(Op),e.scissorTest=!1,e.setSize(e.width,e.height)}function Rp(e){var t=new Hn;t.add(new _i(Fh[0],e)),Ti.compile(t,Ep)}function ff(e){var t=new qi(3*Ns,3*Ns,e);return t.texture.mapping=yt,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Lp(e,t,n,i,l){e.viewport.set(t,n,i,l),e.scissor.set(t,n,i,l)}function mf(e){var t=Ti.autoClear;Ti.autoClear=!1;for(var n=1;n<sf;n++)gf(e,n-1,n,Math.sqrt(Gd[n]*Gd[n]-Gd[n-1]*Gd[n-1]),hf[(n-1)%hf.length]);Ti.autoClear=t}function gf(e,t,n,i,l){yf(e,zd,t,n,i,"latitudinal",l),yf(zd,e,n,n,i,"longitudinal",l)}function yf(e,t,n,i,l,d,g){d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var x=new Hn;x.add(new _i(Fh[i],Vd));var A=Vd.uniforms,I=uf[n]-1,Y=isFinite(l)?Math.PI/(2*I):2*Math.PI/(2*eh-1),Q=l/Y,ie=isFinite(l)?1+Math.floor(3*Q):eh;eh<ie&&console.warn("sigmaRadians, "+l+", is too large and will clip, as it requested "+ie+" samples when the maximum is set to "+eh);for(var z=[],he=0,me=0;me<eh;++me){var ye=me/Q,Ee=Math.exp(-ye*ye/2);z.push(Ee),me==0?he+=Ee:me<ie&&(he+=2*Ee)}for(me=0;me<z.length;me++)z[me]=z[me]/he;A.envMap.value=e.texture,A.samples.value=ie,A.weights.value=z,A.latitudinal.value=d==="latitudinal",g&&(A.poleAxis.value=g),A.dTheta.value=Y,A.mipInt.value=ic-n,A.inputEncoding.value=za[e.texture.encoding],A.outputEncoding.value=za[e.texture.encoding];var Re=uf[i];Lp(t,ye=3*Math.max(0,Ns-2*Re),(i===0?0:2*Ns)+2*Re*(ic-Qu<i?i-ic+Qu:0),3*Re,2*Re),Ti.setRenderTarget(t),Ti.render(x,Ep)}function vf(){var e=new Is({uniforms:{envMap:{value:null},texelSize:{value:new zt(1,1)},inputEncoding:{value:za[Ke]},outputEncoding:{value:za[Ke]}},vertexShader:`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`,fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;


uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	

#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv;
	uv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;
	uv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:R,depthTest:!1,depthWrite:!1});return e.type="EquirectangularToCubeUV",e}function xf(){var e=new Is({uniforms:{envMap:{value:null},inputEncoding:{value:za[Ke]},outputEncoding:{value:za[Ke]}},vertexShader:`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`,fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;


uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:R,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function wf(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Nn.call(this,e),this.type="catmullrom",this.closed=!0}function bf(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Nn.call(this,e),this.type="catmullrom"}function Ip(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Nn.call(this,e),this.type="catmullrom"}Ap.prototype={constructor:Ap,fromScene:function(e,t,n,i){t===void 0&&(t=0),n===void 0&&(n=.1),i===void 0&&(i=100),Op=Ti.getRenderTarget();var l=df();return function(d,g,x,A){var I=new Ii(90,1,g,x),Y=[1,1,1,1,-1,1],Q=[1,1,-1,-1,-1,1],ie=Ti.outputEncoding,z=Ti.toneMapping,he=Ti.toneMappingExposure,me=Ti.getClearColor(),ye=Ti.getClearAlpha();Ti.toneMapping=nt,Ti.toneMappingExposure=1,Ti.outputEncoding=Ke,d.scale.z*=-1;var Ee=d.background;if(Ee&&Ee.isColor){Ee.convertSRGBToLinear();var Re=Math.max(Ee.r,Ee.g,Ee.b),Ve=Math.min(Math.max(Math.ceil(Math.log2(Re)),-128),127);Ee=Ee.multiplyScalar(Math.pow(2,-Ve));var et=(Ve+128)/255;Ti.setClearColor(Ee,et),d.background=null}for(var Fe=0;Fe<6;Fe++){var at=Fe%3;at==0?(I.up.set(0,Y[Fe],0),I.lookAt(Q[Fe],0,0)):at==1?(I.up.set(0,0,Y[Fe]),I.lookAt(0,Q[Fe],0)):(I.up.set(0,Y[Fe],0),I.lookAt(0,0,Q[Fe])),Lp(A,at*Ns,2<Fe?Ns:0,Ns,Ns),Ti.setRenderTarget(A),Ti.render(d,I)}Ti.toneMapping=z,Ti.toneMappingExposure=he,Ti.outputEncoding=ie,Ti.setClearColor(me,ye),d.scale.z*=-1}(e,n,i,l),0<t&&gf(l,0,0,t),mf(l),pf(l),l},fromEquirectangular:function(e){return e.magFilter=pt,e.minFilter=pt,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){Op=Ti.getRenderTarget();var t=df(e);return function(n,i){var l=new Hn;n.isCubeTexture?eu==null&&(eu=xf()):Qc==null&&(Qc=vf());var d=n.isCubeTexture?eu:Qc;l.add(new _i(Fh[0],d));var g=d.uniforms;(g.envMap.value=n).isCubeTexture||g.texelSize.value.set(1/n.image.width,1/n.image.height),g.inputEncoding.value=za[n.encoding],g.outputEncoding.value=za[n.encoding],Lp(i,0,0,3*Ns,2*Ns),Ti.setRenderTarget(i),Ti.render(l,Ep)}(e,t),mf(t),pf(t),t},compileCubemapShader:function(){eu==null&&Rp(eu=xf())},compileEquirectangularShader:function(){Qc==null&&Rp(Qc=vf())},dispose:function(){Vd.dispose(),eu!=null&&eu.dispose(),Qc!=null&&Qc.dispose();for(var e=0;e<Fh.length;e++)Fh[e].dispose()}},gt.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(gt.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},Object.assign(ya.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new sr,n=0,i=e.length;n<i;n++){var l=e[n];t.vertices.push(new Oe(l.x,l.y,l.z||0))}return t}}),Object.assign(va.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),wf.prototype=Object.create(Nn.prototype),bf.prototype=Object.create(Nn.prototype),Ip.prototype=Object.create(Nn.prototype),Object.assign(Ip.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Id.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ad.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(s.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ep.extractUrlBase(e)}}),s.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(_d.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(xp.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Xi.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),$s.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},wp.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(vr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),vr.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),vr.ceilPowerOfTwo(e)}}),Object.assign(Si.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(fr.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Oe().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,l,d){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,l,d)}}),na.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Bi.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Ar.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Ri.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Ri,{barycoordFromPoint:function(e,t,n,i,l){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ri.getBarycoord(e,t,n,i,l)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ri.getNormal(e,t,n,i)}}),Object.assign($a.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ul(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Kl(this,e)}}),Object.assign(zt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Oe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Jr.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(sr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(At.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(At.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(_i.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(_i.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Mc.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Eu.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),_c.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(gt.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ii.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Vr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(en.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===wa},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(wa)}}}),Object.assign(en.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?wa:Wr),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Sn.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new en(t,arguments[2])))},addDrawCall:function(e,t,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Sn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Yo.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===wa},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Yo.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?wa:Wr),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Rs.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Dd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(kt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Qe}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ks.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Xa.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Su.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Su.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?vt:Ke}}}),Object.defineProperties(Ph.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(qi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties($u.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return new Cd().load(e,function(n){t.setBuffer(n)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),dp.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Xs.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Nf={merge:function(e,t,n){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};Go.crossOrigin=void 0,Go.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var l=new wt;l.setCrossOrigin(this.crossOrigin);var d=l.load(e,n,void 0,i);return t&&(d.mapping=t),d},Go.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var l=new it;l.setCrossOrigin(this.crossOrigin);var d=l.load(e,n,void 0,i);return t&&(d.mapping=t),d},Go.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Go.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Bf={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"113"}})),h.ACESFilmicToneMapping=We,h.AddEquation=T,h.AddOperation=ve,h.AdditiveBlending=ee,h.AlphaFormat=Ur,h.AlwaysDepth=q,h.AlwaysStencilFunc=Gs,h.AmbientLight=yd,h.AmbientLightProbe=lp,h.AnimationClip=Mo,h.AnimationLoader=ae,h.AnimationMixer=gp,h.AnimationObjectGroup=Hp,h.AnimationUtils=Di,h.ArcCurve=Qt,h.ArrayCamera=fc,h.ArrowHelper=$c,h.Audio=$u,h.AudioAnalyser=dp,h.AudioContext=op,h.AudioListener=up,h.AudioLoader=Cd,h.AxesHelper=Fd,h.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Fd(e)},h.BackSide=C,h.BasicDepthPacking=ao,h.BasicShadowMap=0,h.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Pe(e)},h.Bone=Rh,h.BooleanKeyframeTrack=Yu,h.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Kc(e,t)},h.Box2=xp,h.Box3=Xi,h.Box3Helper=Cp,h.BoxBufferGeometry=lc,h.BoxGeometry=oh,h.BoxHelper=Kc,h.BufferAttribute=en,h.BufferGeometry=Sn,h.BufferGeometryLoader=Md,h.ByteType=ct,h.Cache=gl,h.Camera=Ao,h.CameraHelper=Tp,h.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},h.CanvasTexture=Ec,h.CatmullRomCurve3=Nn,h.CineonToneMapping=Ct,h.CircleBufferGeometry=Vc,h.CircleGeometry=Ju,h.ClampToEdgeWrapping=An,h.Clock=cp,h.ClosedSplineCurve3=wf,h.Color=Qe,h.ColorKeyframeTrack=Zu,h.CompressedTexture=Nu,h.CompressedTextureLoader=pe,h.ConeBufferGeometry=Wu,h.ConeGeometry=Hu,h.CubeCamera=Xs,h.CubeGeometry=oh,h.CubeReflectionMapping=It,h.CubeRefractionMapping=Bt,h.CubeTexture=Ss,h.CubeTextureLoader=it,h.CubeUVReflectionMapping=yt,h.CubeUVRefractionMapping=ze,h.CubicBezierCurve=Er,h.CubicBezierCurve3=Bn,h.CubicInterpolant=qu,h.CullFaceBack=L,h.CullFaceFront=G,h.CullFaceFrontBack=3,h.CullFaceNone=w,h.Curve=gt,h.CurvePath=ya,h.CustomBlending=J,h.CylinderBufferGeometry=Ls,h.CylinderGeometry=dl,h.Cylindrical=Yp,h.DataTexture=Al,h.DataTexture2DArray=mu,h.DataTexture3D=ja,h.DataTextureLoader=Pe,h.DecrementStencilOp=7683,h.DecrementWrapStencilOp=34056,h.DefaultLoadingManager=gd,h.DepthFormat=gr,h.DepthStencilFormat=Wi,h.DepthTexture=Bu,h.DirectionalLight=bl,h.DirectionalLightHelper=jd,h.DirectionalLightShadow=wl,h.DiscreteInterpolant=Xu,h.DodecahedronBufferGeometry=po,h.DodecahedronGeometry=Wl,h.DoubleSide=j,h.DstAlphaFactor=ne,h.DstColorFactor=we,h.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new en(e,t).setUsage(wa)},h.DynamicCopyUsage=35050,h.DynamicDrawUsage=wa,h.DynamicReadUsage=35049,h.EdgesGeometry=$l,h.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new fi(new $l(e.geometry),new ki({color:t!==void 0?t:16777215}))},h.EllipseCurve=Nt,h.EqualDepth=se,h.EqualStencilFunc=514,h.EquirectangularReflectionMapping=Ln,h.EquirectangularRefractionMapping=rn,h.Euler=y,h.EventDispatcher=Ia,h.ExtrudeBufferGeometry=Rs,h.ExtrudeGeometry=ul,h.Face3=yn,h.Face4=function(e,t,n,i,l,d,g){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new yn(e,t,n,l,d,g)},h.FaceColors=1,h.FileLoader=P,h.FlatShading=1,h.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new on(e,t)},h.Float32BufferAttribute=on,h.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Tr(e,t)},h.Float64BufferAttribute=Tr,h.FloatType=Rt,h.Fog=Xo,h.FogExp2=ho,h.Font=ip,h.FontLoader=ap,h.FrontFaceDirectionCCW=1,h.FrontFaceDirectionCW=0,h.FrontSide=O,h.Frustum=$s,h.GammaEncoding=Ft,h.Geometry=sr,h.GeometryUtils=Nf,h.GreaterDepth=Ye,h.GreaterEqualDepth=Ae,h.GreaterEqualStencilFunc=518,h.GreaterStencilFunc=516,h.GridHelper=Id,h.Group=rl,h.HalfFloatType=$t,h.HemisphereLight=Jc,h.HemisphereLightHelper=Ld,h.HemisphereLightProbe=sp,h.IcosahedronBufferGeometry=Rc,h.IcosahedronGeometry=Ro,h.ImageBitmapLoader=np,h.ImageLoader=Xe,h.ImageUtils=Go,h.ImmediateRenderObject=bp,h.IncrementStencilOp=7682,h.IncrementWrapStencilOp=34055,h.InstancedBufferAttribute=bd,h.InstancedBufferGeometry=wd,h.InstancedInterleavedBuffer=yp,h.InstancedMesh=Pu,h.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new bi(e,t)},h.Int16BufferAttribute=bi,h.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new be(e,t)},h.Int32BufferAttribute=be,h.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Rr(e,t)},h.Int8BufferAttribute=Rr,h.IntType=Wt,h.InterleavedBuffer=Yo,h.InterleavedBufferAttribute=gc,h.Interpolant=Ga,h.InterpolateDiscrete=jr,h.InterpolateLinear=K,h.InterpolateSmooth=2302,h.InvertStencilOp=5386,h.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},h.KeepStencilOp=oo,h.KeyframeTrack=ma,h.LOD=Mc,h.LatheBufferGeometry=Zl,h.LatheGeometry=Fc,h.Layers=S,h.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},h.LessDepth=ge,h.LessEqualDepth=oe,h.LessEqualStencilFunc=515,h.LessStencilFunc=513,h.Light=Vr,h.LightProbe=ds,h.LightShadow=Io,h.Line=Ra,h.Line3=wp,h.LineBasicMaterial=ki,h.LineCurve=zn,h.LineCurve3=ui,h.LineDashedMaterial=Hc,h.LineLoop=Sc,h.LinePieces=1,h.LineSegments=fi,h.LineStrip=0,h.LinearEncoding=Ke,h.LinearFilter=xn,h.LinearInterpolant=Wc,h.LinearMipMapLinearFilter=1008,h.LinearMipMapNearestFilter=1007,h.LinearMipmapLinearFilter=er,h.LinearMipmapNearestFilter=nn,h.LinearToneMapping=nt,h.Loader=s,h.LoaderUtils=ep,h.LoadingManager=Bh,h.LogLuvEncoding=In,h.LoopOnce=2200,h.LoopPingPong=2202,h.LoopRepeat=2201,h.LuminanceAlphaFormat=Pi,h.LuminanceFormat=Qi,h.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h.Material=kt,h.MaterialLoader=xd,h.Math=vr,h.MathUtils=vr,h.Matrix3=Si,h.Matrix4=fr,h.MaxEquation=c,h.Mesh=_i,h.MeshBasicMaterial=Mr,h.MeshDepthMaterial=qo,h.MeshDistanceMaterial=nl,h.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},h.MeshLambertMaterial=fa,h.MeshMatcapMaterial=fl,h.MeshNormalMaterial=Uc,h.MeshPhongMaterial=ks,h.MeshPhysicalMaterial=Gc,h.MeshStandardMaterial=hs,h.MeshToonMaterial=zc,h.MinEquation=u,h.MirroredRepeatWrapping=Yn,h.MixOperation=le,h.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return e.slice()},e},h.MultiplyBlending=_,h.MultiplyOperation=Ne,h.NearestFilter=pt,h.NearestMipMapLinearFilter=1005,h.NearestMipMapNearestFilter=1004,h.NearestMipmapLinearFilter=qt,h.NearestMipmapNearestFilter=st,h.NeverDepth=Be,h.NeverStencilFunc=512,h.NoBlending=R,h.NoColors=V,h.NoToneMapping=He,h.NormalBlending=M,h.NotEqualDepth=Ge,h.NotEqualStencilFunc=517,h.NumberKeyframeTrack=js,h.Object3D=At,h.ObjectLoader=_d,h.ObjectSpaceNormalMap=Co,h.OctahedronBufferGeometry=mi,h.OctahedronGeometry=Sa,h.OneFactor=E,h.OneMinusDstAlphaFactor=ce,h.OneMinusDstColorFactor=Ie,h.OneMinusSrcAlphaFactor=te,h.OneMinusSrcColorFactor=X,h.OrthographicCamera=xl,h.PCFShadowMap=k,h.PCFSoftShadowMap=D,h.PMREMGenerator=Ap,h.ParametricBufferGeometry=Oc,h.ParametricGeometry=Ka,h.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new bc(e)},h.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Zo(e)},h.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new zl(e,t)},h.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Zo(e)},h.Path=va,h.PerspectiveCamera=Ii,h.Plane=na,h.PlaneBufferGeometry=Qs,h.PlaneGeometry=Rl,h.PlaneHelper=Sp,h.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new zl(e,t)},h.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Zo(e)},h.PointLight=vl,h.PointLightHelper=Rd,h.Points=zl,h.PointsMaterial=Zo,h.PolarGridHelper=_p,h.PolyhedronBufferGeometry=ra,h.PolyhedronGeometry=Fu,h.PositionalAudio=hp,h.PropertyBinding=Qa,h.PropertyMixer=pp,h.QuadraticBezierCurve=ri,h.QuadraticBezierCurve3=ji,h.Quaternion=Bi,h.QuaternionKeyframeTrack=ml,h.QuaternionLinearInterpolant=Ql,h.REVISION="113",h.RGBADepthPacking=Ci,h.RGBAFormat=Or,h.RGBAIntegerFormat=No,h.RGBA_ASTC_10x10_Format=rs,h.RGBA_ASTC_10x5_Format=Sr,h.RGBA_ASTC_10x6_Format=ns,h.RGBA_ASTC_10x8_Format=vs,h.RGBA_ASTC_12x10_Format=Fo,h.RGBA_ASTC_12x12_Format=Ji,h.RGBA_ASTC_4x4_Format=Vs,h.RGBA_ASTC_5x4_Format=no,h.RGBA_ASTC_5x5_Format=gs,h.RGBA_ASTC_6x5_Format=Pa,h.RGBA_ASTC_6x6_Format=ys,h.RGBA_ASTC_8x5_Format=ro,h.RGBA_ASTC_8x6_Format=io,h.RGBA_ASTC_8x8_Format=Xr,h.RGBA_PVRTC_2BPPV1_Format=Ea,h.RGBA_PVRTC_4BPPV1_Format=Bo,h.RGBA_S3TC_DXT1_Format=es,h.RGBA_S3TC_DXT3_Format=fs,h.RGBA_S3TC_DXT5_Format=to,h.RGBDEncoding=hi,h.RGBEEncoding=Xt,h.RGBEFormat=si,h.RGBFormat=Gr,h.RGBIntegerFormat=oa,h.RGBM16Encoding=or,h.RGBM7Encoding=Gn,h.RGB_ETC1_Format=ms,h.RGB_PVRTC_2BPPV1_Format=sa,h.RGB_PVRTC_4BPPV1_Format=ts,h.RGB_S3TC_DXT1_Format=Fs,h.RGFormat=Da,h.RGIntegerFormat=$n,h.RawShaderMaterial=Is,h.Ray=Ar,h.Raycaster=Jp,h.RectAreaLight=vd,h.RedFormat=H,h.RedIntegerFormat=Hr,h.ReinhardToneMapping=ht,h.RepeatWrapping=Zt,h.ReplaceStencilOp=7681,h.ReverseSubtractEquation=N,h.RingBufferGeometry=Bc,h.RingGeometry=Uu,h.Scene=Hn,h.SceneUtils=Bf,h.ShaderChunk=Dr,h.ShaderLib=bo,h.ShaderMaterial=Xa,h.ShadowMaterial=pl,h.Shape=$a,h.ShapeBufferGeometry=Ko,h.ShapeGeometry=Kl,h.ShapePath=rp,h.ShapeUtils=us,h.ShortType=Ue,h.Skeleton=Eu,h.SkeletonHelper=Ad,h.SkinnedMesh=_c,h.SmoothShading=2,h.Sphere=Kr,h.SphereBufferGeometry=hl,h.SphereGeometry=zu,h.Spherical=Xp,h.SphericalHarmonics3=Sd,h.SphericalReflectionMapping=Xn,h.Spline=Ip,h.SplineCurve=zr,h.SplineCurve3=bf,h.SpotLight=tc,h.SpotLightHelper=Pd,h.SpotLightShadow=yl,h.Sprite=bc,h.SpriteMaterial=al,h.SrcAlphaFactor=W,h.SrcAlphaSaturateFactor=xe,h.SrcColorFactor=U,h.StaticCopyUsage=35046,h.StaticDrawUsage=Wr,h.StaticReadUsage=35045,h.StereoCamera=Vp,h.StreamCopyUsage=35042,h.StreamDrawUsage=35040,h.StreamReadUsage=35041,h.StringKeyframeTrack=Ku,h.SubtractEquation=B,h.SubtractiveBlending=F,h.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},h.TangentSpaceNormalMap=vo,h.TetrahedronBufferGeometry=Ac,h.TetrahedronGeometry=yr,h.TextBufferGeometry=pa,h.TextGeometry=Ui,h.Texture=Yr,h.TextureLoader=wt,h.TorusBufferGeometry=Jl,h.TorusGeometry=Ic,h.TorusKnotBufferGeometry=yi,h.TorusKnotGeometry=gi,h.Triangle=Ri,h.TriangleFanDrawMode=2,h.TriangleStripDrawMode=1,h.TrianglesDrawMode=0,h.TubeBufferGeometry=Os,h.TubeGeometry=Lc,h.UVMapping=300,h.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new pi(e,t)},h.Uint16BufferAttribute=pi,h.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Mi(e,t)},h.Uint32BufferAttribute=Mi,h.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new tr(e,t)},h.Uint8BufferAttribute=tr,h.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ci(e,t)},h.Uint8ClampedBufferAttribute=ci,h.Uncharted2ToneMapping=Tt,h.Uniform=Dd,h.UniformsLib=bn,h.UniformsUtils=sh,h.UnsignedByteType=kr,h.UnsignedInt248Type=qr,h.UnsignedIntType=$e,h.UnsignedShort4444Type=an,h.UnsignedShort5551Type=hr,h.UnsignedShort565Type=_r,h.UnsignedShortType=lt,h.VSMShadowMap=f,h.Vector2=zt,h.Vector3=Oe,h.Vector4=Jr,h.VectorKeyframeTrack=ec,h.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Oe(e,t,n)},h.VertexColors=2,h.VideoTexture=Hl,h.WebGLCubeRenderTarget=Ys,h.WebGLMultisampleRenderTarget=zs,h.WebGLRenderTarget=qi,h.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Ys(e,n)},h.WebGLRenderer=Su,h.WebGLUtils=jl,h.WireframeGeometry=Pc,h.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new fi(new Pc(e.geometry),new ki({color:t!==void 0?t:16777215}))},h.WrapAroundEnding=Te,h.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new P(e)},h.ZeroCurvatureEnding=Ce,h.ZeroFactor=m,h.ZeroSlopeEnding=ue,h.ZeroStencilOp=0,h.sRGBEncoding=vt,Object.defineProperty(h,"__esModule",{value:!0})},typeof o=="object"&&r!==void 0?v(o):typeof define=="function"&&define.amd?define(["exports"],v):v((a=a||self).THREE={})},{}],20:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MrxDbgUtils=void 0;var a,v,h=b("three"),w=b("./Operate/MxEntSelJig"),L=b("./Operate/MxJigCmdManager"),G=b("./UI/MxUiVue"),k=b("./Operate/MrxDbgUiPrPoint"),D=b("./Operate/MrxDbgUiPrBase"),f=b("./MxThreeJS");(v=a||(o.MrxDbgUtils=a={})).findEntAtPoint=function(O,C,j,V,R){return j===void 0&&(j=null),V===void 0&&(V=!0),new Promise(function(M){for(var ee=O.findMxEntityAtPoint(C,V,R),F=[],_=ee.length,J=0;J<_;J++){var T=ee[J];if(!j||!j.type||j.type==T.getTypeName()){var B=T.objectId();F.push(B)}}M(F)})},v.selectEnt=function(O,C){return C===void 0&&(C=null),new Promise(function(j){var V=new w.MxEntSelJig;V.disableAllTrace(),V.setDynamicInputType(L.MxJigCmdManager.DynamicInputType.kDynTip),O&&G.MxUiVue.acutPrintf(O),V.filter=C,V.callRet=function(R){j(R)},L.MxJigCmdManager.runCmd(V)})},v.getCorner=function(O,C,j,V,R){return j===void 0&&(j=!1),R===void 0&&(R=!1),new Promise(function(M){var ee=new k.MrxDbgUiPrPoint;ee.setMessage(C),j?(ee.setDynamicInputType(L.MxJigCmdManager.DynamicInputType.kDynTip),ee.disableAllTrace()):(ee.setDynamicInputType(L.MxJigCmdManager.DynamicInputType.kXYCoordInput),R&&ee.disableAllTrace());var F=new D.McEdGetPointWorldDrawObject;F.setDraw(function(_,J){var T=new h.Vector3(O.x,_.y,_.z),B=new h.Vector3(_.x,O.y,_.z),N=[];N.push(O),N.push(T),N.push(_),N.push(B),N.push(O);var u=null,c=65280;if(j){if(_.x>O.x)u=f.MxThreeJS.createLines(N,16777215),c=255;else{var m=J.getMcEdJig().getMxObject().viewCoordLong2Cad(3);u=f.MxThreeJS.createDashedLines(N,16777215,2*m,m)}var E=[];E.push(O),E.push(T),E.push(_),E.push(O),E.push(_),E.push(B);var U=f.MxThreeJS.createTriangle(E,c,.27);J.drawEntity(U,30),J.drawEntity(u,31)}else u=f.MxThreeJS.createLines(N,16777215),J.drawEntity(u,31)}),ee.setUserDraw(F),ee.go(function(_){V&&V({status:_,detailedResult:ee.getDetailedResult()}),_!=0?M(null):(ee.clearLastInputPoint(),M(ee.value()))})})}},{"./MxThreeJS":37,"./Operate/MrxDbgUiPrBase":45,"./Operate/MrxDbgUiPrPoint":47,"./Operate/MxEntSelJig":50,"./Operate/MxJigCmdManager":54,"./UI/MxUiVue":65,three:19}],21:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawCommands=void 0;var a,v=b("./MxFun"),h=b("./MxType"),w=b("./Operate/MxIntelliSelect"),L=b("./Operate/MxJigCmdManager");function G(j){j!=null&&j.grips!=null&&j.ids!=null&&v.MxFun.getCurrentMx().getMcObject().getGripManager().gripEditImp(j)}function k(j){if(j!=null&&j.pt!=null){var V=v.MxFun.getCurrentMx(),R=j.pt;if(!V.getMxDatabase().getGripManager().doPointSelect(R)){var M=!0;if(V.isValidMcObject()&&V.getMcObject().getGripManager().doPointSelect(R)&&(M=!1),v.MxFun.isPC()||(M=!1),M&&V.isMultipleSelect){var ee=V.screenCoord2Current(R.x,R.y,0),F=new w.MxIntelliSelectJig(ee);F.setDisableDynInput(!0),F.setDisableOsnap(!0),L.MxJigCmdManager.runCmd(F)}}}}function D(j){j!=null&&j.grips!=null&&j.ents!=null&&v.MxFun.getCurrentMx().getMxDatabase().getGripManager().gripEditImp(j)}function f(){v.MxFun.getCurrentMx().getMcObject().undo()}function O(){v.MxFun.getCurrentMx().getMcObject().redo()}function C(){v.MxFun.getCurrentMx().startPanCommand()}(a||(o.MxDrawCommands=a={})).registerCommand=function(){v.MxFun.addCommand("Mx_FrontEndWebpageIntelliSel",k,h.MxType.MxCommandFlag.MCRX_CMD_TRANSPARENT|h.MxType.MxCommandFlag.MCRX_CMD_NO_UNDO_MARKER|h.MxType.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT|h.MxType.MxCommandFlag.MCRX_CMD_NO_RECORD_PRVCMD),v.MxFun.addCommand("Mx_FrontEndWebpageGripEdit",D,h.MxType.MxCommandFlag.MCRX_CMD_TRANSPARENT|h.MxType.MxCommandFlag.MCRX_CMD_NO_UNDO_MARKER|h.MxType.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT|h.MxType.MxCommandFlag.MCRX_CMD_NO_RECORD_PRVCMD),v.MxFun.addCommand("McDraw_GripEdit",G,h.MxType.MxCommandFlag.MCRX_CMD_TRANSPARENT|h.MxType.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT|h.MxType.MxCommandFlag.MCRX_CMD_NO_RECORD_PRVCMD),v.MxFun.addCommand("Mx_Undo",f,h.MxType.MxCommandFlag.MCRX_CMD_NO_UNDO_MARKER),v.MxFun.addCommand("Mx_Redo",O,h.MxType.MxCommandFlag.MCRX_CMD_NO_UNDO_MARKER),v.MxFun.addCommand("Mx_Pan",C,h.MxType.MxCommandFlag.MCRX_CMD_NO_UNDO_MARKER)}},{"./MxFun":27,"./MxType":39,"./Operate/MxIntelliSelect":52,"./Operate/MxJigCmdManager":54}],22:[function(b,r,o){var a,v;Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawData=void 0,(v=a||(o.MxDrawData=a={})).m_dInputRectWidth=16,v.m_isEnableIntelliSelect=!0,v.m_isEnableGripEidt=!0,v.m_isForbiddenDynInput=!1,v.m_isMultipleSelect=!1,v.m_isAutoResetRenderer=!1,v.m_isCorrectLargeCoordinates=!0,v.m_isRequestHeaderCacheControl=!1,v.m_gripPointColor=3355443455,v.m_isMapBox=!1,v.setIniset=function(h){h.EnableIntelliSelect!==void 0&&typeof h.EnableIntelliSelect=="boolean"&&(v.m_isEnableIntelliSelect=h.EnableIntelliSelect),h.EnableGripEidt!==void 0&&typeof h.EnableGripEidt=="boolean"&&(v.m_isEnableGripEidt=h.EnableGripEidt),h.ForbiddenDynInput!==void 0&&typeof h.ForbiddenDynInput=="boolean"&&(v.m_isForbiddenDynInput=h.ForbiddenDynInput),h.multipleSelect!==void 0&&typeof h.multipleSelect=="boolean"&&(v.m_isMultipleSelect=h.multipleSelect),h.autoResetRenderer!==void 0&&typeof h.autoResetRenderer=="boolean"&&(v.m_isAutoResetRenderer=h.autoResetRenderer),h.correctLargeCoordinates!==void 0&&typeof h.correctLargeCoordinates=="boolean"&&(v.m_isCorrectLargeCoordinates=h.correctLargeCoordinates),h.requestHeaderCacheControl!==void 0&&typeof h.requestHeaderCacheControl=="boolean"&&(v.m_isRequestHeaderCacheControl=h.requestHeaderCacheControl),h.MapBox!==void 0&&typeof h.MapBox=="boolean"&&(v.m_isMapBox=h.MapBox),h.inputRectWidth!==void 0&&typeof h.inputRectWidth=="number"&&(v.m_dInputRectWidth=h.inputRectWidth),h.gripPointColor!==void 0&&typeof h.gripPointColor=="number"&&(v.m_gripPointColor=h.gripPointColor)}},{}],23:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObject=o.IniSetName=o.MxRunMode=void 0;var a,v,h,w=b("three"),L=b("./MxFun"),G=b("./View/MxBrowseLayerData"),k=b("./View/MxBrowseDisplay"),D=b("./MxNetData"),f=b("./MxNetData"),O=b("./MxManager"),C=b("./MxSystemVariable"),j=b("./MxLocalFileLoad"),V=b("./Operate/MxDrawObjectOsnap"),R=b("./View/MxDbDatabase"),M=b("./View/MxDrawMapBox"),ee=b("./MxDrawObjectEvent"),F=b("./View/MxDbEntityGrip"),_=b("./cpp/McDrawObject"),J=b("./UI/MxUiVue"),T=b("./MxDrawData"),B=b("./MxTempMarkDraw");(v=a||(o.MxRunMode=a={}))[v.kBrowse=1]="kBrowse",v[v.kCPPMxCAD=4]="kCPPMxCAD",(h||(o.IniSetName=h={})).kEnableOsnapFunction="EnableOsnapFunction";var N=(u.prototype.getCurrentMousePostion=function(){return this.curMousePostion},u.prototype.isValidCurMousePostion=function(){return this.m_isValidCurMousePostion},u.prototype.setCurrentMousePostion=function(c,m){if(m===void 0&&(m=!1),m){if(0<c.touches.length){var E=c.target.getBoundingClientRect();this.curMousePostion.x=c.touches[0].clientX-E.left,this.curMousePostion.y=c.touches[0].clientY-E.top,this.m_isValidCurMousePostion=!0}}else this.curMousePostion.x=c.offsetX,this.curMousePostion.y=c.offsetY,this.m_isValidCurMousePostion=!0},u.prototype.mapBoxRender=function(c,m,E){this.mcObject.updateDisplayMapBox(m),E||(this.camera.projectionMatrix=m,this.renderer.autoClear=!1,this.renderer.state.reset(),this.secenView&&this.renderer.render(this.secenView,this.cameraView),this.renderer.render(this.scene,this.camera),this._callCreateCanvasImageData!=null&&(this._callCreateCanvasImageData(this.renderer.domElement.toDataURL("image/png")),this._callCreateCanvasImageData=void 0)),this.callEvent("render",this.renderer)},u.prototype.mapBoxInitThreeJSObject=function(c,m,E,U){this.scene=c,this.camera=m,this.renderer=E,this.controls=U},u.prototype.getMxDrawThreeJs=function(){return this.mxdrawThreeJS},u.prototype.setPointMultipleSelect=function(c){this.isPointMultipleSelect=c},u.prototype.pointMultipleSelect=function(){return this.isPointMultipleSelect},u.prototype.getMcObject=function(){return this.mcObject},u.prototype.getSysVarLong=function(c){return this.mcObject.isValid()?this.mcObject.getSysVarLong(c):this.m_sysVariable.getSysVarNumber(c)},u.prototype.getSysVarDouble=function(c){return this.mcObject.isValid()?this.mcObject.getSysVarDouble(c):this.m_sysVariable.getSysVarNumber(c)},u.prototype.getSysVarPoint=function(c){return this.mcObject.isValid()?this.mcObject.getSysVarPoint(c):this.m_sysVariable.getSysVarPoint(c)},u.prototype.getCAD2DocMatrix=function(){return this._cad2Doc},u.prototype.isValidMcObject=function(){return this.mcObject.isValid()},u.prototype.getId=function(){return this.id},u.prototype.getEventManager=function(){return this.eventManager},u.prototype.setCurrentLoadUrl=function(c){this._sCurrentLoadURL=c},u.prototype.getCurrentLoadUrl=function(){return this._sCurrentLoadURL},u.prototype.isWebgl2=function(){return!(!this._rendererParam||this._rendererParam.retver!="webgl2")},u.prototype.getMxDatabase=function(){return this.m_mxDatabase},u.prototype.updateCanvasSize=function(){this._onResizeFun&&this._onResizeFun()},u.prototype.addMxEntity=function(c){return this.m_mxDatabase.addMxEntity(c)},u.prototype.getMxEntity=function(c){return this.m_mxDatabase.getEntity(c)},u.prototype.getMxEntityUserObject=function(c){var m=this.getMxEntity(c);return m?m.getUserObject():null},u.prototype.eraseAllMxEntity=function(){this.m_mxDatabase.eraseAllEntity()},u.prototype.eraseMxEntity=function(c){var m=this.m_mxDatabase.getEntity(c);return!!m&&m.erase()},u.prototype.getAllMxEntity=function(){var c=[];return this.m_mxDatabase.getAllEntity().forEach(function(m){m&&c.push(m.getUserObject())}),c},u.prototype.getMxAllSelect=function(){var c=this.m_mxDatabase.getSelectManager().getAllSelect(),m=this.m_mxDatabase.getGripManager().getAllSelect(),E=new Set;return c.forEach(function(U){E.add(U)}),m.forEach(function(U){E.has(U)||c.push(U)}),c},u.prototype.getPrvCommandSelect=function(){return this.m_mxDatabase.getSelectManager().getPrvCommandSelect()},u.prototype.getMxCADAllSelect=function(){return this.mcObject.isValid()?this.mcObject.getGripManager().getAllSelect():[]},u.prototype.getSelectPoints=function(){return this.mcObject.getGripManager().getSelectPoints()},u.prototype.getPrvCommandMxCADSelect=function(){return this.mcObject.isValid()?this.mcObject.getGripManager().getPrvCommandSelect():[]},u.prototype.addMxCurrentSelect=function(c,m,E){return m===void 0&&(m=!0),E===void 0&&(E=!0),this.m_mxDatabase.getGripManager().addSelect(c,m,E)},u.prototype.addMxCADCurrentSelect=function(c,m,E){return m===void 0&&(m=!0),E===void 0&&(E=!0),!!this.mcObject.isValid()&&this.mcObject.getGripManager().addSelect(c,m,E)},u.prototype.fireSelectChange=function(c){if(c){if(this.mcObject.isValid())return this.mcObject.getGripManager().fireSelectChange()}else this.m_mxDatabase.getGripManager().fireMxEntitySelectChange()},u.prototype.clearMxCurrentSelect=function(){var c=this.m_mxDatabase.clearMxCurrentSelect();return this.mcObject.isValid()&&this.mcObject.getGripManager().clearAll(),c},u.prototype.addViewObject=function(c){this.secenView?this.threejsselectObjectsView.add(c):console.log("this.secenView is null")},u.prototype.removeViewObject=function(c){L.MxFun.removeThreejsObject(c,this.threejsselectObjectsView)},u.prototype.setOtherRefFile=function(c){this._tzDwgStaticFile=c},u.prototype.setRequestHeader=function(c){this._requestHeader=c},u.prototype.initZoomW=function(c,m){this._initZoomwCoordPt1=c.clone(),this._initZoomWCoordPt2=m.clone()},u.prototype.setMouseRightRotate=function(c){this._mouseRightRotate=c,this.controls!=null&&(this.controls.mouseButtons.RIGHT=c?w.MOUSE.ROTATE:-1)},u.prototype.setZoomSpeed=function(c){var m=this.controls.zoomSpeed;return this.controls.zoomSpeed=c,m},u.prototype.resetRenderer=function(){this.renderer.info.reset()},u.prototype.getRenderer=function(){return this.renderer},u.prototype.isPaningCommand_call=function(){return this.bakControls!=null},u.prototype.startPanCommand_call=function(){this.bakControls={},this.bakControls.LEFT=this.controls.mouseButtons.LEFT,this.bakControls.RIGHT=this.controls.mouseButtons.RIGHT,this.bakControls.MIDDLE=this.controls.mouseButtons.MIDDLE,this.controls.mouseButtons.LEFT=w.MOUSE.PAN,this._mouseRightRotate?this.controls.mouseButtons.RIGHT=w.MOUSE.ROTATE:this.controls.mouseButtons.RIGHT=-1,this.controls.mouseButtons.MIDDLE=1,J.MxUiVue.setCursorType(J.MxUiVue.CursorType.kPan)},u.prototype.endPanCommand_call=function(){this.bakControls&&(this.controls.mouseButtons.LEFT=this.bakControls.LEFT,this.controls.mouseButtons.RIGHT=this.bakControls.RIGHT,this.controls.mouseButtons.MIDDLE=this.bakControls.MIDDLE,this.bakControls=void 0,J.MxUiVue.setCursorType(J.MxUiVue.CursorType.kNormal))},u.prototype.isPaningCommand=function(){return this.mxdrawThreeJS.isPaningCommand()},u.prototype.startPanCommand=function(){this.mxdrawThreeJS.startPanCommand()},u.prototype.endPanCommand=function(){this.mxdrawThreeJS.endPanCommand()},u.prototype.setMouseMiddlePan=function(c){this._isMouseMiddlePan=typeof c=="boolean"?c?1:0:c,this.controls!=null&&(this._isMouseMiddlePan==1?(this.controls.mouseButtons.LEFT=-1,this.controls.mouseButtons.RIGHT=-1,this.controls.mouseButtons.MIDDLE=w.MOUSE.PAN):this._isMouseMiddlePan==2?(this.controls.mouseButtons.LEFT=w.MOUSE.PAN,this.controls.mouseButtons.RIGHT=-1,this.controls.mouseButtons.MIDDLE=w.MOUSE.PAN):(this.controls.mouseButtons.LEFT=w.MOUSE.PAN,this._mouseRightRotate?this.controls.mouseButtons.RIGHT=w.MOUSE.ROTATE:this.controls.mouseButtons.RIGHT=-1,this.controls.mouseButtons.MIDDLE=1))},u.prototype.resetThreeJSControls=function(){this.controls&&(this.controls.saveState(),this.controls.reset())},u.prototype.enableZoom=function(c){this.controls!=null&&(this.controls.enableZoom=c)},u.prototype.enablePan=function(c){this.controls!=null&&(this.controls.enablePan=c)},u.prototype.getOrbitControls=function(){return this.controls},u.prototype.enableViewControls=function(c){this.controls.enabled=c},u.prototype.initRunMode=function(c){this._isCreate?console.log("iniRunMode failed,mxobject already created"):this._runMode=c},u.prototype.getRunMode=function(){return this._runMode},u.prototype.setStaticLocalLoad=function(c){this._isStaticLocalLoad=c},u.prototype.isStaticLocalLoad=function(){return this._isStaticLocalLoad},u.prototype.setStaticLocalLoadPath=function(c){this._staticLocalLoadPath=c},u.prototype.on=function(c,m){if(this._event[c])if(this._event[c]instanceof Array)this._event[c].includes(m)||this._event[c].push(m);else{var E=this._event[c];if(E==m)return;this._event[c]=[],this._event[c].push(E),this._event[c].push(m)}else this._event[c]=m},u.prototype.addEvent=function(c,m){this.on(c,m)},u.prototype.addControlsEvent=function(c,m,E){return E===void 0&&(E=!1),this.eventManager.addEventListener(c,m,E)},u.prototype.removeEvent=function(c){this._event[c]=void 0},u.prototype.removeEventFuction=function(c,m){if(this._event[c]){if(this._event[c]instanceof Array){var E=this._event[c].indexOf(m);if(E!=-1)return this._event[c].splice(E,1),this._event[c].length==0&&delete this._event[c],!0}else if(this._event[c]==m)return delete this._event[c],!0}return!1},u.prototype.sysVariable=function(){return this.m_sysVariable},u.prototype.setIniset=function(c){var m=this;Object.keys(c).forEach(function(E){m.m_iniSet[E]=c[E]}),T.MxDrawData.setIniset(c),c.multipleSelect!==void 0&&typeof c.multipleSelect=="boolean"&&(this.isMultipleSelect=c.multipleSelect)},u.prototype.getInisetValue=function(c){return this.m_iniSet[c]},u.prototype.getViewColor=function(){return this._viewcolor},u.prototype.isWhiteViewColor=function(){return!!this.mcObject.isPaperSpaceDisplay()||this._viewcolor==16777215},u.prototype.initUserLoginData=function(c,m){this._userIdentitySign=c,this._userRandomToken=m},u.prototype.initRendererParam=function(c){this._rendererParam=c},u.prototype.getRendererParam=function(){return this._rendererParam},u.prototype.automaticInversionColor=function(c){return this._viewcolor!=16777215||c!=16777215?c:0},u.prototype.automaticInversionColor2=function(c){return this._viewcolor==16777215&&(16777215&c)==16777215?4278190080&c:c},u.prototype.setViewColor=function(c){this._viewcolor=c,this._runMode!=a.kCPPMxCAD&&this.scene!=null&&(this.scene.background=new w.Color(c))},u.prototype.zoomScale=function(c,m){this.mxdrawThreeJS.zoomScale(c,m)},u.prototype.setViewAngle=function(c){this.mxdrawThreeJS.setViewAngle(c)},u.prototype.zoomW=function(c,m,E,U,X){X===void 0&&(X=!1),this.mxdrawThreeJS.zoomW(c,m,E,U,X)},u.prototype.zoomCenter=function(c,m,E){this.mxdrawThreeJS.zoomCenter(c,m,E)},u.prototype.getViewAngle=function(){return this._viewangle},u.prototype.callInitCompleteEvent=function(){this.callEvent("loadComplete")},u.prototype.callInitObjectEvent=function(){this.callEvent("initObject")},u.prototype.callInitSceneEvent=function(c,m,E){var U=this._event.initScene;if(!U)return 0;if(U instanceof Array){var X=0;return U.forEach(function(W){X=W(c,m,E)}),X}return U(c,m,E)},u.prototype.callOpenFileComplete=function(c,m){m===void 0&&(m=0);try{var E=this._event.openFileComplete;if(!E)return;E instanceof Array?E.forEach(function(U){U(c,m)}):E(c,m)}catch(U){throw console.log(U),U}},u.prototype.hasEvent=function(c){return this._event[c]!=null},u.prototype.regenAllMxDbEntity=function(){return this.m_mxDatabase.regenAllMxDbEntity()},u.prototype.callEvent=function(c,m){try{var E=this._event[c];if(!E)return!1;if(E instanceof Array){var U=!1;return E.forEach(function(X){U=X(m)}),U}return E(m)}catch(X){throw console.log(X),X}},u.prototype.callViewChange=function(){this.onViewChange(),this.callEvent("viewchange")},u.prototype.userLoginResult=function(c){this.callEvent("userLoginResult",c)},u.prototype.serverReturn=function(c){var m=JSON.parse(c);this.callEvent("serverReturn",m)},u.prototype.openFileResult=function(c){JSON.parse(c).linkServer||console.log("link mx serverobj error"),this.callEvent("openFileResult",c)},u.prototype.xzSize=function(c){var m=this._devicePixelRatio;if(m-1<=1e-4&&-1e-4<=m-1)return c;for(var E=9999999,U=c,X=0,W=c;X<100;X++){if((ne=(te=W*m)-Math.floor(te))<=.001)return W;ne<E&&(E=ne,U=W),W+=1}for(W=c;X<100;X++){var te,ne;if((ne=(te=W*m)-Math.floor(te))<=.001)return W;ne<E&&(E=ne,U=W),--W}return U},u.prototype.setSize=function(c,m){this._viewWidth=c,this._viewHeight=m,this._userCanvas!=null&&(this._userCanvas.width=c,this._userCanvas.height=m,this._userCanvas.style.width=c+"px",this._userCanvas.style.height=m+"px"),this.onResizeImp(),this.updateDisplay()},u.prototype.getCurrentColor=function(){return this._color},u.prototype.setCurrentColor=function(c){this._color=c},u.prototype.call=function(c,m,E){this._net.getSend().CallServerJS(c,m,E)},u.prototype.zoomAll=function(){this._is2d&&this.call("getDatabaseBoundHelp",'{"isBackground":1}',function(c){if(c.length!=0){var m=JSON.parse(c);this.zoomW(new w.Vector3(m[0],m[1],0),new w.Vector3(m[2],m[3],0))}})},u.prototype.getViewCenterDocCoord=function(){return this._userCanvas!=null?this.screenCoord2Current(.5*this._userCanvas.clientWidth,.5*this._userCanvas.clientHeight,0):this.screenCoord2Current(.5*this._viewWidth,.5*this._viewHeight,0)},u.prototype.closeWebSocket=function(){this._net.closeWebSocket()},u.prototype.findMxEntityAtPoint=function(c,m,E){!m&&m!==void 0||(c=this.currentCoord2Screen(c.x,c.y,0));var U=[],X=this.m_mxDatabase.getIntersectObjects(c);if(X.length==0)return U;var W=new Map;return X.forEach(function(te){var ne=(0,F.MxGetMxDbEntitForThreeJsObject)(te.object);if(ne){var ce=ne.objectId();if(!W.has(ce)){if(E){var we=(0,F.MxGetWordDrawxDataForThreeJsObject)(te.object);we&&E(ce,we)}W.set(ce,ne.getUserObject())}}}),W.forEach(function(te){U.push(te)}),U},u.prototype.isCppMxCAD=function(){return this._runMode==a.kCPPMxCAD},u.prototype.loadMxCADImage=function(c,m){var E=this;if(this.mcObject.isValid()){var U=c;U.lastIndexOf("/")!=-1&&(U=U.substring(U.lastIndexOf("/")+1).toLowerCase()),this.mcObject.getTextureManager().loadImage(c,U,function(X,W){X?(E.mcObject.getTextureManager().createOpenGLTexture(c),m(W)):m(void 0)})}else m(void 0)},u.prototype.onLoad=function(c){if(this._runMode==a.kCPPMxCAD)this.callInitCompleteEvent();else if(this._isStaticLocalLoad)this._net=new f.MxNet,this._net.init(this,!1),0<this._openFile.length&&(this._staticLocalNet=new j.MxLocalDwgFileLoad(this._net),this._staticLocalNet.load(encodeURIComponent(this._staticLocalLoadPath),encodeURIComponent(this._openFile)));else if(this._openFile.length==0)this.callInitCompleteEvent(),this.callOpenFileComplete(0);else if(this._net=new f.MxNet,this._net.init(this,!1),this._staticNet=new f.MxHFileLoad(this._net),this._staticNet.setRequestHeader(this._requestHeader),this._staticNet.setUrlParam(c),this._staticNet.load(this._openFile,this._staticLoadingOpenFiles),this._tzDwgStaticFile&&0<this._tzDwgStaticFile.length){var m=new f.MxNet;m.init(this,!1),this._extRefManager.createTzDwgExternalReferences(99999),m.setCurrentDatabaseId(99999),this._staticLoadTzNet=new f.MxHFileLoad(m),this._staticLoadTzNet.setShowloading(!1),this._staticLoadTzNet.setRequestHeader(this._requestHeader),this._staticLoadTzNet.load(this._tzDwgStaticFile,[])}},u.prototype.stopAllLoading=function(){this._staticNet&&this._staticNet.stopAllLoading()},u.prototype.getStaticNet=function(){return this._staticNet},u.prototype.isStaticFileNet=function(){return!this._isStaticLocalLoad&&this._staticNet!=null},u.prototype.getStaticLocalNet=function(){return this._staticLocalNet},u.prototype.getStaticLoadTzNet=function(){return this._staticLoadTzNet},u.prototype.getViewWidth=function(){return this._userCanvas!=null?this._userCanvas.clientWidth:this._viewWidth},u.prototype.getViewHeight=function(){return this._userCanvas!=null?this._userCanvas.clientHeight:this._viewHeight},u.prototype.makeCurrent=function(){O.MxManager.setCurrentMx(this),this.mcObject.makeCurrent()},u.prototype.createCanvasImageData=function(c,m){var E=0,U=0,X=!1,W=!1,te=!1;m&&m.range_pt1&&m.range_pt2&&(te=W=!0,this.saveZoom()),m&&m.width&&m.height&&(E=this.getViewWidth(),U=this.getViewHeight(),X=!0,this.setSize(m.width,m.height)),te&&this.zoomW(m.range_pt1,m.range_pt2);var ne=this;this._callCreateCanvasImageData=function(ce){X&&ne.setSize(E,U),W&&ne.recoverZoom(),c(ce)},this.updateDisplay()},u.prototype.getIntersectObjects=function(c){return this.getMxDrawThreeJs().createRaycaster(c).intersectObjects(this.threejsselectObjects.children,!0)},u.prototype.addObject=function(c){this.threejsselectObjects.add(c)},u.prototype.removeObject=function(c){this.threejsselectObjects.remove(c)},u.prototype.render=function(){this.secenView?(this.mcObject.updateDisplay()?(this.renderer.autoClear=!1,this.renderer.state.reset()):this.renderer.autoClear=!0,this.renderer.render(this.secenView,this.cameraView),this.renderer.autoClear=!1):this.mcObject.updateDisplay()?(this.renderer.autoClear=!1,this.renderer.state.reset()):this.renderer.autoClear=!0,this.renderer.render(this.scene,this.camera),this._callCreateCanvasImageData!=null&&(this._callCreateCanvasImageData(this.renderer.domElement.toDataURL("image/png")),this._callCreateCanvasImageData=void 0),this.callEvent("render",this.renderer)},u.prototype.updateDisplay=function(c){c===void 0&&(c=!1),this.mxdrawThreeJS.updateDisplay(c)},u.prototype.isRenderLoop=function(){return this._isAnimation},u.prototype.renderLoop=function(c){c===void 0&&(c=!0),this._isAnimation=c,this.updateDisplay()},u.prototype.updateDisplayImplement=function(c){c===void 0&&(c=!1);var m=this,E=function(){m.m_mxDatabase.upDirtyDisplay(),m._isAnimation?(m._isAnimationStarting=!0,requestAnimationFrame(E)):m._isWaiteCount=0,m.render()};c!==!0?this._isAnimationStarting||(this._isAnimation?requestAnimationFrame(E):((5<this._isWaiteCount||this._isWaiteCount<0)&&(this._isWaiteCount=0),this._isWaiteCount<=0&&requestAnimationFrame(E),this._isWaiteCount++)):E()},u.prototype.gotoLayoutOld=function(c){c=="Modle"&&(c="");var m=this._openFile;for(var E in this._iniParam)(te=(W=this._iniParam[E])[0])=="srcname"&&(m=W[1]);var U={},X="";for(var E in this._iniParam){var W,te;if(U[te=(W=this._iniParam[E])[0]]==null){U[te]=!0;var ne=W[1];if(te=="file"){if(ne=m,0<c.length){var ce=ne.substring(ne.lastIndexOf(".")+1);ne=ne.substring(0,ne.lastIndexOf("."))+"%23"+c+"%23."+ce}}else if(te=="srcname")continue;X.length==0?X=te+"="+ne+"&srcname="+m:X+="&"+te+"="+ne}}var we=L.MxFun.getLocationPageUrl()+"?"+X;window.location.href=we},u.prototype.gotoLayout=function(c){var m=!1,E=!this.isStaticFileNet();for(var U in this._iniParam)if((we=this._iniParam[U])[0]=="dwgdir"){m=!0;break}if(m||E)this.gotoLayoutOld(c);else{c=="Model"&&(c="");var X=this._openFile;if(!X)return;var W=X.lastIndexOf(".dwg");if(W===void 0||W===-1)return;if((X=X.substring(0,W))[X.length-1]=="#"){var te=X.substring(0,X.length-1),ne=te.lastIndexOf("#");ne!==void 0&&ne!==-1&&(X=te.substring(0,ne))}0<c.length?X=X+"#"+c+"#.dwg.mxb1.wgh":X+=".dwg.mxb1.wgh";var ce={};for(var U in this._iniParam){var we,Ie=(we=this._iniParam[U])[0];if(ce[Ie]==null){ce[Ie]=!0;var xe=we[1];Ie!="file"&&Ie!="srcname"&&(X+="&"+Ie+"="+xe)}}var Be=L.MxFun.getLocationPageUrl()+"?file="+X;window.location.href=encodeURI(Be)}},u.prototype.addInitParam=function(c,m){var E=new Array;E.push(c),E.push(m),this._iniParam.push(E)},u.prototype.openFile=function(c,m){if(m===void 0&&(m=""),!this._isCreate)return console.log("mx: openFile Fialed mxasser(_isCreate == false)"),!1;if(this.stopAllLoading(),c.length==0)return!1;this.reInit(),this._devicePixelRatio=window.devicePixelRatio,c instanceof Array?(this._openFile=c[0],this._staticLoadingOpenFiles=c):this._openFile=c,this._openFileExtName=this._openFile.substring(this._openFile.lastIndexOf(".")+1),this._iniParam=[],this._initZoomwCoordPt1=null,this._initZoomWCoordPt2=null;var E=new Array;return E.push("file"),E.push(this._openFile),this._iniParam.push(E),this.onLoad(m),!0},u.prototype.updateCameraDisplayRange=function(c,m,E){this.mxdrawThreeJS.updateCameraDisplayRange(c,m,E)},u.prototype.clearAllObject=function(){this.reInit()},u.prototype.newFile=function(c,m,E,U){if(!this._isCreate)return console.log("mx: openFile Fialed mxasser(_isCreate == false)"),!1;var X,W;if(W=c instanceof Object&&m instanceof Object?(X=c,m):(X=new w.Vector3(c,m,0),new w.Vector3(E,U,0)),X.x>W.x){var te=X.x;X.x=W.x,W.x=te}if(X.y>W.y){var ne=X.y;X.y=W.y,W.y=ne}this.reInit(),this._devicePixelRatio=window.devicePixelRatio,this._openFile="",this._openFileExtName="dwg",this._iniParam=[],this._initZoomwCoordPt1=null,this._initZoomWCoordPt2=null;var ce=new w.Matrix4;ce.identity(),this.intiDoc2Wold(ce),this.initCAD2Doc(ce),this.initializingObjectMatrix(),this.mxdrawThreeJS.updateCameraDisplayRange(X,W,0),this.updateDisplay(!0);var we=L.MxFun.getUiObj();we!=null&&(we.SetLayoutData(this._allLayoutName),we.UpDisplayLayout())},u.prototype.calcViewsize=function(){if(this._userCanvas==null)return{viewWidth:window.innerWidth,viewHeight:window.innerHeight};var c=this._userCanvas.clientWidth,m=this._userCanvas.clientHeight;if(this._event.onResize!=null){var E=this._event.onResize;E instanceof Array&&(E=E[0]);var U=E();U!=null&&(c=parseInt(U.width),m=parseInt(U.height))}return{viewWidth:c,viewHeight:m}},u.prototype.initMxCpp=function(c){c&&c.getImp()?(this.mcObject.init(this,c),this.secenView!=null?this.secenView.background=null:this.scene.background=null):console.log("mxerror: mcppObjectImp is null")},u.prototype.create=function(c,m,E,U){if(this._is2d?this.mxdrawThreeJS=U?new M.MxDrawMapBoxThreeJS(U,this):new M.MxDrawObject2dThreeJS(this):this.mxdrawThreeJS=new M.MxDrawObject3dThreeJS(this),this._callCreateCanvasImageData=void 0,this._devicePixelRatio=window.devicePixelRatio,this._runMode==a.kCPPMxCAD)this._openFile="";else{if(m instanceof Array?(this._openFile=m[0],this._staticLoadingOpenFiles=m):this._openFile=m,this._iniParam=L.MxFun.getUrlParams(),this._openFileExtName=this._openFile.substring(this._openFile.lastIndexOf(".")+1),this._openFile!=""){var X=new Array;X.push("file"),X.push(this._openFile),this._iniParam.push(X)}this._userIdentitySign!=""&&(this.addInitParam("userIdentitySign",this._userIdentitySign),this.addInitParam("userRandomToken",this._userRandomToken)),this.addInitParam("runMode","browse")}this._userCanvas=c;var W=window.innerWidth,te=window.innerHeight;if(c!=null&&(W=c.clientWidth,te=c.clientHeight),this._viewWidth=W,this._viewHeight=te,this.m_mxDatabase.getSelectManager().setCanvasSize(W,te),this.mxdrawThreeJS.onInitThreejs(),this.eventManager.registEvent(this),this.onCreate(),this.m_mxDatabase.init(this),this._parentDocObject=new w.Object3D,this.scene.add(this._parentDocObject),this._parentDocObject_SmallCoord=new w.Object3D,this.scene.add(this._parentDocObject_SmallCoord),this.threejsselectObjects=new w.Object3D,this.scene.add(this.threejsselectObjects),this._objectsOsnap=new V.MxDrawObjectOsnap(this),this.tempMarkDraw.init(this),O.MxManager.add(this),O.MxManager.setCurrentMx(this),this.mxdrawThreeJS.addControlsChangeEvent(),U||this.updateDisplay(),this.mxdrawThreeJS.getType()!=M.MxThreeJSType.kMapBox){var ne=this;if(c==null){var ce=function(){ne._viewWidth=window.innerWidth,ne._viewHeight=window.innerHeight,ne.onResizeImp(),ne.updateDisplay()};window.addEventListener("resize",ce,!1),this._onResizeFun=ce}else{var we=function(se){se&&se.viewWidth&&se.viewHeight||(se=ne.calcViewsize()),ne._viewWidth=se.viewWidth,ne._viewHeight=se.viewHeight,ne.onResizeImp(ne._viewWidth,ne._viewHeight),ne.updateDisplay()};if(this._onResizeFun=we,this._event.addResizeEvent!=null){var Ie=this._event.addResizeEvent;Ie instanceof Array&&(Ie=Ie[0]),Ie(we,c)}else window.addEventListener("resize",we,!1);if(window.setTimeout(function(){we()},5),this._event.onResize!=null){var xe=ne.calcViewsize();we(xe);var Be=0,q=0,ge=!0,oe=window.setInterval(function(){q++;var se=ne.calcViewsize();if(se.viewWidth==xe.viewWidth&&se.viewHeight==xe.viewHeight&&0<se.viewWidth&&0<se.viewHeight){if(8<++Be)return clearInterval(oe),void we(se);1<=Be&&ge&&(we(se),2<=Be&&(ge=!1))}else Be=0;xe=se,50<q&&(clearInterval(oe),0<se.viewWidth&&0<se.viewHeight?we(se):console.log("mxassert(0) error view size"))},50)}}}this.callInitObjectEvent(),this.onLoad(E),this._isCreate=!0},u.prototype.initResize=function(){if(this._userCanvas==null)this._viewWidth=window.innerWidth,this._viewHeight=window.innerHeight,this.onResizeImp();else{if(this._viewWidth=this._userCanvas.clientWidth,this._viewHeight=this._userCanvas.clientHeight,this._event.onResize!=null){var c=this._event.onResize;c instanceof Array&&(c=c[0]);var m=c();m!=null&&(this._viewWidth=m.width,this._viewHeight=m.height)}this.onResizeImp(this._viewWidth,this._viewHeight)}this.updateDisplay()},u.prototype.is2D=function(){return this._is2d},u.prototype.getOpenFile=function(){return this._openFile},u.prototype.getFileTitle=function(){var c=this._openFile;if(this._openFile.substring(this._openFile.lastIndexOf(".")+1).toLowerCase()=="wgh"){var m=this._openFile.substring(0,this._openFile.indexOf(".mxb1.wgh")).split("/");(c=m.length==1?m[0]:m[m.length-1])[0]=="$"&&(c=c.substring(1))}return c},u.prototype.getIniParam=function(){return this._iniParam},u.prototype.getOpenFileExtName=function(){return this._openFileExtName},u.prototype.loadCodeToServer=function(c,m){this._net.getSend().CallLoadCodeToServer(c,m)},u.prototype.userLogin=function(c,m){this._net.getSend().UserLogin(c,m)},u.prototype.getUserCanvas=function(){return this._userCanvas},u.prototype.getCanvas=function(){return this._userCanvas!=null?this._userCanvas:this.renderer.domElement},u.prototype.getScene=function(){return this.scene},u.prototype.getCamera=function(){return this.camera},u.prototype.callCommand=function(c,m,E){m===void 0&&(m=""),this._net.getSend().DoCommand(c,m,E)},u.prototype.deleteAll=function(){this.removeAllEntity(),this.callCommand("Mx_ClearAll"),this.updateDisplay()},u.prototype.initAllLayoutName=function(c){this._allLayoutName=c},u.prototype.getAllLayoutName=function(){return this._allLayoutName},u.prototype.updataClipMaterial=function(){this._blocks.updataClipMaterial(this)},u.prototype.getExtRefManager=function(){return this._extRefManager},u.prototype.showLayer=function(c,m){typeof c=="string"&&(c=this._layers.getLayerIdForName(c)),this._blocks.showLayer(c,m),this.updateDisplay()},u.prototype.addLayerInfo=function(c,m,E){m=this.automaticInversionColor(16777215&m),this._layers.add(c,m,E)},u.prototype.setZeroLayerId=function(c){this._layers.setZeroLayerId(c)},u.prototype.addLayerInfoComplete=function(){this._layers.initComplete()},u.prototype.addEntity=function(c,m){var E=this._mapId2Entity.get(c);E==null&&(E=new Array,this._mapId2Entity.set(c,E)),E.push(m)},u.prototype.getEntity=function(c){return this._mapId2Entity.get(c)},u.prototype.clearThreejsScence=function(){this.m_mxDatabase.getGripManager().reInit(),this.isValidMcObject()&&this.mcObject.getGripManager().reInit(),L.MxFun.removeThreejsObject(this.threejsselectObjects,this.scene),this.threejsselectObjects=new w.Object3D,L.MxFun.removeThreejsObject(this._parentDocObject,this.scene),this._parentDocObject=new w.Object3D,L.MxFun.removeThreejsObject(this._parentDocObject_SmallCoord,this.scene),this._parentDocObject_SmallCoord=new w.Object3D,this.scene.remove(),this.scene.dispose(),this.scene=new w.Scene,this.scene.add(this.threejsselectObjects),this.scene.add(this._parentDocObject),this.scene.add(this._parentDocObject_SmallCoord),this._objectsOsnap=new V.MxDrawObjectOsnap(this),this.m_mxDatabase.reInit(),this.tempMarkDraw.init(this),this.mxdrawThreeJS.onInitScene(),L.MxFun.removeThreejsObject(this.threejsselectObjectsView,this.secenView),this.threejsselectObjectsView=null,this.secenView.remove(),this.secenView.dispose(),this.secenView=null,this.onInitViewScene(),this._runMode!=a.kCPPMxCAD&&this.mxdrawThreeJS.getType()!=M.MxThreeJSType.kMapBox||(this.secenView!=null?this.secenView.background=null:this.scene.background=null)},u.prototype.reInit=function(){this.clearThreejsScence(),this._openFile="",this._openFileExtName="",this._mapId2Entity=new Map,this._setAdyDelete=new Map,this._layers=new G.MxBrowseLayerData,this._blocks=new k.Blocks,this._extRefManager=new k.ExternalReferenceManager,this._doc2World=new w.Matrix4,this._word2doc=new w.Matrix4,this._allLayoutName=new Array,this._tzDwgStaticFile="",this._devicePixelRatio=window.devicePixelRatio,this._blocks.initRootBlockRef()},u.prototype.removeEntity=function(c){if(this._setAdyDelete[c]==null){this._setAdyDelete[c]=!0;var m=this._mapId2Entity.get(c);if(m!=null){for(var E in m)this.scene.remove(m[E]);this._mapId2Entity.delete(c)}}},u.prototype.removeEntityFromServer=function(c){for(var m=c.getInt32(4,!0),E=0;E<m;E++){var U=c.getInt32(4*(E+20),!0);this.removeEntity(U)}},u.prototype.removeAllEntity=function(){var c=this;this._mapId2Entity.forEach(function(m,E,U){for(var X in m)c.scene.remove(m[X])}),this._mapId2Entity.clear()},u.prototype.mxWebAddEntity=function(c){this._setAdyDelete.clear();var m=this.mxWebAddEntity_3DChild(c);this.mxWebAddEntity_Curve(c,m),this._setAdyDelete.clear()},u.prototype.getViewWorldCoord=function(){var c=new w.Vector3(-1,-1,1);c.unproject(this.camera);var m=new w.Vector3(-1,1,1);m.unproject(this.camera);var E=new w.Vector3(1,1,1);E.unproject(this.camera);var U=new w.Vector3(1,-1,1);return U.unproject(this.camera),{pt1:c,pt2:m,pt3:E,pt4:U}},u.prototype.getViewDocCoord=function(){var c=this.getViewWorldCoord();return c.pt1=this.docCoord2Cad2(this.worldCoord2Doc(c.pt1.x,c.pt1.y,0)),c.pt2=this.docCoord2Cad2(this.worldCoord2Doc(c.pt2.x,c.pt2.y,0)),c.pt3=this.docCoord2Cad2(this.worldCoord2Doc(c.pt3.x,c.pt3.y,0)),c.pt4=this.docCoord2Cad2(this.worldCoord2Doc(c.pt4.x,c.pt4.y,0)),c},u.prototype.screenCoord2World=function(c,m,E){return this.mxdrawThreeJS.screenCoord2World(c,m,E)},u.prototype.worldCoord2Screen=function(c,m,E){return this.mxdrawThreeJS.worldCoord2Screen(c,m,E)},u.prototype.screenCoord2World_mxdrawThreeJS_call=function(c,m,E){var U=this.getCanvas(),X=U.clientWidth,W=U.clientHeight;E=.5;var te=this.camera;te&&te.isOrthographicCamera&&(E=(te.near+te.far)/(te.near-te.far));var ne=new w.Vector3(c/X*2-1,-m/W*2+1,E);return ne.unproject(this.camera),ne.z=0,ne},u.prototype.worldCoord2Screen_mxdrawThreeJS_call=function(c,m,E){var U=new w.Vector3(c,m,E).project(this.camera),X=this.getCanvas(),W=X.clientWidth/2,te=X.clientHeight/2,ne=Math.round(U.x*W+W),ce=Math.round(-U.y*te+te);return new w.Vector3(ne,ce,0)},u.prototype.worldCoordLong2Doc=function(c){var m=this.worldCoord2Doc(0,0,0),E=this.worldCoord2Doc(c,0,0);return m.distanceTo(E)},u.prototype.docCoordLong2World=function(c){var m=this.docCoord2World(0,0,0),E=this.docCoord2World(c,0,0);return m.distanceTo(E)},u.prototype.getDoc2CADMatrix=function(){return this._doc2CAD},u.prototype.docCoord2Cad=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._doc2CAD),U},u.prototype.toSmallcoord=function(c){return this._runMode==a.kCPPMxCAD?this.cadCoord2Doc2(c):c},u.prototype.toSmallcoord2=function(c,m,E){return E===void 0&&(E=0),this._runMode==a.kCPPMxCAD?this.cadCoord2Doc(c,m,E):new w.Vector3(c,m,E)},u.prototype.docCoord2Cad2=function(c){return(c=c.clone()).applyMatrix4(this._doc2CAD),c},u.prototype.cadCoord2Doc=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._cad2Doc),U},u.prototype.cadCoord2Doc2=function(c){return(c=c.clone()).applyMatrix4(this._cad2Doc),c},u.prototype.docCoordLong2Cad=function(c){var m=this.docCoord2Cad(0,0,0),E=this.docCoord2Cad(c,0,0);return m.distanceTo(E)},u.prototype.cadCoordLong2Doc=function(c){var m=this.cadCoord2Doc(0,0,0),E=this.cadCoord2Doc(c,0,0);return m.distanceTo(E)},u.prototype.viewCoordLong2Cad=function(c){return this.docCoordLong2Cad(this.screenCoordLong2Doc(c))},u.prototype.cadCoordLong2View=function(c){return this.docCoordLong2Screen(this.cadCoordLong2Doc(c))},u.prototype.viewCoord2Cad=function(c,m,E){var U=this.screenCoord2Doc(c,m,E);return this.docCoord2Cad(U.x,U.y,U.z)},u.prototype.cadCoord2View=function(c,m,E){var U=this.cadCoord2Doc(c,m,E);return this.docCoord2Screen(U.x,U.y,U.z)},u.prototype.docCoord2World=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._doc2World),U},u.prototype.getDoc2World=function(){return this._doc2World},u.prototype.getWorldToDoc=function(){return this._word2doc},u.prototype.worldCoord2Doc=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._word2doc),U},u.prototype.screenCoord2Doc=function(c,m,E){var U=this.screenCoord2World(c,m,E);return this.worldCoord2Doc(U.x,U.y,0)},u.prototype.worldCoord2Currnet=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._word2Current),U},u.prototype.currentCoord2World=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._current2word),U},u.prototype.screenCoord2Current=function(c,m,E){var U=this.screenCoord2World(c,m,E);return U.applyMatrix4(this._word2Current),U},u.prototype.currentCoord2Screen=function(c,m,E){var U=new w.Vector3(c,m,E);return U.applyMatrix4(this._current2word),this.worldCoord2Screen(U.x,U.y,U.z)},u.prototype.docCoord2Screen=function(c,m,E){var U=this.docCoord2World(c,m,E);return this.worldCoord2Screen(U.x,U.y,U.z)},u.prototype.screenCoordLong2Doc=function(c){var m=this.screenCoord2Doc(0,0,0),E=this.screenCoord2Doc(c,0,0);return m.distanceTo(E)},u.prototype.screenCoordLong2DocScale=function(){var c=this.screenCoord2Doc(0,0,0),m=this.screenCoord2Doc(1,0,0);return c.distanceTo(m)},u.prototype.docCoordLong2Screen=function(c){var m=this.docCoord2Screen(0,0,0),E=this.docCoord2Screen(0<c?c:-c,0,0);return 0<=c?m.distanceTo(E):-m.distanceTo(E)},u.prototype.screenCoordLong2World=function(c){var m=this.screenCoord2World(0,0,0),E=this.screenCoord2World(0<c?c:-c,0,0);return 0<=c?m.distanceTo(E):-m.distanceTo(E)},u.prototype.worldCoordLong2Screen=function(c){var m=this.worldCoord2Screen(0,0,0),E=this.worldCoord2Screen(c,0,0);return m.distanceTo(E)},u.prototype.initCAD2Doc=function(c){c instanceof Array?this._cad2Doc.fromArray(c):this._cad2Doc=c,this._doc2CAD.getInverse(this._cad2Doc),this.mcObject.initCAD2Doc(this._cad2Doc,this._doc2CAD)},u.prototype.intiDoc2Wold=function(c){c instanceof Array?this._doc2World.fromArray(c):this._doc2World=c,this._word2doc.getInverse(this._doc2World)},u.prototype.intiword2Current=function(c){this._word2Current=c.clone(),this._current2word.getInverse(this._word2Current)},u.prototype.initializingObjectMatrix=function(){this.isNewObjectMatrix&&this._runMode==a.kCPPMxCAD?(this.m_mxDatabase.initObjectMatrix(this._cad2Doc),this._parentDocObject.matrix=this._cad2Doc,this._parentDocObject.matrixAutoUpdate=!1,this._parentDocObject_SmallCoord.matrix=new w.Matrix4,this._parentDocObject_SmallCoord.matrixAutoUpdate=!1,this.threejsselectObjects.matrix=this._cad2Doc,this.threejsselectObjects.matrixAutoUpdate=!1,this.intiword2Current(this._doc2CAD)):(this.m_mxDatabase.initObjectMatrix(this._doc2World),this._parentDocObject.matrix=this._doc2World,this._parentDocObject.matrixAutoUpdate=!1,this._parentDocObject_SmallCoord.matrix=this._doc2World,this._parentDocObject_SmallCoord.matrixAutoUpdate=!1,this.threejsselectObjects.matrix=this._doc2World,this.threejsselectObjects.matrixAutoUpdate=!1,this.intiword2Current(this._word2doc))},u.prototype.getDrawContainer=function(){return this.threejsselectObjects},u.prototype.getTheTempDrawContainer=function(){return this._parentDocObject},u.prototype.getTheTempDrawContainer_SmallCoord=function(){return this._parentDocObject_SmallCoord},u.prototype.getTempMarkDraw=function(){return this.tempMarkDraw},u.prototype.mxWebAddEntityFor2dPointMeshBuffers=function(c,m){var E=new D.MxNetData(c),U=E.getdPointMeshBuffersHead(),X=U.zeroLayerIdIndex,W=U.databaseIndex;m!=-1&&(W=m);for(var te=U.datasize,ne=0;ne<U.datacount;ne++){var ce=E.getdPointMeshBufferDataHead(te);te=ce.offset;var we=ce.layerId,Ie=we==X,xe=ce.blkId,Be=ce.pointCount;if(!(Be<1)){for(var q=[],ge=[],oe=[],se=[],Ae=[],Ye=0;Ye<Be;Ye++){var Ge=c.getFloat32(te,!0);te+=4;var Ne=c.getFloat32(te,!0);te+=4;var le=c.getFloat32(te,!0);te+=4;var ve=c.getFloat32(te,!0);te+=4;var He=c.getFloat32(te,!0);te+=4;var nt=c.getFloat32(te,!0);te+=4;var ht=c.getInt32(te,!0);te+=4;var Tt=ht>>24&255;Tt==2?(se.push(Ge,Ne),se.push(le,ve),se.push(He,nt)):Tt==1?xe!=0&&Ie?(Ae.push(Ge,Ne),Ae.push(le,ve),Ae.push(He,nt)):(oe.push(Ge,Ne),oe.push(le,ve),oe.push(He,nt)):(ht=this.automaticInversionColor(16777215&ht),q.push(Ge,Ne),q.push(le,ve),q.push(He,nt),ge.push((255&ht)/255,(ht>>8&255)/255,(ht>>16&255)/255),ge.push((255&ht)/255,(ht>>8&255)/255,(ht>>16&255)/255),ge.push((255&ht)/255,(ht>>8&255)/255,(ht>>16&255)/255))}var Ct=this._blocks,We=this._layers;W!=0&&(Ct=this._extRefManager.getBlocks(W),We=this._extRefManager.getLayers(W));var It=Ct.crateBlock(xe);It.addGeometryMesh(q,ge,we,se,oe,Ae),Ct.createThreejsObj(It,this,We)}}},u.prototype.mxWebAddEntityForMemorySections=function(c,m){var E=new D.MxNetData(c),U=E.getMemorySectionsHead(),X=(U.zeroLayerIdIndex,U.databaseIndex);m!=-1&&(X=m);var W=U.nOffset,te=this._blocks,ne=this._layers;X!=0&&(te=this._extRefManager.getBlocks(X),ne=this._extRefManager.getLayers(X));for(var ce=0;ce<U.datacount;ce++){var we=E.getMemorySectionHead(W);W=we.offset;var Ie=new k.MxNewDisplayMemorySection;Ie.layerId=we.layerId,Ie.blockId=we.blkId,Ie.id=we.memId,Ie.color=we.memColor,Ie.type=we.memType;var xe=!1;Ie.type==k.MxNewDisplayMemorySectionType.kLinesType_Float?(xe=!0,Ie.type=k.MxNewDisplayMemorySectionType.kLinesType):Ie.type==k.MxNewDisplayMemorySectionType.kTriangleType_Float?(xe=!0,Ie.type=k.MxNewDisplayMemorySectionType.kTriangleType):Ie.type==k.MxNewDisplayMemorySectionType.kPointType_Float&&(xe=!0,Ie.type=k.MxNewDisplayMemorySectionType.kPointType);var Be=we.pointCount;if(!(Be<1)){for(var q=[],ge=0;ge<Be;ge++)if(xe){var oe=c.getFloat32(W,!0);W+=4;var se=c.getFloat32(W,!0);W+=4,c.getFloat32(W,!0),W+=4,q.push(oe,se,0)}else oe=c.getFloat64(W,!0),W+=8,se=c.getFloat64(W,!0),W+=8,c.getFloat64(W,!0),W+=8,q.push(oe,se,0);Ie.points=q;var Ae=te.crateBlock(Ie.blockId);Ae.addMemorySections(Ie),te.createThreejsObj(Ae,this,ne)}}},u.prototype.convertBytesToUTF8=function(c,m){var E=0;m=Math.min(m||c.length,c.length),c[0]===239&&c[1]===187&&c[2]===191&&(E=3);for(var U=[],X=0;E<m;X++){var W,te,ne,ce=c[E++];if(ce===0)break;ce<128?U[X]=String.fromCharCode(ce):194<=ce&&ce<224?(W=c[E++],U[X]=String.fromCharCode(((31&ce)<<6)+(63&W))):224<=ce&&ce<240?(W=c[E++],te=c[E++],U[X]=String.fromCharCode(((15&ce)<<12)+((63&W)<<6)+(63&te))):240<=ce&&ce<245&&(ne=((7&ce)<<18)+((63&(W=c[E++]))<<12)+((63&(te=c[E++]))<<6)+(63&c[E++])-65536,U[X]=String.fromCharCode(55296+(ne>>10),56320+(1023&ne)))}return U.join("")},u.prototype.mxWebAddEntityFor2dPointTextureBuffers=function(c,m){var E=new D.MxNetData(c),U=E.getdPointTextureBuffersHead(),X=U.ver,W=(U.zeroLayerIdIndex,U.databaseIndex);m!=-1&&(W=m);for(var te=U.datasize,ne=0;ne<U.datacount;ne++){var ce=E.getdPointTextureBufferDataHead(te);te=ce.offset;var we=ce.layerId,Ie=ce.blkId,xe=ce.dataCount;if(!(xe<1)){var Be=0,q=this._blocks,ge=this._layers;W!=0&&(q=this._extRefManager.getBlocks(W),ge=this._extRefManager.getLayers(W));for(var oe=q.crateBlock(Ie);Be<xe;Be++){var se=c.getFloat64(te,!0);te+=8;var Ae=c.getFloat64(te,!0);te+=8;var Ye=c.getFloat64(te,!0);te+=8;var Ge=c.getUint32(te,!0);te+=4;var Ne=c.getUint32(te,!0);te+=4;var le=this.convertBytesToUTF8(new Uint8Array(c.buffer.slice(te,te+Ne)),void 0);te+=Ne;var ve=[],He=[],nt=[];if(!(Ge<1)){for(var ht=0;ht<Ge;ht++){if(5<=X){var Tt=c.getFloat64(te,!0);te+=8;var Ct=c.getFloat64(te,!0);te+=8,c.getFloat64(te,!0),te+=8;var We=c.getFloat64(te,!0);te+=8;var It=c.getFloat64(te,!0);te+=8,c.getFloat64(te,!0),te+=8;var Bt=c.getFloat64(te,!0);te+=8;var Ln=c.getFloat64(te,!0);te+=8,c.getFloat64(te,!0),te+=8,ve.push(Tt,Ct),ve.push(We,It),ve.push(Bt,Ln)}else Tt=c.getFloat32(te,!0),te+=4,Ct=c.getFloat32(te,!0),te+=4,We=c.getFloat32(te,!0),te+=4,It=c.getFloat32(te,!0),te+=4,Bt=c.getFloat32(te,!0),te+=4,Ln=c.getFloat32(te,!0),te+=4,ve.push(Tt,Ct),ve.push(We,It),ve.push(Bt,Ln);var rn=c.getInt32(te,!0);te+=4;var Xn=c.getFloat32(te,!0);te+=4;var yt=c.getFloat32(te,!0);te+=4;var ze=c.getFloat32(te,!0);te+=4;var Zt=c.getFloat32(te,!0);te+=4;var An=c.getFloat32(te,!0);te+=4;var Yn=c.getFloat32(te,!0);te+=4;var pt=rn>>24&255;rn=pt==2||pt==1?16777215:this.automaticInversionColor(16777215&rn),nt.push(Xn,yt),nt.push(ze,Zt),nt.push(An,Yn),He.push((255&rn)/255,(rn>>8&255)/255,(rn>>16&255)/255),He.push((255&rn)/255,(rn>>8&255)/255,(rn>>16&255)/255),He.push((255&rn)/255,(rn>>8&255)/255,(rn>>16&255)/255)}oe.addGeometryTexture(ve,nt,He,we,le,se,Ae,Ye)}}q.createThreejsObj(oe,this,ge)}}},u.prototype.mxWebAddEntityFor2dPointCurveBuffers=function(c,m){var E=new D.MxNetData(c),U=E.getdPointCurveBuffersHead(),X=U.zeroLayerIdIndex,W=U.databaseIndex;m!=-1&&(W=m);for(var te=U.datasize,ne=0;ne<U.datacount;ne++){var ce=E.getdPointCurveBufferDataHead(te);te=ce.offset;var we=ce.layerId,Ie=we==X,xe=ce.blkId,Be=ce.pointCount;if(!(Be<1)){for(var q=[],ge=[],oe=[],se=[],Ae=[],Ye=0;Ye<Be;Ye++){var Ge=c.getFloat32(te,!0);te+=4;var Ne=c.getFloat32(te,!0);te+=4;var le=c.getFloat32(te,!0);te+=4;var ve=c.getFloat32(te,!0);te+=4;var He=c.getInt32(te,!0);te+=4;var nt=He>>24&255;nt==2?(se.push(Ge,Ne),se.push(le,ve)):nt==1?xe!=0&&Ie?(Ae.push(Ge,Ne),Ae.push(le,ve)):(oe.push(Ge,Ne),oe.push(le,ve)):(q.push(Ge,Ne),q.push(le,ve),He=this.automaticInversionColor(16777215&He),ge.push((255&He)/255,(He>>8&255)/255,(He>>16&255)/255),ge.push((255&He)/255,(He>>8&255)/255,(He>>16&255)/255))}var ht=this._blocks,Tt=this._layers;W!=0&&(ht=this._extRefManager.getBlocks(W),Tt=this._extRefManager.getLayers(W));var Ct=ht.crateBlock(xe);Ct.addGeometryCurve(q,ge,we,se,oe,Ae),ht.createThreejsObj(Ct,this,Tt)}}},u.prototype.mxWebAddEntityFor2dPointCurveBuffer=function(c,m){var E=new D.MxNetData(c);if(!E.getIsSketchEntity()){var U,X=E.getLayerId(),W=X==E.getZeroLayerId(),te=E.getBlockId();if(!((U=c.getInt32(20,!0)/20)<1)){for(var ne=80,ce=[],we=[],Ie=[],xe=[],Be=[],q=0;q<U;q++){var ge=c.getFloat32(ne,!0);ne+=4;var oe=c.getFloat32(ne,!0);ne+=4;var se=c.getFloat32(ne,!0);ne+=4;var Ae=c.getFloat32(ne,!0);ne+=4;var Ye=c.getInt32(ne,!0);ne+=4;var Ge=Ye>>24&255;Ge==2?(xe.push(ge,oe),xe.push(se,Ae)):Ge==1?te!=0&&W?(Be.push(ge,oe),Be.push(se,Ae)):(Ie.push(ge,oe),Ie.push(se,Ae)):(Ye=this.automaticInversionColor(16777215&Ye),ce.push(ge,oe),ce.push(se,Ae),we.push((255&Ye)/255,(Ye>>8&255)/255,(Ye>>16&255)/255),we.push((255&Ye)/255,(Ye>>8&255)/255,(Ye>>16&255)/255))}var Ne=E.getDatabaseIndex();m!=-1&&(Ne=m);var le=this._blocks,ve=this._layers;Ne!=0&&(le=this._extRefManager.getBlocks(Ne),ve=this._extRefManager.getLayers(Ne));var He=le.crateBlock(te);He.addGeometryCurve(ce,we,X,xe,Ie,Be),le.createThreejsObj(He,this,ve)}}},u.prototype.mxWebAddEntityFor2dPointMeshBuffer=function(c,m){var E=new D.MxNetData(c);if(!E.getIsSketchEntity()){var U,X=E.getLayerId(),W=E.getBlockId(),te=X==E.getZeroLayerId();if(!((U=c.getInt32(12,!0)/28)<1)){for(var ne=80,ce=[],we=[],Ie=[],xe=[],Be=[],q=0;q<U;q++){var ge=c.getFloat32(ne,!0);ne+=4;var oe=c.getFloat32(ne,!0);ne+=4;var se=c.getFloat32(ne,!0);ne+=4;var Ae=c.getFloat32(ne,!0);ne+=4;var Ye=c.getFloat32(ne,!0);ne+=4;var Ge=c.getFloat32(ne,!0);ne+=4;var Ne=c.getInt32(ne,!0);ne+=4;var le=Ne>>24&255;le==2?(xe.push(ge,oe),xe.push(se,Ae),xe.push(Ye,Ge)):le==1?W!=0&&te?(Be.push(ge,oe),Be.push(se,Ae),Be.push(Ye,Ge)):(Ie.push(ge,oe),Ie.push(se,Ae),Ie.push(Ye,Ge)):(ce.push(ge,oe),ce.push(se,Ae),ce.push(Ye,Ge),Ne=this.automaticInversionColor(16777215&Ne),we.push((255&Ne)/255,(Ne>>8&255)/255,(Ne>>16&255)/255),we.push((255&Ne)/255,(Ne>>8&255)/255,(Ne>>16&255)/255),we.push((255&Ne)/255,(Ne>>8&255)/255,(Ne>>16&255)/255))}var ve=E.getDatabaseIndex();m!=-1&&(ve=m);var He=this._blocks,nt=this._layers;ve!=0&&(He=this._extRefManager.getBlocks(ve),nt=this._extRefManager.getLayers(ve));var ht=He.crateBlock(W);ht.addGeometryMesh(ce,we,X,xe,Ie,Be),He.createThreejsObj(ht,this,nt)}}},u.prototype.mxWebCreateAllBlocks=function(c,m){var E=new D.MxNetData(c).getDatabaseIndex();m!=-1&&(E=m);var U=this._blocks;E!=0&&(U=this._extRefManager.getBlocks(E)),U.createBlocks(c,this.scene)},u.prototype.mxWebEntitysData=function(c,m){m==-1&&this._objectsOsnap.mxWebEntitysData(c,m)},u.prototype.getObjectOsnap=function(){return this._objectsOsnap},u.prototype.saveMxEntityToJson=function(c){return this.m_mxDatabase.saveJson(c)},u.prototype.getDtabaseJsonString=function(){return JSON.stringify(this.m_mxDatabase.toJsonObject())},u.prototype.loadMxEntityFromJson=function(c){return this.m_mxDatabase.loadJson(c)},u);function u(c){this._is2d=!0,this._runMode=a.kBrowse,this._userCanvas=null,this._openFile="empty",this._staticLoadingOpenFiles=[],this._openFileExtName="",this._userIdentitySign="",this._rendererParam=void 0,this._userRandomToken="",this._isCreate=!1,this.m_iniSet={},this._net=null,this._staticNet=null,this._staticLoadTzNet=null,this._staticLocalNet=null,this._isStaticLocalLoad=!1,this._staticLocalLoadPath="",this._viewWidth=1,this._viewHeight=1,this.m_sysVariable=new C.MxSystemVariable,this._color="#FFFFFF",this._viewcolor=15790320,this._isAnimation=!1,this._isAnimationStarting=!1,this._isWaiteCount=0,this._callCreateCanvasImageData=void 0,this._event={},this.scene=null,this.camera=null,this.camera_recover=null,this.secenView=null,this.cameraView=null,this.renderer=null,this.controls=null,this.threejsselectObjectsView=null,this._mouseRightRotate=!1,this._isMouseMiddlePan=1,this._mapId2Entity=new Map,this._setAdyDelete=new Map,this._layers=new G.MxBrowseLayerData,this._blocks=new k.Blocks,this._extRefManager=new k.ExternalReferenceManager,this._doc2World=new w.Matrix4,this._word2doc=new w.Matrix4,this._cad2Doc=new w.Matrix4,this._doc2CAD=new w.Matrix4,this._word2Current=new w.Matrix4,this._current2word=new w.Matrix4,this._allLayoutName=new Array,this._devicePixelRatio=1,this._tzDwgStaticFile="",this._requestHeader="",this._objectsOsnap=null,this._initZoomwCoordPt1=null,this._initZoomWCoordPt2=null,this.m_mxDatabase=null,this._parentDocObject=null,this._parentDocObject_SmallCoord=null,this.threejsselectObjects=null,this.tempMarkDraw=new B.MxTempMarkDraw,this._onResizeFun=null,this._sCurrentLoadURL="",this.eventManager=new ee.MxDrawObjectEvent,this._viewangle=0,this.id=0,this.mcObject=new _.McDrawObject,this.isPointMultipleSelect=!1,this.isNewObjectMatrix=!0,this.bakControls=void 0,this.isMultipleSelect=!1,this.mxdrawThreeJS=null,this.curMousePostion=new w.Vector2(0,0),this.m_isValidCurMousePostion=!1,this._is2d=c,this._blocks.initRootBlockRef(),this.m_iniSet[h.kEnableOsnapFunction]=!1,this.m_sysVariable.init(this),this.m_mxDatabase=new R.MxDbDatabase,this.id=O.MxManager.allocId(),this.isMultipleSelect=T.MxDrawData.m_isMultipleSelect}o.MxDrawObject=N},{"./MxDrawData":22,"./MxDrawObjectEvent":26,"./MxFun":27,"./MxLocalFileLoad":28,"./MxManager":29,"./MxNetData":31,"./MxSystemVariable":35,"./MxTempMarkDraw":36,"./Operate/MxDrawObjectOsnap":49,"./UI/MxUiVue":65,"./View/MxBrowseDisplay":66,"./View/MxBrowseLayerData":67,"./View/MxDbDatabase":68,"./View/MxDbEntityGrip":70,"./View/MxDrawMapBox":75,"./cpp/McDrawObject":77,three:19}],24:[function(b,r,o){var a,v=this&&this.__extends||(a=function(R,M){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,F){ee.__proto__=F}||function(ee,F){for(var _ in F)Object.prototype.hasOwnProperty.call(F,_)&&(ee[_]=F[_])})(R,M)},function(R,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function ee(){this.constructor=R}a(R,M),R.prototype=M===null?Object.create(M):(ee.prototype=M.prototype,new ee)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObject2d=void 0;var h,w=b("three"),L=b("./MxFun"),G=b("./MxDrawObject"),k=b("three-orbitcontrols"),D=b("./MxNetData"),f=b("./MxMaterial"),O=b("./MxDrawData"),C=b("./View/MxDrawMapBox"),j=(v(V,h=G.MxDrawObject),V.prototype.set3DDraw=function(R){this.is3DDraw=R},V.prototype.getOrthographicCamera=function(){return this.camera instanceof w.OrthographicCamera?this.camera:null},V.prototype.getFullDisplayRange=function(){return{minPt:this._initMinDisplayPoint,maxPt:this._initMaxDisplayPoint}},V.prototype.saveZoom=function(){this.camera_recover=this.camera.clone(!1),this.controls.saveState()},V.prototype.recoverZoom=function(){this.camera_recover&&(this.camera.copy(this.camera_recover,!1),this.camera_recover=null,this.getOrthographicCamera().updateProjectionMatrix(),this.controls.reset(),this.mcObject.updateDisplayMatrixData())},V.prototype.zoomW_call=function(R,M,ee,F){if(R.distanceTo(M)<1e-7)console.log("Mx:ZoomW param invalid");else{if(ee!=null&&ee||(R=this.currentCoord2World(R.x,R.y,0),M=this.currentCoord2World(M.x,M.y,0)),R.x>M.x){var _=R.x;R.x=M.x,M.x=_}R.y>M.y&&(_=R.y,R.y=M.y,M.y=_);var J=this.getViewWidth(),T=this.getViewHeight();T<5&&(T=5),J<5&&(J=5);var B=Math.abs(R.x-M.x),N=Math.abs(R.y-M.y);B<1e-5&&(B=1e-5),N<1e-5&&(N=1e-5);var u=this.getOrthographicCamera();if(B/N<J/T){var c=.5*N,m=J/T;u.left=-c*m,u.right=c*m,u.top=c,u.bottom=-c}else c=.5*B,m=T/J,u.left=-c,u.right=c,u.top=c*m,u.bottom=-c*m;var E=B,U=N,X=E;X<U&&(X=U),this._runMode==G.MxRunMode.kCPPMxCAD?(u.far=10240,u.near=-10240):(u.far=1e3*X,u.far<9e4&&(u.far=9e4),u.near=1e3*-X,-9e4<u.near&&(u.near=-9e4));var W=R.x+.5*E,te=R.y+.5*U;u.zoom=1,u.position.set(W,te,100),u.lookAt(new w.Vector3(W,te,0)),u.updateProjectionMatrix(),this.controls.target.x=W,this.controls.target.y=te,this.controls.target.z=0,this.controls.update(),this.mcObject.updateDisplayMatrixData(F)}},V.prototype.zoomScale_call=function(R){var M=this.getOrthographicCamera();M.zoom=Math.max(this.controls.minZoom,Math.min(this.controls.maxZoom,M.zoom*R)),M.updateProjectionMatrix(),this.controls.update(),this.mcObject.updateDisplayMatrixData()},V.prototype.zoomCenter_call=function(R,M){var ee=this.getOrthographicCamera(),F=this.currentCoord2World(R,M,0);R=F.x,M=F.y,ee.position.set(R,M,ee.position.z),ee.lookAt(new w.Vector3(R,M,0)),ee.updateProjectionMatrix(),this.controls.target.x=R,this.controls.target.y=M,this.controls.target.z=0,this.controls.update(),this.mcObject.updateDisplayMatrixData()},V.prototype.calcCameraUp=function(R){var M=new w.Vector3(0,1,0),ee=new w.Matrix4;return ee.makeRotationZ(R),M.applyMatrix4(ee),M},V.prototype.updateCameraDisplayRangeImp=function(R,M,ee){this._initZoomwCoordPt1!=null&&this._initZoomWCoordPt2!=null?(this._initMinDisplayPoint=this.docCoord2World(this._initZoomwCoordPt1.x,this._initZoomwCoordPt1.y,0),this._initMaxDisplayPoint=this.docCoord2World(this._initZoomWCoordPt2.x,this._initZoomWCoordPt2.y,0)):(this._initMinDisplayPoint=R,this._initMaxDisplayPoint=M),this._viewangle=ee,this.camera.up=this.calcCameraUp(ee),this.cameraView.up=this.calcCameraUp(ee),this.cameraView.updateProjectionMatrix(),this.zoomW(this._initMinDisplayPoint,this._initMaxDisplayPoint,!0)},V.prototype.setViewAngle_call=function(R){this._viewangle=R;var M=this.getOrthographicCamera();M&&(M.up=this.calcCameraUp(R),M.updateProjectionMatrix()),this.cameraView.up=this.calcCameraUp(R),this.cameraView.updateProjectionMatrix(),this.controls.update(),this.mcObject.setViewAngle(R),this.mcObject.updateDisplayMatrixData()},V.prototype.zoomInitialStates=function(){this._initMinDisplayPoint!=null&&this._initMaxDisplayPoint!=null?(this.camera.up=this.calcCameraUp(this._viewangle),this.cameraView.up=this.calcCameraUp(this._viewangle),this.cameraView.updateProjectionMatrix(),this.zoomW(this._initMinDisplayPoint,this._initMaxDisplayPoint,!0)):console.log("mx assert(0)")},V.prototype.onInitScene=function(){if(this.callInitSceneEvent(this.scene,this.controls,!0)==0){var R=new w.AmbientLight(3355443,1);this.scene.add(R);var M=new w.DirectionalLight(16777215,1);M.position.set(-2,2,3).normalize(),this.scene.add(M)}},V.prototype.updataCameraView=function(R,M){var ee=R,F=M;this.cameraView.left=0,this.cameraView.right=ee,this.cameraView.top=F,this.cameraView.bottom=0,this.cameraView.updateProjectionMatrix()},V.prototype.onInitViewScene=function(){if(!this.secenView){this.secenView=new w.Scene,this._runMode!=G.MxRunMode.kCPPMxCAD&&this.mxdrawThreeJS.getType()!=C.MxThreeJSType.kMapBox&&(this.secenView.background=new w.Color(this._viewcolor));var R=this.getViewWidth(),M=this.getViewHeight();R=this.xzSize(R),M=this.xzSize(M),this.cameraView=new w.OrthographicCamera(0,R,M,0,1,2e3),this.cameraView.position.set(0,0,2e3),this.cameraView.lookAt(new w.Vector3(0,0,0)),this.cameraView.updateProjectionMatrix();var ee=new w.AmbientLight(3355443,1);this.secenView.add(ee);var F=new w.DirectionalLight(16777215,1);F.position.set(-2,2,3).normalize(),this.secenView.add(F),this.threejsselectObjectsView=new w.Object3D,this.secenView.add(this.threejsselectObjectsView)}},V.prototype.onInitThreejs=function(){var R=this.getViewWidth(),M=this.getViewHeight(),ee=(R=this.xzSize(R))/(M=this.xzSize(M))*50;this.onInitViewScene(),this.camera=new w.OrthographicCamera(ee/-2,ee/2,25,-25,-10240,10240),this.camera.position.set(0,0,200),this.scene=new w.Scene;var F=this.getUserCanvas(),_=this._rendererParam;_=_||{},F==null?(_.antialias=!1,_.stencil=!0,this.renderer=new w.WebGLRenderer(_),this.renderer.setClearColor(0,1),this.renderer.setPixelRatio(this._devicePixelRatio),this.renderer.setSize(R,M),document.body.appendChild(this.renderer.domElement)):(_.canvas=F,_.stencil=!0,this.renderer=new w.WebGLRenderer(_),this.renderer.setClearColor(0,1),this.renderer.setPixelRatio(this._devicePixelRatio)),this.renderer.sortObjects=!0,this.renderer.info.autoReset=O.MxDrawData.m_isAutoResetRenderer,this.renderer.info.reset();var J=this.getUserCanvas();J==null&&(J=this.renderer.domElement),this.controls=new k.OrbitControls(this.camera,J),this.is3DDraw||(this.controls.enableZoom=!0),L.MxFun.isPC()?(this.controls.zoomSpeed=4,this.controls.screenSpacePanning=!0,this.setMouseMiddlePan(this._isMouseMiddlePan),this._mouseRightRotate&&(this.controls.mouseButtons.RIGHT=w.MOUSE.ROTATE)):(this.controls.zoomSpeed=1.5,this.controls.touches.ONE=w.TOUCH.PAN,this.controls.screenSpacePanning=!0)},V.prototype.onCreate=function(){this._is2d=!0,this.mxdrawThreeJS.onInitScene()},V.prototype.mxWebAddEntity_3DChild=function(R){var M=new D.MxNetData(R).getMesh();if(M.id==null)return M.size;var ee=new w.Mesh(M.geometry,f.MxMaterial.GetBaseColorMaterial(M.nColorIndex));return this.removeEntity(M.id),this.scene.add(ee),M.isSketchEntity&&this.addEntity(M.id,ee),M.size},V.prototype.mxWebAddEntity_Curve=function(R,M){var ee=new D.MxNetData(R).getCurve(M);if(ee.id!=null){var F=f.MxMaterial.GetCurveColorMaterial(ee.colorIndex),_=new w.LineSegments(ee.geometry,F);this.removeEntity(ee.id),this.scene.add(_),ee.isSketchEntity&&this.addEntity(ee.id,_)}},V.prototype.onViewChange=function(){this._onResizeImpCalling||(this._bakOnResizeViewWorldCoord=void 0)},V.prototype.mapBox_onResizeImp=function(R,M){var ee=R,F=M;this.mcObject.setSize(ee,F),this.callEvent("viewsizechange",{width:ee,height:F}),this.callEvent("viewchange"),this.m_mxDatabase.getSelectManager().setCanvasSize(ee,F)},V.prototype.onResizeImp=function(R,M){var ee;this._bakOnResizeViewWorldCoord?ee=this._bakOnResizeViewWorldCoord:(ee=this.getViewWorldCoord(),this._bakOnResizeViewWorldCoord=ee);var F=this.getViewWidth();R!=null&&(F=R);var _=this.getViewHeight();if(M!=null&&(_=M),!(_<5||F<5)){var J=ee.pt1.x+.5*(ee.pt3.x-ee.pt1.x),T=ee.pt1.y+.5*(ee.pt3.y-ee.pt1.y),B=new w.Matrix4;B.makeRotationZ(this._viewangle);var N=new w.Matrix4().makeTranslation(J,T,0).multiply(B).multiply(new w.Matrix4().makeTranslation(-J,-T,0)),u=ee.pt1.clone(),c=ee.pt2.clone(),m=ee.pt3.clone(),E=ee.pt4.clone();u.applyMatrix4(N),c.applyMatrix4(N),m.applyMatrix4(N),E.applyMatrix4(N);var U=u.clone();U.x>c.x&&(U.x=c.x),U.x>m.x&&(U.x=m.x),U.x>E.x&&(U.x=E.x),U.y>c.y&&(U.y=c.y),U.y>m.y&&(U.y=m.y),U.y>E.y&&(U.y=E.y);var X=u.clone();X.x<c.x&&(X.x=c.x),X.x<m.x&&(X.x=m.x),X.x<E.x&&(X.x=E.x),X.y<c.y&&(X.y=c.y),X.y<m.y&&(X.y=m.y),X.y<E.y&&(X.y=E.y),F=this.xzSize(F),_=this.xzSize(_);var W=new w.Vector2;if(this.renderer.getSize(W),W.x!=F||W.y!=_){this._onResizeImpCalling=!0;var te=this.getOrthographicCamera(),ne=Math.abs(X.x-U.x),ce=Math.abs(X.y-U.y);if(ne<1e-5&&(ne=1e-5),ce<1e-5&&(ce=1e-5),ne/ce<F/_){var we=.5*ce,Ie=F/_;te.left=-we*Ie,te.right=we*Ie,te.top=we,te.bottom=-we}else we=.5*ne,Ie=_/F,te.left=-we,te.right=we,te.top=we*Ie,te.bottom=-we*Ie;var xe=U.x+.5*ne,Be=U.y+.5*ce;te.zoom=1;var q=te.position.z;te.position.set(xe,Be,q),te.lookAt(new w.Vector3(xe,Be,0)),te.updateProjectionMatrix(),this.controls.target.x=xe,this.controls.target.y=Be,this.controls.target.z=0,this.controls.update(),this.renderer.setSize(F,_),this.mcObject.setSize(F,_),this.updataClipMaterial(),this.updataCameraView(F,_),this.callEvent("viewsizechange",{width:F,height:_}),this.callEvent("viewchange"),this.m_mxDatabase.getSelectManager().setCanvasSize(F,_),this.m_mxDatabase.onViewChange(),this._onResizeImpCalling=!1}}},V);function V(){var R=h.call(this,!0)||this;return R._initMinDisplayPoint=null,R._initMaxDisplayPoint=null,R.is3DDraw=L.MxFun.is3DDwg(),R._bakOnResizeViewWorldCoord=void 0,R._onResizeImpCalling=!1,R}o.MxDrawObject2d=j},{"./MxDrawData":22,"./MxDrawObject":23,"./MxFun":27,"./MxMaterial":30,"./MxNetData":31,"./View/MxDrawMapBox":75,three:19,"three-orbitcontrols":17}],25:[function(b,r,o){var a,v=this&&this.__extends||(a=function(j,V){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,M){R.__proto__=M}||function(R,M){for(var ee in M)Object.prototype.hasOwnProperty.call(M,ee)&&(R[ee]=M[ee])})(j,V)},function(j,V){if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");function R(){this.constructor=j}a(j,V),j.prototype=V===null?Object.create(V):(R.prototype=V.prototype,new R)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObject3d=void 0;var h,w=b("three"),L=b("./MxDrawObject"),G=b("three-orbitcontrols"),k=b("./MxNetData"),D=b("./MxMaterial"),f=b("./MxTools"),O=(v(C,h=L.MxDrawObject),C.prototype.mxWebAddEntity_Curve=function(j,V){var R,M=new k.MxNetData(j),ee=j.getInt32(32,!0)==0,F=M.getIsSketchEntity();if(!((R=ee?j.getInt32(20,!0)/4/3:j.getInt32(20,!0)/4/2)<2)){for(var _=new w.Geometry,J=V,T=0;T<R;T++){var B=j.getFloat32(J,!0);J+=4;var N=j.getFloat32(J,!0);J+=4;var u=0;ee&&(u=j.getFloat32(J,!0),J+=4),_.vertices.push(f.MxTools.AsThreeJsPoint(B,N,u))}var c=j.getInt32(28,!0),m=D.MxMaterial.GetCurveColorMaterial(c),E=new w.LineSegments(_,m),U=j.getInt32(4,!0);this.removeEntity(U),this.scene.add(E),F&&this.addEntity(U,E)}},C.prototype.mxWebAddEntity_3DChild=function(j){var V=new k.MxNetData(j),R=V.getId(),M=(V.getColorIndex(),V.getBufferType()==0),ee=V.getIsSketchEntity();this.removeEntity(R);var F=new w.Mesh(new w.Geometry),_=this.mxWebUpdateEntity_3DChild(F,j,M);return this.scene.add(F),ee&&this.addEntity(R,F),F.geometry.computeBoundingBox(),F.geometry.computeBoundingSphere(),_},C.prototype.mxWebUpdateEntity_3DChild=function(j,V,R){var M=new k.MxNetData(V),ee=M.getVertexBufferSize(),F=M.getIndexBufferSize(),_=M.getColorIndex();if(ee===0||F===0)return M.getDrawDataOffset();var J=M.getMateria(),T=void 0,B=!0,N=!1,u=!1;J.length!=0&&((T=JSON.parse(J)).computeFaceNonmal!=null&&(B=T.computeFaceNonmal),T.castShadow!=null&&(N=T.castShadow),T.receiveShadow!=null&&(u=T.receiveShadow)),j.material=D.MxMaterial.createMaterial(T),j.material==null&&(j.material=D.MxMaterial.GetColorMaterial(_)),j.castShadow=N,j.receiveShadow=u;var c,m=M.getDrawDataOffset();c=R?ee/4/8:ee/4/2;var E=j.geometry;E.vertices=[],E.faces=[];for(var U=0;U<c;U++){var X=V.getFloat32(m+0,!0),W=V.getFloat32(m+4,!0),te=0,ne=0,ce=0,we=0,Ie=0,xe=0;R?(te=V.getFloat32(m+8,!0),ne=V.getFloat32(m+12,!0),ce=V.getFloat32(m+16,!0),we=V.getFloat32(m+20,!0),Ie=V.getFloat32(m+24,!0),xe=V.getFloat32(m+28,!0),m+=32):m+=8;var Be=f.MxTools.AsThreeJsPoint(X,W,te);E.vertices.push(Be),E.vertices[U].normal=f.MxTools.AsThreeJsPoint(ne,ce,we),E.vertices[U].uv=new w.Vector2(Ie,xe)}var q=F/4;for(U=0;U<q;U+=3){var ge=V.getInt32(m,!0);m+=4;var oe=V.getInt32(m,!0);m+=4;var se=V.getInt32(m,!0);m+=4;var Ae=new w.Face3(ge,oe,se);B||Ae.vertexNormals.push(E.vertices[ge].normal,E.vertices[oe].normal,E.vertices[se].normal),E.faces.push(Ae),E.faceVertexUvs[0].push([E.vertices[ge].uv,E.vertices[oe].uv,E.vertices[se].uv])}return B&&E.computeFaceNormals(),m},C.prototype.updateUVs=function(j){j.faceVertexUvs[0]=[],j.faces.forEach(function(V){var R=["x","y","z"].sort(function(B,N){return Math.abs(V.normal[B])-Math.abs(V.normal[N])}),M=j.vertices[V.a],ee=j.vertices[V.b],F=j.vertices[V.c],_=new w.Vector2(M[R[0]],M[R[1]]),J=new w.Vector2(ee[R[0]],ee[R[1]]),T=new w.Vector2(F[R[0]],F[R[1]]);j.faceVertexUvs[0].push([_,J,T])}),j.uvsNeedUpdate=!0},C.prototype.onInitThreejs=function(){var j=this.getViewWidth(),V=this.getViewHeight(),R=(j=this.xzSize(j))/(V=this.xzSize(V))*50;this.camera=new w.OrthographicCamera(R/-2,R/2,25,-25,1,1e3),this.camera.position.set(-200,200,200),this.scene=new w.Scene,this.scene.background=new w.Color(this._viewcolor);var M=this.getUserCanvas();M==null?(this.renderer=new w.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(this._devicePixelRatio),this.renderer.setSize(j,V),document.body.appendChild(this.renderer.domElement)):(this.renderer=new w.WebGLRenderer({canvas:M,antialias:!0,alpha:!0}),this.renderer.setPixelRatio(this._devicePixelRatio));var ee=this.getUserCanvas();ee==null&&(ee=this.renderer.domElement),this.controls=new G.OrbitControls(this.camera,ee)},C.prototype.onInitViewScene=function(){},C.prototype.onInitScene=function(){if(this.callInitSceneEvent(this.scene,this.controls,!1)==0){var j=new w.AmbientLight(2236962);j.integrity=1,this.scene.add(j);var V=new w.DirectionalLight(16777215,1);V.position.set(-2,2,3).normalize(),this.scene.add(V);var R=new w.GridHelper(2e3,100);R.position.y=-199,R.material.opacity=.25,R.material.transparent=!0,this.scene.add(R);var M=new w.AxesHelper(20);this.scene.add(M)}},C.prototype.onCreate=function(){this._is2d=!1,this.callEvent("initRenderer",this.renderer),this.mxdrawThreeJS.onInitScene()},C.prototype.getOrthographicCamera=function(){return this.camera instanceof w.OrthographicCamera?this.camera:null},C.prototype.onViewChange=function(){},C.prototype.onResizeImp=function(j,V){var R=this.getViewWidth();j!=null&&(R=j);var M=this.getViewHeight();V!=null&&(M=V),R=this.xzSize(R),M=this.xzSize(M);var ee=this.getOrthographicCamera(),F=R/M;ee.left=50*F/-2,ee.right=50*F/2,ee.top=25,ee.bottom=-25,ee.updateProjectionMatrix(),this.renderer.setSize(R,M)},C.prototype.zoomInitialStates=function(){},C.prototype.saveZoom=function(){},C.prototype.recoverZoom=function(){},C.prototype.zoomScale_call=function(j){},C.prototype.zoomW_call=function(j,V,R,M){},C.prototype.zoomCenter_call=function(j,V){},C.prototype.setViewAngle_call=function(j){this._viewangle=j},C.prototype.getFullDisplayRange=function(){return{}},C);function C(){var j=h.call(this,!1)||this;return j._viewcolor=15790320,j}o.MxDrawObject3d=O},{"./MxDrawObject":23,"./MxMaterial":30,"./MxNetData":31,"./MxTools":38,three:19,"three-orbitcontrols":17}],26:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObjectEvent=o.MxDrawObjectEventDefautProc=void 0;var a=b("./MxFun"),v=b("./Operate/MxJigCmdManager"),h=b("three"),w=b("./UI/MxUiVue"),L=b("./MxDrawData"),G=(k.prototype.onMousemove=function(O){if(w.MxUiVue.isNull())return 0;var C=this.mxObj.screenCoord2Doc(O.offsetX,O.offsetY,0);return C=this.mxObj.docCoord2Cad(C.x,C.y,C.z),w.MxUiVue.setTipCoord(a.MxFun.formatString("{0},{1},0.000",C.x.toFixed(3),C.y.toFixed(3))),0},k.prototype.onTouchStart=function(O){if(L.MxDrawData.m_isEnableIntelliSelect&&!v.MxJigCmdManager.isRunning()&&!this.mxObj.isPaningCommand()&&O.touches.length==1){var C=O.target.getBoundingClientRect(),j=O.touches[0].clientX-C.left,V=O.touches[0].clientY-C.top,R=this.mxObj,M=R.screenCoord2Current(j,V,0);if(!(R.getMxDatabase().getGripManager().onMouseLBDown(M)||R.isValidMcObject()&&R.getMcObject().getGripManager().onMouseLBDown(M))){var ee=new h.Vector3(j,V,0);return a.MxFun.sendStringToExecute("Mx_FrontEndWebpageIntelliSel",{pt:ee}),1}}return 0},k.prototype.onMousdown=function(O){if(O.button==v.MxJigCmdManager.MouseButton.kRight&&v.MxJigCmdManager.isRunning())return v.MxJigCmdManager.OnEnter(-1),O.stopPropagation(),0;if(L.MxDrawData.m_isEnableIntelliSelect&&O.button==v.MxJigCmdManager.MouseButton.kLeft&&!v.MxJigCmdManager.isRunning()&&!this.mxObj.isPaningCommand()){var C=this.mxObj,j=C.screenCoord2Current(O.offsetX,O.offsetY,0);if(!(C.getMxDatabase().getGripManager().onMouseLBDown(j)||C.isValidMcObject()&&C.getMcObject().getGripManager().onMouseLBDown(j))){var V=new h.Vector3(O.offsetX,O.offsetY,0);return a.MxFun.sendStringToExecute("Mx_FrontEndWebpageIntelliSel",{pt:V}),1}}return 0},k.prototype.init=function(O,C){this.mxObj=O;var j=this;C.addEventListener("mousemove",function(V){return j.onMousemove(V)}),C.addEventListener("mousedown",function(V){return j.onMousdown(V)}),C.addEventListener("touchstart",function(V){return j.onTouchStart(V)})},k);function k(){}o.MxDrawObjectEventDefautProc=G;var D=(f.prototype.onMousedown=function(O,C){this.callEvent("mousedown",O,C)},f.prototype.onMousemove=function(O,C){this.callEvent("mousemove",O,C)},f.prototype.onMouseup=function(O,C){this.callEvent("mouseup",O,C)},f.prototype.registEvent=function(O){var C=O.getMxDrawThreeJs().getRegistEventObject();if(!C)return!1;var j=this;a.MxFun.isPC()?(C.addEventListener("mouseup",function(V){var R=O.getMxDrawThreeJs().getDomMousePos(V);j.onMouseup(V,R)},!0),C.addEventListener("mousemove",function(V){var R=O.getMxDrawThreeJs().getDomMousePos(V);O.setCurrentMousePostion(V),j.onMousemove(V,R)},!0),C.addEventListener("mousedown",function(V){var R=O.getMxDrawThreeJs().getDomMousePos(V);O.setCurrentMousePostion(V),j.onMousedown(V,R)},!0)):(C.addEventListener("touchstart",function(V){O.setCurrentMousePostion(V,!0),j.callEvent("touchstart",V)},!0),C.addEventListener("touchend",function(V){j.callEvent("touchend",V)},!0),C.addEventListener("touchmove",function(V){O.setCurrentMousePostion(V,!0),j.callEvent("touchmove",V)},!0)),this.defautProc.init(O,this)},f.prototype.getEventCall=function(O){var C;return O=="mousemove"?C=this.aryMousemoveEventCall:O=="mouseup"?C=this.aryMouseupEventCall:O=="mousedown"?C=this.aryMousedownEventCall:O=="touchstart"?C=this.aryTouchstartEventCall:O=="touchend"?C=this.aryTouchendEventCall:O=="touchmove"&&(C=this.aryTouchmoveEventCall),C},f.prototype.callEvent=function(O,C,j){var V=this.getEventCall(O);if(V){for(var R=V.slice(),M=0,ee=R.length;M<ee;M++){var F=R[M](C,j);if(F==1)return F}return 0}},f.prototype.addEventListener=function(O,C,j){j===void 0&&(j=!1);var V=this.getEventCall(O);return!!V&&(-1<V.indexOf(C)||(j?V.unshift(C):V.push(C)),!0)},f.prototype.removeEventListener=function(O,C){var j=this.getEventCall(O);if(!j)return!1;var V=j.indexOf(C);return-1<V&&(j.splice(V,1),!0)},f);function f(){this.aryMousedownEventCall=[],this.aryMouseupEventCall=[],this.aryMousemoveEventCall=[],this.aryTouchstartEventCall=[],this.aryTouchendEventCall=[],this.aryTouchmoveEventCall=[],this.defautProc=new G}o.MxDrawObjectEvent=D},{"./MxDrawData":22,"./MxFun":27,"./Operate/MxJigCmdManager":54,"./UI/MxUiVue":65,three:19}],27:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxFun=void 0;var a,v,h,w,L,G,k,D,f,O,C,j,V,R,M,ee,F=b("three"),_=b("./MxManager"),J=b("./MxDrawObject"),T=b("./MxDrawObject2d"),B=b("./MxDrawObject3d"),N=b("./UI/MxUiObjectMobile"),u=b("./UI/MxUiObjectPC"),c=b("./Operate/MxJigCmdManager"),m=b("./Operate/MxJigGetLine"),E=b("./Operate/MxCmdRunManager"),U=b("./UI/MxUiVue"),X=b("./MxThreeJS"),W=b("./MxWindowsEvent"),te=b("./MxTools"),ne=b("./MxDrawCommands"),ce=b("./MxDrawData"),we=b("./MxLocalFileLoad"),Ie=b("./TempTest/MxTestJig"),xe=b("./MxVersion"),Be=b("./MrxDbgUtils");function q(le){le.cmd&&Ge(le.cmd)}function ge(le){var ve=new RegExp("(^|&)"+le+"=([^&]*)(&|$)"),He=window.location.href,nt=He.indexOf("?"),ht=(He=nt==-1?"":He.substring(nt)).substr(1).match(ve);return ht!=null?decodeURIComponent(ht[2]):""}function oe(){return _.MxManager.currentMx()}function se(le,ve){var He={};if(le!=null)if(le instanceof Array)He.is2d=!0;else{le.length==0&&(le="empty");var nt=le.substring(le.lastIndexOf(".")+1).toLowerCase();if(nt!="dwg"&&nt!="dxf"&&nt!="dwf"&&nt!="mwg"&&nt!="wgh"||(He.is2d=!0),ve!=1&&ve!=null&&nt!="wgh"){var ht=void 0,Tt=le.split("/");(ht=Tt.length==1?Tt[0]:Tt[Tt.length-1])[0]=="$"&&(ht=ht.substring(1));for(var Ct=void 0,We=0;We<Tt.length-1;We++)Ct=We==0?Tt[We]:Ct+"/"+Tt[We];le=Ct?Ct+"/$"+ht+".mxb1.wgh":"$"+ht+".mxb1.wgh"}}else le="empty_template.dwg";return He.sFileName=le,He}function Ae(le){if(typeof le=="string"){var ve=le.substring(le.lastIndexOf(".")+1).toLowerCase();if(ve!="dwg"&&ve!="wgh"){var He=le.lastIndexOf("?");if(He!=-1){var nt=le.substring(He,le.length);return{sFileName:le=le.substring(0,He),sUrlParam:nt}}}}return null}function Ye(){return c.MxJigCmdManager.stopCmd(c.MxJigCmdManager.DetailedResult.kUnknown)}function Ge(le,ve){if(le.length!=0){var He=oe();return E.MxCmdRunManager.runCmd(He,le,ve)}Ye()}function Ne(le){le!=null&&(le.init(),U.MxUiVue.init(le)),j||(console.log("MxDraw Version:"+xe.MxBulid.getVersion()),j=!0,M=new we.MxLocalNodeJs,c.MxJigCmdManager.init(),W.MxWindowsEvent.registEvent(),ne.MxDrawCommands.registerCommand(),window.mxConfig_isLoadTest&&Ie.MxTest.registerCommand(),R.sendStringToExecute=q)}v=a||(o.MxFun=a={}),h=".",C=null,j=!(O="ws://localhost:5090"),R={},M=V=f=k=w=void 0,ee=D=G=L=-1,v.getUiObj=function(){return C},v.on=function(le,ve){_.MxManager.on(le,ve)},v.callEvent=function(le,ve){return _.MxManager.callEvent(le,ve)},v.getNodeJs=function(){return M},v.setMxServer=function(le){O=le},v.getMxServer=function(){return O},v.isPC=function(){return ee==-1?function(){if(!/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)){var le=navigator.userAgent.toLowerCase();return 0<=le.indexOf("win64")||0<=le.indexOf("wow64")||0<=le.indexOf("win32")||0<=le.indexOf("wow32")||/macintosh|mac os x/i.test(navigator.userAgent)||!("ontouchstart"in window||0<navigator.maxTouchPoints)}}()?(ee=1,!0):(ee=0,!1):ee==1},v.getClientPlatform=function(){return navigator.platform},v.getClientInfo=function(){return{width:document.body.clientWidth,height:document.body.clientHeight}},v.curPath=function(){return h},v.setCurPath=function(le){h=le},v.getQueryString=ge,v.getLocationPageUrl=function(){var le=window.location.href,ve=le.lastIndexOf("?");return ve==-1?le:le.substring(0,ve)},v.getHostUrl=function(){var le=window.location.hostname;return le.substring(0,4)!="http"&&(le="http://"+le),le},v.isAbsoluteWebPath=function(le){return le.substring(0,4)=="http"},v.getUrlParams=function(){var le=window.location.search,ve=le.substr(1,le.length).split("&"),He=new Array;if(ve!=null)for(var nt=0;nt<ve.length;nt++){var ht=ve[nt].replace(/[=|^==]/,"&").split("&");if(1<ht.length){var Tt=new Array;Tt.push(decodeURIComponent(ht[0])),Tt.push(decodeURIComponent(ht[1])),He.push(Tt)}}return He},v.call=function(le,ve,He){ve==null?ve="{}":typeof ve=="string"?ve.length==0?ve="{}":ve[0]=="["&&ve[ve.length-1]=="]"||ve[0]=="{"&&ve[ve.length-1]=="}"||(ve='"'+(ve=ve.replace(/"/g,"'"))+'"'):ve=typeof ve=="object"?JSON.stringify(ve):"{}",_.MxManager.currentMx().call(le,ve,He)},v.loadCodeToServer=function(le,ve){_.MxManager.currentMx().loadCodeToServer(le,ve)},v.getCurrentMx=function(){return _.MxManager.currentMx()},v.isEnableSelect=function(){if(L!=-1)return L==1;var le=ge("select");return L=0,le!=null&&le.toLowerCase()=="y"&&(L=1),L==1},v.is3DDwg=function(){if(D!=-1)return D==1;var le=ge("3ddwg");return D=0,le!=null&&le.toLowerCase()=="y"&&(D=1),D==1},v.isStaticLoad=function(){if(G!=-1)return G==1;var le=ge("static");return G=0,le!=null&&le.toLowerCase()=="y"&&(G=1),G==1},v.enableSelect=function(le){L=le?1:0},v.enablStaticLoad=function(le){G=le==null||le?1:0},v.dwgDir=function(){return k!=null||(k=ge("dwgdir"))==null&&(k=""),k},v.setDwgDir=function(le){k=le},v.getStaticServer=function(){return f!=null||(f=ge("staticServer"))==null&&(f=""),f},v.setStaticServer=function(le){f=le},v.is2dParam=function(){if(w!=null)return w;var le=ge("file");if(w=!1,le!=null){var ve=le.substring(le.lastIndexOf(".")+1);ve.toLowerCase()!="dwg"&&ve.toLowerCase()!="dxf"&&ve.toLowerCase()!="dwf"&&ve.toLowerCase()!="mwg"||(w=!0)}return w},v.set2dParam=function(le){w=le},v.showLayer=function(le,ve){return _.MxManager.currentMx().showLayer(le,ve)},v.screenCoord2World=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().screenCoord2World(le.x,le.y,le.z):_.MxManager.currentMx().screenCoord2World(le,ve,He)},v.worldCoord2Screen=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().worldCoord2Screen(le.x,le.y,le.z):_.MxManager.currentMx().worldCoord2Screen(le,ve,He)},v.docCoord2Cad=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().docCoord2Cad(le.x,le.y,le.z):_.MxManager.currentMx().docCoord2Cad(le,ve,He)},v.cadCoord2Doc=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().cadCoord2Doc(le.x,le.y,le.z):_.MxManager.currentMx().cadCoord2Doc(le,ve,He)},v.docCoord2World=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().docCoord2World(le.x,le.y,le.z):_.MxManager.currentMx().docCoord2World(le,ve,He)},v.worldCoord2Doc=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().worldCoord2Doc(le.x,le.y,le.z):_.MxManager.currentMx().worldCoord2Doc(le,ve,He)},v.screenCoord2Doc=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().screenCoord2Doc(le.x,le.y,le.z):_.MxManager.currentMx().screenCoord2Doc(le,ve,He)},v.docCoord2Screen=function(le,ve,He){return le instanceof Object?_.MxManager.currentMx().docCoord2Screen(le.x,le.y,le.z):_.MxManager.currentMx().docCoord2Screen(le,ve,He)},v.docCoordLong2Cad=function(le){return _.MxManager.currentMx().docCoordLong2Cad(le)},v.cadCoordLong2Doc=function(le){return _.MxManager.currentMx().cadCoordLong2Doc(le)},v.viewCoordLong2Cad=function(le){return _.MxManager.currentMx().viewCoordLong2Cad(le)},v.cadCoordLong2View=function(le){return _.MxManager.currentMx().cadCoordLong2View(le)},v.zoomCenter=function(le,ve){_.MxManager.currentMx().is2D()&&(_.MxManager.currentMx().zoomCenter(le,ve),_.MxManager.currentMx().updateDisplay())},v.zoomW=function(le,ve,He,nt,ht){_.MxManager.currentMx().is2D()&&(_.MxManager.currentMx().zoomW(new F.Vector3(le,ve,0),new F.Vector3(He,nt,0),ht),_.MxManager.currentMx().updateDisplay())},v.zoomScale=function(le){_.MxManager.currentMx().is2D()&&(_.MxManager.currentMx().zoomScale(le),_.MxManager.currentMx().updateDisplay())},v.zoomAll=function(){_.MxManager.currentMx().is2D()&&(_.MxManager.currentMx().zoomAll(),_.MxManager.currentMx().updateDisplay())},v.deleteAll=function(){return _.MxManager.currentMx().deleteAll()},v.callCommand=function(le,ve,He){_.MxManager.currentMx().callCommand(le,ve,He)},v.getCurrentColor=function(){return _.MxManager.currentMx().getCurrentColor()},v.setCurrentColor=function(le){_.MxManager.currentMx().setCurrentColor(le)},v.showLoading=function(){C!=null&&C.ShowLoading()},v.hideLoading=function(){C!=null&&C.HideLoading()},v.showProp=function(le){C!=null&&C.ShowObjectProperty(le)},v.hideProp=function(){C!=null&&C.HideObjectProp()},v.getUiObject=function(){return C},v.getViewCenterDocCoord=function(){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().getViewCenterDocCoord():new F.Vector3(0,0,0)},v.screenCoordLong2Doc=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().screenCoordLong2Doc(le):le},v.docCoordLong2Screen=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().docCoordLong2Screen(le):le},v.worldCoordLong2Doc=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().worldCoordLong2Doc(le):le},v.docCoordLong2World=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().docCoordLong2World(le):le},v.screenCoordLong2World=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().screenCoordLong2World(le):le},v.worldCoordLong2Screen=function(le){return _.MxManager.currentMx().is2D()?_.MxManager.currentMx().worldCoordLong2Screen(le):le},v.addSelectEvent=function(le){_.MxManager.addSelectEvent(le)},v.clearSelectEvent=function(){_.MxManager.clearSelectEvent()},v.removeThreejsObject=function(le,ve,He){le&&(le.traverse(function(nt){(nt instanceof F.Mesh||nt instanceof F.Line||nt instanceof F.LineLoop)&&(nt.geometry.dispose(),He&&(nt.material instanceof Array?nt.material.forEach(function(ht){ht.dispose()}):nt.material.dispose()))}),ve.remove(le))},v.removeThreejsAllChildren=function le(ve){for(;0<ve.children.length;){var He=ve.children[0];ve.remove(He),0<He.children.length&&le(He),He.geometry&&He.geometry.dispose(),He.material instanceof Array?He.material.forEach(function(nt){nt.dispose()}):He.material.dispose(),He.texture&&He.texture.dispose()}},v.setOutServerDebugCall=function(le){_.MxManager.setOutDebugCall(le)},v.updateDisplay=function(){_.MxManager.updateDisplay()},v.getCurrentDraw=oe,v.formatString=function(le){for(var ve=[],He=1;He<arguments.length;He++)ve[He-1]=arguments[He];for(var nt=0;nt<ve.length;nt++)le=le.replace("{".concat(nt,"}"),ve[nt]);return le},v.createMxUiObject=function(le){var ve;return ve=this.isPC()?new u.MxUiObjectPC:new N.MxUiObjectMobile,le(C=ve),ve.create(),ve},v.openFile=function(le,ve){var He="";if(typeof le=="string"){var nt=Ae(le);nt&&(He=nt.sUrlParam,le=nt.sFileName)}ve==null&&(ve=!1);var ht=se(le,ve);return ht.is2d&&(w=ht.is2d),le=ht.sFileName,_.MxManager.currentMx().openFile(le,He)},v.createMxObject=function(le,ve,He,nt,ht,Tt,Ct,We){j||Ne(),typeof le=="string"&&(le=le.length==0?void 0:document.getElementById(le));var It=null,Bt="";if(We)ve="",(It=new T.MxDrawObject2d).initRunMode(J.MxRunMode.kCPPMxCAD),It.setViewColor(0);else{if(ve==null)ve=v.getQueryString("file");else{var Ln=Ae(ve);Ln&&(Bt=Ln.sUrlParam,ve=Ln.sFileName)}var rn=nt==null||nt;if(ve===void 0||ve.length==0||ve=="empty")rn=!0,ve=ve=="empty"?"":"empty_template.dwg";else{var Xn=se(ve,Tt);Xn.is2d&&(rn=Xn.is2d),ve=Xn.sFileName}ht==1&&(ve=""),rn?(It=new T.MxDrawObject2d).setViewColor(0):(It=new B.MxDrawObject3d).setViewColor(15790320)}return He!=null&&He(It),It.create(le,ve,Bt,Ct),It},v.getMxObjectFormElement=function(le){return _.MxManager.getMxObject(le)},v.initMxCpp=function(le){_.MxManager.initMxCpp(le)},v.isRunningCommand=function(){return c.MxJigCmdManager.isRunning()},v.stopRunCommand=Ye,v.runCommand=function(le){return c.MxJigCmdManager.runCmd(le)},v.getTHREE=function(){return F},v.getLine=function(le){var ve=new m.MxJigGetLine;ve.setRetCall(le),c.MxJigCmdManager.runCmd(ve)},v.addCommand=function(le,ve,He){E.MxCmdRunManager.addCommand(le,ve,He)},v.sendStringToExecute=Ge,v.getMxEntity=function(le){var ve=oe();return ve?ve.getMxEntityUserObject(le):null},v.initUiDataObject=function(le){U.MxUiVue.isNull()&&(le.init(v),U.MxUiVue.init(le))},v.init=Ne,v.addWindowsEvent=function(le){W.MxWindowsEvent.addEvent(le)},v.getCurrentMousePostion=function(){return oe().getCurrentMousePostion()},v.getMxThreeJS=function(){return X.MxThreeJS},v.getMxTools=function(){return te.MxTools},v.getMxCmdRunManager=function(){return E.MxCmdRunManager},v.getMxJigCmdManager=function(){return c.MxJigCmdManager},v.initQuickCommand=function(le){E.MxCmdRunManager.InitQuickCommand(le)},v.InitLanguageString=function(le){E.MxCmdRunManager.InitLanguageString(le)},v.getLanguageString=function(le,ve){return ve===void 0&&(ve=""),E.MxCmdRunManager.getLanguageString(le,ve)},v.Assert=function(le){le||console.log("MxAssert error")},v.setIniset=function(le){ce.MxDrawData.setIniset(le)},v.setPostMessageToParentFrameFunction=function(le){V=le},v.postMessageToParentFrame=function(le){return V!=null&&(V(le),!0)},v.onParentFrameMessage=function(le){le!=null&&le.type!=null&&R[le.type]&&R[le.type](le)},v.acutPrintf=function(le){for(var ve=[],He=1;He<arguments.length;He++)ve[He-1]=arguments[He];if(!U.MxUiVue.isNull()){for(var nt=arguments,ht=nt[0],Tt=0;Tt<nt.length-1;Tt++){var Ct=new RegExp("\\{"+Tt+"\\}","gm");ht=ht.replace(Ct,nt[Tt+1])}U.MxUiVue.AcutPrintfNoFormat(ht,!0)}},v.loadImageMaterial=function(le,ve){_.MxManager.getMxDbTextureManager().loadImage(le,ve)},v.loadSVG=function(le,ve,He,nt){_.MxManager.getMxDbSvgManager().loadSVG(le,ve,He,nt)},v.initMxDbEntityType=function(le){_.MxManager.getMxDbEntityClassHierarchy().init(le)},v.initDynamicCreate=function(le){_.MxManager.getMxDbEntityClassHierarchy().initDynamic(le)},v.ceneratecursor=function(le,ve,He,nt){le===void 0&&(le=128),ve===void 0&&(ve=10),He===void 0&&(He=!0);var ht=document.createElement("canvas");ht.width=ht.height=le,ht.style.background="transparent";var Tt=ht.getContext("2d"),Ct=le%2==0?-.5:0,We=ve%2==0?-.5:0;Tt.strokeStyle=nt||"#fff",He&&(Tt.beginPath(),Tt.moveTo(ht.width/2+Ct,Ct),Tt.lineTo(ht.width/2+Ct,ht.height+Ct),Tt.stroke(),Tt.beginPath(),Tt.moveTo(Ct,ht.height/2+Ct),Tt.lineTo(ht.width+Ct,ht.height/2+Ct),Tt.stroke()),Tt.beginPath(),Tt.strokeRect(le/2-ve/2+We,le/2-ve/2+We,ve,ve),Tt.stroke();var It=new Image;return It.src=ht.toDataURL("image/png"),It.src},v.getMrxDbgUtilsClass=function(){return Be.MrxDbgUtils},v.getNumberColor=function(le){return le instanceof Object?le.getHex&&(le=le.getHex()):typeof le=="string"&&(le=parseInt(le)),le}},{"./MrxDbgUtils":20,"./MxDrawCommands":21,"./MxDrawData":22,"./MxDrawObject":23,"./MxDrawObject2d":24,"./MxDrawObject3d":25,"./MxLocalFileLoad":28,"./MxManager":29,"./MxThreeJS":37,"./MxTools":38,"./MxVersion":40,"./MxWindowsEvent":41,"./Operate/MxCmdRunManager":48,"./Operate/MxJigCmdManager":54,"./Operate/MxJigGetLine":55,"./TempTest/MxTestJig":61,"./UI/MxUiObjectMobile":63,"./UI/MxUiObjectPC":64,"./UI/MxUiVue":65,three:19}],28:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxLocalDwgFileLoad=o.MxLocalFileLoad=o.MxLocalNodeJs=void 0;var a=b("./MxFun"),v=(h.prototype.init=function(D){this.loadFileCall=D.loadFileFun},h.prototype.loadFile=function(D,f,O,C,j){this.loadFileCall!=null?this.loadFileCall(D,f,O,C,j):j(void 0)},h);function h(){this.loadFileCall=null}o.MxLocalNodeJs=v;var w=(L.prototype.setPath=function(D){this.path=D},L.prototype.setBinary=function(D){this.isBinary=D},L.prototype.load=function(D,f,O,C){a.MxFun.getNodeJs().loadFile(this.path+D,this.isBinary,f,O,C)},L);function L(){this.path="",this.isBinary=!1}o.MxLocalFileLoad=w;var G=(k.prototype.setShowloading=function(D){this._isShowLoading=D},k.prototype.load=function(D,f){var O="$"+f+".mxb1.wgh";this._path=D,this._filename=f;var C=this;this.getFile(this._path,O,!1,function(j){typeof j=="string"?C.net.onStaticHeadMessage(j):console.log("mx error h1")},function(){console.log("mx get "+O+" faild")})},k.prototype.getDatas=function(){if(this._iGet>=this._dataNum)this._isShowLoading&&a.MxFun.hideLoading();else{var D=this._dataType[this._iGet];this._iGet++;var f=this,O=this._iGet+1,C="$"+this._filename+".mxb"+O+".wgh",j=D!=0;this.getFile(this._path,C,j,function(V){f.net.onStaticMessage(V),f.getDatas()},function(){f._dataNum=0,f._iGet=0,f._isShowLoading&&a.MxFun.hideLoading(),console.log("mx get "+C+" faild")})}},k.prototype.onRenderHead=function(D){var f=JSON.parse(D);this._dataType=f.type,this._dataNum=f.count,this._iGet=0,this._isShowLoading&&a.MxFun.showLoading(),this.getDatas()},k.prototype.getFile=function(D,f,O,C,j){var V=new w;V.setPath(D),V.setBinary(O),V.load(f,C,function(){},j)},k);function k(D){this.net=null,this._dataNum=0,this._iGet=0,this._dataType=[],this._path="",this._filename="",this._isShowLoading=!0,this.net=D}o.MxLocalDwgFileLoad=G},{"./MxFun":27}],29:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxManager=o.MxCpp=o.MxData=void 0;var a,v,h=b("./View/MxDbEntity"),w=b("./View/MxDbTextureManager"),L=b("./SVGLoader/MxSVGLoader");(v=a||(o.MxData=a={})).iSelectRenderOrder=5,v.iCADMeshRenderOrder=10,v.iCADCurveRenderOrder=20,v.iMxEntityRenderOrder=30,v.iGripRenderOrder=110,v.iDynJigRenderOrder=120;var G,k,D,f,O,C,j,V,R,M,ee,F,_=(J.prototype.init=function(T){this.imp=T},J.prototype.getMxCAD_MxCpp=function(){return this.imp},J.prototype.getMxCAD_App=function(){return this.imp.App},J.prototype.newMcGePoint3d=function(T){return this.imp?this.imp.newMcGePoint3d(T):null},J.prototype.decodeFromGb2312=function(T){return this.imp.decodeFromGb2312(T)},J.prototype.encodeToGb2312=function(T){return this.imp.encodeToGb2312(T)},J.prototype.getMcDbCurve=function(T){if(this.imp.App.objectIdIsKindOf(T,"McDbCurve"))return this.imp.App.objectIdToObject(T)},J);function J(){}o.MxCpp=_,k=G||(o.MxManager=G={}),D=[],f=null,C=[],j=void(O=0),V=new w.MxDbTextureManager,R=new L.MxSvgManager,M=new h.MxDbEntityClassHierarchy,ee=new _,F={},k.add=function(T){D.push(T)},k.on=function(T,B){F[T]||(F[T]=[]),F[T].push(B)},k.callEvent=function(T,B){var N;if(F[T])return F[T].forEach(function(u){var c=u(B);N=N||c}),N},k.initMxCpp=function(T){ee.init(T)},k.getMxCpp=function(){return ee},k.allocId=function(){return++O},k.getMxDbEntityClassHierarchy=function(){return M},k.getMxDbTextureManager=function(){return V},k.getMxDbSvgManager=function(){return R},k.outDebugString=function(T){j==null?console.log(T):j(T)},k.setOutDebugCall=function(T){j=T},k.onLoad=function(){for(var T in D)D[T].onLoad("")},k.updateDisplay=function(){for(var T in D)D[T].updateDisplay()},k.currentMx=function(){return f},k.setCurrentMx=function(T){f=T},k.initResize=function(){for(var T in D)D[T].initResize()},k.addSelectEvent=function(T){C.push(T)},k.clearSelectEvent=function(){C=[]},k.callSelectObject=function(T){for(var B in C)if(C[B](T)==1)break},k.getMxObject=function(T){if(typeof T=="number"){for(var B in D)if(D[B].getId()===T)return D[B]}else for(var B in D)if(D[B].getCanvas()===T)return D[B];return null}},{"./SVGLoader/MxSVGLoader":59,"./View/MxDbEntity":69,"./View/MxDbTextureManager":74}],30:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxMaterial=void 0;var a,v=b("three");(function(h){h.shaderUniforms={crAmbient:{value:new v.Vector3(1,0,0)},crDiffuse:{value:new v.Vector3(1,0,0)},crSpecular:{value:new v.Vector3(1,0,0)}},h.m_arrSystemColors=new Array(0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10066176,10066252,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510272,8755532,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019904,7510348,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529536,6265164,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,39168,5019980,32512,4161343,19456,2509862,65343,8388511,52275,6737023,39206,5019999,32543,4161359,19475,2509871,65407,8388543,52326,6737049,39244,5020018,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39282,5020037,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39321,5020057,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29337,5014937,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19609,5010073,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9881,5005209,8063,4149119,4940,2502476,255,8355839,204,6710988,153,5000345,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490521,6245529,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980889,7490713,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471257,8735897,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,10027161,10046617,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,10027122,10046597,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,10027084,10046578,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,10027046,10046559,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215),h.m_arrDefUseMaterials=new Array(null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null),h.m_arrDefUseCurveMaterials=new Array(null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null),h.m_arrDefUseBasicMaterials=new Array(null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null),h.m_selectMaterial=new v.MeshPhongMaterial({color:255,opacity:.2,transparent:!0,side:v.DoubleSide}),h.m_mouseMoveMaterial=new v.MeshPhongMaterial({color:16776960,side:v.DoubleSide}),h.m_lockedMaterial=new v.MeshPhongMaterial({color:197379,side:v.DoubleSide}),h.m_samplePoints=new v.PointsMaterial({color:255,depthTest:!1,size:8}),h.m_samplePointsMouseMove=new v.PointsMaterial({color:16711680,depthTest:!1,size:12});var w=new v.MeshBasicMaterial({color:16777215,transparent:!0,depthTest:!1,side:v.DoubleSide,opacity:1,stencilWrite:!1,colorWrite:!1});h.getStencilMaterial=function(){return w},h.GetColorByIndex=function(L){return h.m_arrSystemColors[L]},h.GetColorMaterial=function(L){var G=h.m_arrDefUseMaterials[L];return G===null&&(G=new v.MeshLambertMaterial({color:h.m_arrSystemColors[L],side:v.DoubleSide}),h.m_arrDefUseMaterials[L]=G),G},h.GetBaseColorMaterial=function(L){var G=h.m_arrDefUseBasicMaterials[L];return G===null&&(G=new v.MeshBasicMaterial({color:h.m_arrSystemColors[L],side:v.DoubleSide}),h.m_arrDefUseMaterials[L]=G),G},h.GetCurveColorMaterial=function(L){var G=h.m_arrDefUseCurveMaterials[L];return G===null&&(G=new v.LineBasicMaterial({color:h.m_arrSystemColors[L],linewidth:1}),h.m_arrDefUseCurveMaterials[L]=G),G},h.GetSelectMaterial=function(){return h.m_selectMaterial},h.GetMouseMoveMaterial=function(){return h.m_mouseMoveMaterial},h.GetLockedMaterial=function(){return h.m_lockedMaterial},h.GetSamplePointsMaterial=function(){return h.m_samplePoints},h.GetSamplePointsMouseMoveMaterial=function(){return h.m_samplePointsMouseMove},h.createMaterial=function(L){var G=void 0;if(L==null)return G;function k(D,f){if(f.map!=null){var O=f.map,C=new v.TextureLoader().load(O);C.wrapS=C.wrapT=v.RepeatWrapping,D.map=C,D.side=v.DoubleSide}}return L.transparent!=0?L.transparent=!0:L.transparent=!1,L.name=="MeshPhongMaterial"?k(G=new v.MeshPhongMaterial(L),L):L.name=="MeshBasicMaterial"?k(G=new v.MeshBasicMaterial(L),L):L.name=="MeshDepthMaterial"?k(G=new v.MeshDepthMaterial(L),L):L.name=="MeshNormalMaterial"?k(G=new v.MeshNormalMaterial(L),L):L.name=="MeshLambertMaterial"?k(G=new v.MeshLambertMaterial(L),L):L.name=="MeshStandardMaterial"&&k(G=new v.MeshStandardMaterial(L),L),G}})(a||(o.MxMaterial=a={}))},{three:19}],31:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxHFileLoad=o.MxNet=o.MxNetBinMessageType=o.MxNetSend=o.MxNetMessage=o.MxNetMessageType=o.MxNetData=void 0;var a,v,h=b("three"),w=b("./MxFun"),L=b("pako"),G=b("./MxManager"),k=b("./MxDrawData"),D=(f.prototype.getId=function(){return this._dataView.getInt32(4,!0)},f.prototype.getVersion_MwBlobHead=function(){return this._dataView.getInt32(60,!0)},f.prototype.getVersion_MwBlobHeadDynLen=function(){return this._dataView.getInt32(4,!0)},f.prototype.getdPointCurveBuffersHead=function(){var T={};return T.ver=this._dataView.getInt32(4,!0),T.databaseIndex=this._dataView.getInt32(8,!0),T.zeroLayerIdIndex=this._dataView.getInt32(16,!0),T.datacount=this._dataView.getInt32(20,!0),T.datasize=this._dataView.getInt32(24,!0),T},f.prototype.getdPointMeshBuffersHead=function(){var T={};return T.ver=this._dataView.getInt32(4,!0),T.databaseIndex=this._dataView.getInt32(8,!0),T.id=this._dataView.getInt32(12,!0),T.zeroLayerIdIndex=this._dataView.getInt32(16,!0),T.datacount=this._dataView.getInt32(20,!0),T.datasize=this._dataView.getInt32(24,!0),T},f.prototype.getdPointTextureBuffersHead=function(){var T={};return T.ver=this._dataView.getInt32(4,!0),T.databaseIndex=this._dataView.getInt32(8,!0),T.zeroLayerIdIndex=this._dataView.getInt32(16,!0),T.datacount=this._dataView.getInt32(20,!0),T.datasize=this._dataView.getInt32(24,!0),T},f.prototype.getBlobHeadForMemorySectionsHead=function(T){var B={};return B.type=this._dataView.getInt32(T,!0),T+=4,B.ver=this._dataView.getInt32(T,!0),T+=4,B.databaseIndex=this._dataView.getInt32(T,!0),T+=4,B.nOffset=T,B},f.prototype.getMemorySectionsHead=function(){var T=this.getBlobHeadForMemorySectionsHead(0);return T.zeroLayerIdIndex=this._dataView.getInt32(T.nOffset,!0),T.nOffset+=4,T.datacount=this._dataView.getInt32(T.nOffset,!0),T.nOffset+=4,T.datasize=this._dataView.getInt32(T.nOffset,!0),T.nOffset+=4,T.datasize!=T.nOffset&&console.log("mx: sectionshead size assert(0)"),T},f.prototype.getMemorySectionHead=function(T){var B=this.getBlobHeadForMemorySectionsHead(T);return T=B.nOffset,B.pointCount=this._dataView.getInt32(T,!0),T+=4,B.layerId=this._dataView.getInt32(T,!0),T+=4,B.blkId=this._dataView.getInt32(T,!0),T+=4,B.memColor=this._dataView.getInt32(T,!0),T+=4,B.memId=this._dataView.getInt32(T,!0),T+=4,B.memType=this._dataView.getInt32(T,!0),T+=4,B.offset=T,B},f.prototype.getdPointTextureBufferDataHead=function(T){T+=4,T+=4,T+=4;var B={};return B.dataCount=this._dataView.getInt32(T,!0),T+=4,B.layerId=this._dataView.getInt32(T,!0),T+=4,B.blkId=this._dataView.getInt32(T,!0),T+=4,B.offset=T,B},f.prototype.getdPointCurveBufferDataHead=function(T){T+=4,T+=4,T+=4;var B={};return B.pointCount=this._dataView.getInt32(T,!0),T+=4,B.layerId=this._dataView.getInt32(T,!0),T+=4,B.blkId=this._dataView.getInt32(T,!0),T+=4,B.offset=T,B},f.prototype.getdPointMeshBufferDataHead=function(T){T+=4,T+=4,T+=4;var B={};return B.pointCount=this._dataView.getInt32(T,!0),T+=4,B.layerId=this._dataView.getInt32(T,!0),T+=4,B.blkId=this._dataView.getInt32(T,!0),T+=4,B.offset=T,B},f.prototype.getDatabaseIndex=function(){return this._dataView.getInt32(8,!0)},f.prototype.getColorIndex=function(){return this._dataView.getInt32(24,!0)},f.prototype.getBufferType=function(){return this._dataView.getInt32(32,!0)},f.prototype.getIsSketchEntity=function(){return this._dataView.getInt32(40,!0)},f.prototype.getLayerId=function(){return this._dataView.getInt32(44,!0)},f.prototype.getBlockId=function(){return this._dataView.getInt32(48,!0)},f.prototype.getVertexBufferSize=function(){return this._dataView.getInt32(12,!0)},f.prototype.getIndexBufferSize=function(){return this._dataView.getInt32(16,!0)},f.prototype.getZeroLayerId=function(){return this._dataView.getInt32(52,!0)},f.prototype.getSelectMark=function(){return this._dataView.getInt32(56,!0)},f.prototype.getMateria=function(){var T=this._dataView.getInt32(36,!0);if(T==0)return"";for(var B=[],N=0;N<T;N++){var u=String.fromCharCode(this._dataView.getUint8(80+N));B.push(u)}return B.join("")},f.prototype.getDrawDataOffset=function(){return this._dataView.getInt32(36,!0)+80},f.prototype.getMesh=function(){var T=this._dataView.getInt32(4,!0),B=this._dataView.getInt32(32,!0)==0,N={},u=this._dataView.getInt32(12,!0),c=this._dataView.getInt32(16,!0);if(u===0||c===0)return N.size=80,N;var m,E=new h.Geometry,U=80;m=B?u/4/8:u/4/2;for(var X=0;X<m;X++){var W=this._dataView.getFloat32(U+0,!0),te=this._dataView.getFloat32(U+4,!0),ne=0;B?(ne=this._dataView.getFloat32(U+8,!0),this._dataView.getFloat32(U+12,!0),this._dataView.getFloat32(U+16,!0),this._dataView.getFloat32(U+20,!0),this._dataView.getFloat32(U+24,!0),this._dataView.getFloat32(U+28,!0),U+=32):U+=8;var ce=new h.Vector3(W,te,ne);E.vertices.push(ce)}var we=c/4;for(X=0;X<we;X+=3){var Ie=this._dataView.getInt32(U,!0);U+=4;var xe=this._dataView.getInt32(U,!0);U+=4;var Be=this._dataView.getInt32(U,!0);U+=4;var q=new h.Face3(Ie,xe,Be);E.faces.push(q)}var ge=this.getIsSketchEntity();return N.size=U,N.geometry=E,N.id=T,N.isSketchEntity=ge,N.nColorIndex=this._dataView.getInt32(24,!0),N},f.prototype.getCurve=function(T){var B,N=this._dataView.getInt32(32,!0),u=this.getIsSketchEntity(),c=N==0,m={};if((B=c?this._dataView.getInt32(20,!0)/4/3:this._dataView.getInt32(20,!0)/4/2)<2)return m;for(var E=new h.Geometry,U=T,X=0;X<B;X++){var W=this._dataView.getFloat32(U,!0);U+=4;var te=this._dataView.getFloat32(U,!0);U+=4;var ne=0;c&&(ne=this._dataView.getFloat32(U,!0),U+=4),E.vertices.push(new h.Vector3(W,te,ne))}var ce=this._dataView.getInt32(4,!0);return m.size=U,m.geometry=E,m.id=ce,m.isSketchEntity=u,m.colorIndex=this._dataView.getInt32(28,!0),m},f);function f(T){this._dataView=T}o.MxNetData=D,(v=a||(o.MxNetMessageType=a={})).kAddLayer="00000007",v.kClearLayer="00000008",v.kHideLayer="00000009",v.kShowLayer="00000010",v.kUpdateDisplayRange="00000011",v.kCallJsReturn="00000012",v.kLayerData="00000013",v.kSendDebugString="00000014",v.kShowLoading="00000015",v.kHideLoading="00000016",v.kSelectObject="00000017",v.kGlRenderHead="00000018",v.kUserLoginResult="00000019",v.kOpenFileResult="00000020",v.kServerReturn="00000021",v.kMxCADLayerData="00000056",v.kMxCADSystemVariable="00000057";var O=(C.prototype.setJsRetCall=function(T,B,N){this.serverJsRetCall.set(B+N,T)},C.prototype.onSocketErrort=function(){this.serverJsRetCall.forEach(function(T){T(void 0)}),this.serverJsRetCall=new Map},C.prototype.Do=function(T){var B=this.net.getCurrentDatabaseId();if(B==-1){var N=T.substring(0,4);B=parseInt(N)}var u=T.substring(4,12),c=T.substring(12);return this.messageCall[u]!=null&&(this.messageCall[u](c,B),!0)},C);function C(T,B){this.messageCall=new Map,this.serverJsRetCall=new Map,this.net=null,this.net=B;var N=this;this.messageCall[a.kUpdateDisplayRange]=function(u){if(!N.net.isTzDwgStaticFile()){u=u.replace(/\\/g,"\\\\");try{var c=JSON.parse(u);if(c!=null&&T.is2D()){T.initCAD2Doc(new h.Matrix4),c.newbrownermode?c.DToSMat?k.MxDrawData.m_isCorrectLargeCoordinates?(T.intiDoc2Wold(new h.Matrix4),T.initCAD2Doc(c.DToSMat)):T.intiDoc2Wold(c.DToSMat):T.intiDoc2Wold(new h.Matrix4):T.intiDoc2Wold(c.DToWMat),T.initializingObjectMatrix(),T.updateCameraDisplayRange(new h.Vector3(+c.pt1[0],+c.pt1[1],+c.pt1[2]),new h.Vector3(+c.pt2[0],+c.pt2[1],+c.pt2[2]),+c.viewangle),T.initAllLayoutName(c.layout),T.updateDisplay(!0);var m=w.MxFun.getUiObj();m!=null&&(m.SetLayoutData(c.layout),m.UpDisplayLayout())}}catch{console.log("UpdateDisplayRange exception")}}},this.messageCall[a.kCallJsReturn]=function(u){if(u.length!=0){var c=JSON.parse(u);c.cmd.length==0&&(c.cmd="__mx_loadcode");var m=c.cmd+c.count,E=N.serverJsRetCall.get(m);E&&(N.serverJsRetCall.delete(m),typeof c.ret=="string"&&(c.ret=c.ret.replace(/\'/g,'"')),E(c.ret))}else console.log("assert(0),kCallJsReturn return empty")},this.messageCall[a.kSendDebugString]=function(u){G.MxManager.outDebugString(u)},this.messageCall[a.kUserLoginResult]=function(u){T.userLoginResult(u)},this.messageCall[a.kOpenFileResult]=function(u){T.openFileResult(u)},this.messageCall[a.kServerReturn]=function(u){T.serverReturn(u)},this.messageCall[a.kShowLoading]=function(u){N.net.isTzDwgStaticFile()||w.MxFun.showLoading()},this.messageCall[a.kHideLoading]=function(u){N.net.isTzDwgStaticFile()||(w.MxFun.hideLoading(),T.callInitCompleteEvent())},this.messageCall[a.kSelectObject]=function(u){var c=JSON.parse(u);G.MxManager.callSelectObject(parseInt(c.id))},this.messageCall[a.kGlRenderHead]=function(u){T.isStaticLocalLoad()?T.getStaticLocalNet().onRenderHead(u):(N.net.isTzDwgStaticFile()?T.getStaticLoadTzNet():T.getStaticNet()).onRenderHead(u)},this.messageCall[a.kMxCADSystemVariable]=function(u,c){T.sysVariable().OnMessageMxCADSystemVariable(u)},this.messageCall[a.kLayerData]=function(u,c){if(c==0){if(T.addLayerInfoComplete(),(X=JSON.parse(u))!=null){if(!X.isSketch){var m=X.list;for(var E in m)T.addLayerInfo(m[E].id,m[E].colorvalue,m[E].name),m[E].zerolayer==1&&T.setZeroLayerId(m[E].id)}X.isSketch||T.callEvent("uiSetLayerData",X.list);var U=w.MxFun.getUiObj();U!=null&&(X.isSketch?U.SetSketchLayerData(X.list):U.SetLayerData(X.list),U.UpDisplayLayer())}}else{var X,W=T.getExtRefManager().getLayers(c);if(W.initComplete(),(X=JSON.parse(u))!=null)for(var E in m=X.list)W.add(m[E].id,m[E].colorvalue,m[E].name),m[E].zerolayer==1&&W.setZeroLayerId(m[E].id)}}}o.MxNetMessage=O;var j,V,R=(M.prototype.setWebSocket=function(T){this._webSocket=T},M.prototype.UndoMark=function(){this._webSocket!=null&&this._webSocket.send(this.SendType.kUndoMark+"")},M.prototype.DoCommand=function(T,B,N){this._webSocket!=null&&(N!=null?(this._callCount++,200<this._callCount&&(this._callCount=1),this._msg.setJsRetCall(N,T,this._callCount),B==null&&(B=""),this._webSocket.send(this.SendType.kCmdEx+","+T+","+this._callCount+","+B)):B==null?this._webSocket.send(this.SendType.kCmd+","+T):this._webSocket.send(this.SendType.kCmd+","+T+","+B))},M.prototype.OpenFile=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kOpenFile+","+T)},M.prototype.UserLogin=function(T,B,N){if(this._webSocket!=null){var u={};u.IdentitySign=T,u.RandomToken=B??"",u.Init=N??"",this._webSocket.send(this.SendType.kUserLogin+","+JSON.stringify(u))}},M.prototype.Init=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kInit+","+T)},M.prototype.CallServerJS=function(T,B,N){this._webSocket!=null&&(N==null?B==null||B==null||B.length==0?this._webSocket.send(this.SendType.kCallJS+',{"command":"'+T+'","param":"{}"}'):this._webSocket.send(this.SendType.kCallJS+',{"command":"'+T+'","param":'+B+"}"):(this._callCount++,200<this._callCount&&(this._callCount=1),this._msg.setJsRetCall(N,T,this._callCount),B==null||B==null||B.length==0?this._webSocket.send(this.SendType.kCallJS+',{"command":"'+T+'","param":"{}","count":"'+this._callCount+'"}'):this._webSocket.send(this.SendType.kCallJS+',{"command":"'+T+'","param":'+B+',"count":"'+this._callCount+'"}')))},M.prototype.CallLoadCodeToServer=function(T,B){this._webSocket!=null&&(this._msg.setJsRetCall(B,"__mx_loadcode",0),T!=null&&T!=null&&T.length!=0&&this._webSocket.send(this.SendType.kCallJS+","+T))},M.prototype.DeleteObject=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kDelete+","+T)},M.prototype.SelectObject=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kSelect+","+T)},M.prototype.QuitSelectObject=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kQuitSelect+","+T)},M.prototype.SendDragDrawEntity=function(T){this._webSocket!=null&&this._webSocket.send(this.SendType.kAddDragDraw+","+T)},M.prototype.SendDragDrawRequest=function(){this._webSocket!=null&&(this.SendMousePickRay(),this._webSocket.send(this.SendType.kRequestDragDraw))},M.prototype.SendDragDrawDetermine=function(){this._webSocket!=null&&(this.SendMousePickRay(),this._webSocket.send(this.SendType.kDetermineDragDraw))},M.prototype.SendDragDrawCancel=function(){this._webSocket!=null&&this._webSocket.send(this.SendType.kCancelDragDraw)},M.prototype.SendMousePickRay=function(){this._webSocket},M);function M(T,B){this.SendType={},this._callCount=1,this._webSocket=T,this._msg=B,this.SendType.kCmd=0,this.SendType.kDelete=1,this.SendType.kSelect=2,this.SendType.kOpenFile=3,this.SendType.kGetDemoList=4,this.SendType.kCallJS=5,this.SendType.kAddDragDraw=6,this.SendType.kRequestDragDraw=7,this.SendType.kMousePickRay=8,this.SendType.kDetermineDragDraw=9,this.SendType.kCancelDragDraw=10,this.SendType.kQuitSelect=11,this.SendType.kInit=12,this.SendType.kCmdEx=13,this.SendType.kUserLogin=14,this.SendType.kUndoMark=15}o.MxNetSend=R,(V=j||(o.MxNetBinMessageType=j={})).eBlockRef=10,V.eEntitysData=14,V.eAddEntityFor2dPointTextureBuffers=15,V.eMxNewMemorySections=16,V.kMxCADBlockRef=56,V.kMxCADMemorySections=57,V.kMxCADMemorySectionsFromChange=59,V.kMxCADNotUseMemorySectionsForChage=61,V.kMxCADEntityDisplayDatas=62;var ee=(F.prototype.setCurrentDatabaseId=function(T){this._iCurrentDatabaseId=T},F.prototype.getMxDrawObject=function(){return this._mx},F.prototype.getCurrentDatabaseId=function(){return this._iCurrentDatabaseId},F.prototype.isTzDwgStaticFile=function(){return this._iCurrentDatabaseId!=-1},F.prototype.onBinMessage=function(T){var B=this._mx,N=L.inflate(T),u=new DataView(N.buffer),c=u.getInt32(0,!0);this._binMessageCall.has(c)?this._binMessageCall.get(c)(u,this._iCurrentDatabaseId):(this._iCurrentDatabaseId==-1&&(c==0?B.mxWebAddEntity(u):c==6?B.removeEntityFromServer(u):c==11&&B.getExtRefManager().createExternalReferences(u)),c==12?B.mxWebAddEntityFor2dPointCurveBuffers(u,this._iCurrentDatabaseId):c==13?B.mxWebAddEntityFor2dPointMeshBuffers(u,this._iCurrentDatabaseId):c==8?B.mxWebAddEntityFor2dPointCurveBuffer(u,this._iCurrentDatabaseId):c==9?B.mxWebAddEntityFor2dPointMeshBuffer(u,this._iCurrentDatabaseId):c==j.eBlockRef&&B.mxWebCreateAllBlocks(u,this._iCurrentDatabaseId))},F.prototype.socket_onErrort=function(){this._msg.onSocketErrort()},F.prototype.socket_onMessageImp=function(T,B){if(B===void 0&&(B=!1),typeof T=="string")this._msg.Do(T);else if(B)this.onBinMessage(T);else{var N=new FileReader;N.readAsArrayBuffer(T);var u=this;N.onload=function(c){u._mx.updateDisplay(),u.onBinMessage(N.result)}}this._mx.updateDisplay()},F.prototype.initBinMessage=function(){var T=this._mx;this._binMessageCall.set(j.eEntitysData,function(B,N){T.mxWebEntitysData(B,N)}),this._binMessageCall.set(j.eAddEntityFor2dPointTextureBuffers,function(B,N){T.mxWebAddEntityFor2dPointTextureBuffers(B,N)}),this._binMessageCall.set(j.eMxNewMemorySections,function(B,N){T.mxWebAddEntityForMemorySections(B,N)})},F.prototype.init=function(T,B){var N=this;this._mx=T,this._msg=new O(T,this),this.initBinMessage(),B&&(this._webSocket=new WebSocket(w.MxFun.getMxServer()),this._webSocket.onopen=function(){var u=N._mx.getIniParam();if(u.length!=0){for(var c="{",m=u.length,E=0;E<m;E++)c=E==0?c+'"'+u[E][0]+'":"'+u[E][1]+'"':c+',"'+u[E][0]+'":"'+u[E][1]+'"';c+="}",N._send.Init(c)}},this._webSocket.onmessage=function(u){N.socket_onMessageImp(u.data)},this._webSocket.onerror=function(){console.log("mx: socket error"),N.socket_onErrort()}),this._send=new R(this._webSocket,this._msg)},F.prototype.closeWebSocket=function(){this._webSocket&&(this._send.setWebSocket(null),this._webSocket.close(),this._webSocket=null)},F.prototype.getOnMessage=function(){return this._msg},F.prototype.getSend=function(){return this._send},F.prototype.onStaticMessage=function(T){try{return this.socket_onMessageImp(T,!0),!0}catch(B){return console.log("mx file data error!"),console.log(B),!1}},F.prototype.onStaticHeadMessage=function(T){return typeof T=="string"&&this._msg.Do(T)},F);function F(){this._webSocket=null,this._send=null,this._msg=null,this._mx=null,this._binMessageCall=new Map,this._iCurrentDatabaseId=-1}o.MxNet=ee;var _=(J.prototype.stopAllLoading=function(){this._isStopLoading||(this._isStopLoading=!0,this._isShowLoading&&w.MxFun.hideLoading())},J.prototype.setShowloading=function(T){this._isShowLoading=T},J.prototype.showLoading=function(){this._isShowLoading&&w.MxFun.showLoading()},J.prototype.hideLoading=function(T){this._isStopLoading||(this._isShowLoading&&w.MxFun.hideLoading(),this.net.getMxDrawObject().callInitCompleteEvent(),this.net.getMxDrawObject().callOpenFileComplete(T))},J.prototype.setRequestHeader=function(T){this._requestHeader=T},J.prototype.setUrlParam=function(T){this._urlParam=T},J.prototype.load=function(T,B){var N=w.MxFun.curPath(),u=w.MxFun.dwgDir(),c=w.MxFun.getStaticServer(),m="/buf/";if(T.substring(T.lastIndexOf(".")+1).toLowerCase()=="wgh"){m="/";var E=T.substring(0,T.indexOf(".mxb1.wgh")).split("/");(T=E.length==1?E[0]:(c=T.substring(0,T.lastIndexOf("/")),E[E.length-1]))[0]=="$"&&(T=T.substring(1))}var U="$"+(T=encodeURIComponent(T))+".mxb1.wgh";c.length!=0?N=c+m:u.length!=0?N=N+"/"+u+m:N+=m,this._path=N,this._filename=T,1<(this._staticLoadingOpenFiles=B).length&&(U=B[0],this._path=void 0);var X=this;this.getFile(this._path,U,function(W){if(!X._isStopLoading)return typeof W!="string"?(console.log("mx error h1"),void X.hideLoading(4)):X.net.onStaticHeadMessage(W)?void 0:(console.log("mx error h1:"+W),void X.hideLoading(2))},function(){X.hideLoading(3),console.log("mx get "+U+" faild")})},J.prototype.getData=function(){if(this._isStopLoading)this.hideLoading(5);else if(this._iGet>=this._dataNum)this.hideLoading(0);else{var T=this._dataType[this._iGet];this._iGet++;var B=this,N=this._iGet+1,u="$"+this._filename+".mxb"+N+".wgh";if(1<this._staticLoadingOpenFiles.length){if(this._iGet>=this._staticLoadingOpenFiles.length)return console.log("Mx staticLoadingOpenFiles error!"),void this.hideLoading(7);u=this._staticLoadingOpenFiles[this._iGet]}var c=u;this._path&&(c=this._path+u);var m=c.substring(0,c.lastIndexOf("/")+1);if(this.net.getMxDrawObject().setCurrentLoadUrl(m),T==0)this.getFile(this._path,u,function(X){B._isStopLoading||(B.net.onStaticMessage(X)||(console.log(this._path),console.log(u)),B.getData())},function(){B._dataNum=0,B._iGet=0,B.hideLoading(8),console.log("mx get "+u+" faild")});else{var E=new XMLHttpRequest,U=u;this._path&&(U=this._path+u),this._urlParam.length!=0?E.open("GET",U+this._urlParam):E.open("GET",U),k.MxDrawData.m_isRequestHeaderCacheControl&&E.setRequestHeader("Cache-Control","max-age=7200"),this._requestHeader.length!=0&&E.setRequestHeader("usertoken",this._requestHeader),E.responseType="arraybuffer",E.onload=function(){B._isStopLoading||(B.net.onStaticMessage(E.response)||console.log(U),B.getData())},E.addEventListener("error",function(X){B._dataNum=0,B._iGet=0,B.hideLoading(9),console.log("mx get "+u+" faild")},!1),E.send()}}},J.prototype.onRenderHead=function(T){if(!this._isStopLoading){var B=JSON.parse(T);this._dataType=B.type,this._dataNum=B.count,this._iGet=0,this.showLoading(),this.getData()}},J.prototype.getFile=function(T,B,N,u){var c=new h.FileLoader(this.manager);c.setPath(T);var m=B;this._urlParam.length!=0&&(m=B+this._urlParam),this._requestHeader.length!=0&&(c.requestHeader={usertoken:this._requestHeader}),c.load(m,N,function(){},u)},J);function J(T,B){this.net=null,this.manager=null,this._dataNum=0,this._iGet=0,this._dataType=[],this._path="",this._filename="",this._staticLoadingOpenFiles=[],this._isShowLoading=!0,this._requestHeader="",this._isStopLoading=!1,this._urlParam="",this.net=T,this.manager=B!==void 0?B:h.DefaultLoadingManager}o.MxHFileLoad=_},{"./MxDrawData":22,"./MxFun":27,"./MxManager":29,pako:1,three:19}],32:[function(b,r,o){var a,v;Object.defineProperty(o,"__esModule",{value:!0}),o.MxShader=void 0,(v=a||(o.MxShader=a={})).VSHADER_COLOR_POINT=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
attribute vec2 position; 
attribute vec3 color; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.VSHADER_COLOR_POINT_BYLAYER=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
uniform vec3 color; 
attribute vec2 position; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.FSHADER_COLOR_POINT=` precision highp float; 
varying vec4 vColor; 
void main() { 
gl_FragColor = vColor; 
} 
`,v.VSHADER_COLOR_POINT_TEXTURE=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
attribute vec2 position; 
attribute vec2 uv; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
varying vec2 vUv; 
void main(){ 
vUv = uv; 
mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.FSHADER_COLOR_POINT_TEXTURE=` precision highp float; 
varying vec2 vUv; 
uniform sampler2D texture; 
void main() { 
gl_FragColor = texture2D( texture, vUv ); 
} 
`,v.VSHADER_COLOR_POINT_CLIP=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
uniform vec2 clippt1; 
uniform vec2 clippt2; 
uniform float vieww; 
uniform float viewh; 
attribute vec2 position; 
attribute vec3 color; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
varying vec2 vCp1; 
varying vec2 vCp2; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
vec4 pt1 = projectionMatrix * modelViewMatrix * vec4( clippt1.x,clippt1.y,0.0, 1.0 ); 
vec4 pt2 = projectionMatrix * modelViewMatrix * vec4( clippt2.x,clippt2.y,0.0, 1.0 ); 
vCp1 = vec2(pt1.x * vieww + vieww,pt1.y * viewh + viewh); 
vCp2 = vec2(pt2.x * vieww + vieww,pt2.y * viewh + viewh); 
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.VSHADER_COLOR_POINT_BYLAYER_CLIP=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
uniform vec3 color; 
uniform vec2 clippt1; 
uniform vec2 clippt2; 
uniform float vieww; 
uniform float viewh; 
attribute vec2 position; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
varying vec2 vCp1; 
varying vec2 vCp2; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
vec4 pt1 = projectionMatrix * modelViewMatrix * vec4( clippt1.x,clippt1.y,0.0, 1.0 ); 
vec4 pt2 = projectionMatrix * modelViewMatrix * vec4( clippt2.x,clippt2.y,0.0, 1.0 ); 
vCp1 = vec2(pt1.x * vieww + vieww,pt1.y * viewh + viewh); 
vCp2 = vec2(pt2.x * vieww + vieww,pt2.y * viewh + viewh); 
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.FSHADER_COLOR_POINT_CLIP=`precision highp float; 
varying vec4 vColor; 
varying vec2 vCp1; 
varying vec2 vCp2; 
void main() { 
if(gl_FragCoord.x > vCp1.x && gl_FragCoord.x < vCp2.x && gl_FragCoord.y > vCp1.y && gl_FragCoord.y < vCp2.y) 
gl_FragColor = vColor; 
else 
discard; 
} 
`,v.VSHADER_COLOR_POINT_FORMXCAD=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
uniform vec3 color; 
attribute vec2 position; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
gl_PointSize = 1.0;
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.FSHADER_COLOR_POINT_FORMXCAD=` precision highp float; 
varying vec4 vColor; 
void main() { 
gl_FragColor = vColor; 
} 
`,v.VSHADER_COLOR_POINT_CLIP_FORMXCAD=` precision highp float; 
uniform mat4 modelViewMatrix; 
uniform mat4 projectionMatrix; 
uniform vec3 color; 
uniform vec2 clippt1; 
uniform vec2 clippt2; 
uniform float vieww; 
uniform float viewh; 
attribute vec2 position; 
attribute vec4 tran1; 
attribute vec4 tran2; 
attribute vec4 tran3; 
attribute vec4 tran4; 
attribute float ishide; 
varying vec4 vColor; 
varying vec2 vCp1; 
varying vec2 vCp2; 
void main(){ 
 mat4 tran; 
tran[0][0] = tran1.x;tran[0][1] = tran1.y;tran[0][2] = tran1.z;tran[0][3] = tran1.w; 
tran[1][0] = tran2.x;tran[1][1] = tran2.y;tran[1][2] = tran2.z;tran[1][3] = tran2.w; 
tran[2][0] = tran3.x;tran[2][1] = tran3.y;tran[2][2] = tran3.z;tran[2][3] = tran3.w; 
tran[3][0] = tran4.x;tran[3][1] = tran4.y;tran[3][2] = tran4.z;tran[3][3] = tran4.w; 
vec4 pt1 = projectionMatrix * modelViewMatrix * vec4( clippt1.x,clippt1.y,0.0, 1.0 ); 
vec4 pt2 = projectionMatrix * modelViewMatrix * vec4( clippt2.x,clippt2.y,0.0, 1.0 ); 
vCp1 = vec2(pt1.x * vieww + vieww,pt1.y * viewh + viewh); 
vCp2 = vec2(pt2.x * vieww + vieww,pt2.y * viewh + viewh); 
if(ishide > 0.1) 
   vColor = vec4(color,0.0); 
else 
   vColor = vec4(color,1.0); 
gl_Position = projectionMatrix * modelViewMatrix * tran *  vec4( position.x,position.y,0.0, 1.0 ); 
} 
`,v.FSHADER_COLOR_POINT_CLIP_FORMXCAD=`precision highp float; 
varying vec4 vColor; 
varying vec2 vCp1; 
varying vec2 vCp2; 
void main() { 
if(gl_FragCoord.x > vCp1.x && gl_FragCoord.x < vCp2.x && gl_FragCoord.y > vCp1.y && gl_FragCoord.y < vCp2.y) 
gl_FragColor = vColor; 
else 
discard; 
} 
`},{}],33:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxStencilObject=void 0;var a=b("three"),v=b("./MxMaterial"),h=(w.prototype.object_onAfterRender=function(L){var G=this.aryMeshStencil;if(G&&0<G.length){L.getContext();var k=L.state.buffers;k.stencil.setLocked(!1),k.depth.setTest(!0),k.stencil.setTest(!1)}},w.prototype.object_onBeforeRender=function(L,G,k){var D=this.aryMeshStencil;if(D&&0<D.length){var f=L.getContext(),O=L.state.buffers;O.color.setMask(!1),O.color.setLocked(!0),O.depth.setTest(!1),O.stencil.setTest(!0),O.stencil.setMask(255),O.stencil.setClear(0),L.clearStencil(),O.stencil.setLocked(!0);var C=1,j=!0;D.forEach(function(V){j?(j=!1,O.stencil.setFunc(f.ALWAYS,C,255),O.stencil.setOp(f.KEEP,f.KEEP,f.REPLACE)):(O.stencil.setFunc(f.EQUAL,C,255),O.stencil.setOp(f.KEEP,f.KEEP,f.INCR),C++),L.mxRenderObject(V,G,k,V.material,null)}),O.color.setLocked(!1),O.color.setMask(!0),O.stencil.setMask(0),O.stencil.setFunc(f.EQUAL,C,255)}},w.prototype.associateObject=function(L,G){var k=this;G.forEach(function(f){if(3<=f.length){var O=new a.Shape(f),C=new a.ShapeGeometry(O),j=new a.Mesh(C,v.MxMaterial.getStencilMaterial());k.aryMeshStencil.push(j)}});var D=this;L.onBeforeRender=function(f,O,C){D.object_onBeforeRender(f,O,C)},L.onAfterRender=function(f){D.object_onAfterRender(f)}},w);function w(){this.aryMeshStencil=[]}o.MxStencilObject=h},{"./MxMaterial":30,three:19}],34:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxString=void 0;var a=(v.prototype.Find=function(h){return this.m_val.indexOf(h)},v.prototype.Left=function(h){return this.m_val.substring(0,h)},v.prototype.Right=function(h){return this.m_val.substring(this.m_val.length-h,this.m_val.length)},v.prototype.TrimLeft=function(h){for(;0<this.m_val.length&&this.m_val[0]==h;)this.m_val=this.m_val.slice(1)},v.prototype.TrimRight=function(h){for(;0<this.m_val.length&&this.m_val[this.m_val.length-1]==h;)this.m_val=this.m_val.slice(0,-1)},v.prototype.AnalyzeString=function(h){return this.m_val.split(h)},v.prototype.IsEmpty=function(){return this.m_val.length==0},v.prototype.MakeUpper=function(){this.m_val=this.m_val.toUpperCase()},v.prototype.MakeLower=function(){this.m_val=this.m_val.toLowerCase()},v.prototype.GetLength=function(){return this.m_val.length},v);function v(h){this.m_val="",h!=null&&(this.m_val=h)}o.MxString=a},{}],35:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxSystemVariable=void 0;var a=b("three"),v=b("./Operate/McEdJigOsnap"),h=(w.prototype.init=function(L){this.m_mxObj=L},w.prototype.getAllLinetypeName=function(){return this.m_vecLinetype},w.prototype.getSysVarBool=function(L){return this.m_data[L]!=null&&this.m_data[L]},w.prototype.setSysVarBool=function(L,G){this.m_data[L]=G},w.prototype.setSysVarPoint=function(L,G){this.m_data[L]=G},w.prototype.OnMessageMxCADSystemVariable=function(L){this.m_vecLinetype=[];var G=JSON.parse(L);if(G!=null){var k=G.vecLinetypeName;for(var D in k)this.m_vecLinetype.push(k[D]);this.m_data.CELTYPE=G.curLinetypeName,this.m_data.CLAYER=G.clayer,this.m_data.CECOLOR=G.cecolor,this.m_data.CECOLORINDEX=G.cecolorindex}this.m_mxObj.callEvent("loadSystmeVariableComplete")},w.prototype.getSysVarPoint=function(L){return this.m_data[L]==null?new a.Vector3(0,0,0):this.m_data[L]},w.prototype.setSysVarNumber=function(L,G){this.m_data[L]=G},w.prototype.getSysVarNumber=function(L){return this.m_data[L]==null?0:this.m_data[L]},w.prototype.getSysVar=function(L){return this.m_data[L]},w.prototype.setSysVar=function(L,G){this.m_data[L]=G},w);function w(){this.m_data={},this.m_mxObj=null,this.m_vecLinetype=[],this.m_data.GETPOINTSTATUS=0,this.m_data.LASTPOINT=void 0,this.m_data.LASTMOVEPOINT=void 0,this.m_data.CELTYPE="Continuous",this.m_data.CLAYER="0",this.m_data.CECOLOR=67108863,this.m_data.CECOLORINDEX=7,this.m_data.OSMODE=v.MxOsnapDefine.OsModeAll}o.MxSystemVariable=h},{"./Operate/McEdJigOsnap":43,three:19}],36:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxTempMarkDraw=void 0;var a=b("three"),v=b("./MxFun"),h=b("./MxThreeJS"),w=(L.prototype.init=function(G){this.threeObjectGroup=new a.Object3D,G.addObject(this.threeObjectGroup)},L.prototype.clear=function(G){G||v.MxFun.removeThreejsAllChildren(this.threeObjectGroup)},L.prototype.drawLine=function(G,k,D,f){D===void 0&&(D=16777215),f===void 0&&(f=1),this.threeObjectGroup.add(h.MxThreeJS.createLine(G,k,D,f))},L.prototype.drawCircle=function(G,k,D){this.threeObjectGroup.add(h.MxThreeJS.createCircle(G,k,D))},L.prototype.drawEntity=function(G){this.threeObjectGroup.add(G)},L.prototype.drawCircleMark=function(G,k,D){this.drawCircle(G,k,D);var f=new a.Vector3(.3*k,0,0);f.applyAxisAngle(new a.Vector3(0,0,1),60*Math.PI/180);var O=new a.Vector3(.3*k,0,0);O.applyAxisAngle(new a.Vector3(0,0,1),30*Math.PI/180);var C=new a.Vector3(k,0,0);C.applyAxisAngle(new a.Vector3(0,0,1),45*Math.PI/180);var j=G.clone().add(f),V=G.clone().add(O),R=G.clone().add(C);this.drawLine(G,j,D),this.drawLine(G,V,D),this.drawLine(G,R,D)},L);function L(){this.threeObjectGroup=null}o.MxTempMarkDraw=w},{"./MxFun":27,"./MxThreeJS":37,three:19}],37:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxThreeJS=void 0;var a,v,h=b("three"),w=b("./MxFun");function L(G){return Math.pow(2,Math.floor(Math.log(G)/Math.LN2))}(v=a||(o.MxThreeJS=a={})).createLine=function(G,k,D,f){var O,C=new h.Geometry;return O=f&&f!=1||f==0?new h.LineBasicMaterial({color:D,transparent:!0,depthTest:!1,opacity:f}):new h.LineBasicMaterial({color:D,transparent:!0,depthTest:!1}),C.vertices.push(G,k),new h.Line(C,O)},v.createSolid=function(G,k,D){if(G.length<3)return null;var f,O=new h.Shape(G.map(function(j){var V=j.x,R=j.y;return new h.Vector2(V,R)})),C=new h.ShapeGeometry(O);return f=D&&D!=1||D==0?new h.MeshPhongMaterial({color:k,side:h.DoubleSide,transparent:!0,depthTest:!1,opacity:D}):new h.MeshPhongMaterial({color:k,side:h.DoubleSide,transparent:!0,depthTest:!1}),new h.Mesh(C,f)},v.createPoint=function(G,k,D){D===void 0&&(D=3);var f=new h.Geometry;f.vertices.push(G);var O=new h.PointsMaterial({color:k,size:D});return new h.Points(f,O)},v.createDashedLine=function(G,k,D,f,O){var C=new h.Geometry;C.vertices.push(G,k);var j=new h.Line(C,new h.LineDashedMaterial({color:D,dashSize:f,gapSize:O,transparent:!0,depthTest:!1}));return j.computeLineDistances(),j},v.createCircle=function(G,k,D){var f=new h.CircleGeometry(k,64,3,2*Math.PI),O=new h.LineBasicMaterial({color:D,transparent:!0,depthTest:!1});f.vertices.shift();var C=new h.LineLoop(f,O);return C.position.x=G.x,C.position.y=G.y,C.position.z=G.z,C},v.createSolidCircle=function(G,k,D){var f=new h.MeshBasicMaterial({color:D,transparent:!0,depthTest:!1}),O=new h.CircleGeometry(k,64,3,2*Math.PI),C=new h.Mesh(O,f);return C.position.x=G.x,C.position.y=G.y,C.position.z=G.z,C},v.clacTextSize=function(G,k){var D=document.createElement("canvas").getContext("2d");if(D==null)return k;var f=w.MxFun.formatString("normal {0}px Arial","256");return D.font=f,D.measureText(G).width*k/256},v.clacTextSpriteSize=function(G,k,D){k<=1e-8&&(k=1);var f=document.createElement("canvas"),O=f.getContext("2d"),C=w.MxFun.formatString("normal {0}px Arial","256");O.font=C;var j=k/256,V=0,R=[],M=!0,ee=0;if(D){V=D;for(var F=0,_=0,J=0;_<G.length;_++)(T=O.measureText(G.substring(F,_+1))).width*j>V&&(ee+=(T.fontBoundingBoxAscent+T.fontBoundingBoxDescent)*j,R.push(G.substring(F,_)),F=_,J++);if(F<_){var T=O.measureText(G.substring(F,_));R.push(G.substring(F,_)),ee+=(T.fontBoundingBoxAscent+T.fontBoundingBoxDescent)*j,J++}M=J<=1}else ee=k,V=(T=O.measureText(G)).width*j,R.push(G),M=!1;var B=ee/V*(f.width=1024);return f.height=L(B),f.height<B&&(f.height*=2),f.height==0&&(f.height=512),{spritewidth:V,spriteheight:V*f.height/f.width,textwidth:V,allTextHeight:ee,singleline:M}},v.creatTextSprite=function(G,k,D,f,O,C,j){D<=1e-8&&(D=1);var V=document.createElement("canvas"),R=V.getContext("2d");j?(R.font=j(256),R.font.length==0&&(R.font=w.MxFun.formatString("normal {0}px Arial","256"))):R.font=w.MxFun.formatString("normal {0}px Arial","256");var M=D/256,ee=0,F=[],_=[],J=0;if(C){ee=C;for(var T=0,B=0;B<G.length;B++)(u=R.measureText(G.substring(T,B+1))).width*M>ee&&(J+=N=(u.fontBoundingBoxAscent+u.fontBoundingBoxDescent)*M,F.push(G.substring(T,B)),_.push(N),T=B);if(T<B){var N,u=R.measureText(G.substring(T,B));F.push(G.substring(T,B)),J+=N=(u.fontBoundingBoxAscent+u.fontBoundingBoxDescent)*M,_.push(N)}}else J=D,ee=(u=R.measureText(G)).width*M,F.push(G),_.push(J);var c=J/ee*(V.width=1024);V.height=L(c),V.height<c&&(V.height*=2),V.height==0&&(V.height=512);var m=1024/ee,E=m*D;j?(R.font=j(E),R.font.length==0&&(R.font=w.MxFun.formatString("normal {0}px Arial",""+E))):R.font=w.MxFun.formatString("normal {0}px Arial",""+E);var U=w.MxFun.formatString("rgba({0}, {1}, {2}, 1.0)",(O>>16&255)+"",(O>>8&255)+"",(255&O)+"");R.fillStyle=U,R.textAlign="left",R.textBaseline="bottom";for(var X=0,W=0;X<F.length;X++)W+=m*_[X];for(X=0,W=.5*(V.height-W);X<F.length;X++)W+=m*_[X],R.fillText(F[X],0,W);var te=new h.Texture(V);te.needsUpdate=!0;var ne=new h.SpriteMaterial({transparent:!0,depthTest:!1,map:te});ne.rotation=f;var ce=new h.Sprite(ne);return ce.scale.set(ee,ee/V.width*V.height,1),ce.position.set(k.x,k.y,k.z),ce},v.createTriangle=function(G,k,D){if(!(G.length<3)){for(var f=G.length,O=new h.Geometry,C=0;C+2<f;C+=3){O.vertices.push(G[C]),O.vertices.push(G[C+1]),O.vertices.push(G[C+2]);var j=new h.Face3(C,C+1,C+2);O.faces.push(j)}O.computeFaceNormals(),O.computeVertexNormals(),D==null&&(D=1);var V=new h.MeshBasicMaterial({color:k,transparent:!0,depthTest:!1,side:h.DoubleSide,opacity:D});return new h.Mesh(O,V)}},v.createLines=function(G,k,D){var f,O=new h.Geometry;return O.vertices=G,f=D&&D!=1||D==0?new h.LineBasicMaterial({color:k,transparent:!0,depthTest:!1,opacity:D}):new h.LineBasicMaterial({color:k,transparent:!0,depthTest:!1}),new h.Line(O,f)},v.createDashedArc=function(G,k,D,f,O,C,j){var V=new h.CircleGeometry(k,64,D,f),R=new h.LineDashedMaterial({color:O,dashSize:C,gapSize:j,transparent:!0,depthTest:!1});V.vertices.shift();var M=new h.Line(V,R);return M.position.x=G.x,M.position.y=G.y,M.position.z=G.z,M},v.createDashedLines=function(G,k,D,f){var O=new h.Geometry;return O.vertices=G,new h.Line(O,new h.LineDashedMaterial({color:k,dashSize:D,gapSize:f,transparent:!0,depthTest:!1}))}},{"./MxFun":27,three:19}],38:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxPair=o.MxTools=void 0;var a,v,h=b("three");(v=a||(o.MxTools=a={})).AsMxWebPoint=function(w,L,G){return new h.Vector3(-w,G,L)},v.AsMxWebPoint_pt=function(w){return new h.Vector3(-w.x,w.z,w.y)},v.AsThreeJsPoint=function(w,L,G){return new h.Vector3(-w,G,L)},v.stringTrimLeftSpace=function(w){return w.replace(/^\s*/g,"")},v.stringDeleteAllSpace=function(w){return w.replace(/\s*/g,"")},v.stringTrimLeftRightSpace=function(w){return w.replace(/^\s*|\s*$/g,"")},v.stringTrimRightSpace=function(w){return w.replace(/(\s*$)/g,"")},v.IsNumerical=function(w){if(typeof w=="string"){var L=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return!(!/^\d+(\.\d+)?$/.test(w)&&!L.test(w))}var G=w.m_val;return L=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/,!(!/^\d+(\.\d+)?$/.test(G)&&!L.test(G))},v.formatString=function(w){for(var L=[],G=1;G<arguments.length;G++)L[G-1]=arguments[G];for(var k=0;k<L.length;k++)w=w.replace("{".concat(k,"}"),L[k]);return w},v._tstof=function(w){return parseFloat(w)},v._tstoi=function(w){return parseInt(w)},v.IsZero=function(w){return-1e-7<w&&w<1e-7},v.MillimeterToPixels=function(w){return 10*w},v.getXYPlanDistance=function(w,L){var G=new h.Vector2(w.x,w.y),k=new h.Vector2(L.x,L.y);return G.distanceTo(k)},v.MxASSERT=function(w,L){w||console.log("MxASSERT(0):"+L)},v.generateUUID=function(){return h.MathUtils.generateUUID()},v.MxMax=function(w,L){return L<w?w:L},v.getOpacity=function(w){var L=(4278190080&w)>>24&255;return L<=0&&(L=255),L/255},v.getColor=function(w){return 16777215&w},o.MxPair=function(w,L){this.first=w,this.second=L}},{three:19}],39:[function(b,r,o){var a,v,h,w;Object.defineProperty(o,"__esModule",{value:!0}),o.MxType=void 0,(h=(v=a||(o.MxType=a={})).MxCommandFlag||(v.MxCommandFlag={}))[h.MCRX_CMD_MODAL=0]="MCRX_CMD_MODAL",h[h.MCRX_CMD_TRANSPARENT=1]="MCRX_CMD_TRANSPARENT",h[h.MCRX_CMD_NO_UNDO_MARKER=2]="MCRX_CMD_NO_UNDO_MARKER",h[h.MCRX_CMD_NOPRV=4]="MCRX_CMD_NOPRV",h[h.MCRX_CMD_NO_RECORD_PRVCMD=8]="MCRX_CMD_NO_RECORD_PRVCMD",h[h.MCRX_CMD_NO_CLEAR_SELECT=16]="MCRX_CMD_NO_CLEAR_SELECT",(w=v.MxCloneType||(v.MxCloneType={}))[w.kClone=1]="kClone",w[w.kDragClone=2]="kDragClone",w[w.kMxFileClone=3]="kMxFileClone",w[w.kSaveDwgClone=4]="kSaveDwgClone"},{}],40:[function(b,r,o){var a;Object.defineProperty(o,"__esModule",{value:!0}),o.MxBulid=void 0,window.MxDrawVersion="1.0(2024-08-14 10:55)",(a||(o.MxBulid=a={})).getVersion=function(){return window.MxDrawVersion?window.MxDrawVersion:"inalid version"}},{}],41:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxWindowsEvent=void 0;var a,v,h,w,L=b("./MxFun"),G=b("./Operate/MxJigCmdManager"),k=b("./MxDrawData"),D=b("./UI/MxUiVue");function f(M,ee){for(var F=0,_=w.length;F<_;F++){var J=w[F](M,ee);if(J!=0)return J}}function O(M){f("mousemove",M)}function C(M){f("mouseup",M)}function j(M){f("dblclick",M)}function V(M){f("mousedown",M)}function R(M){var ee=M||window.event||arguments.callee.caller.arguments[0];if(ee&&ee.keyCode==27){var F=L.MxFun.getCurrentMx();if(F.isPaningCommand())return void F.endPanCommand();if(G.MxJigCmdManager.isRunning()){if(G.MxJigCmdManager.getCurCmd().getDynImput().onKeyEcsDown()!=0)return;G.MxJigCmdManager.stopCmd(G.MxJigCmdManager.DetailedResult.kEcsIn)}else{var _=!1;if(k.MxDrawData.m_isEnableIntelliSelect){var J=!1;F.getMxDatabase().getGripManager().removeAllGrips()&&(J=!0),F.getMxDatabase().getSelectManager().removeAllEntity()&&(J=!0),F.isValidMcObject()&&F.getMcObject().getGripManager().clearAll()&&(J=!0),J&&(F.updateDisplay(),F.getMxDatabase().getGripManager().fireMxEntitySelectChange(),_=!0)}_||D.MxUiVue.acutPrintf(` *取消*
命令:`)}}}v=a||(o.MxWindowsEvent=a={}),h=!1,w=new Array,v.addEvent=function(M){w.push(M)},v.registEvent=function(){h||(h=!0,L.MxFun.isPC()&&(document.addEventListener("mousemove",O,!1),document.addEventListener("mouseup",C,!1),document.addEventListener("mousedown",V,!1),document.addEventListener("dblclick",j,!1),document.onkeydown=R))}},{"./MxDrawData":22,"./MxFun":27,"./Operate/MxJigCmdManager":54,"./UI/MxUiVue":65}],42:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.McEdJigDynamicTrace=void 0;var a=b("three"),v=b("./MxJigCmdManager"),h=b("../MxFun"),w=b("../MxDrawData"),L=b("../MxTools"),G=b("../MxManager"),k=b("../MxThreeJS"),D=b("./McEdJigOsnap"),f=(O.prototype.IsEqual=function(M){return this.m_snapObjectId==M.m_snapObjectId&&this.m_pt.distanceTo(M.m_pt)<1e-6},O.prototype.drawLine=function(M,ee,F){var _=k.MxThreeJS.createLine(new a.Vector3(M.x,M.y,M.z),new a.Vector3(ee.x,ee.y,ee.z),this.m_iColor);F.add(_),this.m_aryDynDrawObject.push(_)},O.prototype.clearDraw=function(M){for(var ee=this.m_aryDynDrawObject.length,F=0;F<ee;F++)h.MxFun.removeThreejsObject(this.m_aryDynDrawObject[F],M);this.m_aryDynDrawObject=[]},O.prototype.draw=function(M,ee){var F=M.toSmallcoord(this.m_pt),_=new a.Vector3(F.x,F.y+this.m_iGripWidth,0),J=new a.Vector3(F.x,F.y-this.m_iGripWidth,0);this.drawLine(_,J,ee);var T=new a.Vector3(F.x+this.m_iGripWidth,F.y,0),B=new a.Vector3(F.x-this.m_iGripWidth,F.y,0);this.drawLine(T,B,ee)},O);function O(){this.m_snapObjectId=0,this.m_pt=new a.Vector3,this.m_osmode=0,this.m_iColor=16760703,this.m_iGripWidth=10,this.m_aryDynDrawObject=new Array}var C=(j.prototype.clearDraw=function(M){for(var ee=this.m_aryDynDrawObject.length,F=0;F<ee;F++)h.MxFun.removeThreejsObject(this.m_aryDynDrawObject[F],M);this.m_aryDynDrawObject=[]},j.prototype.draw=function(M,ee){this.m_draw.setWidth(this.m_iGripWidth),this.m_draw.draw(M.toSmallcoord(this.m_pt),this.m_ostype,ee)},j);function j(M,ee){var F=this;this.m_aryDynDrawObject=new Array,this.m_iGripWidth=10,this.m_draw=new D.McEdJigOsnapDraw,this.m_pt=M,this.m_ostype=ee,this.m_draw.setAddDynDrawObject_call(function(_){F.m_aryDynDrawObject.push(_)})}var V=(R.prototype.DynamicTraceTimeCall=function(M){if(!this.m_mxJig.isExit()&&this.m_iTimeCallId==M&&this.m_isDynTrace&&this.m_snapObjectId!=0){var ee=new f;ee.m_osmode=this.m_osmode,ee.m_snapObjectId=this.m_snapObjectId,ee.m_pt=this.m_ptSnapPoint,ee.m_iGripWidth=.5*this.m_mxJig.getMxObject().screenCoordLong2Doc(w.MxDrawData.m_dInputRectWidth);for(var F=this.m_aryTraceObject.length,_=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),J=0;J<F;J++)if(this.m_aryTraceObject[J].IsEqual(ee))return this.m_aryTraceObject[J].clearDraw(_),void this.m_aryTraceObject.splice(J,1);this.m_aryTraceObject.push(ee),ee.draw(this.m_mxJig.getMxObject(),_),this.m_mxJig.getMxObject().updateDisplay()}},R.prototype.OnDynamicTrace=function(M,ee,F){if(this.m_isDynTrace)if(M==0)this.m_iTimeCallId++,this.m_snapObjectId=0;else{if(F==v.MxJigCmdManager.OsnapMode.kOsModeNear)return;var _=.5*this.m_mxJig.getMxObject().screenCoordLong2Doc(w.MxDrawData.m_dInputRectWidth);if(this.m_snapObjectId!=0&&this.m_ptSnapPoint.distanceTo(ee)<_)return;var J=this.m_iTimeCallId,T=this;setTimeout(function(){T.DynamicTraceTimeCall(J)},400),this.m_snapObjectId=M,this.m_ptSnapPoint=ee,this.m_osmode=F}},R.prototype.ClearOsmodeObjectDisplay=function(){for(var M=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),ee=this.m_aryTraceOsmodeObject.length,F=0;F<ee;F++)this.m_aryTraceOsmodeObject[F].clearDraw(M);this.m_aryTraceOsmodeObject=[]},R.prototype.ClearTraceObject=function(){for(var M=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),ee=this.m_aryTraceObject.length,F=0;F<ee;F++)this.m_aryTraceObject[F].clearDraw(M);this.m_aryTraceObject=[]},R.prototype.ClearDisplay=function(){this.ClearTraceObject(),this.ClearOsmodeObjectDisplay(),this.ClearDynDrawEntity()},R.prototype.GetTraceLine=function(M,ee,F,_){var J=ee.m_pt;if(J.distanceTo(M)<2*F)return[];var T={pt1:new a.Vector3(J.x-_,J.y),pt2:new a.Vector3(J.x+_,J.y)},B={pt1:new a.Vector3(J.x,J.y-_),pt2:new a.Vector3(J.x,J.y+_)},N=[];N.push(T),N.push(B);for(var u=G.MxManager.getMxCpp().getMcDbCurve(ee.m_snapObjectId);u;){var c=u.getFirstDeriv(G.MxManager.getMxCpp().newMcGePoint3d(J));if(c.ret!=0||c.val.isZeroLength())break;c.val.normalize(),c.val.mult(_);var m={pt1:new a.Vector3(J.x-c.val.x,J.y-c.val.y),pt2:new a.Vector3(J.x+c.val.x,J.y+c.val.y)};N.push(m),c.val.rotateBy(Math.PI/2);var E={pt1:new a.Vector3(J.x-c.val.x,J.y-c.val.y),pt2:new a.Vector3(J.x+c.val.x,J.y+c.val.y)};N.push(E);break}return N},R.prototype.ClearDynDrawEntity=function(){for(var M=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),ee=this.m_vecDynDrawEntity.length,F=0;F<ee;F++)h.MxFun.removeThreejsObject(this.m_vecDynDrawEntity[F],M);this.m_vecDynDrawEntity=[]},R.prototype.DoMouseMove=function(M){if(this.ClearDynDrawEntity(),this.ClearOsmodeObjectDisplay(),this.m_isValidTracePoint=!1,!this.m_isDynTrace)return[];if(this.m_aryTraceObject.length==0)return[];for(var ee=[],F=this.m_mxJig.getMxObject(),_=F.viewCoordLong2Cad(w.MxDrawData.m_dInputRectWidth),J=2*_,T=F.viewCoordLong2Cad(F.getViewWidth()),B=F.viewCoordLong2Cad(F.getViewHeight()),N=L.MxTools.MxMax(T,B),u=G.MxManager.getMxCpp().getMxCAD_App(),c=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),m=this.m_mxJig.getMxObject().viewCoordLong2Cad(this.m_dashedLineLen),E=0;E<this.m_aryTraceObject.length-1;E++){var U=this.m_aryTraceObject[E],X=U.m_pt,W=this.GetTraceLine(M,U,J,N);if(W.length!=0)for(var te=E+1;te<this.m_aryTraceObject.length&&!this.m_isValidTracePoint;te++){var ne=this.m_aryTraceObject[E],ce=ne.m_pt,we=this.GetTraceLine(M,ne,J,N);if(W.length!=0)for(var Ie=0;Ie<we.length&&!this.m_isValidTracePoint;Ie++)for(var xe=we[Ie],Be=0;Be<W.length&&!this.m_isValidTracePoint;Be++){var q=W[Be],ge=u.MxCADAssist.IntersectWith(q.pt1.x,q.pt1.y,q.pt2.x,q.pt2.y,xe.pt1.x,xe.pt1.y,xe.pt2.x,xe.pt2.y,3);if(0<ge.length()){var oe=ge.at(0),se=new a.Vector3(oe.x,oe.y,oe.z);if(se.distanceTo(M)<J){var Ae=k.MxThreeJS.createDashedLine(F.toSmallcoord(q.pt1),F.toSmallcoord(q.pt2),this.m_iDashedLineLenColor,m,m);c.add(Ae),this.m_vecDynDrawEntity.push(Ae);var Ye=k.MxThreeJS.createDashedLine(F.toSmallcoord(xe.pt1),F.toSmallcoord(xe.pt2),this.m_iDashedLineLenColor,m,m);c.add(Ye),this.m_vecDynDrawEntity.push(Ye),Ie=we.length,this.m_isValidTracePoint=!0,this.m_ptTracePoint=se,this.CreteTracePoint(se,_),ee.push({pt:X,ostype:U.m_osmode}),ee.push({pt:ce,ostype:ne.m_osmode});break}}}}}if(this.m_isValidTracePoint||this.TracekPerpLine(M,ee,J,N,_)||this.TracekTangLine(M,ee,J,N,_))return ee;for(E=0;E<this.m_aryTraceObject.length;E++)if(X=this.m_aryTraceObject[E].m_pt,this.m_aryTraceObject[E].m_osmode!=v.MxJigCmdManager.OsnapMode.kOsModePerp&&!(X.distanceTo(M)<2*J)){var Ge={pt1:new a.Vector3(X.x-N,X.y),pt2:new a.Vector3(X.x+N,X.y)};if(0<(ve=u.MxCADAssist.GetClosestPointTo(Ge.pt1.x,Ge.pt1.y,Ge.pt2.x,Ge.pt2.y,M.x,M.y,!0)).length()){var Ne=ve.at(0);if((He=new a.Vector3(Ne.x,Ne.y,Ne.z)).distanceTo(M)<J){var le=k.MxThreeJS.createDashedLine(F.toSmallcoord(Ge.pt1),F.toSmallcoord(Ge.pt2),this.m_iDashedLineLenColor,m,m);c.add(le),this.m_vecDynDrawEntity.push(le),this.m_isValidTracePoint=!0,this.m_ptTracePoint=He,ee.push({pt:X,ostype:this.m_aryTraceObject[E].m_osmode}),this.CreteTracePoint(He,_);break}}var ve,He,nt={pt1:new a.Vector3(X.x,X.y-N),pt2:new a.Vector3(X.x,X.y+N)};if(0<(ve=u.MxCADAssist.GetClosestPointTo(nt.pt1.x,nt.pt1.y,nt.pt2.x,nt.pt2.y,M.x,M.y,!0)).length()&&(Ne=ve.at(0),(He=new a.Vector3(Ne.x,Ne.y,Ne.z)).distanceTo(M)<J)){le=k.MxThreeJS.createDashedLine(F.toSmallcoord(nt.pt1),F.toSmallcoord(nt.pt2),this.m_iDashedLineLenColor,m,m),c.add(le),this.m_vecDynDrawEntity.push(le),this.m_isValidTracePoint=!0,this.m_ptTracePoint=He,ee.push({pt:X,ostype:this.m_aryTraceObject[E].m_osmode}),this.CreteTracePoint(He,_);break}}return ee},R.prototype.MouseMove=function(M){var ee=this.DoMouseMove(M);if(this.m_isValidTracePoint)for(var F=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),_=this.m_mxJig.getMxObject().screenCoordLong2Doc(w.MxDrawData.m_dInputRectWidth),J=0;J<ee.length;J++){var T=new C(ee[J].pt,ee[J].ostype);T.m_iGripWidth=_,T.draw(this.m_mxJig.getMxObject(),F),this.m_aryTraceOsmodeObject.push(T)}},R.prototype.Init=function(){var M=this.m_mxJig.getMxObject();M.getMcObject().isValid()?(this.m_isDynTrace=M.getSysVarLong("DYNTRACE")!=0,M.sysVariable().getSysVarNumber("GETPOINTSTATUS")&v.MxJigCmdManager.GETPOINTSTATUS.OsModeDynTraceTempDisable&&(this.m_isDynTrace=!1),this.m_mxJig.isDisableDynamicTrace()&&(this.m_isDynTrace=!1),this.m_isDynTrace):this.m_isDynTrace=!1},R.prototype.GetTracePoint=function(){if(this.m_isDynTrace)return this.m_isValidTracePoint?this.m_ptTracePoint:void 0},R.prototype.ReSetTempDisplay=function(){this.ClearDynDrawEntity(),this.ClearOsmodeObjectDisplay(),this.m_isValidTracePoint=!1},R.prototype.CreteTracePoint=function(M,ee){var F=this.m_mxJig.getMxObject(),_=F.getTheTempDrawContainer_SmallCoord();ee/=2;var J=k.MxThreeJS.createLine(F.toSmallcoord2(M.x+ee,M.y+ee,0),F.toSmallcoord2(M.x-ee,M.y-ee,0),16711680);_.add(J),this.m_vecDynDrawEntity.push(J);var T=k.MxThreeJS.createLine(F.toSmallcoord2(M.x-ee,M.y+ee,0),F.toSmallcoord2(M.x+ee,M.y-ee,0),16711680);_.add(T),this.m_vecDynDrawEntity.push(T)},R.prototype.TracekPerpLine=function(M,ee,F,_,J){for(var T=this.m_aryTraceObject,B=T.length,N=G.MxManager.getMxCpp().getMxCAD_App(),u=this.m_mxJig.getMxObject(),c=u.getTheTempDrawContainer_SmallCoord(),m=u.viewCoordLong2Cad(this.m_dashedLineLen),E=0;E<B;E++){var U=T[E].m_pt;if(!(U.distanceTo(M)<2*F)){var X=G.MxManager.getMxCpp().getMcDbCurve(T[E].m_snapObjectId);if(X){var W=X.getFirstDeriv(G.MxManager.getMxCpp().newMcGePoint3d(U));if(W.ret==0&&!W.val.isZeroLength()){W.val.normalize(),W.val.rotateBy(Math.PI/2),W.val.mult(_);var te={pt1:new a.Vector3(U.x-W.val.x,U.y-W.val.y),pt2:new a.Vector3(U.x+W.val.x,U.y+W.val.y)},ne=N.MxCADAssist.GetClosestPointTo(te.pt1.x,te.pt1.y,te.pt2.x,te.pt2.y,M.x,M.y,!0);if(0<ne.length()){var ce=ne.at(0),we=new a.Vector3(ce.x,ce.y,ce.z);if(we.distanceTo(M)<F){var Ie=k.MxThreeJS.createDashedLine(u.toSmallcoord2(U.x-W.val.x,U.y-W.val.y,0),u.toSmallcoord2(U.x+W.val.x,U.y+W.val.y,0),this.m_iDashedLineLenColor,m,m);c.add(Ie),this.m_vecDynDrawEntity.push(Ie),this.m_isValidTracePoint=!0,this.m_ptTracePoint=we,ee.push({pt:U,ostype:T[E].m_osmode}),this.CreteTracePoint(we,J);break}}}}}}return this.m_isValidTracePoint},R.prototype.TracekTangLine=function(M,ee,F,_,J){for(var T=this.m_aryTraceObject,B=T.length,N=G.MxManager.getMxCpp().getMxCAD_App(),u=this.m_mxJig.getMxObject(),c=u.getTheTempDrawContainer_SmallCoord(),m=u.viewCoordLong2Cad(this.m_dashedLineLen),E=0;E<B;E++){var U=T[E].m_pt;if(!(U.distanceTo(M)<2*F)){var X=G.MxManager.getMxCpp().getMcDbCurve(T[E].m_snapObjectId);if(X){var W=X.getFirstDeriv(G.MxManager.getMxCpp().newMcGePoint3d(U));if(W.ret==0&&!W.val.isZeroLength()){W.val.normalize(),W.val.mult(_);var te={pt1:new a.Vector3(U.x-W.val.x,U.y-W.val.y),pt2:new a.Vector3(U.x+W.val.x,U.y+W.val.y)},ne=N.MxCADAssist.GetClosestPointTo(te.pt1.x,te.pt1.y,te.pt2.x,te.pt2.y,M.x,M.y,!0);if(0<ne.length()){var ce=ne.at(0),we=new a.Vector3(ce.x,ce.y,ce.z);if(we.distanceTo(M)<F){var Ie=k.MxThreeJS.createDashedLine(u.toSmallcoord2(U.x-W.val.x,U.y-W.val.y),u.toSmallcoord2(U.x+W.val.x,U.y+W.val.y),this.m_iDashedLineLenColor,m,m);c.add(Ie),this.m_vecDynDrawEntity.push(Ie),this.m_isValidTracePoint=!0,this.m_ptTracePoint=we,ee.push({pt:U,ostype:T[E].m_osmode}),this.CreteTracePoint(we,J);break}}}}}}return this.m_isValidTracePoint},R);function R(M){this.m_snapObjectId=0,this.m_ptSnapPoint=new a.Vector3,this.m_osmode=0,this.m_ptTracePoint=new a.Vector3,this.m_isValidTracePoint=!1,this.m_isDynTrace=!1,this.m_iTimeCallId=0,this.m_mxJig=null,this.m_aryTraceObject=[],this.m_aryTraceOsmodeObject=[],this.m_vecDynDrawEntity=[],this.m_dashedLineLen=1.5,this.m_iDashedLineLenColor=11184810,this.m_mxJig=M}o.McEdJigDynamicTrace=V},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxThreeJS":37,"../MxTools":38,"./McEdJigOsnap":43,"./MxJigCmdManager":54,three:19}],43:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.McEdJigOsnap=o.McEdJigOsnapDraw=o.McEdJigOrtho=o.McEdImpJigGlobalData=o.MxOsnapDefine=void 0;var a,v,h,w,L,G,k,D,f,O,C=b("three"),j=b("../MxDrawObject"),V=b("../MxFun"),R=b("./MxJigCmdManager"),M=b("../MxTools"),ee=b("../MxDrawData");(v=a||(o.MxOsnapDefine=a={}))[v.OsModeInvalid=0]="OsModeInvalid",v[v.OsModeEnd=1]="OsModeEnd",v[v.OsModeMid=2]="OsModeMid",v[v.OsModeCen=4]="OsModeCen",v[v.OsModeNode=8]="OsModeNode",v[v.OsModeQuad=16]="OsModeQuad",v[v.OsModeInt=32]="OsModeInt",v[v.OsModeIns=64]="OsModeIns",v[v.OsModePerp=128]="OsModePerp",v[v.OsModeTan=256]="OsModeTan",v[v.OsModeNear=512]="OsModeNear",v[v.OsModeApp=2048]="OsModeApp",v[v.OsModeExt=4096]="OsModeExt",v[v.OsModePar=8192]="OsModePar",v[v.OsModeOff=16384]="OsModeOff",v[v.OsModeAll=16383]="OsModeAll",w=h||(o.McEdImpJigGlobalData=h={}),L=!1,G=new C.Vector3,k=new C.Vector3,f=D=!1,O=new Array,w.setPrvPoint=function(u){G=u,f=!0},w.isOsnapZValue=function(){return!1},w.setIsValidPrvpoint=function(u){f=u},w.isValidPrvpoint=function(){return f},w.getPrvPoint=function(){return G},w.setIsValidBasepoint=function(u){L=u},w.isValidBasepoint=function(){return L},w.setBasepoint=function(u){L=!0,k=u},w.getBasepoint=function(){return k},w.initStartCommand=function(){D=L=!1},w.setIsTmpDisableOsmode=function(u){D=u},w.isTmpDisableOsmode=function(){return D},w.addDynDrawObject=function(u){O.push(u)},w.clearDisplay=function(u){for(var c=O.length,m=0;m<c;m++)V.MxFun.removeThreejsObject(O[m],u);O=[]};var F=(_.prototype.Init=function(){this.m_isTrace=!this.m_mxJig.isDisableOrthoTrace(),this.m_isValid=!1},_.prototype.OnViewMouseMove=function(u){if(this.m_isTrace){var c=this.m_mxJig.getMxObject(),m=c.sysVariable().getSysVarNumber("GETPOINTSTATUS");if(!(c.getSysVarLong("ORTHOMODE")==0||m&R.MxJigCmdManager.GETPOINTSTATUS.OsModeOrthoTempDisable)&&m&R.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint){var E=c.sysVariable().getSysVarPoint("LASTPOINT");Math.abs(u.x-E.x)>Math.abs(u.y-E.y)?(this.m_ptOrtho.x=u.x,this.m_ptOrtho.y=E.y):(this.m_ptOrtho.x=E.x,this.m_ptOrtho.y=u.y),this.m_isValid=!0}else this.m_isValid=!1}},_.prototype.GetCurOrthoPoint=function(){return{pt:this.m_ptOrtho,isValid:this.m_isValid}},_);function _(u){this.m_mxJig=null,this.m_ptOrtho=new C.Vector3,this.m_isValid=!1,this.m_isTrace=!0,this.m_mxJig=u}o.McEdJigOrtho=F;var J=(T.prototype.setAddDynDrawObject_call=function(u){this.m_addDynDrawObject_call=u},T.prototype.addDynDrawObject=function(u){this.m_addDynDrawObject_call?this.m_addDynDrawObject_call(u):h.addDynDrawObject(u)},T.prototype.drawLine=function(u,c,m){var E=new C.Geometry,U=new C.LineBasicMaterial({color:this.m_iColor});E.vertices.push(new C.Vector3(u.x,u.y,u.z),new C.Vector3(c.x,c.y,c.z));var X=new C.Line(E,U);m.add(X),this.addDynDrawObject(X)},T.prototype.drawPolyline=function(u,c){for(var m=new C.Geometry,E=new C.LineBasicMaterial({color:this.m_iColor}),U=u.length,X=0;X<U;X++)m.vertices.push(new C.Vector3(u[X].x,u[X].y,u[X].z));var W=new C.Line(m,E);c.add(W),this.addDynDrawObject(W)},T.prototype.setWidth=function(u){this.m_dOsmodeWdith=u},T.prototype.GetDrawRect=function(){var u=.5*this.m_dOsmodeWdith,c={};return c.left=this.m_pt.x-u,c.right=this.m_pt.x+u,c.top=this.m_pt.y-u,c.bottom=this.m_pt.y+u,c},T.prototype.DrawNear=function(u){var c=this.GetDrawRect(),m=[new C.Vector3,new C.Vector3];m[0].x=c.left,m[0].y=c.top,m[1].x=c.right,m[1].y=c.top,this.drawLine(m[0],m[1],u),m[0].x=c.left,m[0].y=c.bottom,m[1].x=c.right,m[1].y=c.bottom,this.drawLine(m[0],m[1],u),m[0].x=c.right,m[0].y=c.top,m[1].x=c.left,m[1].y=c.bottom,this.drawLine(m[0],m[1],u),m[0].x=c.right,m[0].y=c.bottom,m[1].x=c.left,m[1].y=c.top,this.drawLine(m[0],m[1],u)},T.prototype.DrawEnd=function(u){var c=this.GetDrawRect(),m=[new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3];m[0].x=c.left,m[0].y=c.top,m[1].x=c.right,m[1].y=c.top,m[2].x=c.right,m[2].y=c.bottom,m[3].x=c.left,m[3].y=c.bottom,this.drawLine(m[0],m[1],u),this.drawLine(m[1],m[2],u),this.drawLine(m[2],m[3],u),this.drawLine(m[3],m[0],u)},T.prototype.DrawMid=function(u){var c=this.GetDrawRect(),m=1.2*(c.right-c.left),E=m/2/Math.sin(60*3.14159265/180),U=E*Math.sin(.5235987750000001),X=new C.Vector3(this.m_pt.x,this.m_pt.y,this.m_pt.z);X.y-=E;var W=new C.Vector3;W.x=this.m_pt.x+m/2,W.y=this.m_pt.y+U;var te=new C.Vector3;te.x=this.m_pt.x-m/2,te.y=this.m_pt.y+U;var ne=[new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3];ne[0].x=X.x,ne[0].y=X.y,ne[1].x=W.x,ne[1].y=W.y,ne[2].x=te.x,ne[2].y=te.y,ne[3].x=X.x,ne[3].y=X.y,this.drawLine(ne[0],ne[1],u),this.drawLine(ne[1],ne[2],u),this.drawLine(ne[2],ne[3],u)},T.prototype.DrawPerp=function(u){var c=this.GetDrawRect(),m=[new C.Vector3,new C.Vector3,new C.Vector3];m[0].x=c.left,m[0].y=c.top,m[1].x=c.left,m[1].y=c.bottom,m[2].x=c.right,m[2].y=c.bottom,this.drawPolyline(m,u),m[0].x=c.left,m[0].y=this.m_pt.y,m[1].x=this.m_pt.x,m[1].y=this.m_pt.y,m[2].x=this.m_pt.x,m[2].y=c.bottom,this.drawPolyline(m,u)},T.prototype.DrawCircle=function(u,c,m){m==null&&(m=.5*this.m_dOsmodeWdith);for(var E=[],U=0,X=3.14159265/180;U<=360;U+=15){var W=m*Math.cos(U*X)+u.x,te=m*Math.sin(U*X)+u.y;E.push(new C.Vector3(W,te))}this.drawPolyline(E,c)},T.prototype.DrawInt=function(u){var c=this.GetDrawRect(),m=[new C.Vector3,new C.Vector3];m[0].x=c.right,m[0].y=c.top,m[1].x=c.left,m[1].y=c.bottom,this.drawLine(m[0],m[1],u),m[0].x=c.right,m[0].y=c.bottom,m[1].x=c.left,m[1].y=c.top,this.drawLine(m[0],m[1],u)},T.prototype.DrawCen=function(u){this.DrawInt(u),this.DrawCircle(this.m_pt,u)},T.prototype.DrawTan=function(u){this.DrawEnd(u)},T.prototype.DrawIns=function(u){var c=this.GetDrawRect(),m={},E=(c.right-c.left)/1.5;m.left=this.m_pt.x-E,m.right=this.m_pt.x+E,m.top=this.m_pt.y-E,m.bottom=this.m_pt.y+E;var U=this.m_pt.x,X=this.m_pt.y,W=[new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3];W[0].x=m.left,W[0].y=m.top,W[1].x=m.left,W[1].y=X+2,W[2].x=U,W[2].y=X+2,W[3].x=U,W[3].y=m.bottom,W[4].x=m.right,W[4].y=m.bottom,W[5].x=m.right,W[5].y=X-2,W[6].x=U,W[6].y=X-2,W[7].x=U,W[7].y=m.top,W[8].x=m.left,W[8].y=m.top,this.drawPolyline(W,u)},T.prototype.DrawNode=function(u){var c=this.GetDrawRect(),m={},E=(c.right-c.left)/1.5;m.left=this.m_pt.x-E,m.right=this.m_pt.x+E,m.top=this.m_pt.y-E,m.bottom=this.m_pt.y+E;var U=this.m_dOsmodeWdith/1.3;this.m_pt.x,this.m_pt.x,this.m_pt.y,this.m_pt.y;var X=[new C.Vector3,new C.Vector3,new C.Vector3,new C.Vector3];X[0].x=m.left,X[0].y=m.top,X[1].x=m.right,X[1].y=m.bottom,X[2].x=m.left,X[2].y=m.bottom,X[3].x=m.right,X[3].y=m.top,this.drawLine(X[0],X[1],u),this.drawLine(X[2],X[3],u),this.DrawCircle(this.m_pt,u,U)},T.prototype.draw=function(u,c,m){this.m_pt=u,this.m_osmode=c;var E=.5*this.m_dOsmodeWdith;if(this.m_osmode!=R.MxJigCmdManager.OsnapMode.kOsModekInValid)if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeNear)this.DrawNear(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeEnd)this.DrawEnd(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeMid)this.DrawMid(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModePerp)this.DrawPerp(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeInt)this.DrawInt(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeCen)this.DrawCen(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeTan)this.DrawTan(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeIns)this.DrawIns(m);else if(this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModeNode)this.DrawNode(m);else{var U=new C.Vector3(u.x-E,u.y-E,0),X=new C.Vector3(u.x+E,u.y+E,0);this.drawLine(U,X,m);var W=new C.Vector3(u.x-E,u.y+E,0),te=new C.Vector3(u.x+E,u.y-E,0);this.drawLine(W,te,m)}},T.prototype.upDisplay=function(u,c,m){this.clearDisplay(m);var E=m.getMxObject();this.setWidth(E.screenCoordLong2Doc(ee.MxDrawData.m_dInputRectWidth)),u=E.toSmallcoord(u),this.draw(u,c,E.getTheTempDrawContainer_SmallCoord())},T.prototype.clearDisplay=function(u){var c=u.getMxObject().getTheTempDrawContainer_SmallCoord();h.clearDisplay(c)},T);function T(){this.m_iColor=16711935,this.m_addDynDrawObject_call=void 0,this.m_pt=new C.Vector3,this.m_osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid,this.m_dOsmodeWdith=10}o.McEdJigOsnapDraw=J;var B=(N.prototype.resetData=function(){this.m_osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid,this.m_isValidPrvInputPoint=!1,this.m_lOSmode=0,this.m_vecOffset.set(0,0,0),this.m_isValid=!1,this.m_iLongprogressStatus=-1,this.reComputeOffset()},N.prototype.notifyOsnapToServer=function(){var u=this;if(this.m_isRuning){var c={ptx:this.m_pt.x,pty:this.m_pt.y,osmode:this.m_lOSmode,isValidPrvInputPoint:this.m_isValidPrvInputPoint};this.m_isValidPrvInputPoint&&(c.prvPtx=this.m_prvInputPoint.x,c.prvPty=this.m_prvInputPoint.y);var m=this.m_mxJig.getMxObject();if(m.getRunMode()==j.MxRunMode.kBrowse){var E=this,U=m.getCurrentMousePostion();m.getObjectOsnap().getOsnapData(U,function(te,ne){te=m.worldCoord2Doc(te.x,te.y,te.z),E.m_ptSnapPoint.x=te.x,E.m_ptSnapPoint.y=te.y,E.m_ptSnapPoint.z=0,E.m_ptSnapSrcPoint.x=E.m_pt.x,E.m_ptSnapSrcPoint.y=E.m_pt.y,E.m_ptSnapSrcPoint.z=0,E.m_osmode=ne,E.m_draw.upDisplay(new C.Vector3(te.x,te.y,0),ne,E.m_mxJig)})}else if(m.getRunMode()==j.MxRunMode.kCPPMxCAD){var X=this;c.SearchRnge=m.viewCoordLong2Cad(ee.MxDrawData.m_dInputRectWidth),m.getMcObject().onNotifyOsnap(c,function(te){X.m_ptSnapPoint.x=te.ptsx,X.m_ptSnapPoint.y=te.ptsy,X.m_ptSnapPoint.z=te.ptsz,X.m_ptSnapSrcPoint.x=te.ptx,X.m_ptSnapSrcPoint.y=te.pty,X.m_ptSnapSrcPoint.z=0,X.m_osmode=te.osmode,X.m_snapObjectId=te.id,X.m_draw.upDisplay(new C.Vector3(te.ptsx,te.ptsy,te.ptsz),te.osmode,X.m_mxJig),X.m_mxJig.onGetOsnapData(te)})}else{c.SearchRnge=m.viewCoordLong2Cad(ee.MxDrawData.m_dInputRectWidth);var W=this;m.callCommand("MxCAD_NotifyOsnap",JSON.stringify(c),function(te){if(!(typeof te!="string"||te.length<1)&&W.m_isRuning){var ne=JSON.parse(te);u.m_ptSnapPoint.x=ne.ptsx,u.m_ptSnapPoint.y=ne.ptsy,u.m_ptSnapPoint.z=ne.ptsz,u.m_ptSnapSrcPoint.x=ne.ptx,u.m_ptSnapSrcPoint.y=ne.pty,u.m_ptSnapSrcPoint.z=0,u.m_osmode=ne.osmode,W.m_draw.upDisplay(new C.Vector3(ne.ptsx,ne.ptsy,ne.ptsz),ne.osmode,W.m_mxJig)}})}}},N.prototype.startDrag=function(u,c){this.m_mxJig=c;var m,E,U=this.m_mxJig.getMxObject();function X(){m.notifyOsnapToServer()}return c.isDisableOsnap()?this.m_isEnable=!1:this.m_isEnable=U.getInisetValue(j.IniSetName.kEnableOsnapFunction)===!0,this.m_isOffsetInputPostion=u,this.m_isRuning=!0,this.resetData(),this.m_notifyOsnap_delayCall=(m=this,E=null,function(){clearTimeout(E),E=setTimeout(X,20)}),!0},N.prototype.endDrag=function(){return this.m_isRuning=!1,this.m_draw.clearDisplay(this.m_mxJig),!0},N.prototype.reCompteCurrentPoint=function(u){return this.m_isOffsetInputPostion&&u.add(this.m_vecOffset),u},N.prototype.isEnable=function(){var u,c=this.m_mxJig.getMxObject().getSysVarLong("OSMODE");return u=!(c==0||c&a.OsModeOff||h.isTmpDisableOsmode()),this.m_isEnable&&u},N.prototype.notifyOsnap=function(u,c){this.m_lOSmode=u,c==null?this.m_isValidPrvInputPoint=!1:(this.m_isValidPrvInputPoint=!0,this.m_prvInputPoint=c),this.m_osmode==R.MxJigCmdManager.OsnapMode.kOsModekInValid&&this.m_draw.clearDisplay(this.m_mxJig),this.m_notifyOsnap_delayCall()},N.prototype.setPoint=function(u,c){if(this.isEnable()){u==null?(this.m_isValid=!1,this.m_osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid):(this.m_iLongprogressStatus==-1||this.m_iLongprogressStatus,this.m_pt=u,this.m_inPoint=u,this.m_isValid=!0,(c==null||this.m_osmode!=R.MxJigCmdManager.OsnapMode.kOsModekInValid&&M.MxTools.getXYPlanDistance(this.m_ptSnapSrcPoint,u)>c)&&(this.m_osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid));var m=this.m_mxJig.getMxObject().getSysVarLong("OSMODE"),E=h.getPrvPoint();this.notifyOsnap(m,h.isValidPrvpoint()?E:void 0)}},N.prototype.seInValidPoint=function(){this.setPoint(void 0)},N.prototype.getCurrentOSnapPoint=function(u){var c={isSnapPoint:!1};return this.isEnable()?(c.pt=u,c.osmode=this.m_osmode,this.m_osmode!=R.MxJigCmdManager.OsnapMode.kOsModekInValid?(c.isSnapPoint=!0,c.pt.x=this.m_ptSnapPoint.x,c.pt.y=this.m_ptSnapPoint.y,c.pt.z=this.m_ptSnapPoint.z,h.isOsnapZValue()||(u.z=0)):c.pt=u):(c.pt=u,c.osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid),c},N.prototype.setLongprogressStatus=function(u){this.m_iLongprogressStatus=u},N.prototype.reComputeOffset=function(){if(this.m_isOffsetInputPostion){var u=this.m_mxJig.getMxObject(),c=M.MxTools.MillimeterToPixels(8);c=u.screenCoordLong2Doc(c),this.m_vecOffset.set(0,c,0),this.m_vecOffset.applyAxisAngle(new C.Vector3(0,0,1),20*Math.PI/180)}},N);function N(u){this.m_inPoint=new C.Vector3,this.m_vecOffset=new C.Vector3,this.m_pt=new C.Vector3,this.m_isValid=!1,this.m_ptSnapPoint=new C.Vector3,this.m_ptSnapSrcPoint=new C.Vector3,this.m_snapObjectId=0,this.m_osmode=R.MxJigCmdManager.OsnapMode.kOsModekInValid,this.m_prvInputPoint=new C.Vector3,this.m_isValidPrvInputPoint=!1,this.m_lOSmode=0,this.m_iLongprogressStatus=-1,this.m_isOffsetInputPostion=!1,this.m_mxJig=null,this.m_notifyOsnap_delayCall=void 0,this.m_isRuning=!1,this.m_isEnable=!1,this.m_mxJig=u,this.m_draw=new J}o.McEdJigOsnap=B},{"../MxDrawData":22,"../MxDrawObject":23,"../MxFun":27,"../MxTools":38,"./MxJigCmdManager":54,three:19}],44:[function(b,r,o){var a,v=this&&this.__extends||(a=function(M,ee){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,_){F.__proto__=_}||function(F,_){for(var J in _)Object.prototype.hasOwnProperty.call(_,J)&&(F[J]=_[J])})(M,ee)},function(M,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");function F(){this.constructor=M}a(M,ee),M.prototype=ee===null?Object.create(ee):(F.prototype=ee.prototype,new F)});Object.defineProperty(o,"__esModule",{value:!0}),o.McGiWorldDrawSelect=o.McGiWorldDraw=o.McGiWorldDrawType=void 0;var h,w,L=b("three"),G=b("../MxThreeJS"),k=b("../MxManager"),D=b("three.meshline"),f=b("../MxFun");(w=h||(o.McGiWorldDrawType=h={}))[w.kWorldDraw=1]="kWorldDraw",w[w.kDynDragDraw=2]="kDynDragDraw",w[w.kSelectDraw=3]="kSelectDraw";var O=(C.prototype.getType=function(){return this.worldDrawType},C.prototype.setXData=function(M){this.xData=M},C.prototype.setMatrix=function(M){this.matrix=M},C.prototype.getMatrix=function(){return this.matrix},C.prototype.setOpacity=function(M){this.opacity=M},C.prototype.getOpacity=function(){return this.opacity},C.prototype.setColor=function(M){M=f.MxFun.getNumberColor(M),this.iColor!=M&&(this.widthMaterial=null),this.iColor=M},C.prototype.setDash=function(M,ee){this.dDashArray=M,this.dDashRatio=ee},C.prototype.getDash=function(){return{dDashArray:this.dDashArray,dDashRatio:this.dDashRatio}},C.prototype.setDashLineDisplay=function(M){M?(this.dDashArray=.03,this.dDashRatio=.1,this.dLineWidth==0&&(this.dLineWidth=6,this.lineWidthByPixels=!0)):(this.dDashArray=0,this.dDashRatio=0)},C.prototype.isDashLineDisplay=function(){return 0<this.dDashArray&&0<this.dDashRatio},C.prototype.getColor=function(){return this.iColor},C.prototype.setRenderOrder=function(M){this.iRenderOrder=M},C.prototype.getRenderOrder=function(){return this.iRenderOrder},C.prototype.setLineWidthByPixels=function(M){this.lineWidthByPixels!=M&&(this.widthMaterial=null),this.lineWidthByPixels=M},C.prototype.getLineWidthByPixels=function(){return this.lineWidthByPixels},C.prototype.setLineWidth=function(M){this.dLineWidth!=M&&(this.widthMaterial=null),this.dLineWidth=M},C.prototype.getLineWidth=function(){return this.dLineWidth},C.prototype.drawEntity=function(M){var ee=this.iRenderOrder;M.type=="Group"?M.traverse(function(F){F.type!="Group"&&(F.renderOrder=ee)}):M.renderOrder=ee,this.matrix!=null&&M.applyMatrix4(this.matrix),this.aryEntity.push(M),this.xData&&(M.MxWordDrawXData=this.xData,this.xData=null)},C.prototype.getEntitys=function(){return this.aryEntity},C.prototype.getMxObject=function(){return this.mxObj},C.prototype.createWidthMaterial=function(){this.widthMaterial==null&&(0<this.dDashArray&&0<this.dDashRatio?this.widthMaterial=new D.MeshLineMaterial({useMap:!1,color:this.iColor,opacity:1,resolution:new L.Vector2(this.mxObj.getViewWidth(),this.mxObj.getViewHeight()),sizeAttenuation:!this.lineWidthByPixels,lineWidth:this.dLineWidth,transparent:!0,depthTest:!1,dashArray:this.dDashArray,dashRatio:this.dDashRatio}):this.widthMaterial=new D.MeshLineMaterial({useMap:!1,color:this.iColor,opacity:1,resolution:new L.Vector2(this.mxObj.getViewWidth(),this.mxObj.getViewHeight()),sizeAttenuation:!this.lineWidthByPixels,lineWidth:this.dLineWidth,transparent:!0,depthTest:!1}))},C.prototype.drawSolid=function(M){if(!(M.length<3)){var ee=new L.Shape(M.map(function(J){var T=J.x,B=J.y;return new L.Vector2(T,B)})),F=new L.ShapeGeometry(ee),_=new L.Mesh(F,new L.MeshPhongMaterial({color:this.getColor(),side:L.DoubleSide,transparent:!0,opacity:this.getOpacity()}));this.drawEntity(_)}},C.prototype.drawLines=function(M){if(!(M.length<2))if(this.dLineWidth!=0){this.createWidthMaterial();var ee=new L.Geometry;ee.vertices=M;var F=new D.MeshLine;F.setGeometry(ee);var _=new L.Mesh(F.geometry,this.widthMaterial);this.drawEntity(_),this.drawEntity(G.MxThreeJS.createLines(M.slice(0),this.iColor,0))}else this.drawEntity(G.MxThreeJS.createLines(M.slice(0),this.iColor,this.opacity))},C.prototype.drawGeometryLines=function(M){if(!(M.vertices.length<2))if(this.dLineWidth!=0){this.createWidthMaterial();var ee=new D.MeshLine;if(!(M instanceof L.Geometry)){var F=new L.Geometry;F.vertices=M.vertices,M=F}ee.setGeometry(M);var _=new L.Mesh(ee.geometry,this.widthMaterial);this.drawEntity(_);var J=new L.LineBasicMaterial({color:this.iColor,transparent:!0,depthTest:!1,opacity:0}),T=new L.Line(M,J);this.drawEntity(T)}else J=void 0,J=this.opacity&&this.opacity!=1||this.opacity==0?new L.LineBasicMaterial({color:this.iColor,transparent:!0,depthTest:!1,opacity:this.opacity}):new L.LineBasicMaterial({color:this.iColor,transparent:!0,depthTest:!1}),T=new L.Line(M,J),this.drawEntity(T)},C.prototype.drawSelectLine=function(M,ee,F,_){M instanceof Object&&ee instanceof Object?this.drawEntity(G.MxThreeJS.createLine(M,ee,this.iColor,0)):typeof M=="number"&&typeof ee=="number"&&this.drawEntity(G.MxThreeJS.createLine(new L.Vector3(M,ee,0),new L.Vector3(F,_,0),this.iColor,0))},C.prototype.drawLine=function(M,ee,F,_){var J,T;if(M instanceof Object&&ee instanceof Object?(J=M,T=ee):typeof M=="number"&&typeof ee=="number"&&(J=new L.Vector3(M,ee,0),T=new L.Vector3(F,_,0)),this.dLineWidth!=0){this.createWidthMaterial();var B=new Float32Array(6);B[0]=J.x,B[1]=J.y,B[2]=0,B[3]=T.x,B[4]=T.y,B[5]=0;var N=new D.MeshLine;N.setGeometry(B);var u=new L.Mesh(N.geometry,this.widthMaterial);u.renderOrder=this.iRenderOrder,this.drawEntity(u),this.drawSelectLine(J,T)}else this.drawEntity(G.MxThreeJS.createLine(J,T,this.iColor,this.opacity))},C.prototype.drawCircle=function(M,ee){this.drawEntity(G.MxThreeJS.createCircle(M,ee,this.iColor))},C.prototype.drawText=function(M,ee,F,_,J,T){var B=G.MxThreeJS.creatTextSprite(M,_,ee,F,this.iColor,J,T);return this.drawEntity(B),B},C.prototype.setupForEntity=function(M){this.iColor=f.MxFun.getNumberColor(M.getColor()),this.iRenderOrder=M.getRenderOrder(),this.opacity=M.opacity,this.dLineWidth=M.getLineWidth(),this.lineWidthByPixels=M.getLineWidthByPixels(),this.dDashArray=M.getDash().dDashArray,this.dDashRatio=M.getDash().dDashRatio},C);function C(M,ee){this.aryEntity=[],this.iColor=16777215,this.dLineWidth=0,this.lineWidthByPixels=!0,this.iRenderOrder=k.MxData.iMxEntityRenderOrder,this.worldDrawType=1,this.widthMaterial=null,this.dDashArray=0,this.dDashRatio=0,this.matrix=null,this.opacity=1,this.xData=null,this.mxObj=M,this.worldDrawType=ee}o.McGiWorldDraw=O;var j,V=(v(R,j=O),R.prototype.setSmallCoordDraw=function(M){this.isSmallCorrdDraw=M},R.prototype.setCurEntityId=function(M){this.curEntityId=M},R.prototype.drawEntity=function(M){},R.prototype.drawText=function(M,ee,F,_,J,T){return null},R.prototype.drawSelectLine=function(M,ee,F,_){},R.prototype.isValid=function(){return this.curEntityId!=0||(console.log("this.curEntityId == 0"),!1)},R.prototype.drawLine=function(M,ee,F,_){var J,T;this.isValid()&&(M instanceof Object&&ee instanceof Object?(J=M,T=ee):typeof M=="number"&&typeof ee=="number"&&(J=new L.Vector3(M,ee,0),T=new L.Vector3(F,_,0)),this.selectManager.addLineDisplay(this.curEntityId,J,T,this.isSmallCorrdDraw))},R.prototype.drawCircle=function(M,ee){this.isValid()&&this.selectManager.addCircleDisplay(this.curEntityId,M,ee,this.isSmallCorrdDraw)},R.prototype.drawLines=function(M){if(!(M.length<2))for(var ee=M.length,F=0;F<ee-1;F++)this.selectManager.addLineDisplay(this.curEntityId,M[F],M[F+1],this.isSmallCorrdDraw)},R);function R(M,ee){var F=j.call(this,M,h.kSelectDraw)||this;return F.isSmallCorrdDraw=!1,F.selectManager=ee,F.curEntityId=0,F.isSmallCorrdDraw=!1,F}o.McGiWorldDrawSelect=V},{"../MxFun":27,"../MxManager":29,"../MxThreeJS":37,three:19,"three.meshline":18}],45:[function(b,r,o){var a,v=this&&this.__extends||(a=function(B,N){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var m in c)Object.prototype.hasOwnProperty.call(c,m)&&(u[m]=c[m])})(B,N)},function(B,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");function u(){this.constructor=B}a(B,N),B.prototype=N===null?Object.create(N):(u.prototype=N.prototype,new u)});Object.defineProperty(o,"__esModule",{value:!0}),o.MrxDbgUiPrBase=o.MrxDbgUiPrBase_Return=o.McEdGetPointWorldDrawObject=o.McEdGetPointWorldDraw=void 0;var h=b("three"),w=b("./MxJig"),L=b("./MxJigCmdManager"),G=b("../MxThreeJS"),k=b("../UI/MxUiVue"),D=b("../MxString"),f=b("./McGiWorldDraw"),O=b("../MxManager"),C=(j.prototype.setMcEdJig=function(B){this.m_pJig=B},j.prototype.getMcEdJig=function(){return this.m_pJig},j.prototype.setColor=function(B){this.m_iColor=B},j.prototype.getColor=function(){return this.m_iColor},j.prototype.getDrawColor=function(){return this.m_pJig.getMxObject().automaticInversionColor(this.m_iColor)},j.prototype.drawLine=function(B,N){this.m_pJig.drawEntity(G.MxThreeJS.createLine(B,N,this.getDrawColor()))},j.prototype.drawRect=function(B,N){var u=new h.Vector3(B.x,N.y,0),c=new h.Vector3(N.x,B.y,0);this.drawLine(B,u),this.drawLine(u,N),this.drawLine(N,c),this.drawLine(c,B)},j.prototype.drawMcDbEntity=function(B,N){this.m_pJig.drawMcDbEntity(B,N?0:this.getDrawColor(),N)},j.prototype.drawMcDbLine=function(B,N,u,c,m,E){this.m_pJig.drawMcDbLine(B,N,u,c,m,E,this.getDrawColor())},j.prototype.drawCircle=function(B,N){this.m_pJig.drawEntity(G.MxThreeJS.createCircle(B,N,this.getDrawColor()))},j.prototype.drawEntity=function(B,N,u){u===void 0&&(u=!1),this.m_pJig.drawEntity(B,N,u)},j.prototype.drawText=function(B,N,u,c){var m=G.MxThreeJS.creatTextSprite(B,c,N,u,this.getDrawColor());this.drawEntity(m)},j.prototype.drawSolid=function(B,N){var u=G.MxThreeJS.createSolid(B,this.getDrawColor(),N);u&&this.drawEntity(u)},j.prototype.drawCustomEntity=function(B,N){var u=new f.McGiWorldDraw(this.m_pJig.getMxObject(),f.McGiWorldDrawType.kDynDragDraw);u.setupForEntity(B),B.worldDraw(u);for(var c=u.getEntitys(),m=c.length,E=0;E<m;E++)this.drawEntity(c[E],N,B.isUseSmallcoordDisplay())},j);function j(){this.m_pJig=null,this.m_iColor=16777215}o.McEdGetPointWorldDraw=C;var V,R,M,ee=(v(F,V=C),F.prototype.setDraw=function(B){this.m_callDraw=B},F.prototype.worldDraw=function(B){this.m_callDraw!=null&&this.m_callDraw(B,this)},F);function F(){var B=V!==null&&V.apply(this,arguments)||this;return B.m_callDraw=void 0,B}o.McEdGetPointWorldDrawObject=ee,(M=R||(o.MrxDbgUiPrBase_Return=R={}))[M.kCancel=-2]="kCancel",M[M.kNone=-1]="kNone",M[M.kOk=0]="kOk",M[M.kKeyWord=1]="kKeyWord";var _,J=(v(T,_=w.McEdJigCommand),T.prototype.procInKeyword=function(B){B.status>=L.MxJigCmdManager.DragStatus.kKW1&&0<B.sKeyValue.length?this.m_keyWordPicked=B.sKeyValue.toUpperCase():this.m_keyWordPicked=""},T.prototype.getReturnStatus=function(B){switch(B){case L.MxJigCmdManager.DragStatus.kNoChange:return R.kNone;case L.MxJigCmdManager.DragStatus.kCancel:return R.kCancel;case L.MxJigCmdManager.DragStatus.kNull:return R.kNone;case L.MxJigCmdManager.DragStatus.kNormal:return R.kOk}return 1<=B?R.kKeyWord:R.kCancel},T.prototype.SetLASTPOINT=function(B){var N=this._mxObject;if((N=N||O.MxManager.currentMx()).sysVariable().setSysVarPoint("LASTPOINT",B),B){var u=N.sysVariable().getSysVarNumber("GETPOINTSTATUS");u|=L.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint,N.sysVariable().setSysVarNumber("GETPOINTSTATUS",u)}else u=N.sysVariable().getSysVarNumber("GETPOINTSTATUS"),u&=~L.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint,N.sysVariable().setSysVarNumber("GETPOINTSTATUS",u)},T.prototype.clearLastInputPoint=function(){this._mxObject||(this._mxObject=O.MxManager.currentMx()),this.SetLASTPOINT(void 0)},T.prototype.setCursorType=function(B){this.m_cursorType=B},T.prototype.getCursorType=function(){return this.m_cursorType},T.prototype.setInputToucheType=function(B){this.m_toucheType=B},T.prototype.getInputToucheType=function(){return this.m_toucheType},T.prototype.keyWords=function(){return this.m_keyWords},T.prototype.setKeyWords=function(B){this.m_keyWords=B},T.prototype.message=function(){return this.m_message},T.prototype.setMessage=function(B){this.m_message=B},T.prototype.keyWordPicked=function(){return this.m_keyWordPicked},T.prototype.isKeyWordPicked=function(B){return B=B.toUpperCase(),this.m_keyWordPicked==B},T.prototype.setUserDraw=function(B){B.setMcEdJig(this),this.m_pWorldDraw=B},T.prototype.printMessage=function(){var B=new D.MxString(this.m_message);B.TrimRight(":"),1<this.m_keyWords.length&&this.m_keyWords[0]=="["&&this.m_keyWords[this.m_keyWords.length-1]=="]"?B.m_val.indexOf(`
`)==-1?k.MxUiVue.acutPrintf(`
`+B.m_val+" 或"+this.m_keyWords+":"):k.MxUiVue.acutPrintf(B.m_val+" 或"+this.m_keyWords+":"):B.m_val.indexOf(`
`)==-1?k.MxUiVue.acutPrintf(`
`+B.m_val+":"):k.MxUiVue.acutPrintf(B.m_val+":")},T);function T(){var B=_!==null&&_.apply(this,arguments)||this;return B.m_keyWords="",B.m_message="",B.m_keyWordPicked="",B.m_pWorldDraw=null,B.m_toucheType=L.MxJigCmdManager.InType.kGetBegan,B.m_cursorType=k.MxUiVue.CursorType.kNormal,B}o.MrxDbgUiPrBase=J},{"../MxManager":29,"../MxString":34,"../MxThreeJS":37,"../UI/MxUiVue":65,"./McGiWorldDraw":44,"./MxJig":53,"./MxJigCmdManager":54,three:19}],46:[function(b,r,o){var a,v=this&&this.__extends||(a=function(m,E){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,X){U.__proto__=X}||function(U,X){for(var W in X)Object.prototype.hasOwnProperty.call(X,W)&&(U[W]=X[W])})(m,E)},function(m,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function U(){this.constructor=m}a(m,E),m.prototype=E===null?Object.create(E):(U.prototype=E.prototype,new U)});Object.defineProperty(o,"__esModule",{value:!0}),o.MrxDbgUiPrAngle=o.MrxDbgUiPrKeyWord=o.MrxDbgUiPrString=o.MrxDbgUiPrInt=o.MrxDbgUiPrDist=void 0;var h,w=b("three"),L=b("./MxJigCmdManager"),G=b("../MxFun"),k=b("./MrxDbgUiPrBase"),D=b("../UI/MxUiVue"),f=b("../MxThreeJS"),O=b("../MxString"),C=(v(j,h=k.MrxDbgUiPrBase),j.prototype.value=function(){return this.m_value},j.prototype.basePt=function(){return new w.Vector3(this.m_basePt.x,this.m_basePt.y,0)},j.prototype.setBasePt=function(m){this.m_basePt==null?this.m_basePt=new w.Vector3(m.x,m.y,0):(this.m_basePt.x=m.x,this.m_basePt.y=m.y),this.m_useBasePt=!0},j.prototype.setUseBasePt=function(m){this.m_useBasePt=m},j.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null,this.clearLastInputPoint(),this.m_useBasePt&&this.SetLASTPOINT(this.m_basePt)},j.prototype.go=function(m){this.initGo(),this.m_retcall=m,this.m_previousInPoint=null,this.m_currentInPoint=null,this.m_value=0,L.MxJigCmdManager.runCmd(this)},j.prototype.onExitCommand=function(){var m=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var E=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){h.prototype.onExitCommand.call(m,!1),E=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!E&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),E||h.prototype.onExitCommand.call(this,!0)},j.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),h.prototype.onStartCommand.call(this)},j.prototype.sampler=function(){var m,E=L.MxJigCmdManager.acquirePoint(this.m_toucheType,!1);return E.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_currSamplerPoint==null?this.m_currSamplerPoint=new w.Vector3(E.pt.x,E.pt.y,0):(this.m_currSamplerPoint.x=E.pt.x,this.m_currSamplerPoint.y=E.pt.y)),m=this.m_useBasePt?this.acquireDist(this.m_toucheType,this.m_basePt):this.acquireDist(this.m_toucheType,this.m_currentInPoint),this.procInKeyword(m),m.status==L.MxJigCmdManager.DragStatus.kNormal?(this.m_value=m.dist,m.status):m.status==L.MxJigCmdManager.DragStatus.kKW1?m.status:this.m_useBasePt||this.m_currentInPoint?E.status:((m=this.acquirePoint(this.m_toucheType,!1)).status==L.MxJigCmdManager.DragStatus.kNormal&&m.exit&&(this.m_previousInPoint==null?this.m_previousInPoint=new w.Vector3(m.pt.x,m.pt.y,0):(this.m_previousInPoint.x=m.pt.x,this.m_previousInPoint.y=m.pt.y)),m.status)},j.prototype.done=function(m){if(this.m_retcall!=null)return this.m_resultDragStatus=m,this.m_useBasePt||m!=L.MxJigCmdManager.DragStatus.kNormal||!this.m_previousInPoint||this.m_currentInPoint?L.MxJigCmdManager.DoneStatius.kExitCommand:(this.m_currentInPoint=this.m_previousInPoint,this.m_previousInPoint=null,L.MxJigCmdManager.DoneStatius.kContinueCommand);G.MxFun.Assert(0)},j.prototype.upDisplay=function(){this.m_currSamplerPoint&&(this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_currSamplerPoint)),this.m_useBasePt&&this.m_basePt?this.drawEntity(f.MxThreeJS.createLine(this.m_currSamplerPoint,this.m_basePt,16777215)):this.m_currentInPoint&&this.drawEntity(f.MxThreeJS.createLine(this.m_currSamplerPoint,this.m_currentInPoint,16777215)))},j);function j(){var m=h.call(this)||this;return m.m_useBasePt=!1,m.m_basePt=null,m.m_previousInPoint=null,m.m_currentInPoint=null,m.m_value=0,m.m_currSamplerPoint=null,m.m_retcall=null,m.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,m.m_cursorType=D.MxUiVue.CursorType.kCross,m}o.MrxDbgUiPrDist=C;var V,R=(v(M,V=k.MrxDbgUiPrBase),M.prototype.value=function(){return this.m_value},M.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null,this.clearLastInputPoint()},M.prototype.go=function(m){this.initGo(),this.m_retcall=m,this.m_value=0,this.m_currSamplerPoint=null,L.MxJigCmdManager.runCmd(this)},M.prototype.onExitCommand=function(){var m=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var E=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){V.prototype.onExitCommand.call(m,!1),E=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!E&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),E||V.prototype.onExitCommand.call(this,!0)},M.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),V.prototype.onStartCommand.call(this)},M.prototype.sampler=function(){var m=L.MxJigCmdManager.acquirePoint(this.m_toucheType,!1);m.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_currSamplerPoint==null?this.m_currSamplerPoint=new w.Vector3(m.pt.x,m.pt.y,0):(this.m_currSamplerPoint.x=m.pt.x,this.m_currSamplerPoint.y=m.pt.y));var E=this.acquireInt();return this.procInKeyword(E),E.status==L.MxJigCmdManager.DragStatus.kNormal?this.m_value=E.iVal:(E.status,L.MxJigCmdManager.DragStatus.kKW1),E.status},M.prototype.done=function(m){if(this.m_retcall!=null)return this.m_resultDragStatus=m,L.MxJigCmdManager.DoneStatius.kExitCommand;G.MxFun.Assert(0)},M.prototype.upDisplay=function(){this.m_currSamplerPoint&&this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_currSamplerPoint))},M);function M(){var m=V.call(this)||this;return m.m_value=0,m.m_currSamplerPoint=null,m.m_retcall=null,m.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,m.m_cursorType=D.MxUiVue.CursorType.kNormal,m.setDynamicInputType(L.MxJigCmdManager.DynamicInputType.kNoInput),m}o.MrxDbgUiPrInt=R;var ee,F=(v(_,ee=k.MrxDbgUiPrBase),_.prototype.value=function(){return this.m_value},_.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null},_.prototype.go=function(m){this.initGo(),this.m_retcall=m,this.m_value="",this.m_currSamplerPoint=null,L.MxJigCmdManager.runCmd(this)},_.prototype.onExitCommand=function(){var m=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var E=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){ee.prototype.onExitCommand.call(m,!1),E=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!E&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),E||ee.prototype.onExitCommand.call(this,!0)},_.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),ee.prototype.onStartCommand.call(this)},_.prototype.sampler=function(){var m=L.MxJigCmdManager.acquirePoint(this.m_toucheType,!1);m.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_currSamplerPoint==null?this.m_currSamplerPoint=new w.Vector3(m.pt.x,m.pt.y,0):(this.m_currSamplerPoint.x=m.pt.x,this.m_currSamplerPoint.y=m.pt.y));var E=this.acquireString();return this.procInKeyword(E),E.status==L.MxJigCmdManager.DragStatus.kNormal?this.m_value=E.sValue:(E.status,L.MxJigCmdManager.DragStatus.kKW1),E.status},_.prototype.done=function(m){if(this.m_retcall!=null)return this.m_resultDragStatus=m,L.MxJigCmdManager.DoneStatius.kExitCommand;G.MxFun.Assert(0)},_.prototype.upDisplay=function(){this.m_currSamplerPoint&&this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_currSamplerPoint))},_);function _(){var m=ee.call(this)||this;return m.m_value="",m.m_currSamplerPoint=null,m.m_retcall=null,m.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,m.m_cursorType=D.MxUiVue.CursorType.kCross,m}o.MrxDbgUiPrString=F;var J,T=(v(B,J=k.MrxDbgUiPrBase),B.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null},B.prototype.printMessage=function(){var m=new O.MxString(this.m_message);m.TrimRight(":"),1<this.m_keyWords.length&&this.m_keyWords[0]=="["&&this.m_keyWords[this.m_keyWords.length-1]=="]"?m.m_val.indexOf(`
`)==-1?D.MxUiVue.acutPrintf(`
`+m.m_val+" "+this.m_keyWords+":"):D.MxUiVue.acutPrintf(m.m_val+" "+this.m_keyWords+":"):m.m_val.indexOf(`
`)==-1?D.MxUiVue.acutPrintf(`
`+m.m_val+":"):D.MxUiVue.acutPrintf(m.m_val+":")},B.prototype.go=function(m){this.initGo(),this.m_retcall=m,this.m_currSamplerPoint=null,L.MxJigCmdManager.runCmd(this)},B.prototype.onExitCommand=function(){var m=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var E=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){J.prototype.onExitCommand.call(m,!1),E=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!E&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),E||J.prototype.onExitCommand.call(this,!0)},B.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),J.prototype.onStartCommand.call(this)},B.prototype.sampler=function(){var m=L.MxJigCmdManager.acquirePoint(this.m_toucheType,!1);m.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_currSamplerPoint==null?this.m_currSamplerPoint=new w.Vector3(m.pt.x,m.pt.y,0):(this.m_currSamplerPoint.x=m.pt.x,this.m_currSamplerPoint.y=m.pt.y));var E=this.acquireKeyword();return this.procInKeyword(E),E.status,L.MxJigCmdManager.DragStatus.kKW1,E.status},B.prototype.done=function(m){if(this.m_retcall!=null)return m>=L.MxJigCmdManager.DragStatus.kKW1&&(m=L.MxJigCmdManager.DragStatus.kNormal),this.m_resultDragStatus=m,L.MxJigCmdManager.DoneStatius.kExitCommand;G.MxFun.Assert(0)},B.prototype.upDisplay=function(){this.m_currSamplerPoint&&this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_currSamplerPoint))},B);function B(){var m=J.call(this)||this;return m.m_currSamplerPoint=null,m.m_retcall=null,m.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,m.m_cursorType=D.MxUiVue.CursorType.kCross,m.setUserInputControls(0),m.setDisableDynInput(!0),m}o.MrxDbgUiPrKeyWord=T;var N,u=(v(c,N=k.MrxDbgUiPrBase),c.prototype.value=function(){return this.m_value},c.prototype.basePt=function(){return new w.Vector3(this.m_basePt.x,this.m_basePt.y,0)},c.prototype.setBasePt=function(m){this.m_basePt==null?this.m_basePt=new w.Vector3(m.x,m.y,0):(this.m_basePt.x=m.x,this.m_basePt.y=m.y),this.m_useBasePt=!0},c.prototype.setUseBasePt=function(m){this.m_useBasePt=m},c.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null,this.clearLastInputPoint(),this.m_useBasePt&&this.SetLASTPOINT(this.m_basePt)},c.prototype.go=function(m){this.initGo(),this.m_retcall=m,this.m_previousInPoint=null,this.m_currentInPoint=null,this.m_value=0,L.MxJigCmdManager.runCmd(this)},c.prototype.onExitCommand=function(){var m=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var E=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){N.prototype.onExitCommand.call(m,!1),E=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!E&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),E||N.prototype.onExitCommand.call(this,!0)},c.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),N.prototype.onStartCommand.call(this)},c.prototype.sampler=function(){var m,E=L.MxJigCmdManager.acquirePoint(this.m_toucheType,!1);return E.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_currSamplerPoint==null?this.m_currSamplerPoint=new w.Vector3(E.pt.x,E.pt.y,0):(this.m_currSamplerPoint.x=E.pt.x,this.m_currSamplerPoint.y=E.pt.y)),m=this.m_useBasePt?this.acquireAngle(this.m_toucheType,this.m_basePt):this.acquireAngle(this.m_toucheType,this.m_currentInPoint),this.procInKeyword(m),m.status==L.MxJigCmdManager.DragStatus.kNormal?(this.m_value=m.ang,m.status):m.status==L.MxJigCmdManager.DragStatus.kKW1?m.status:this.m_useBasePt||this.m_currentInPoint?E.status:((m=this.acquirePoint(this.m_toucheType,!1)).status==L.MxJigCmdManager.DragStatus.kNormal&&m.exit&&(this.m_previousInPoint==null?this.m_previousInPoint=new w.Vector3(m.pt.x,m.pt.y,0):(this.m_previousInPoint.x=m.pt.x,this.m_previousInPoint.y=m.pt.y)),m.status)},c.prototype.done=function(m){if(this.m_retcall!=null)return this.m_resultDragStatus=m,this.m_useBasePt||m!=L.MxJigCmdManager.DragStatus.kNormal||!this.m_previousInPoint||this.m_currentInPoint?L.MxJigCmdManager.DoneStatius.kExitCommand:(this.m_currentInPoint=this.m_previousInPoint,this.m_previousInPoint=null,L.MxJigCmdManager.DoneStatius.kContinueCommand);G.MxFun.Assert(0)},c.prototype.upDisplay=function(){this.m_currSamplerPoint&&(this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_currSamplerPoint)),this.m_useBasePt&&this.m_basePt?this.drawEntity(f.MxThreeJS.createLine(this.m_currSamplerPoint,this.m_basePt,16777215)):this.m_currentInPoint&&this.drawEntity(f.MxThreeJS.createLine(this.m_currSamplerPoint,this.m_currentInPoint,16777215)))},c);function c(){var m=N.call(this)||this;return m.m_useBasePt=!1,m.m_basePt=null,m.m_previousInPoint=null,m.m_currentInPoint=null,m.m_value=0,m.m_currSamplerPoint=null,m.m_retcall=null,m.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,m.m_cursorType=D.MxUiVue.CursorType.kCross,m}o.MrxDbgUiPrAngle=u},{"../MxFun":27,"../MxString":34,"../MxThreeJS":37,"../UI/MxUiVue":65,"./MrxDbgUiPrBase":45,"./MxJigCmdManager":54,three:19}],47:[function(b,r,o){var a,v=this&&this.__extends||(a=function(V,R){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,ee){M.__proto__=ee}||function(M,ee){for(var F in ee)Object.prototype.hasOwnProperty.call(ee,F)&&(M[F]=ee[F])})(V,R)},function(V,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function M(){this.constructor=V}a(V,R),V.prototype=R===null?Object.create(R):(M.prototype=R.prototype,new M)});Object.defineProperty(o,"__esModule",{value:!0}),o.MrxDbgUiPrPoint=void 0;var h,w=b("three"),L=b("./MxJigCmdManager"),G=b("../MxFun"),k=b("./MrxDbgUiPrBase"),D=b("../UI/MxUiVue"),f=b("../MxThreeJS"),O=b("../MxManager"),C=(v(j,h=k.MrxDbgUiPrBase),j.prototype.value=function(){return new w.Vector3(this.m_value.x,this.m_value.y,0)},j.prototype.getCADValue=function(){return O.MxManager.getMxCpp().newMcGePoint3d(new w.Vector3(this.m_value.x,this.m_value.y,0))},j.prototype.basePt=function(){return new w.Vector3(this.m_basePt.x,this.m_basePt.y,0)},j.prototype.setBasePt=function(V){this.m_basePt==null?this.m_basePt=new w.Vector3(V.x,V.y,0):(this.m_basePt.x=V.x,this.m_basePt.y=V.y),this.m_useBasePt=!0},j.prototype.setUseBasePt=function(V){this.m_useBasePt=V},j.prototype.initGo=function(){this.m_keyWordPicked="",this.m_retcall=null,this.m_retWhileCall=null,this.m_exitCall=null,this.m_useBasePt&&this.SetLASTPOINT(this.m_basePt)},j.prototype.go=function(V){this.initGo(),this.m_retcall=V,L.MxJigCmdManager.runCmd(this)},j.prototype.goWhile=function(V,R){this.initGo(),this.m_retWhileCall=V,R&&(this.m_exitCall=R),L.MxJigCmdManager.runCmd(this)},j.prototype.onExitCommand=function(){var V=this;D.MxUiVue.setCursorType(D.MxUiVue.CursorType.kNormal);var R=!1;this.m_retcall!=null&&(L.MxJigCmdManager.setRunCmdEvent(function(){h.prototype.onExitCommand.call(V,!1),R=!0}),this.m_retcall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.setRunCmdEvent(void 0)),!R&&L.MxJigCmdManager.isWaitCmdNull()&&D.MxUiVue.restoreCmdStatus(),R||h.prototype.onExitCommand.call(this,!0)},j.prototype.onStartCommand=function(){D.MxUiVue.setCursorType(this.m_cursorType),this.printMessage(),L.MxJigCmdManager.setKeywordList(this.keyWords()),this.m_useBasePt&&this.SetLASTPOINT(this.m_basePt),h.prototype.onStartCommand.call(this)},j.prototype.sampler=function(){var V=this.acquirePoint(this.m_toucheType);return this.procInKeyword(V),V.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.m_value==null?this.m_value=new w.Vector3(V.pt.x,V.pt.y,0):(this.m_value.x=V.pt.x,this.m_value.y=V.pt.y)),V.status},j.prototype.done=function(V){if(this.m_retcall!=null)return this.m_resultDragStatus=V,this.m_exitCall&&this.m_exitCall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.DoneStatius.kExitCommand;if(this.m_retWhileCall!=null){if((this.m_resultDragStatus=V)==L.MxJigCmdManager.DragStatus.kCancel)return this.m_exitCall&&this.m_exitCall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.DoneStatius.kExitCommand;var R=!1;V==L.MxJigCmdManager.DragStatus.kNull&&(R=!0);var M=this.m_retWhileCall(this.getReturnStatus(this.m_resultDragStatus));return M!=null&&M.exit!=null&&(R=M.exit),R?(this.m_exitCall&&this.m_exitCall(this.getReturnStatus(this.m_resultDragStatus)),L.MxJigCmdManager.DoneStatius.kExitCommand):(L.MxJigCmdManager.setKeywordList(this.keyWords()),this.printMessage(),L.MxJigCmdManager.DoneStatius.kContinueCommand)}G.MxFun.Assert(0)},j.prototype.upDisplay=function(){if(this.m_value&&(this.m_pWorldDraw&&(this._mxObject.getMcObject().onReadyJigUpdateDispla(),this.m_pWorldDraw.worldDraw(this.m_value)),this.m_useBasePt&&this.m_basePt)){var V=16777215;this._mxObject.isWhiteViewColor()&&(V=0);var R=this._mxObject;this.drawEntity(f.MxThreeJS.createLine(R.toSmallcoord(this.m_value),R.toSmallcoord(this.m_basePt),V),void 0,!0)}},j);function j(){var V=h.call(this)||this;return V.m_useBasePt=!1,V.m_basePt=null,V.m_value=null,V.m_retcall=null,V.m_retWhileCall=null,V.m_exitCall=null,V.m_resultDragStatus=L.MxJigCmdManager.DragStatus.kCancel,V.m_cursorType=D.MxUiVue.CursorType.kCross,V}o.MrxDbgUiPrPoint=C},{"../MxFun":27,"../MxManager":29,"../MxThreeJS":37,"../UI/MxUiVue":65,"./MrxDbgUiPrBase":45,"./MxJigCmdManager":54,three:19}],48:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxCmdRunManager=void 0;var a,v,h,w,L,G,k,D,f,O=b("../MxFun"),C=b("../MxType"),j=b("./MxJigCmdManager"),V=b("../UI/MxUiVue"),R=b("../MxDrawData");v=a||(o.MxCmdRunManager=a={}),h={},w=new Array,L=0,G=!1,k="",D={},f={},v.InitQuickCommand=function(M){if(M)if(M instanceof Array)for(var ee=M.length,F=0;F<ee;F++){var _=M[F];if(!(_.length<2)){var J=_[0];if(J.length!=0)for(var T=_.length,B=1;B<T;B++)_[B].length!=0&&(D[_[B].toUpperCase()]=J)}}else console.log("Mx:QuickCommand data error,Not an array");else console.log("Mx:QuickCommand data error")},v.InitLanguageString=function(M){this.m_mapLanguageString=M},v.getLanguageString=function(M,ee){var F=f[M];return F===void 0&&(F=ee),F},v.MoveUpKey=function(){return G?++L>=w.length&&(L=0):G=!0,!0},v.MoveDownKey=function(){return!!G&&(--L<0&&(L=w.length-1),!0)},v.GetListCommad=function(){return L<0||L>=w.length?"":w[L]},v.ClearPrvCmd=function(){k=""},v.GetPrvCmd=function(){return k},v.SetPrvCmd=function(M){k=M},v.runCmd=function(M,ee,F){var _=ee.toUpperCase(),J=h[_];if(M&&J==null){var T=D[_];if(T!=null&&(J=h[T.toUpperCase()]),J==null)return V.MxUiVue.isNull()?console.log(O.MxFun.formatString('未知命令"{0}"',ee)):V.MxUiVue.acutPrintf(`未知命令"{0}"。
命令:`,ee),!1}if(!J)return!1;M.endPanCommand(),M.getTempMarkDraw().clear(!1);var B=w.indexOf(J.cmd);-1<B&&w.splice(B,1),G=!(L=0),w.push(J.cmd),!(J.flag&C.MxType.MxCommandFlag.MCRX_CMD_NO_RECORD_PRVCMD)&&(k=J.cmd);var N=J.fun;M&&!(J.flag&C.MxType.MxCommandFlag.MCRX_CMD_TRANSPARENT)&&V.MxUiVue.acutPrintf(`{0}
`,J.cmd),j.MxJigCmdManager.stopCmd(j.MxJigCmdManager.DetailedResult.kNewCommadIn),M.callEvent("commandWillStart",{cmd:J.cmd}),M.getMcObject().fireStartRunCommand(J.cmd,J.flag);var u=M.sysVariable().getSysVarNumber("GETPOINTSTATUS");if(u&=~j.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint,u&=~j.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastMovePoint,M.sysVariable().setSysVarNumber("GETPOINTSTATUS",u),M&&(J.flag&C.MxType.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT)==0){var c=!1,m=M.getMxAllSelect();if(M.getMxDatabase().getGripManager().removeAllGrips()&&(c=!0),M.getMxDatabase().getSelectManager().removeAllEntity()&&(c=!0),M.isValidMcObject()){var E=M.getMcObject().getGripManager().getAllSelect();M.getMcObject().getGripManager().setPrvCommandSelect(E),M.getMcObject().getGripManager().clearAll()&&(c=!0)}M.getMxDatabase().getSelectManager().setPrvCommandSelect(m),c&&(M.getMxDatabase().getGripManager().fireMxEntitySelectChange(),M.updateDisplay())}try{N(F)}catch(U){console.log("mx: run cmd error"),console.log(U)}return M.getMcObject().fireEndRunCommand(J.cmd,J.flag),M&&(j.MxJigCmdManager.isRunning()||V.MxUiVue.restoreCmdStatus(),M.updateDisplay(),R.MxDrawData.m_isAutoResetRenderer||M.resetRenderer()),!0},v.addCommand=function(M,ee,F){F==null&&(F=C.MxType.MxCommandFlag.MCRX_CMD_MODAL);var _=M.toUpperCase();h[_]={fun:ee,cmd:M,flag:F}}},{"../MxDrawData":22,"../MxFun":27,"../MxType":39,"../UI/MxUiVue":65,"./MxJigCmdManager":54}],49:[function(b,r,o){var a,v=this&&this.__extends||(a=function(T,B){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,u){N.__proto__=u}||function(N,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(N[c]=u[c])})(T,B)},function(T,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function N(){this.constructor=T}a(T,B),T.prototype=B===null?Object.create(B):(N.prototype=B.prototype,new N)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObjectOsnap=o.McDbLine=o.McDbCurve=o.McDbEntity=o.McDbType=void 0;var h,w,L=b("three"),G=b("../MxThreeJS"),k=b("../MxDrawData"),D=b("./MxJigCmdManager"),f=b("./McEdJigOsnap");(w=h||(o.McDbType=h={}))[w.kInValid=0]="kInValid",w[w.kLine=1]="kLine";var O=(C.prototype.getType=function(){return this.m_type},C);function C(){this.m_type=h.kInValid}o.McDbEntity=O;var j,V=(v(R,j=O),R);function R(){return j!==null&&j.apply(this,arguments)||this}o.McDbCurve=V;var M,ee=(v(F,M=V),F);function F(){var T=M.call(this)||this;return T.m_type=h.kLine,T}o.McDbLine=ee;var _=(J.prototype.getBlobHead=function(T,B){var N={};return N.type=T.getInt32(B,!0),B+=4,N.ver=T.getInt32(B,!0),B+=4,N.databaseIndex=T.getInt32(B,!0),B+=4,N.nOffset=B,N},J.prototype.clearData=function(){this.threejsObjects=new L.Object3D},J.prototype.calculateDistance=function(T,B,N){var u=new L.Vector3().subVectors(B,T),c=new L.Vector3().subVectors(N,T),m=u.clone().normalize(),E=c.clone().normalize(),U=m.dot(E),X=new L.Vector3().subVectors(N,B),W=new L.Vector3().subVectors(T,B),te=X.clone().normalize(),ne=W.clone().normalize();if(0<te.dot(ne)&&0<U){var ce=Math.sqrt(1-U*U),we=T.distanceTo(N),Ie=we*ce,xe=we*U,Be=u.clone().normalize().multiplyScalar(xe),q=T.clone().add(Be),ge=u.clone().normalize().multiplyScalar(200+xe);return{pt1:T,pt2:B,pt:N,distance:Ie,targetPt:q,warningPt:T.clone().add(ge)}}return null},J.prototype.getOsnapData=function(T,B){if(this.threejsObjects){var N=new L.Raycaster,u=k.MxDrawData.m_dInputRectWidth;N.linePrecision=this.mxObj.screenCoordLong2World(u);var c=this.mxObj.getCanvas(),m=c.clientWidth,E=c.clientHeight,U=this.mxObj.screenCoord2World(T.x,T.y);U.z=0,T=new L.Vector2(T.x/m*2-1,-T.y/E*2+1),N.setFromCamera(T,this.mxObj.getCamera());var X=N.intersectObjects(this.threejsObjects.children,!0),W=this.mxObj.getSysVarLong("OSMODE"),te=new Map;if(X.length)for(var ne=0;ne<X.length;ne++){var ce=X[ne];if(ce.object.userData&&ce.object.userData.obj.getType()==h.kLine){var we=ce.object.userData.obj;if(W&f.MxOsnapDefine.OsModeEnd){var Ie=U.distanceTo(we.pt1);we.pt1.type=D.MxJigCmdManager.OsnapMode.kOsModeEnd,te.set(Ie,we.pt1);var xe=U.distanceTo(we.pt2);we.pt2.type=D.MxJigCmdManager.OsnapMode.kOsModeEnd,te.set(xe,we.pt2)}if(W&f.MxOsnapDefine.OsModeNear&&(!we.bulge||we.bulge==0)){var Be=this.calculateDistance(we.pt1,we.pt2,U);Be&&(Be.targetPt.type=D.MxJigCmdManager.OsnapMode.kOsModeNear,te.set(Be.distance,Be.targetPt))}}}if(te.size){var q=this.mxObj.screenCoordLong2World(u),ge=Array.from(te);ge.sort(function(oe,se){return oe[0]-se[0]}),ge[0][0]<q&&B(ge[0][1],ge[0][1].type)}}},J.prototype.mxWebEntitysData=function(T,B){var N=this.getBlobHead(T,0);T.getInt32(N.nOffset,!0),N.nOffset+=4;var u=T.getInt32(N.nOffset,!0);N.nOffset+=4;var c=T.getInt32(N.nOffset,!0);if(N.nOffset+=4,1<c)console.log("mx:error mxfun.js version is old!");else{var m=T.getInt32(N.nOffset,!0);if(N.nOffset+=4,m==N.nOffset){this.threejsObjects=new L.Object3D;for(var E=0;E<u;E++){var U=T.getInt8(N.nOffset);N.nOffset+=1;var X=T.getInt32(N.nOffset,!0);if(N.nOffset+=4,U==1){var W=T.getFloat32(N.nOffset,!0);N.nOffset+=4;var te=T.getFloat32(N.nOffset,!0);N.nOffset+=4;var ne=T.getFloat32(N.nOffset,!0);N.nOffset+=4;var ce=T.getFloat32(N.nOffset,!0);N.nOffset+=4,(se=new ee).pt1=new L.Vector3(W,te,0),se.pt2=new L.Vector3(ne,ce,0),(Ae=G.MxThreeJS.createLine(se.pt1,se.pt2,16777215)).userData.obj=se,this.threejsObjects.add(Ae)}else if(U==2){var we=T.getInt8(N.nOffset);N.nOffset+=1;var Ie=T.getInt32(N.nOffset,!0);N.nOffset+=4;for(var xe=new L.Vector3,Be=0,q=null,ge=0;ge<Ie;ge++){var oe=new L.Vector3;oe.x=T.getFloat32(N.nOffset,!0),N.nOffset+=4,oe.y=T.getFloat32(N.nOffset,!0),N.nOffset+=4;var se,Ae,Ye=T.getFloat32(N.nOffset,!0);N.nOffset+=4,0<ge&&((se=new ee).pt1=xe.clone(),se.pt2=oe.clone(),se.bulge=Ye,(Ae=G.MxThreeJS.createLine(se.pt1,se.pt2,16777215)).userData.obj=se,this.threejsObjects.add(Ae)),xe=oe,Be=Ye,ge==0&&(q=oe)}we&&2<Ie&&((se=new ee).pt1=q.clone(),se.pt2=xe.clone(),se.bulge=Be,(Ae=G.MxThreeJS.createLine(se.pt1,se.pt2,16777215)).userData.obj=se,this.threejsObjects.add(Ae))}else console.log("mx:error mxWebEntitysData type"),N.nOffset=N.nOffset-5+X}}else console.log("mx: mxWebEntitysData size assert(0)")}},J);function J(T){this.threejsObjects=null,this.mxObj=null,this.mxObj=T}o.MxDrawObjectOsnap=_},{"../MxDrawData":22,"../MxThreeJS":37,"./McEdJigOsnap":43,"./MxJigCmdManager":54,three:19}],50:[function(b,r,o){var a,v=this&&this.__extends||(a=function(O,C){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,V){j.__proto__=V}||function(j,V){for(var R in V)Object.prototype.hasOwnProperty.call(V,R)&&(j[R]=V[R])})(O,C)},function(O,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function j(){this.constructor=O}a(O,C),O.prototype=C===null?Object.create(C):(j.prototype=C.prototype,new j)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxEntSelJig=void 0;var h,w=b("./MxJig"),L=b("./MxJigCmdManager"),G=b("../UI/MxUiVue"),k=b("../MrxDbgUtils"),D=(v(f,h=w.McEdJigCommand),f.prototype.sampler=function(){var O=L.MxJigCmdManager.InType.kGetBegan,C=this.acquirePoint(O);return C.status==L.MxJigCmdManager.DragStatus.kNormal&&(this.point=C.pt),C.status},f.prototype.done=function(O){if(O==L.MxJigCmdManager.DragStatus.kNormal){var C=this;k.MrxDbgUtils.findEntAtPoint(this.getMxObject(),this.point,this.filter).then(function(j){C.callRet(j)})}else this.callRet([]);return L.MxJigCmdManager.DoneStatius.kExitCommand},f.prototype.onStartCommand=function(){G.MxUiVue.setCursorType(G.MxUiVue.CursorType.kRect),h.prototype.onStartCommand.call(this)},f.prototype.onExitCommand=function(){G.MxUiVue.setCursorType(G.MxUiVue.CursorType.kNormal),L.MxJigCmdManager.isWaitCmdNull()&&G.MxUiVue.restoreCmdStatus(),h.prototype.onExitCommand.call(this,!0)},f.prototype.upDisplay=function(){},f);function f(){return h!==null&&h.apply(this,arguments)||this}o.MxEntSelJig=D},{"../MrxDbgUtils":20,"../UI/MxUiVue":65,"./MxJig":53,"./MxJigCmdManager":54}],51:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxGridTrace=void 0;var a=b("three"),v=b("./MxJigCmdManager"),h=b("../MxFun"),w=b("../MxDrawData"),L=b("../MxThreeJS"),G=(k.prototype.ClearDynDrawEntity=function(){for(var D=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),f=this.m_vecDynDrawEntity.length,O=0;O<f;O++)h.MxFun.removeThreejsObject(this.m_vecDynDrawEntity[O],D);this.m_vecDynDrawEntity=[]},k.prototype.GetSanpValue=function(D,f){var O=D%f;return 0<=O?f/2<O?D+=f-O:D-=O:f/2<(O=Math.abs(O))?D-=f-O:D+=O,D},k.prototype.CreteTracePoint=function(D,f){var O=this.m_mxJig.getMxObject(),C=O.getTheTempDrawContainer_SmallCoord();f/=2;var j=L.MxThreeJS.createLine(O.toSmallcoord2(D.x+f,D.y+f,0),O.toSmallcoord2(D.x-f,D.y-f,0),16711680);C.add(j),this.m_vecDynDrawEntity.push(j);var V=L.MxThreeJS.createLine(O.toSmallcoord2(D.x-f,D.y+f,0),O.toSmallcoord2(D.x+f,D.y-f,0),16711680);C.add(V),this.m_vecDynDrawEntity.push(V)},k.prototype.MouseMove=function(D){var f=this.m_mxJig.getMxObject();if(f.getMcObject().isValid()){if(this.ClearDynDrawEntity(),this.m_isValidTracePoint=!1,this.m_isTrace){var O=f.getSysVarPoint("SNAPUNIT");if(!(O.x<1e-6||O.y<1e-6)){D.z=0;var C=new a.Vector3;C.x=this.GetSanpValue(D.x,O.x),C.y=this.GetSanpValue(D.y,O.y);var j=f.viewCoordLong2Cad(w.MxDrawData.m_dInputRectWidth),V=2*j;C.distanceTo(D)<V&&(this.m_isValidTracePoint=!0,this.m_ptTracePoint=C,this.CreteTracePoint(C,j))}}}else this.m_isTrace=!1},k.prototype.Init=function(){var D=this.m_mxJig.getMxObject();D.getMcObject().isValid()?(this.m_isValidTracePoint=!1,this.m_isTrace=!1,D.getSysVarLong("GRIDMODE")!=0&&(this.m_isTrace=!0),D.sysVariable().getSysVarNumber("GETPOINTSTATUS")&v.MxJigCmdManager.GETPOINTSTATUS.OsModeGridSnapTempDisable&&(this.m_isTrace=!1),this.m_mxJig.isDisableGridTrace()&&(this.m_isTrace=!1),this.m_isTrace):this.m_isTrace=!1},k.prototype.GetTracePoint=function(){if(this.m_isTrace)return this.m_isValidTracePoint?this.m_ptTracePoint:void 0},k.prototype.ClearDisplay=function(){this.ClearDynDrawEntity()},k.prototype.ReSetTempDisplay=function(){this.ClearDynDrawEntity(),this.m_isValidTracePoint=!1},k);function k(D){this.m_vecDynDrawEntity=[],this.m_ptTracePoint=new a.Vector3,this.m_isValidTracePoint=!1,this.m_isTrace=!1,this.m_mxJig=null,this.m_mxJig=D}o.MxGridTrace=G},{"../MxDrawData":22,"../MxFun":27,"../MxThreeJS":37,"./MxJigCmdManager":54,three:19}],52:[function(b,r,o){var a,v=this&&this.__extends||(a=function(C,j){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(V,R){V.__proto__=R}||function(V,R){for(var M in R)Object.prototype.hasOwnProperty.call(R,M)&&(V[M]=R[M])})(C,j)},function(C,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");function V(){this.constructor=C}a(C,j),C.prototype=j===null?Object.create(j):(V.prototype=j.prototype,new V)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxIntelliSelectJig=void 0;var h,w=b("three"),L=b("./MxJig"),G=b("./MxJigCmdManager"),k=b("../MxThreeJS"),D=b("../MxTools"),f=(v(O,h=L.McEdJigCommand),O.prototype.sampler=function(){var C=G.MxJigCmdManager.InType.kGetBegan,j=this.acquirePoint(C);return j.status==G.MxJigCmdManager.DragStatus.kNormal&&(this.m_pt2=j.pt),j.status},O.prototype.getTypeName=function(){return"MxIntelliSelect"},O.prototype.done=function(C){if(C==G.MxJigCmdManager.DragStatus.kNormal){var j=this.getMxObject();j.getMxDatabase().getGripManager().doWindowsSelect(this.m_pt1,this.m_pt2),j.getMcObject().getGripManager().doRangeSelect(this.m_pt1,this.m_pt2)}return G.MxJigCmdManager.DoneStatius.kExitCommand},O.prototype.doPointSelect=function(C,j,V){var R=C.viewCoordLong2Cad(16),M={x:j.x,y:j.y,tol:R};C.callCommand("MxCAD_IntelliSelect_Point",JSON.stringify(M),function(ee){V(ee)})},O.prototype.upDisplay=function(){var C=this.getMxObject(),j=this.m_pt1.clone(),V=this.m_pt2.clone(),R=new w.Vector3(this.m_pt1.x,this.m_pt2.y,this.m_pt2.z),M=new w.Vector3(this.m_pt2.x,this.m_pt1.y,this.m_pt2.z);if(!D.MxTools.IsZero(C.getViewAngle())){var ee=new w.Matrix4;ee.makeRotationZ(C.getViewAngle());var F=new w.Matrix4().makeTranslation(j.x,j.y,0).multiply(ee).multiply(new w.Matrix4().makeTranslation(-j.x,-j.y,0));j.applyMatrix4(F),V.applyMatrix4(F),R=new w.Vector3(j.x,V.y,V.z),M=new w.Vector3(V.x,j.y,V.z);var _=new w.Matrix4;_.getInverse(F),j.applyMatrix4(_),V.applyMatrix4(_),R.applyMatrix4(_),M.applyMatrix4(_)}var J=[];J.push(j),J.push(R),J.push(V),J.push(M),J.push(j);var T=null,B=65280;if(V.x>j.x)T=k.MxThreeJS.createLines(J,16777215),B=255;else{var N=this.getMxObject().viewCoordLong2Cad(3);T=k.MxThreeJS.createDashedLines(J,16777215,2*N,N)}var u=[];u.push(j),u.push(R),u.push(V),u.push(j),u.push(V),u.push(M);var c=k.MxThreeJS.createTriangle(u,B,.27);this.drawEntity(c,30),this.drawEntity(T,31)},O);function O(C){var j=h.call(this)||this;return j.m_pt1=C,j.m_pt2=C,j}o.MxIntelliSelectJig=f},{"../MxThreeJS":37,"../MxTools":38,"./MxJig":53,"./MxJigCmdManager":54,three:19}],53:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.McEdJigCommand=o.MxDynamicInput=void 0;var a=b("three"),v=b("../MxFun"),h=b("./MxJigCmdManager"),w=b("../MxManager"),L=b("../MxTools"),G=b("../UI/MxUiVue"),k=b("./McEdJigOsnap"),D=b("./McEdJigDynamicTrace"),f=b("./MxPolarAxisTrace"),O=b("./MxGridTrace"),C=b("../MxThreeJS"),j=b("../MxDrawData"),V=b("./MxOffsetArrow"),R=(M.prototype.getFocusIndex=function(){return this.m_isShowDynInput?this.m_iFocusIndex:-1},M.prototype.ClearDynDrawEntity=function(){for(var _=this.m_jig.getMxObject().getTheTempDrawContainer_SmallCoord(),J=this.m_vecDynDrawEntity.length,T=0;T<J;T++)v.MxFun.removeThreejsObject(this.m_vecDynDrawEntity[T],_);this.m_vecDynDrawEntity=[]},M.prototype.ClearDisplay=function(){this.ClearDynDrawEntity()},M.prototype.onKeyEcsDown=function(){return this.m_isShowDynInput&&this.m_isInputStatus?(this.m_isInputStatus=!1,G.MxUiVue.OnMxEvent({name:"dynInputReSet"}),1):0},M.prototype.onKeyDonw=function(_){if(!this.m_isShowDynInput||_==27||_==16||_==17||_==18)return 0;if(_!=32&&_!=13)return this.m_isInputStatus=!0,0;if(this.m_isInputStatus&&G.MxUiVue.DynamicInput_isShow())if(G.MxUiVue.DynamicInput_getType()==h.MxJigCmdManager.DynamicInputType.kXYCoordInput){var J=G.MxUiVue.DynamicInput_getValue1(),T=G.MxUiVue.DynamicInput_getValue2(),B=G.MxUiVue.DynamicInput_getFocusValue(),N=G.MxUiVue.DynamicInput_getFocusIndex(),u="";B.length!=0?u=L.MxTools.IsNumerical(B)?N==0?v.MxFun.formatString("{0},{1}",B,T):v.MxFun.formatString("{0},{1}",J,B):B:L.MxTools.IsNumerical(J)&&L.MxTools.IsNumerical(T)&&(u=v.MxFun.formatString("{0},{1}",J,T)),this.m_iFocusIndex=N,G.MxUiVue.setCmdText(u)}else G.MxUiVue.DynamicInput_getType()==h.MxJigCmdManager.DynamicInputType.kDistanceInput&&(B=G.MxUiVue.DynamicInput_getFocusValue(),this.m_iFocusIndex=G.MxUiVue.DynamicInput_getFocusIndex(),G.MxUiVue.setCmdText(B));return this.m_isInputStatus=!1,0},M.prototype.isInputStatus=function(){return this.m_isInputStatus},M.prototype.isTruncatedInput=function(){return this.m_isShowDynInput&&this.m_isInputStatus},M.prototype.initDynInput=function(_){this.m_jig=_;var J=this.m_jig.getMxObject();if(this.m_iFocusIndex=-1,this.m_isShowDynInput=!1,!G.MxUiVue.isNull()){G.MxUiVue.DynamicInput_setType(this.m_dynType);var T=J.sysVariable().getSysVarNumber("GETPOINTSTATUS");T&h.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint&&G.MxUiVue.SetLasetPoint(J.sysVariable().getSysVarPoint("LASTPOINT")),this.m_dynType==h.MxJigCmdManager.DynamicInputType.kAutoInput&&(T&h.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint?G.MxUiVue.DynamicInput_setType(h.MxJigCmdManager.DynamicInputType.kDistanceInput):G.MxUiVue.DynamicInput_setType(h.MxJigCmdManager.DynamicInputType.kXYCoordInput))}},M.prototype.setFocus=function(_){G.MxUiVue.OnMxEvent({name:"dynInputSetFocus",param:{isFocus:_}})},M.prototype.exitDynInput=function(){G.MxUiVue.DynamicInput_setShow(!1),G.MxUiVue.DynamicInput_upDisplay()},M.prototype.isShow=function(){return G.MxUiVue.DynamicInput_isShow()},M.prototype.drawSolidPoint=function(_,J,T,B){var N=C.MxThreeJS.createPoint(B.toSmallcoord(_),this.m_iDashedLineLenColor,J);T.add(N),this.m_vecDynDrawEntity.push(N)},M.prototype.drawDashedLine=function(_,J,T,B,N,u){var c=C.MxThreeJS.createDashedLine(u.toSmallcoord2(_.x,_.y,_.z),u.toSmallcoord2(J.x,J.y,J.z),this.m_iDashedLineLenColor,B,B);T.add(c),this.m_vecDynDrawEntity.push(c)},M.prototype.worldDrawDistanceInput=function(_,J){var T=this.m_jig.getMxObject();if(T.getMcObject().isValid()&&((_=_.clone()).z=0,(J=J.clone()).z=0,!(T.docCoordLong2Screen(_.distanceTo(J))<20))){var B=T.getTheTempDrawContainer_SmallCoord(),N=T.viewCoordLong2Cad(this.m_dashedLineLen),u=_.clone().sub(J),c=u.clone();c.applyAxisAngle(new a.Vector3(0,0,1),.5*Math.PI),c.normalize(),c.multiplyScalar(T.viewCoordLong2Cad(50));var m=new a.Vector3(0,1,0),E=new a.Vector3(1,0,0);c.dot(m)<0&&c.multiplyScalar(-1),u.dot(m)<0&&c.multiplyScalar(-1),u.dot(E)<0&&c.multiplyScalar(-1);var U=J.clone().add(c),X=_.clone().add(c),W=J.distanceTo(_),te=new a.Vector3(J.x+W,J.y,J.z);this.drawSolidPoint(J.clone().add(c),3,B,T),this.drawSolidPoint(_.clone().add(c),3,B,T),this.drawSolidPoint(te,3,B,T),this.drawDashedLine(U,X,B,N,N,T),this.drawDashedLine(J,U,B,N,N,T),this.drawDashedLine(_,X,B,N,N,T),this.drawDashedLine(J,te,B,N,N,T);var ne=_.clone().sub(J),ce=0;1e-6<ne.length()&&(ce=ne.angleTo(new a.Vector3(1,0,0)));var we=0,Ie=ce;ne.dot(m)<0&&(we=2*Math.PI-ce,Ie=ce);var xe=C.MxThreeJS.createDashedArc(T.toSmallcoord(J),W,we,Ie,this.m_iDashedLineLenColor,N,N);B.add(xe),this.m_vecDynDrawEntity.push(xe)}},M.prototype.upDynInput=function(){if(!G.MxUiVue.isNull()){var _=this.m_jig.getMxObject(),J=!1;if(J=!this.m_jig.isDisableDynInput()&&_.getSysVarLong("DYNINPUT")==1,j.MxDrawData.m_isForbiddenDynInput&&(J=!1),v.MxFun.isPC()||(J=!1),G.MxUiVue.DynamicInput_setShow(J),this.m_isShowDynInput=J){if(G.MxUiVue.DynamicInput_setTip(G.MxUiVue.getCmdTip()),h.MxJigCmdManager.getAcquireStatus()==h.MxJigCmdManager.AcquireStatus.kMove){var T=h.MxJigCmdManager.getAcquirePoint();if(G.MxUiVue.DynamicInput_setPos(_.currentCoord2Screen(T.x,T.y,T.z)),G.MxUiVue.DynamicInput_getType()==h.MxJigCmdManager.DynamicInputType.kXYCoordInput)G.MxUiVue.DynamicInput_setValue1(T.x.toFixed(3)),G.MxUiVue.DynamicInput_setValue2(T.y.toFixed(3));else if(G.MxUiVue.DynamicInput_getType()==h.MxJigCmdManager.DynamicInputType.kDistanceInput){var B=h.MxJigCmdManager.getAcquirePoint(),N=G.MxUiVue.GetLasetPoint();this.worldDrawDistanceInput(B,N);var u=new a.Vector3(N.x+.5*(B.x-N.x),N.y+.5*(B.y-N.y),N.z+.5*(B.z-N.z)),c=B.clone().sub(N);c.length()<1e-8&&(c=new a.Vector3(1,0,0));var m=c.clone();m.applyAxisAngle(new a.Vector3(0,0,1),.5*Math.PI),m.normalize(),m.multiplyScalar(_.viewCoordLong2Cad(50));var E=new a.Vector3(0,1,0),U=new a.Vector3(1,0,0);m.dot(E)<0&&m.multiplyScalar(-1),c.dot(E)<0&&m.multiplyScalar(-1),c.dot(U)<0&&m.multiplyScalar(-1),u.add(m);var X=N.distanceTo(B);G.MxUiVue.DynamicInput_setValue1(X.toFixed(3)),G.MxUiVue.DynamicInput_setValue1Pos(_.currentCoord2Screen(u.x,u.y,T.z)),X=N.distanceTo(B);var W=N.clone();W.x+=X;var te=(u=new a.Vector3(W.x+.5*(B.x-W.x),W.y+.5*(B.y-W.y),W.z+.5*(B.z-W.z))).clone().sub(N);te.normalize(),te.multiplyScalar(X),u=N.clone().add(te);var ne=B.clone().sub(N),ce=0;1e-6<ne.length()&&(ce=ne.angleTo(new a.Vector3(1,0,0))),ce=180*ce/Math.PI,G.MxUiVue.DynamicInput_setValue2(ce.toFixed(3)+"°"),G.MxUiVue.DynamicInput_setValue2Pos(_.currentCoord2Screen(u.x,u.y,T.z))}}G.MxUiVue.DynamicInput_upDisplay()}}},M.prototype.setDynamicInputType=function(_){this.m_dynType=_},M.prototype.getDynamicInputType=function(){return this.m_dynType},M);function M(_){this.m_dynType=h.MxJigCmdManager.DynamicInputType.kAutoInput,this.m_isInputStatus=!1,this.m_vecDynDrawEntity=[],this.m_dashedLineLen=1.5,this.m_iDashedLineLenColor=8421504,this.m_iFocusIndex=-1,this.m_isShowDynInput=!1,this.m_jig=_}o.MxDynamicInput=R;var ee=(F.prototype.getTypeName=function(){return""},F.prototype.isExit=function(){return this._isExit},F.prototype.getDetailedResult=function(){return this.m_DetailedResult},F.prototype.clearGroup=function(){this.drawGroup&&(this._mxObject.getTheTempDrawContainer().remove(this.drawGroup),this.drawGroup=null),this.drawGroup_smallCoord&&(this._mxObject.getTheTempDrawContainer().remove(this.drawGroup_smallCoord),this.drawGroup_smallCoord=null)},F.prototype.getParentGroup=function(){return this.drawGroup||(this.drawGroup=new a.Group,this.drawGroup.renderOrder=w.MxData.iGripRenderOrder,this._mxObject.getTheTempDrawContainer().add(this.drawGroup)),this.drawGroup},F.prototype.getParentGroup_smallCoord=function(){return this.drawGroup_smallCoord||(this.drawGroup_smallCoord=new a.Group,this.drawGroup_smallCoord.renderOrder=w.MxData.iGripRenderOrder,this._mxObject.getTheTempDrawContainer_SmallCoord().add(this.drawGroup_smallCoord)),this.drawGroup_smallCoord},F.prototype.onExitCommand=function(_){_&&this.m_dynInput.exitDynInput(),this.m_osnap.endDrag(),this.m_dynamicTrace.ClearDisplay(),this.m_polarAxisTrace.ClearDisplay(),this.m_offsetArrow.ClearDisplay(),this.m_gridTrace.ClearDisplay(),this.m_dynInput.ClearDisplay(),this.clearGroup(),this._mxObject.getMcObject().onJigCommandEnd()},F.prototype.getOsnap=function(){return this.m_osnap},F.prototype.getOrtho=function(){return this.m_ortho},F.prototype.getDynamicTrace=function(){return this.m_dynamicTrace},F.prototype.getPolarAxisTrace=function(){return this.m_polarAxisTrace},F.prototype.getOffsetArrow=function(){return this.m_offsetArrow},F.prototype.getGridTrace=function(){return this.m_gridTrace},F.prototype.onGetOsnapData=function(_){this.m_dynamicTrace.OnDynamicTrace(_.id,new a.Vector3(_.ptsx,_.ptsy,_.ptsz),_.osmode)},F.prototype.isDisableDynInput=function(){return this.m_isDisableDynInput},F.prototype.setDisableDynInput=function(_){this.m_isDisableDynInput=_},F.prototype.setDisableOsnap=function(_){this.m_isDisableOsnap=_},F.prototype.setOffsetInputPostion=function(_){this.m_isOffsetInputPostion=_},F.prototype.isOffsetInputPostion=function(){return this.m_isOffsetInputPostion},F.prototype.isDisableOsnap=function(){return this.m_isDisableOsnap},F.prototype.setDisableDynamicTrace=function(_){this.m_isDisableDynamicTrace=_},F.prototype.isDisableDynamicTrace=function(){return this.m_isDisableDynamicTrace},F.prototype.setDisablePolarAxisTrace=function(_){this.m_isDisablePolarAxisTrace=_},F.prototype.isDisablePolarAxisTrace=function(){return this.m_isDisablePolarAxisTrace},F.prototype.setDisableGridTrace=function(_){this.m_isDisableGridTrace=_},F.prototype.isDisableGridTrace=function(){return this.m_isDisableGridTrace},F.prototype.setDisableOrthoTrace=function(_){this.m_isDisableOrtho=_},F.prototype.isDisableOrthoTrace=function(){return this.m_isDisableOrtho},F.prototype.disableAllTrace=function(_){_===void 0&&(_=!0),this.m_isDisableOsnap=_,this.m_isDisableDynamicTrace=_,this.m_isDisablePolarAxisTrace=_,this.m_isDisableGridTrace=_,this.m_isDisableOrtho=_},F.prototype.onStartCommand=function(){this._isCancle=!1,this._isExit=!1,this.m_DetailedResult=h.MxJigCmdManager.DetailedResult.kUnknown,this.m_dynInput.initDynInput(this),this.m_osnap.startDrag(this.m_isOffsetInputPostion,this);var _=this._mxObject.getCurrentMousePostion();this._mxObject.isValidCurMousePostion()||(_.x=.5*this._mxObject.getViewWidth(),_.y=.5*this._mxObject.getViewHeight());var J=this._mxObject.screenCoord2Current(_.x,_.y,0);this.m_osnap.setPoint(J),this.m_dynamicTrace.Init(),this.m_polarAxisTrace.Init(),this.m_offsetArrow.Init(),this.m_gridTrace.Init(),this.m_ortho.Init(),h.MxJigCmdManager.doMouseMoveImp(),this.m_dynInput.setFocus(!0)},F.prototype.getDynImput=function(){return this.m_dynInput},F.prototype.setMxObject=function(_){this._mxObject=_},F.prototype.getMxObject=function(){return this._mxObject},F.prototype.setColor=function(_){this._iColor=_},F.prototype.getColor=function(){return this._iColor},F.prototype.setDynamicInputType=function(_){this.m_dynInput.setDynamicInputType(_)},F.prototype.getDynamicInputType=function(){return this.m_dynInput.getDynamicInputType()},F.prototype.createTriangle=function(_,J,T){var B=new a.MeshBasicMaterial({color:this._iColor,side:a.DoubleSide}),N=new a.Geometry;N.vertices.push(_),N.vertices.push(J),N.vertices.push(T);var u=new a.Vector3(1,1,1),c=new a.Color(this._iColor),m=new a.Face3(0,1,2,u,c,0);return N.faces.push(m),N.computeFaceNormals(),N.computeVertexNormals(),new a.Mesh(N,B)},F.prototype.createPoint=function(_){var J=new a.Geometry;J.vertices.push(_);var T=new a.PointsMaterial({color:this._iColor,size:3});return new a.Points(J,T)},F.prototype.createLine=function(_,J){var T=new a.Geometry,B=new a.LineBasicMaterial({color:this._iColor});return T.vertices.push(_,J),new a.Line(T,B)},F.prototype.drawReserve=function(_){this.m_isReserveDrawStatus=!0,this.m_callReserveDrawAddEntity=_,this.upDisplay(),this.m_isReserveDrawStatus=!1,this.m_callReserveDrawAddEntity=null},F.prototype.drawMcDbEntity=function(_,J,T){var B=_.getImp(),N=B.GetObjectID();N==0&&_.tempRelationObject(),this.m_isReserveDrawStatus?this._mxObject.getMcObject().DrawEntity(B,J,T):this._mxObject.getMcObject().onJigDrawEntityDisplay(B,J,T),N==0&&_.freeTempRelationObject()},F.prototype.drawMcDbLine=function(_,J,T,B,N,u,c){this.m_isReserveDrawStatus?this._mxObject.getMcObject().DrawLine(_,J,T,B,N,u,c):this._mxObject.getMcObject().onJigDrawEntityDisplay_line(_,J,T,B,N,u,c)},F.prototype.drawEntity=function(_,J,T){if(T===void 0&&(T=!1),_!=null)if(this.m_isReserveDrawStatus)_.renderOrder=J??w.MxData.iDynJigRenderOrder,this._mxObject.addObject(_),this.m_callReserveDrawAddEntity&&this.m_callReserveDrawAddEntity(_);else{var B="MxDynDraw_"+this._DynNameId.toString();_.name=B,_.renderOrder=J??w.MxData.iDynJigRenderOrder,this._aryDynDrawObjectNamesId==null&&(this._aryDynDrawObjectNamesId=new Array),this._aryDynDrawObjectNamesId.push(this._DynNameId),this._DynNameId++,T?this.getParentGroup_smallCoord().add(_):this.getParentGroup().add(_)}},F.prototype.floorPowerOfTwo=function(_){return Math.pow(2,Math.floor(Math.log(_)/Math.LN2))},F.prototype.makeTextSprite=function(_,J,T,B,N){var u,c=document.createElement("canvas"),m=c.getContext("2d"),E=v.MxFun.formatString("normal {0}px Arial","256");m.font=E;var U=m.measureText(_);u=2*this.floorPowerOfTwo(U.width),c.width=u,c.height=256,m.font=E,m.textAlign="center",m.textBaseline="middle";var X=v.MxFun.formatString("#{0}",N.toString(16));m.fillStyle=X,m.fillText(_,u/2,128);var W=new a.Texture(c);W.needsUpdate=!0;var te=new a.SpriteMaterial({map:W});te.transparent=!1,te.rotation=B;var ne=new a.Sprite(te);return ne.scale.set(u/256*T,T,1),ne.position.set(J.x,J.y,0),ne},F.prototype.drawText=function(_,J,T,B){var N=this.makeTextSprite(_,B,J,T,this._iColor);this.drawEntity(N)},F.prototype.drawPoints=function(_){for(var J=0;J<_.length;J++){var T=new a.Geometry;T.vertices.push(_[J]);var B=new a.PointsMaterial({color:this._iColor,size:3}),N=new a.Points(T,B);this.drawEntity(N)}},F.prototype.drawPoint=function(_){var J=new a.Geometry;J.vertices.push(_);var T=new a.PointsMaterial({color:this._iColor,size:3}),B=new a.Points(J,T);this.drawEntity(B)},F.prototype.drawPolyline=function(_){for(var J=new a.Geometry,T=0;T<_.length;T++)J.vertices.push(_[T]);var B=new a.LineBasicMaterial({color:this._iColor}),N=new a.Line(J,B);this.drawEntity(N)},F.prototype.drawSpline=function(_){},F.prototype.drawCircle=function(_,J){var T=new a.CircleGeometry(J,64,3,2*Math.PI),B=new a.LineBasicMaterial({color:this._iColor});T.vertices.shift();var N=new a.LineLoop(T,B);N.position.x=_.x,N.position.y=_.y,N.position.z=_.z,this.drawEntity(N)},F.prototype.drawArc=function(_,J,T,B){var N=new a.CircleGeometry(J,64,T,B),u=new a.LineBasicMaterial({color:this._iColor});N.vertices.shift();var c=new a.Line(N,u);c.position.x=_.x,c.position.y=_.y,c.position.z=_.z,this.drawEntity(c)},F.prototype.drawLine=function(_,J){var T=new a.Geometry,B=new a.LineBasicMaterial({color:this._iColor});T.vertices.push(_,J);var N=new a.Line(T,B);this.drawEntity(N)},F.prototype.removeDynDrawObject=function(){if(this._aryDynDrawObjectNamesId!=null){for(var _=0;_<this._aryDynDrawObjectNamesId.length;_++){var J,T="MxDynDraw_"+this._aryDynDrawObjectNamesId[_].toString();(J=this.getParentGroup().getObjectByName(T))?v.MxFun.removeThreejsObject(J,this.getParentGroup()):(J=this.getParentGroup_smallCoord().getObjectByName(T))&&v.MxFun.removeThreejsObject(J,this.getParentGroup_smallCoord())}this._aryDynDrawObjectNamesId=[],this._mxObject.getMcObject().onJigClearDisplay()}},F.prototype.acquirePoint=function(_,J){J===void 0&&(J=!0);var T=h.MxJigCmdManager.acquirePoint(_,J);return this._isExit=T.exit,this._isExit&&(this.m_DetailedResult=T.DetailedResult),T},F.prototype.acquireDist=function(_,J){var T=h.MxJigCmdManager.acquireDist(_,J);return this._isExit=T.exit,this._isExit&&(this.m_DetailedResult=T.DetailedResult),T},F.prototype.acquireAngle=function(_,J){var T=h.MxJigCmdManager.acquireAngle(_,J);return this._isExit=T.exit,this._isExit&&(this.m_DetailedResult=T.DetailedResult),T},F.prototype.acquireInt=function(){var _=h.MxJigCmdManager.acquireInt();return this._isExit=_.exit,this._isExit&&(this.m_DetailedResult=_.DetailedResult),_},F.prototype.acquireString=function(){var _=h.MxJigCmdManager.acquireString();return this._isExit=_.exit,this._isExit&&(this.m_DetailedResult=_.DetailedResult),_},F.prototype.acquireKeyword=function(){var _=h.MxJigCmdManager.acquireKeyword();return this._isExit=_.exit,this._isExit&&(this.m_DetailedResult=_.DetailedResult),_},F.prototype.notifyCancleExit=function(_){this.m_DetailedResult=_,this._isCancle=!0,this.removeDynDrawObject(),this.done(h.MxJigCmdManager.DragStatus.kCancel),this.onExitCommand(!0),h.MxJigCmdManager.commandRunComplete(this)},F.prototype.notifySampler=function(){var _=this.sampler();if(this.m_dynInput.upDynInput(),_==h.MxJigCmdManager.DragStatus.kNormal&&(this.removeDynDrawObject(),this.upDisplay()),this._isExit){var J=this.done(_);this._isCancle||(J==h.MxJigCmdManager.DoneStatius.kContinueCommand?(this._isExit=!1,h.MxJigCmdManager.doMouseMoveImp(),G.MxUiVue.OnMxEvent({name:"dynInputReSet"})):(this.removeDynDrawObject(),h.MxJigCmdManager.commandRunComplete(this),this.onExitCommand(!0)))}this._mxObject.updateDisplay()},F.prototype.getCurrentMouseButton=function(){return h.MxJigCmdManager.getCurrentMouseButton()},F.prototype.userInputControls=function(){return this._userInputContros},F.prototype.setUserInputControls=function(_){this._userInputContros=_},F.prototype.abort=function(_){h.MxJigCmdManager.stopCmd(_)},F);function F(){this._isExit=!1,this._aryDynDrawObjectNamesId=void 0,this._DynNameId=1,this._iColor=16777215,this._isCancle=!1,this.m_isDisableDynInput=!1,this.m_isDisableOsnap=!1,this.m_isDisableDynamicTrace=!1,this.m_isDisablePolarAxisTrace=!1,this.m_isDisableGridTrace=!1,this.m_isDisableOrtho=!1,this.m_dynInput=new R(this),this.m_dynamicTrace=new D.McEdJigDynamicTrace(this),this.m_polarAxisTrace=new f.MxPolarAxisTrace(this),this.m_offsetArrow=new V.MxOffsetArrow(this),this.m_gridTrace=new O.MxGridTrace(this),this.m_osnap=new k.McEdJigOsnap(this),this.m_ortho=new k.McEdJigOrtho(this),this._userInputContros=h.MxJigCmdManager.UserInputControls.kNullResponseAccepted,this.m_isOffsetInputPostion=!1,this.m_isReserveDrawStatus=!1,this.m_callReserveDrawAddEntity=null,this.drawGroup=null,this.drawGroup_smallCoord=null,this._mxObject=null,this.m_DetailedResult=h.MxJigCmdManager.DetailedResult.kUnknown}o.McEdJigCommand=ee},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxThreeJS":37,"../MxTools":38,"../UI/MxUiVue":65,"./McEdJigDynamicTrace":42,"./McEdJigOsnap":43,"./MxGridTrace":51,"./MxJigCmdManager":54,"./MxOffsetArrow":56,"./MxPolarAxisTrace":57,three:19}],54:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxJigCmdManager=o.AcquireReturn=void 0;var a,v=b("three"),h=b("../MxFun"),w=b("./MxJig"),L=b("../MxManager"),G=b("./MrxDbgUiPrPoint"),k=b("./MrxDbgUiPrBase"),D=b("../UI/MxUiVue"),f=b("../MxTools"),O=b("../MxString"),C=b("./McEdJigOsnap"),j=b("../MxDrawData"),V=b("./MrxDbgUiPrDist"),R=function(){this.status=a.DragStatus.kNoChange,this.exit=!0,this.DetailedResult=a.DetailedResult.kUnknown,this.sKeyValue="",this.dist=0,this.iVal=0,this.sValue="",this.ang=0};o.AcquireReturn=R,function(M){var ee,F,_,J,T,B,N,u,c,m,E,U,X,W,te,ne,ce,we,Ie,xe;(F=ee=M.UserInputControls||(M.UserInputControls={}))[F.kGovernedByOrthoMode=1]="kGovernedByOrthoMode",F[F.kNullResponseAccepted=2]="kNullResponseAccepted",F[F.kDontEchoCancelForCtrlC=4]="kDontEchoCancelForCtrlC",F[F.kDontUpdateLastPoint=8]="kDontUpdateLastPoint",F[F.kNoDwgLimitsChecking=16]="kNoDwgLimitsChecking",F[F.kNoZeroResponseAccepted=32]="kNoZeroResponseAccepted",F[F.kNoNegativeResponseAccepted=64]="kNoNegativeResponseAccepted",F[F.kAccept3dCoordinates=128]="kAccept3dCoordinates",F[F.kAcceptMouseUpAsPoint=256]="kAcceptMouseUpAsPoint",F[F.kAnyBlankTerminatesInput=512]="kAnyBlankTerminatesInput",F[F.kInitialBlankTerminatesInput=1024]="kInitialBlankTerminatesInput",F[F.kAcceptOtherInputString=2048]="kAcceptOtherInputString",F[F.kGovernedByUCSDetect=4096]="kGovernedByUCSDetect",F[F.kNoZDirectionOrtho=8192]="kNoZDirectionOrtho",F[F.kSpacesInAccepted=16384]="kSpacesInAccepted",(J=_=M.AcquireStatus||(M.AcquireStatus={}))[J.kNoChange=0]="kNoChange",J[J.kMove=1]="kMove",J[J.kBegan=2]="kBegan",J[J.kEnd=3]="kEnd",J[J.kMouseUp=4]="kMouseUp",J[J.kMouseDown=5]="kMouseDown",J[J.kCancle=6]="kCancle",(B=T=M.DragStatus||(M.DragStatus={}))[B.kNoChange=-6]="kNoChange",B[B.kCancel=-4]="kCancel",B[B.kOther=-3]="kOther",B[B.kNull=-1]="kNull",B[B.kNormal=0]="kNormal",B[B.kKW1=1]="kKW1",(u=N=M.DetailedResult||(M.DetailedResult={}))[u.kUnknown=1]="kUnknown",u[u.kTouchDownIn=2]="kTouchDownIn",u[u.kTouchUpIn=3]="kTouchUpIn",u[u.kMouseLeftIn=4]="kMouseLeftIn",u[u.kMouseLeftUpIn=5]="kMouseLeftUpIn",u[u.kMouseRightIn=6]="kMouseRightIn",u[u.kKeyIn=7]="kKeyIn",u[u.kCoordIn=8]="kCoordIn",u[u.kNullEnterIn=9]="kNullEnterIn",u[u.kNullSpaceIn=10]="kNullSpaceIn",u[u.kEcsIn=11]="kEcsIn",u[u.kNewCommadIn=12]="kNewCommadIn",(c=M.DoneStatius||(M.DoneStatius={}))[c.kContinueCommand=0]="kContinueCommand",c[c.kExitCommand=1]="kExitCommand",(E=m=M.InType||(M.InType={}))[E.kGetBegan=1]="kGetBegan",E[E.kGetEnd=2]="kGetEnd",(X=U=M.MouseButton||(M.MouseButton={}))[X.kInvalid=-1]="kInvalid",X[X.kLeft=0]="kLeft",X[X.kMid=1]="kMid",X[X.kRight=2]="kRight",(te=W=M.COMMAND_IN||(M.COMMAND_IN={}))[te.COMMAND_IN_NO_ENTITY=0]="COMMAND_IN_NO_ENTITY",te[te.COMMAND_IN_EMTPY=1]="COMMAND_IN_EMTPY",te[te.COMMAND_IN_KEY=2]="COMMAND_IN_KEY",te[te.COMMAND_IN_STRING=3]="COMMAND_IN_STRING",te[te.COMMAND_IN_COORD=5]="COMMAND_IN_COORD",te[te.COMMAND_IN_DIST=6]="COMMAND_IN_DIST",te[te.COMMAND_IN_INVALID=7]="COMMAND_IN_INVALID",te[te.COMMAND_IN_INVALID_ZERO=8]="COMMAND_IN_INVALID_ZERO",te[te.COMMAND_IN_INVALID_NEG=9]="COMMAND_IN_INVALID_NEG",te[te.COMMAND_IN_INT=10]="COMMAND_IN_INT",(ce=ne=M.COMMAND_GET||(M.COMMAND_GET={}))[ce.COMMAND_GET_STRING=1]="COMMAND_GET_STRING",ce[ce.COMMAND_GET_KEY=2]="COMMAND_GET_KEY",ce[ce.COMMAND_GET_DIST=4]="COMMAND_GET_DIST",ce[ce.COMMAND_GET_COORD=8]="COMMAND_GET_COORD",ce[ce.COMMAND_GET_INT=16]="COMMAND_GET_INT",(we=M.DynamicInputType||(M.DynamicInputType={}))[we.kNoInput=0]="kNoInput",we[we.kXYCoordInput=1]="kXYCoordInput",we[we.kDistanceInput=2]="kDistanceInput",we[we.kDynTip=3]="kDynTip",we[we.kAutoInput=4]="kAutoInput",we[we.kAngleInput=5]="kAngleInput",(Ie=M.GETPOINTSTATUS||(M.GETPOINTSTATUS={}))[Ie.OsModeSValidLastPoint=1]="OsModeSValidLastPoint",Ie[Ie.OsModeSTempDisable=2]="OsModeSTempDisable",Ie[Ie.OsModeOrthoTempDisable=4]="OsModeOrthoTempDisable",Ie[Ie.OsModeSValidLastMovePoint=8]="OsModeSValidLastMovePoint",Ie[Ie.OsModePoloarTempDisable=16]="OsModePoloarTempDisable",Ie[Ie.OsModeDynTraceTempDisable=32]="OsModeDynTraceTempDisable",Ie[Ie.OsModeGridSnapTempDisable=64]="OsModeGridSnapTempDisable",(xe=M.OsnapMode||(M.OsnapMode={}))[xe.kOsModekInValid=0]="kOsModekInValid",xe[xe.kOsModeEnd=1]="kOsModeEnd",xe[xe.kOsModeMid=2]="kOsModeMid",xe[xe.kOsModeCen=3]="kOsModeCen",xe[xe.kOsModeNode=4]="kOsModeNode",xe[xe.kOsModeQuad=5]="kOsModeQuad",xe[xe.kOsModeIns=7]="kOsModeIns",xe[xe.kOsModePerp=8]="kOsModePerp",xe[xe.kOsModeTan=9]="kOsModeTan",xe[xe.kOsModeNear=10]="kOsModeNear",xe[xe.kOsModeInt=11]="kOsModeInt";var Be,q=void 0,ge=void 0,oe=_.kNoChange,se=U.kInvalid,Ae=-9999999,Ye=new v.Vector2(Ae,Ae),Ge=!1,Ne=void 0,le=!1,ve=0,He=new Map,nt=new Array,ht=new O.MxString,Tt=void 0,Ct=-2;function We(){q!=null&&q.notifySampler()}function It(ct,Ue){var lt=ct.srcElement;if(lt&&(j.MxDrawData.m_isMapBox||lt.tagName=="CANVAS")){if(q==null||q.getDynImput().isTruncatedInput())return 0;Ye.x=ct.offsetX,Ye.y=ct.offsetY,Ue&&(Ye.x=Ue.x,Ye.y=Ue.y),Zt(Ye)}return 0}function Bt(ct,Ue){if(ct.button!=U.kLeft)return 0;var lt=ct.srcElement;if(!lt||!j.MxDrawData.m_isMapBox&&lt.tagName!="CANVAS"||q==null||q.getDynImput().isTruncatedInput())return 0;Ye.x=ct.offsetX,Ye.y=ct.offsetY,Ue&&(Ye.x=Ue.x,Ye.y=Ue.y),Be=q.getMxObject().screenCoord2Current(ct.offsetX,ct.offsetY,0);var Wt=q.getOsnap();return Be=Wt.reCompteCurrentPoint(Be),oe=_.kMouseUp,se=ct.button,We(),ct.stopPropagation(),1}function Ln(ct,Ue,lt){var Wt=q.getMxObject().screenCoord2Current(ct,Ue,lt),$e=q.getOsnap();Wt=$e.reCompteCurrentPoint(Wt);var Rt=$e.getCurrentOSnapPoint(Wt);Wt=Rt.pt;var $t,an=!1;if(Rt.isSnapPoint&&(an=!0),an||($t=q.getDynamicTrace().GetTracePoint())&&(Wt.copy($t),an=!0),an||($t=q.getPolarAxisTrace().GetTracePoint())&&(Wt.copy($t),an=!0),!an){var hr=q.getOrtho();hr.OnViewMouseMove(Wt);var _r=hr.GetCurOrthoPoint();_r.isValid&&(Wt.copy(_r.pt),an=!0)}return an||($t=q.getGridTrace().GetTracePoint())&&(Wt.copy($t),an=!0),Wt}function rn(ct,Ue){if(ct.button!=U.kLeft)return 0;q!=null&&q.getDynImput().isShow()&&q.getDynImput().setFocus(!0);var lt=ct.srcElement;if(!lt||!j.MxDrawData.m_isMapBox&&lt.tagName!="CANVAS"||q==null||q.getDynImput().isTruncatedInput())return 0;Ye.x=ct.offsetX,Ye.y=ct.offsetY,Ue&&(Ye.x=Ue.x,Ye.y=Ue.y);var Wt=Ln(ct.offsetX,ct.offsetY,0);return C.McEdImpJigGlobalData.setPrvPoint(Wt),q.getOsnap().seInValidPoint(),Be=Wt,oe=_.kMouseDown,se=ct.button,We(),ct.stopPropagation(),1}function Xn(ct){if(ct.stopPropagation(),ct.preventDefault(),ct.touches.length!=0){q!=null&&q.getDynImput().isShow()&&q.getDynImput().setFocus(!0);var Ue=ct.srcElement;if(Ue&&(j.MxDrawData.m_isMapBox||Ue.tagName=="CANVAS")){if(q==null)return;var lt=ct.target.getBoundingClientRect();Ye.x=ct.touches[0].clientX-lt.left,Ye.y=ct.touches[0].clientY-lt.top;var Wt=Ln(Ye.x,Ye.y,0);return C.McEdImpJigGlobalData.setPrvPoint(Wt),q.getOsnap().seInValidPoint(),Be=Wt,oe=_.kBegan,se=U.kInvalid,We(),1}}}function yt(ct){ct.stopPropagation(),ct.preventDefault();var Ue=ct.srcElement;if(Ue&&(j.MxDrawData.m_isMapBox||Ue.tagName=="CANVAS")){if(q==null||Ye.x==Ae||Ye.y==Ae)return;if(0<ct.touches.length){var lt=ct.target.getBoundingClientRect();Ye.x=ct.touches[0].clientX-lt.left,Ye.y=ct.touches[0].clientY-lt.top}var Wt=Ln(Ye.x,Ye.y,0);return C.McEdImpJigGlobalData.setPrvPoint(Wt),q.getOsnap().seInValidPoint(),Be=Wt,oe=_.kEnd,se=U.kInvalid,We(),1}}function ze(ct){ct.stopPropagation(),ct.preventDefault();var Ue=ct.srcElement;if(Ue&&(j.MxDrawData.m_isMapBox||Ue.tagName=="CANVAS")){if(q==null)return;var lt=ct.target.getBoundingClientRect();Ye.x=ct.touches[0].clientX-lt.left,Ye.y=ct.touches[0].clientY-lt.top,Zt(Ye)}}function Zt(ct){if(le=!1,ct==null){if(Ye.x==Ae||Ye.y==Ae)return;ct=Ye}q.getDynImput().ClearDisplay();var Ue=q.getMxObject().screenCoord2Current(ct.x,ct.y,0),lt=q.getOffsetArrow();lt.ReSetTempDisplay(),lt.MouseMove(Ue);var Wt=q.getOsnap();Ue=Wt.reCompteCurrentPoint(Ue);var $e=q.getMxObject().viewCoordLong2Cad(.5*j.MxDrawData.m_dInputRectWidth);Wt.setPoint(Ue,$e);var Rt=q.getDynamicTrace();Rt.ReSetTempDisplay(),Rt.OnDynamicTrace(0,Ue,M.OsnapMode.kOsModekInValid),Rt.MouseMove(Ue);var $t=!1,an=Rt.GetTracePoint();an&&(Ue.x=an.x,Ue.y=an.y,Ue.z=an.z,$t=!0);var hr=q.getPolarAxisTrace();if(hr.ReSetTempDisplay(),$t||(hr.MouseMove(Ue),(an=hr.GetTracePoint())&&(Ue.x=an.x,Ue.y=an.y,Ue.z=an.z,$t=!0)),!$t){var _r=q.getOrtho();_r.OnViewMouseMove(Ue);var qr=_r.GetCurOrthoPoint();qr.isValid&&Ue.copy(qr.pt)}var Ur=q.getGridTrace();Ur.ReSetTempDisplay(),$t||(Ur.MouseMove(Ue),(an=Ur.GetTracePoint())&&(Ue.x=an.x,Ue.y=an.y,Ue.z=an.z,$t=!0)),Be=Ue,oe=_.kMove;var Gr=q.getMxObject();Gr.sysVariable().setSysVarPoint("LASTMOVEPOINT",Ue);var Or=Gr.sysVariable().getSysVarNumber("GETPOINTSTATUS");Or|=M.GETPOINTSTATUS.OsModeSValidLastMovePoint,Gr.sysVariable().setSysVarNumber("GETPOINTSTATUS",Or),We.call(this)}function An(){q&&(Tt=q.getMxObject().getEventManager(),h.MxFun.isPC()?(Tt.addEventListener("mouseup",Bt,!0),Tt.addEventListener("mousemove",It,!0),Tt.addEventListener("mousedown",rn,!0)):(Tt.addEventListener("touchstart",Xn,!0),Tt.addEventListener("touchend",yt,!0),Tt.addEventListener("touchmove",ze,!0)))}function Yn(){Tt&&(h.MxFun.isPC()?(Tt.removeEventListener("mouseup",Bt,!0),Tt.removeEventListener("mousemove",It,!0),Tt.removeEventListener("mousedown",rn,!0)):(Tt.removeEventListener("touchstart",Xn,!0),Tt.removeEventListener("touchend",yt,!0),Tt.removeEventListener("touchmove",ze,!0)),Tt=void 0)}function pt(ct){var Ue=ct.getOrbitControls();h.MxFun.isPC()?(Ct=Ue.mouseButtons.LEFT,Ue.mouseButtons.LEFT=-1):Ue.enabled=!1,Ue.resetStatusValue(),ct.callEvent("dragWillStart"),ct.updateDisplay()}function st(ct){var Ue=new v.Vector3,lt=!1,Wt=new O.MxString(ct),$e=Wt.AnalyzeString(",");if($e.length<2)for(;;){var Rt=q.getDynImput().getFocusIndex();if(Rt==-1||Wt.IsEmpty()||!f.MxTools.IsNumerical(Wt))break;if(Rt==0){var $t=f.MxTools._tstof(Wt.m_val);if(f.MxTools.IsZero($t)||!((Gr=(Or=q.getMxObject()).sysVariable().getSysVarNumber("GETPOINTSTATUS"))&M.GETPOINTSTATUS.OsModeSValidLastPoint)||!(Gr&M.GETPOINTSTATUS.OsModeSValidLastMovePoint))break;var an=Or.sysVariable().getSysVarPoint("LASTPOINT");if((_r=Or.sysVariable().getSysVarPoint("LASTMOVEPOINT").clone().sub(an)).length()<1e-7)break;_r.normalize(),_r.multiplyScalar($t);var hr=(Ue=an.add(_r)).clone().add(_r.multiplyScalar(10));Or.sysVariable().setSysVarPoint("LASTMOVEPOINT",hr),lt=!0}else if(Rt==1){var _r,qr=f.MxTools._tstof(Wt.m_val);if(!((Gr=(Or=q.getMxObject()).sysVariable().getSysVarNumber("GETPOINTSTATUS"))&M.GETPOINTSTATUS.OsModeSValidLastPoint)||!(Gr&M.GETPOINTSTATUS.OsModeSValidLastMovePoint)||(an=Or.sysVariable().getSysVarPoint("LASTPOINT"),(_r=Or.sysVariable().getSysVarPoint("LASTMOVEPOINT").clone().sub(an)).length()<1e-7))break;var Ur=new v.Vector3(_r.length(),0,0);Ur.applyAxisAngle(new v.Vector3(0,0,1),qr*Math.PI/180),hr=(Ue=an.add(Ur)).clone().add(Ur.multiplyScalar(2)),Or.sysVariable().setSysVarPoint("LASTMOVEPOINT",hr),lt=!0}break}else{var Gr,Or=q.getMxObject(),Qi=new O.MxString($e[0]),Pi=new O.MxString($e[1]),si=new O.MxString("0");if(2<$e.length&&(si.m_val=$e[2]),Qi.IsEmpty()||Qi.Left(1)!="@")f.MxTools.IsNumerical(Qi)&&f.MxTools.IsNumerical(Pi)&&f.MxTools.IsNumerical(si)?(lt=!0,Ue.x=f.MxTools._tstof(Qi.m_val),Ue.y=f.MxTools._tstof(Pi.m_val),Ue.z=f.MxTools._tstof(si.m_val)):lt=!1;else if(Qi.m_val=Qi.m_val.substring(1,Qi.m_val.length),f.MxTools.IsNumerical(Qi)&&f.MxTools.IsNumerical(Pi)&&f.MxTools.IsNumerical(si))if((Gr=Or.sysVariable().getSysVarNumber("GETPOINTSTATUS"))&M.GETPOINTSTATUS.OsModeSValidLastPoint){lt=!0;var gr=f.MxTools._tstof(Qi.m_val),Wi=f.MxTools._tstof(Pi.m_val),H=f.MxTools._tstof(si.m_val);an=Or.sysVariable().getSysVarPoint("LASTPOINT"),Ue.x=an.x+gr,Ue.y=an.y+Wi,Ue.z=an.z+H}else lt=!1;else lt=!1}return lt?Ue:null}function qt(ct,Ue){Ue===void 0&&(Ue=!1),D.MxUiVue.AcutPrintfNoFormat(ct,Ue)}function xn(ct,Ue){if(ct==W.COMMAND_IN_INVALID){var lt=D.MxUiVue.getCmdTip();return qt(Ue),qt(lt),T.kNoChange}return ct==W.COMMAND_IN_INVALID_ZERO?(lt=D.MxUiVue.getCmdTip(),q.userInputControls()&ee.kNoNegativeResponseAccepted?qt(`
 值必须为正 且非零。 
`):qt(`
 值必不能为零。 
`),qt(lt),T.kOther):ct!=W.COMMAND_IN_INVALID_NEG?T.kNoChange:(lt=D.MxUiVue.getCmdTip(),q.userInputControls()&ee.kNoZeroResponseAccepted?qt(`
 值必须为正 且非零。 
`):qt(`
 值必不能为负。 
`),qt(lt),T.kOther)}function nn(ct){var Ue={iRet:W.COMMAND_IN_NO_ENTITY,sValue:"",iKey:T.kNull,dDist:0,iVal:0,pt:null,cmdText:""};if(!le)return Ue;var lt=q.userInputControls(),Wt=D.MxUiVue.getCmdText();if((Ue.cmdText=Wt).length==0)return lt&ee.kNullResponseAccepted?Ue.iRet=W.COMMAND_IN_EMTPY:Ue.iRet=W.COMMAND_IN_INVALID,Ue;if(ct&ne.COMMAND_GET_KEY&&0<He.size){var $e=new O.MxString(Wt);$e.MakeUpper(),$e.TrimLeft(" "),$e.TrimRight(" ");var Rt=He.get($e.m_val);if(Rt!=null)return Ue.iRet=W.COMMAND_IN_KEY,Ue.iKey=Rt,Ue.sValue=$e.m_val,Ue}if(ct&ne.COMMAND_GET_DIST&&f.MxTools.IsNumerical(Wt))return Ue.dDist=f.MxTools._tstof(Wt),lt&ee.kNoZeroResponseAccepted&&f.MxTools.IsZero(Ue.dDist)?Ue.iRet=W.COMMAND_IN_INVALID_ZERO:lt&ee.kNoNegativeResponseAccepted&&Ue.dDist<0?Ue.iRet=W.COMMAND_IN_INVALID_NEG:(Ue.sValue=Wt,Ue.iRet=W.COMMAND_IN_DIST),Ue;if(ct&ne.COMMAND_GET_INT&&f.MxTools.IsNumerical(Wt))return Ue.iVal=f.MxTools._tstoi(Wt),lt&ee.kNoZeroResponseAccepted&&Ue.iVal==0?Ue.iRet=W.COMMAND_IN_INVALID_ZERO:lt&ee.kNoNegativeResponseAccepted&&Ue.iVal<0?Ue.iRet=W.COMMAND_IN_INVALID_NEG:(Ue.sValue=Wt,Ue.iRet=W.COMMAND_IN_INT),Ue;if(ct&ne.COMMAND_GET_COORD){var $t=st(Wt);if($t!=null)return Ue.sValue=Wt,Ue.iRet=W.COMMAND_IN_COORD,Ue.pt=$t,Ue}return ct&ne.COMMAND_GET_STRING?(Ue.sValue=Wt,Ue.iRet=W.COMMAND_IN_STRING):Ue.iRet=W.COMMAND_IN_INVALID,Ue}function er(ct){var Ue=q.getMxObject();if(Ue.sysVariable().setSysVarPoint("LASTPOINT",ct),ct){var lt=Ue.sysVariable().getSysVarNumber("GETPOINTSTATUS");lt|=M.GETPOINTSTATUS.OsModeSValidLastPoint,Ue.sysVariable().setSysVarNumber("GETPOINTSTATUS",lt)}else lt=Ue.sysVariable().getSysVarNumber("GETPOINTSTATUS"),lt&=~M.GETPOINTSTATUS.OsModeSValidLastPoint,Ue.sysVariable().setSysVarNumber("GETPOINTSTATUS",lt)}function kr(ct){var Ue=new R;return oe==_.kMove?(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!1):oe==_.kEnd?ct&m.kGetEnd?(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!0,Ue.DetailedResult=N.kTouchUpIn,er(Ue.pt)):(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!1):oe==_.kCancle?(Ue.status=T.kCancel,Ue.pt=Be,Ue.exit=!0):oe==_.kBegan?ct&m.kGetBegan?(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!0,Ue.DetailedResult=N.kTouchDownIn,er(Ue.pt)):(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!1):oe==_.kMouseDown?(Ue.status=T.kNormal,Ue.pt=Be,Ue.exit=!0,Ue.DetailedResult=N.kMouseLeftIn,er(Ue.pt)):(Ue.status=T.kNoChange,Ue.pt=void 0,Ue.exit=!1),Ue}M.getInputKeyword=function(ct){if(ct<1)return"";for(var Ue,lt=He.entries();!(Ue=lt.next()).done;)if(Ue.value==ct)return Ue.key;return""},M.GetKeyWordToString=function(){return nt},M.keywordList=function(){return ht.m_val},M.setKeywordList=function(ct){if(ht.m_val=ct,He.clear(),nt.length=0,!ht.IsEmpty())if(ht.TrimLeft(" "),ht.TrimRight(" "),ht.m_val[0]=="["&&ht.m_val[ht.m_val.length-1]=="]"){ht.TrimLeft("["),ht.TrimRight("]");for(var Ue=ht.AnalyzeString("/"),lt=1,Wt=0;Wt<Ue.length;Wt++){var $e=(an=new O.MxString(Ue[Wt])).Find("(");if($e!=-1){var Rt=new O.MxString(an.Left($e)),$t=new O.MxString(an.Right(an.GetLength()-$e-1));$t.TrimRight(")"),Rt.IsEmpty()||$t.IsEmpty()||($t.MakeUpper(),He.set($t.m_val,lt),lt++,nt.push(new f.MxPair($t.m_val,Rt.m_val)))}}}else for(Ue=ht.AnalyzeString(" "),lt=1,Wt=0;Wt<Ue.length;Wt++){var an;(an=new O.MxString(Ue[Wt])).IsEmpty()||(an.MakeUpper(),He.set(an.m_val,lt),lt++)}},M.getAcquirePoint=function(){return Be},M.getAcquireStatus=function(){return oe},M.doMouseMoveImp=Zt,M.OnThreeControlsChage=function(){if(q!=null)return q.getOsnap().reComputeOffset(),void(Ye.x!=Ae&&Ye.y!=Ae&&Zt(Ye))},M.OnEnter=function(ct){ve=ct,le=!0,oe=_.kNoChange,We(),le=!1},M.Test=function(){le=!0},M.registEvent=An,M.unRegistEvent=Yn,M.getCurrentMouseButton=function(){return se},M.isRunning=function(){return q!=null},M.getCurCmd=function(){return q},M.commandRunComplete=function(ct){q!=ct&&console.log("aseert:_curCmd == cmd");var Ue,lt,Wt=L.MxManager.currentMx();q!=null&&(Wt=q.getMxObject()),ge!=null?(q=ge,ge=void 0,se=U.kInvalid,An(),q.onStartCommand(),pt(Wt)):(Yn(),q=void 0,lt=(Ue=Wt).getOrbitControls(),h.MxFun.isPC()?Ct!=-2&&(lt.mouseButtons.LEFT=Ct,Ct=-2,lt.resetStatusValue()):(lt.enabled=!0,lt.resetStatusValue()),Ue.callEvent("dragWillEnd"),Ue.updateDisplay(),j.MxDrawData.m_isAutoResetRenderer||Ue.resetRenderer())},M.isWaitCmdNull=function(){return ge==null},M.stopCmd=function(ct){L.MxManager.currentMx().endPanCommand(),q!=null&&(Ge=!0,q.notifyCancleExit(ct),Ge=!1)},M.setRunCmdEvent=function(ct){Ne=ct},M.runCmd=function(ct){if(!Ge){var Ue=L.MxManager.currentMx();ct.setMxObject(Ue),Ue.isValidCurMousePostion()?Ye=Ue.getCurrentMousePostion():h.MxFun.isPC()?(Ye.x=Ae,Ye.y=Ae):(Ye.x=.5*Ue.getViewWidth(),Ye.y=.5*Ue.getViewHeight()),Ne&&Ne(),q==null?(q=ct,se=U.kInvalid,An(),q.onStartCommand(),pt(Ue)):(ge=ct,Ge=!0,q.notifyCancleExit(N.kNewCommadIn),Ge=!1)}},M.GetAcqurePointFromStringTo=st,M.ProcCommandRetResult=xn,M.GetCommandLineContent=nn,M.acquireKeyword=function(){var ct=new R;if(q==null)return ct.status=T.kCancel,ct.exit=!0,ct;var Ue=nn(ne.COMMAND_GET_STRING|ne.COMMAND_GET_KEY);return Ue.iRet==W.COMMAND_IN_EMTPY?(ct.status=T.kNull,ct.exit=!0,ve==13?ct.DetailedResult=N.kNullEnterIn:ve==32?ct.DetailedResult=N.kNullSpaceIn:ve==-1&&(ct.DetailedResult=N.kMouseRightIn)):Ue.iRet==W.COMMAND_IN_KEY?(ct.status=Ue.iKey,ct.exit=!0,ct.sKeyValue=Ue.sValue,ct.DetailedResult=N.kKeyIn):(Ue.cmdText.length==0?ct.status=T.kNoChange:ct.status=xn(Ue.iRet,`
需要输入关键字。 
`),ct.exit=!1),ct},M.acquireString=function(){var ct=new R;if(q==null)return ct.status=T.kCancel,ct.exit=!0,ct;var Ue=nn(ne.COMMAND_GET_STRING|ne.COMMAND_GET_KEY);return Ue.iRet==W.COMMAND_IN_EMTPY?(ct.status=T.kNull,ct.exit=!0,ve==13?ct.DetailedResult=N.kNullEnterIn:ve==32?ct.DetailedResult=N.kNullSpaceIn:ve==-1&&(ct.DetailedResult=N.kMouseRightIn)):Ue.iRet==W.COMMAND_IN_KEY?(ct.status=Ue.iKey,ct.exit=!0,ct.sKeyValue=Ue.sValue,ct.DetailedResult=N.kKeyIn):Ue.iRet==W.COMMAND_IN_STRING?(ct.status=T.kNormal,ct.sValue=Ue.sValue,ct.exit=!0,ct.DetailedResult=N.kKeyIn):(ct.status=xn(Ue.iRet,`
需要输入非空字符串。 
`),ct.exit=!1),ct},M.acquireInt=function(){var ct=new R;if(q==null)return ct.status=T.kCancel,ct.exit=!0,ct;var Ue=nn(ne.COMMAND_GET_INT|ne.COMMAND_GET_KEY);return Ue.iRet==W.COMMAND_IN_EMTPY?(ct.status=T.kNull,ct.exit=!0,ve==13?ct.DetailedResult=N.kNullEnterIn:ve==32?ct.DetailedResult=N.kNullSpaceIn:ve==-1&&(ct.DetailedResult=N.kMouseRightIn)):Ue.iRet==W.COMMAND_IN_KEY?(ct.status=Ue.iKey,ct.exit=!0,ct.sKeyValue=Ue.sValue,ct.DetailedResult=N.kKeyIn):Ue.iRet==W.COMMAND_IN_INT?(ct.status=T.kNormal,ct.iVal=Ue.iVal,ct.exit=!0,ct.DetailedResult=N.kKeyIn):(ct.status=xn(Ue.iRet,`
 需要整数或选项关键字。 
`),ct.exit=!1),ct},M.acquireDist=function(ct,Ue){var lt=new R;if(q==null)return lt.status=T.kCancel,lt.exit=!0,lt;var Wt=nn(ne.COMMAND_GET_DIST|ne.COMMAND_GET_KEY);if(Wt.iRet==W.COMMAND_IN_EMTPY)return lt.status=T.kNull,lt.exit=!0,ve==13?lt.DetailedResult=N.kNullEnterIn:ve==32?lt.DetailedResult=N.kNullSpaceIn:ve==-1&&(lt.DetailedResult=N.kMouseRightIn),lt;if(Wt.iRet==W.COMMAND_IN_KEY)return lt.status=Wt.iKey,lt.exit=!0,lt.sKeyValue=Wt.sValue,lt.DetailedResult=N.kKeyIn,lt;if(Wt.iRet==W.COMMAND_IN_DIST)return lt.status=T.kNormal,lt.dist=Wt.dDist,lt.exit=!0,lt.DetailedResult=N.kCoordIn,lt;if(lt.status=xn(Wt.iRet,`
 需要点或选项关键字。 
`),!Ue||Wt.iRet==W.COMMAND_IN_INVALID_ZERO||Wt.iRet==W.COMMAND_IN_INVALID_NEG)return lt.exit=!1,lt;var $e=kr(ct);if($e.status==T.kNormal&&$e.exit){var Rt=$e.pt.clone(),$t=Ue.clone();Rt.z=$t.z=0;var an=Rt.distanceTo($t);return q.userInputControls()&ee.kNoZeroResponseAccepted&&f.MxTools.IsZero(an)?(xn(W.COMMAND_IN_INVALID_ZERO,`
 需要点或选项关键字。 
`),lt.status=T.kOther,lt.exit=!1,lt):(lt.status=T.kNormal,lt.dist=an,lt.exit=!0,lt.DetailedResult=$e.DetailedResult,lt)}return lt.exit=!1,lt.status=T.kNoChange,lt},M.acquirePoint=function(ct,Ue){Ue===void 0&&(Ue=!0);var lt=new R;if(q==null)return lt.status=T.kCancel,lt;var Wt=nn(ne.COMMAND_GET_COORD|ne.COMMAND_GET_KEY);return Wt.iRet==W.COMMAND_IN_EMTPY?(lt.status=T.kNull,lt.exit=!0,ve==13?lt.DetailedResult=N.kNullEnterIn:ve==32?lt.DetailedResult=N.kNullSpaceIn:ve==-1&&(lt.DetailedResult=N.kMouseRightIn),lt):Wt.iRet==W.COMMAND_IN_KEY?(lt.status=Wt.iKey,lt.exit=!0,lt.sKeyValue=Wt.sValue,lt.DetailedResult=N.kKeyIn,lt):Wt.iRet==W.COMMAND_IN_COORD?(lt.status=T.kNormal,lt.pt=new v.Vector3(Wt.pt.x,Wt.pt.y,Wt.pt.z),lt.exit=!0,lt.DetailedResult=N.kCoordIn,lt):(Ue&&xn(Wt.iRet,`
 需要点或选项关键字。 
`),kr(ct))},M.acquireAngle=function(ct,Ue){var lt=new R;if(q==null)return lt.status=T.kCancel,lt.exit=!0,lt;var Wt=nn(ne.COMMAND_GET_DIST|ne.COMMAND_GET_KEY);if(Wt.iRet==W.COMMAND_IN_EMTPY)return lt.status=T.kNull,lt.exit=!0,ve==13?lt.DetailedResult=N.kNullEnterIn:ve==32?lt.DetailedResult=N.kNullSpaceIn:ve==-1&&(lt.DetailedResult=N.kMouseRightIn),lt;if(Wt.iRet==W.COMMAND_IN_KEY)return lt.status=Wt.iKey,lt.exit=!0,lt.sKeyValue=Wt.sValue,lt.DetailedResult=N.kKeyIn,lt;if(Wt.iRet==W.COMMAND_IN_DIST)return lt.status=T.kNormal,lt.ang=3.14159265*Wt.dDist/180,lt.exit=!0,lt.DetailedResult=N.kCoordIn,lt;if(lt.status=xn(Wt.iRet,`
 需要点或选项关键字。 
`),!Ue||Wt.iRet==W.COMMAND_IN_INVALID_ZERO||Wt.iRet==W.COMMAND_IN_INVALID_NEG)return lt.exit=!1,lt;var $e=kr(ct);if($e.status==T.kNormal&&$e.exit){var Rt=new v.Vector3($e.pt.x-Ue.x,$e.pt.y-Ue.y,0),$t=Rt.angleTo(new v.Vector3(1,0,0));Rt.dot(new v.Vector3(0,1,0))<-1e-11&&($t=2*Math.PI-$t);var an=q.userInputControls();return an&ee.kNoZeroResponseAccepted&&f.MxTools.IsZero($t)?(xn(W.COMMAND_IN_INVALID_ZERO,`
 需要点或选项关键字。 
`),lt.status=T.kOther,lt.exit=!1,lt):(an&ee.kNoNegativeResponseAccepted&&$t<0?(xn(W.COMMAND_IN_INVALID_NEG,`
 需要点或选项关键字。 
`),lt.status=T.kOther,lt.exit=!1):(lt.status=T.kNormal,lt.ang=$t,lt.exit=!0,lt.DetailedResult=$e.DetailedResult),lt)}return lt.exit=!1,lt.status=T.kNoChange,lt},M.getMcEdJigCommandClass=function(){return w.McEdJigCommand},M.getMrxDbgUiPrPointClass=function(){return G.MrxDbgUiPrPoint},M.getMrxDbgUiPrDistClass=function(){return V.MrxDbgUiPrDist},M.getMrxDbgUiPrIntClass=function(){return V.MrxDbgUiPrInt},M.getMrxDbgUiPrStringClass=function(){return V.MrxDbgUiPrString},M.getMrxDbgUiPrKeyWordClass=function(){return V.MrxDbgUiPrKeyWord},M.getMrxDbgUiPrAngleClass=function(){return V.MrxDbgUiPrAngle},M.getMcEdGetPointWorldDrawClass=function(){return k.McEdGetPointWorldDraw},M.McEdGetPointWorldDrawObjectClass=function(){return k.McEdGetPointWorldDrawObject},M.init=function(){this._curCmd=void 0}}(a||(o.MxJigCmdManager=a={}))},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxString":34,"../MxTools":38,"../UI/MxUiVue":65,"./McEdJigOsnap":43,"./MrxDbgUiPrBase":45,"./MrxDbgUiPrDist":46,"./MrxDbgUiPrPoint":47,"./MxJig":53,three:19}],55:[function(b,r,o){var a,v=this&&this.__extends||(a=function(D,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,C){O.__proto__=C}||function(O,C){for(var j in C)Object.prototype.hasOwnProperty.call(C,j)&&(O[j]=C[j])})(D,f)},function(D,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function O(){this.constructor=D}a(D,f),D.prototype=f===null?Object.create(f):(O.prototype=f.prototype,new O)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxJigGetLine=void 0;var h,w=b("./MxJig"),L=b("./MxJigCmdManager"),G=(v(k,h=w.McEdJigCommand),k.prototype.sampler=function(){var D=L.MxJigCmdManager.InType.kGetBegan;this._isGetPt1||(D=L.MxJigCmdManager.InType.kGetEnd);var f=this.acquirePoint(D);return f.status==L.MxJigCmdManager.DragStatus.kNormal&&(this._isGetPt1?this._pt1=f.pt:this._pt2=f.pt),f.status},k.prototype.setRetCall=function(D){this._retCall=D},k.prototype.done=function(D){if(this._isGetPt1)return this._isGetPt1=!1,L.MxJigCmdManager.DoneStatius.kContinueCommand;var f={};return f.pt1=this.getMxObject().worldCoord2Currnet(this._pt1.x,this._pt1.y,this._pt1.z),f.pt2=this.getMxObject().worldCoord2Currnet(this._pt2.x,this._pt2.y,this._pt2.z),this._retCall(f),L.MxJigCmdManager.DoneStatius.kExitCommand},k.prototype.upDisplay=function(){this._isGetPt1||this._pt1==null||this._pt2==null||this.drawLine(this._pt1,this._pt2)},k);function k(){var D=h!==null&&h.apply(this,arguments)||this;return D._isGetPt1=!0,D}o.MxJigGetLine=G},{"./MxJig":53,"./MxJigCmdManager":54}],56:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxOffsetArrow=void 0;var a=b("three"),v=b("../MxFun"),h=b("../MxThreeJS"),w=b("../MxTools"),L=(G.prototype.ClearDynDrawEntity=function(){var k=this.m_vecDynDrawEntity.length;if(k!=0){for(var D=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),f=0;f<k;f++)v.MxFun.removeThreejsObject(this.m_vecDynDrawEntity[f],D);this.m_vecDynDrawEntity=[]}},G.prototype.MouseMove=function(k){var D=this.m_mxJig.getMxObject();if(D.getMcObject().isValid()&&(this.ClearDynDrawEntity(),this.m_mxJig.isOffsetInputPostion())){var f=k.clone(),O=this.m_mxJig.getOsnap().reCompteCurrentPoint(f.clone()),C=h.MxThreeJS.createLine(D.toSmallcoord(f),D.toSmallcoord(O),16777215),j=D.getTheTempDrawContainer_SmallCoord();j.add(C),this.m_vecDynDrawEntity.push(C);var V=w.MxTools.MillimeterToPixels(2.9);V=D.screenCoordLong2Doc(V);var R=h.MxThreeJS.createSolidCircle(D.toSmallcoord(f),.85*V,16777215);j.add(R),this.m_vecDynDrawEntity.push(R);var M=h.MxThreeJS.createCircle(D.toSmallcoord(f),V,16777215);j.add(M),this.m_vecDynDrawEntity.push(M);var ee=f.sub(O);ee.normalize().multiplyScalar(.8*V);var F=ee.clone().applyAxisAngle(new a.Vector3(0,0,1),15*Math.PI/180),_=ee.clone().applyAxisAngle(new a.Vector3(0,0,1),15*-Math.PI/180),J=O.clone().add(F),T=O.clone().add(_),B=h.MxThreeJS.createLine(D.toSmallcoord(J),D.toSmallcoord(O),16777215);D.getTheTempDrawContainer_SmallCoord().add(B),this.m_vecDynDrawEntity.push(B);var N=h.MxThreeJS.createLine(D.toSmallcoord(T),D.toSmallcoord(O),16777215);D.getTheTempDrawContainer_SmallCoord().add(N),this.m_vecDynDrawEntity.push(N)}},G.prototype.ClearDisplay=function(){this.ClearDynDrawEntity()},G.prototype.ReSetTempDisplay=function(){this.ClearDynDrawEntity()},G.prototype.Init=function(){},G);function G(k){this.m_vecDynDrawEntity=[],this.m_mxJig=null,this.m_mxJig=k}o.MxOffsetArrow=L},{"../MxFun":27,"../MxThreeJS":37,"../MxTools":38,three:19}],57:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxPolarAxisTrace=void 0;var a=b("three"),v=b("./MxJigCmdManager"),h=b("../MxFun"),w=b("../MxDrawData"),L=b("../MxTools"),G=b("../MxManager"),k=b("../MxThreeJS"),D=(f.prototype.ClearDynDrawEntity=function(){for(var O=this.m_mxJig.getMxObject().getTheTempDrawContainer_SmallCoord(),C=this.m_vecDynDrawEntity.length,j=0;j<C;j++)h.MxFun.removeThreejsObject(this.m_vecDynDrawEntity[j],O);this.m_vecDynDrawEntity=[]},f.prototype.CreteTracePoint=function(O,C){var j=this.m_mxJig.getMxObject(),V=j.getTheTempDrawContainer_SmallCoord();C/=2;var R=k.MxThreeJS.createLine(j.toSmallcoord2(O.x+C,O.y+C,0),j.toSmallcoord2(O.x-C,O.y-C,0),16711680);V.add(R),this.m_vecDynDrawEntity.push(R);var M=k.MxThreeJS.createLine(j.toSmallcoord2(O.x-C,O.y+C,0),j.toSmallcoord2(O.x+C,O.y-C,0),16711680);V.add(M),this.m_vecDynDrawEntity.push(M)},f.prototype.MouseMove=function(O){var C=this.m_mxJig.getMxObject();if(C.getMcObject().isValid()){if(this.ClearDynDrawEntity(),this.m_isValidTracePoint=!1,this.m_isTrace&&C.sysVariable().getSysVarNumber("GETPOINTSTATUS")&v.MxJigCmdManager.GETPOINTSTATUS.OsModeSValidLastPoint){var j=C.sysVariable().getSysVarPoint("LASTPOINT"),V=C.getSysVarDouble("POLARANG");if(V=180*V/Math.PI,!((V=Math.abs(V))<.001)){var R=C.viewCoordLong2Cad(w.MxDrawData.m_dInputRectWidth),M=2*R,ee=O.clone().sub(j);if(!(ee.length()<M)){ee.normalize();var F=G.MxManager.getMxCpp().getMxCAD_MxCpp(),_=G.MxManager.getMxCpp().getMxCAD_App(),J=C.getTheTempDrawContainer_SmallCoord(),T=C.viewCoordLong2Cad(this.m_dashedLineLen);ee=F.newMcGeVector3d(ee);var B=F.newMcGeVector3d(new a.Vector3(1,0,0)),N=ee.angleTo2(B),u=(N=180*N/Math.PI)%V;u<V/2?N-=u:N+=V-u;var c=C.viewCoordLong2Cad(C.getViewWidth()),m=C.viewCoordLong2Cad(C.getViewHeight()),E=L.MxTools.MxMax(c,m);(ee=B.clone()).rotateBy(N*Math.PI/180),ee.mult(E);var U=new a.Vector3(j.x+ee.x,j.y+ee.y,j.z+ee.z),X={pt1:U,pt2:j},W=_.MxCADAssist.GetClosestPointTo(X.pt1.x,X.pt1.y,X.pt2.x,X.pt2.y,O.x,O.y,!0);if(0<W.length()){var te=W.at(0),ne=new a.Vector3(te.x,te.y,te.z);if(ne.distanceTo(O)<M){var ce=k.MxThreeJS.createDashedLine(C.toSmallcoord2(j.x-ee.x,j.y-ee.y,j.z-ee.z),C.toSmallcoord(U),this.m_iDashedLineLenColor,T,T);J.add(ce),this.m_vecDynDrawEntity.push(ce),this.m_isValidTracePoint=!0,this.m_ptTracePoint=ne,this.CreteTracePoint(ne,R)}}}}}}else this.m_isTrace=!1},f.prototype.Init=function(){var O=this.m_mxJig.getMxObject();O.getMcObject().isValid()?(this.m_isValidTracePoint=!1,this.m_isTrace=!1,8&O.getSysVarLong("AUTOSNAP")&&(this.m_isTrace=!0),O.sysVariable().getSysVarNumber("GETPOINTSTATUS")&v.MxJigCmdManager.GETPOINTSTATUS.OsModePoloarTempDisable&&(this.m_isTrace=!1),this.m_mxJig.isDisablePolarAxisTrace()&&(this.m_isTrace=!1),this.m_isTrace):this.m_isTrace=!1},f.prototype.GetTracePoint=function(){if(this.m_isTrace)return this.m_isValidTracePoint?this.m_ptTracePoint:void 0},f.prototype.ClearDisplay=function(){this.ClearDynDrawEntity()},f.prototype.ReSetTempDisplay=function(){this.ClearDynDrawEntity(),this.m_isValidTracePoint=!1},f);function f(O){this.m_vecDynDrawEntity=[],this.m_ptTracePoint=new a.Vector3,this.m_isValidTracePoint=!1,this.m_isTrace=!1,this.m_mxJig=null,this.m_dashedLineLen=1.5,this.m_iDashedLineLenColor=11184810,this.m_mxJig=O}o.MxPolarAxisTrace=D},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxThreeJS":37,"../MxTools":38,"./MxJigCmdManager":54,three:19}],58:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0});var a=b("./MxFun");window.MXFUN_THREE=a.MxFun.getTHREE();var v=b("./MxManager");function h(){}(h.CreateMx=function(){a.MxFun.init(),typeof MxMain<"u"&&MxMain(b)==0||a.MxFun.createMxObject(),v.MxManager.callEvent("init");var w=a.MxFun.getUiObject();w!=null&&(w.sTitle=a.MxFun.getCurrentDraw().getFileTitle(),setTimeout(function(){w.init()},400))},h.Main=function(){if(typeof MxUiMain<"u"){MxUiMain(b);var w=a.MxFun.getUiObject();w!=null&&w.writeUICSS()}typeof MxDocumentReady>"u"?$(document).ready(function(){h.CreateMx()}):MxDocumentReady(b,h.CreateMx)},h).Main()},{"./MxFun":27,"./MxManager":29}],59:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxSvgManager=void 0;var a=b("three"),v=b("three"),h=b("./SVGLoader"),w=function(){this.svg=new a.Group,this.aryMeterial=[],this.boxSize=new v.Vector3(1,1,1)},L=(G.prototype.loadSVGImp=function(f,O,C,j){new h.SVGLoader().load(f,function(V){if(V.paths.length){var R=[],M=V.paths,ee=new a.Group,F=!0,_=!0,J=!1,T=!1;j&&(j.drawStrokes&&(F=j.drawStrokes),j.drawFillShapes&&(_=j.drawFillShapes),j.fillShapesWireframe&&(J=j.fillShapesWireframe),j.strokesWireframe&&(T=j.strokesWireframe));for(var B=0;B<M.length;B++){var N=M[B],u=N.userData.style.fill;if(_&&u!==void 0&&u!=="none"){for(var c=new a.MeshBasicMaterial({color:O||new a.Color().setStyle(u),opacity:N.userData.style.fillOpacity,transparent:N.userData.style.fillOpacity<1,side:a.DoubleSide,depthWrite:!1,wireframe:J}),m=h.SVGLoader.createShapes(N),E=0;E<m.length;E++){var U=m[E],X=new a.ShapeBufferGeometry(U),W=new a.Mesh(X,c);ee.add(W)}R.push(c)}var te=N.userData.style.stroke;if(F&&te!==void 0&&te!=="none"){c=new a.MeshBasicMaterial({color:O||new a.Color().setStyle(te),opacity:N.userData.style.strokeOpacity,transparent:N.userData.style.strokeOpacity<1,side:a.DoubleSide,depthWrite:!1,wireframe:T}),E=0;for(var ne=N.subPaths.length;E<ne;E++){var ce=N.subPaths[E];(X=h.SVGLoader.pointsToStroke(ce.getPoints(),N.userData.style,12,.001))&&(W=new a.Mesh(X,c),ee.add(W))}R.push(c)}}C&&C(ee,R)}else console.log("mx svg:"+f+" data.paths.length == 0"),C&&C(null,null)},void 0,function(){C&&C(null,null)})},G.prototype.loadSVG=function(f,O,C,j){var V=this,R=this.mapSvgUrlToData.get(f),M=!j||!j.useBuffer||j.useBuffer;if(R&&M){if(C)if(R==null)C(null,null);else{var ee=R.svg.clone();ee.boxSize=R.boxSize,C(ee,R.aryMeterial)}}else this.loadSVGImp(f,O,function(F,_){if(F&&_){var J=new w;J.svg=F,J.aryMeterial=_;var T=new v.Box3().setFromObject(F);J.boxSize.x=T.max.x-T.min.x,J.boxSize.y=T.max.y-T.min.y,J.boxSize.x!==-1/0&&J.boxSize.y!==-1/0||console.log("mx svg:"+f+" boxSize invalid"),V.mapSvgUrlToData.set(f,J);var B=J.svg.clone();B.boxSize=J.boxSize,C&&C(B,J.aryMeterial)}else V.mapSvgUrlToData.set(f,null),C&&C(null,null)},j)},G);function G(){this.mapSvgUrlToData=new Map}var k=(D.prototype.loadSVG=function(f,O,C,j){C&&this.mxThreeJsBuffer.loadSVG(f,O,C,j)},D);function D(){this.mxThreeJsBuffer=new L}o.MxSvgManager=k},{"./SVGLoader":60,three:19}],60:[function(b,r,o){var a,v=this&&this.__extends||(a=function(k,D){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,O){f.__proto__=O}||function(f,O){for(var C in O)Object.prototype.hasOwnProperty.call(O,C)&&(f[C]=O[C])})(k,D)},function(k,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function f(){this.constructor=k}a(k,D),k.prototype=D===null?Object.create(D):(f.prototype=D.prototype,new f)});Object.defineProperty(o,"__esModule",{value:!0}),o.SVGLoader=void 0;var h,w=b("three"),L=(v(G,h=w.Loader),G.prototype.load=function(k,D,f,O){var C=this,j=new w.FileLoader(C.manager);j.setPath(C.path),j.setRequestHeader(C.requestHeader),j.setWithCredentials(C.withCredentials),j.load(k,function(V){try{D(C.parse(V))}catch(R){O?O(R):console.error(R),C.manager.itemError(k)}},f,O)},G.prototype.parse=function(k){var D=this;function f(X,W,te,ne,ce,we,Ie,xe){if(W!=0&&te!=0){ne=ne*Math.PI/180,W=Math.abs(W),te=Math.abs(te);var Be=(Ie.x-xe.x)/2,q=(Ie.y-xe.y)/2,ge=Math.cos(ne)*Be+Math.sin(ne)*q,oe=-Math.sin(ne)*Be+Math.cos(ne)*q,se=W*W,Ae=te*te,Ye=ge*ge,Ge=oe*oe,Ne=Ye/se+Ge/Ae;if(1<Ne){var le=Math.sqrt(Ne);se=(W*=le)*W,Ae=(te*=le)*te}var ve=se*Ge+Ae*Ye,He=(se*Ae-ve)/ve,nt=Math.sqrt(Math.max(0,He));ce===we&&(nt=-nt);var ht=nt*W*oe/te,Tt=-nt*te*ge/W,Ct=Math.cos(ne)*ht-Math.sin(ne)*Tt+(Ie.x+xe.x)/2,We=Math.sin(ne)*ht+Math.cos(ne)*Tt+(Ie.y+xe.y)/2,It=O(1,0,(ge-ht)/W,(oe-Tt)/te),Bt=O((ge-ht)/W,(oe-Tt)/te,(-ge-ht)/W,(-oe-Tt)/te)%(2*Math.PI);X.currentPath.absellipse(Ct,We,W,te,It,It+Bt,we===0,ne)}else X.lineTo(xe.x,xe.y)}function O(X,W,te,ne){var ce=X*te+W*ne,we=Math.sqrt(X*X+W*W)*Math.sqrt(te*te+ne*ne),Ie=Math.acos(Math.max(-1,Math.min(1,ce/we)));return X*ne-W*te<0&&(Ie=-Ie),Ie}function C(X,W){W=Object.assign({},W);var te={};if(X.hasAttribute("class"))for(var ne=X.getAttribute("class").split(/\s/).filter(Boolean).map(function(Be){return Be.trim()}),ce=0;ce<ne.length;ce++)te=Object.assign(te,_["."+ne[ce]]);function we(Be,q,ge){ge===void 0&&(ge=function(oe){return oe.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),oe}),X.hasAttribute(Be)&&(W[q]=ge(X.getAttribute(Be))),te[Be]&&(W[q]=ge(te[Be])),X.style&&X.style[Be]!==""&&(W[q]=ge(X.style[Be]))}function Ie(Be){return Math.max(0,Math.min(1,ee(Be)))}function xe(Be){return Math.max(0,ee(Be))}return X.hasAttribute("id")&&(te=Object.assign(te,_["#"+X.getAttribute("id")])),we("fill","fill"),we("fill-opacity","fillOpacity",Ie),we("fill-rule","fillRule"),we("opacity","opacity",Ie),we("stroke","stroke"),we("stroke-opacity","strokeOpacity",Ie),we("stroke-width","strokeWidth",xe),we("stroke-linejoin","strokeLineJoin"),we("stroke-linecap","strokeLineCap"),we("stroke-miterlimit","strokeMiterLimit",xe),we("visibility","visibility"),W}function j(X,W){return X-(W-X)}function V(X,W,te){if(typeof X!="string")throw new TypeError("Invalid input: "+typeof X);var ne,ce={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},we=0,Ie=!0,xe="",Be="",q=[];function ge(Ye,Ge,Ne){var le=new SyntaxError('Unexpected character "'+Ye+'" at index '+Ge+".");throw le.partial=Ne,le}function oe(){xe!==""&&(Be===""?q.push(Number(xe)):q.push(Number(xe)*Math.pow(10,Number(Be)))),Be=xe=""}for(var se=X.length,Ae=0;Ae<se;Ae++)if(ne=X[Ae],Array.isArray(W)&&W.includes(q.length%te)&&ce.FLAGS.test(ne))we=1,xe=ne,oe();else{if(we===0){if(ce.WHITESPACE.test(ne))continue;if(ce.DIGIT.test(ne)||ce.SIGN.test(ne)){we=1,xe=ne;continue}if(ce.POINT.test(ne)){we=2,xe=ne;continue}ce.COMMA.test(ne)&&(Ie&&ge(ne,Ae,q),Ie=!0)}if(we===1){if(ce.DIGIT.test(ne)){xe+=ne;continue}if(ce.POINT.test(ne)){xe+=ne,we=2;continue}if(ce.EXP.test(ne)){we=3;continue}ce.SIGN.test(ne)&&xe.length===1&&ce.SIGN.test(xe[0])&&ge(ne,Ae,q)}if(we===2){if(ce.DIGIT.test(ne)){xe+=ne;continue}if(ce.EXP.test(ne)){we=3;continue}ce.POINT.test(ne)&&xe[xe.length-1]==="."&&ge(ne,Ae,q)}if(we===3){if(ce.DIGIT.test(ne)){Be+=ne;continue}if(ce.SIGN.test(ne)){if(Be===""){Be+=ne;continue}Be.length===1&&ce.SIGN.test(Be)&&ge(ne,Ae,q)}}ce.WHITESPACE.test(ne)?(oe(),we=0,Ie=!1):ce.COMMA.test(ne)?(oe(),Ie=!(we=0)):ce.SIGN.test(ne)?(oe(),we=1,xe=ne):ce.POINT.test(ne)?(oe(),we=2,xe=ne):ge(ne,Ae,q)}return oe(),q}var R=["mm","cm","in","pt","pc","px"],M={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function ee(X){var W="px";if(typeof X=="string"||X instanceof String)for(var te=0,ne=R.length;te<ne;te++){var ce=R[te];if(X.endsWith(ce)){W=ce,X=X.substring(0,X.length-ce.length);break}}var we=void 0;return W==="px"&&D.defaultUnit!=="px"?we=M.in[D.defaultUnit]/D.defaultDPI:(we=M[W][D.defaultUnit])<0&&(we=M[W].in*D.defaultDPI),we*parseFloat(X)}var F=[],_={},J=[],T=new w.Matrix3,B=new w.Matrix3,N=new w.Matrix3,u=new w.Matrix3,c=new w.Vector2,m=new w.Vector3,E=new w.Matrix3,U=new DOMParser().parseFromString(k,"image/svg+xml");return function X(W,te){if(W.nodeType===1){var ne,ce,we,Ie,xe,Be,q,ge,oe,se,Ae,Ye,Ge=function(Tt){if(!(Tt.hasAttribute("transform")||Tt.nodeName==="use"&&(Tt.hasAttribute("x")||Tt.hasAttribute("y"))))return null;var Ct=function(We){var It=new w.Matrix3,Bt=T;if(We.nodeName==="use"&&(We.hasAttribute("x")||We.hasAttribute("y"))){var Ln=ee(We.getAttribute("x")),rn=ee(We.getAttribute("y"));It.translate(Ln,rn)}if(We.hasAttribute("transform"))for(var Xn=We.getAttribute("transform").split(")"),yt=Xn.length-1;0<=yt;yt--){var ze=Xn[yt].trim();if(ze!==""){var Zt=ze.indexOf("("),An=ze.length;if(0<Zt&&Zt<An){var Yn=ze.substr(0,Zt),pt=V(ze.substr(Zt+1,An-Zt-1));switch(Bt.identity(),Yn){case"translate":1<=pt.length&&(rn=Ln=pt[0],2<=pt.length&&(rn=pt[1]),Bt.translate(Ln,rn));break;case"rotate":if(1<=pt.length){var st,qt=0,xn=0;st=-pt[0]*Math.PI/180,3<=pt.length&&(qt=pt[1],xn=pt[2]),B.identity().translate(-qt,-xn),N.identity().rotate(st),u.multiplyMatrices(N,B),B.identity().translate(qt,xn),Bt.multiplyMatrices(B,u)}break;case"scale":if(1<=pt.length){var nn=pt[0],er=nn;2<=pt.length&&(er=pt[1]),Bt.scale(nn,er)}break;case"skewX":pt.length===1&&Bt.set(1,Math.tan(pt[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":pt.length===1&&Bt.set(1,0,0,Math.tan(pt[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":pt.length===6&&Bt.set(pt[0],pt[2],pt[4],pt[1],pt[3],pt[5],0,0,1)}}It.premultiply(Bt)}}return It}(Tt);return 0<J.length&&Ct.premultiply(J[J.length-1]),E.copy(Ct),J.push(Ct),Ct}(W),Ne=!0,le=null;switch(W.nodeName){case"svg":break;case"style":(function(Tt){if(Tt.sheet&&Tt.sheet.cssRules&&Tt.sheet.cssRules.length)for(var Ct=0;Ct<Tt.sheet.cssRules.length;Ct++){var We=Tt.sheet.cssRules[Ct];if(We.type===1)for(var It=We.selectorText.split(/,/gm).filter(Boolean).map(function(Ln){return Ln.trim()}),Bt=0;Bt<It.length;Bt++)_[It[Bt]]=Object.assign(_[It[Bt]]||{},We.style)}})(W);break;case"g":te=C(W,te);break;case"path":te=C(W,te),W.hasAttribute("d")&&(le=function(Tt){for(var Ct=new w.ShapePath,We=new w.Vector2,It=new w.Vector2,Bt=new w.Vector2,Ln=!0,rn=!1,Xn=Tt.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),yt=0,ze=Xn.length;yt<ze;yt++){var Zt=Xn[yt],An=Zt.charAt(0),Yn=Zt.substr(1).trim();Ln===!0&&(Ln=!(rn=!0));var pt=void 0;switch(An){case"M":for(var st=0,qt=(pt=V(Yn)).length;st<qt;st+=2)We.x=pt[st+0],We.y=pt[st+1],It.x=We.x,It.y=We.y,st===0?Ct.moveTo(We.x,We.y):Ct.lineTo(We.x,We.y),st===0&&Bt.copy(We);break;case"H":for(st=0,qt=(pt=V(Yn)).length;st<qt;st++)We.x=pt[st],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"V":for(st=0,qt=(pt=V(Yn)).length;st<qt;st++)We.y=pt[st],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"L":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=2)We.x=pt[st+0],We.y=pt[st+1],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"C":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=6)Ct.bezierCurveTo(pt[st+0],pt[st+1],pt[st+2],pt[st+3],pt[st+4],pt[st+5]),It.x=pt[st+2],It.y=pt[st+3],We.x=pt[st+4],We.y=pt[st+5],st===0&&rn===!0&&Bt.copy(We);break;case"S":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=4)Ct.bezierCurveTo(j(We.x,It.x),j(We.y,It.y),pt[st+0],pt[st+1],pt[st+2],pt[st+3]),It.x=pt[st+0],It.y=pt[st+1],We.x=pt[st+2],We.y=pt[st+3],st===0&&rn===!0&&Bt.copy(We);break;case"Q":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=4)Ct.quadraticCurveTo(pt[st+0],pt[st+1],pt[st+2],pt[st+3]),It.x=pt[st+0],It.y=pt[st+1],We.x=pt[st+2],We.y=pt[st+3],st===0&&rn===!0&&Bt.copy(We);break;case"T":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=2){var xn=j(We.x,It.x),nn=j(We.y,It.y);Ct.quadraticCurveTo(xn,nn,pt[st+0],pt[st+1]),It.x=xn,It.y=nn,We.x=pt[st+0],We.y=pt[st+1],st===0&&rn===!0&&Bt.copy(We)}break;case"A":for(st=0,qt=(pt=V(Yn,[3,4],7)).length;st<qt;st+=7)if(pt[st+5]!=We.x||pt[st+6]!=We.y){var er=We.clone();We.x=pt[st+5],We.y=pt[st+6],It.x=We.x,It.y=We.y,f(Ct,pt[st],pt[st+1],pt[st+2],pt[st+3],pt[st+4],er,We),st===0&&rn===!0&&Bt.copy(We)}break;case"m":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=2)We.x+=pt[st+0],We.y+=pt[st+1],It.x=We.x,It.y=We.y,st===0?Ct.moveTo(We.x,We.y):Ct.lineTo(We.x,We.y),st===0&&Bt.copy(We);break;case"h":for(st=0,qt=(pt=V(Yn)).length;st<qt;st++)We.x+=pt[st],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"v":for(st=0,qt=(pt=V(Yn)).length;st<qt;st++)We.y+=pt[st],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"l":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=2)We.x+=pt[st+0],We.y+=pt[st+1],It.x=We.x,It.y=We.y,Ct.lineTo(We.x,We.y),st===0&&rn===!0&&Bt.copy(We);break;case"c":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=6)Ct.bezierCurveTo(We.x+pt[st+0],We.y+pt[st+1],We.x+pt[st+2],We.y+pt[st+3],We.x+pt[st+4],We.y+pt[st+5]),It.x=We.x+pt[st+2],It.y=We.y+pt[st+3],We.x+=pt[st+4],We.y+=pt[st+5],st===0&&rn===!0&&Bt.copy(We);break;case"s":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=4)Ct.bezierCurveTo(j(We.x,It.x),j(We.y,It.y),We.x+pt[st+0],We.y+pt[st+1],We.x+pt[st+2],We.y+pt[st+3]),It.x=We.x+pt[st+0],It.y=We.y+pt[st+1],We.x+=pt[st+2],We.y+=pt[st+3],st===0&&rn===!0&&Bt.copy(We);break;case"q":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=4)Ct.quadraticCurveTo(We.x+pt[st+0],We.y+pt[st+1],We.x+pt[st+2],We.y+pt[st+3]),It.x=We.x+pt[st+0],It.y=We.y+pt[st+1],We.x+=pt[st+2],We.y+=pt[st+3],st===0&&rn===!0&&Bt.copy(We);break;case"t":for(st=0,qt=(pt=V(Yn)).length;st<qt;st+=2)xn=j(We.x,It.x),nn=j(We.y,It.y),Ct.quadraticCurveTo(xn,nn,We.x+pt[st+0],We.y+pt[st+1]),It.x=xn,It.y=nn,We.x=We.x+pt[st+0],We.y=We.y+pt[st+1],st===0&&rn===!0&&Bt.copy(We);break;case"a":for(st=0,qt=(pt=V(Yn,[3,4],7)).length;st<qt;st+=7)pt[st+5]==0&&pt[st+6]==0||(er=We.clone(),We.x+=pt[st+5],We.y+=pt[st+6],It.x=We.x,It.y=We.y,f(Ct,pt[st],pt[st+1],pt[st+2],pt[st+3],pt[st+4],er,We),st===0&&rn===!0&&Bt.copy(We));break;case"Z":case"z":Ct.currentPath.autoClose=!0,0<Ct.currentPath.curves.length&&(We.copy(Bt),Ct.currentPath.currentPoint.copy(We),Ln=!0);break;default:console.warn(Zt)}rn=!1}return Ct}(W));break;case"rect":te=C(W,te),le=function(Tt){var Ct=ee(Tt.getAttribute("x")||0),We=ee(Tt.getAttribute("y")||0),It=ee(Tt.getAttribute("rx")||Tt.getAttribute("ry")||0),Bt=ee(Tt.getAttribute("ry")||Tt.getAttribute("rx")||0),Ln=ee(Tt.getAttribute("width")),rn=ee(Tt.getAttribute("height")),Xn=.448084975506,yt=new w.ShapePath;return yt.moveTo(Ct+It,We),yt.lineTo(Ct+Ln-It,We),It===0&&Bt===0||yt.bezierCurveTo(Ct+Ln-It*Xn,We,Ct+Ln,We+Bt*Xn,Ct+Ln,We+Bt),yt.lineTo(Ct+Ln,We+rn-Bt),It===0&&Bt===0||yt.bezierCurveTo(Ct+Ln,We+rn-Bt*Xn,Ct+Ln-It*Xn,We+rn,Ct+Ln-It,We+rn),yt.lineTo(Ct+It,We+rn),It===0&&Bt===0||yt.bezierCurveTo(Ct+It*Xn,We+rn,Ct,We+rn-Bt*Xn,Ct,We+rn-Bt),yt.lineTo(Ct,We+Bt),It===0&&Bt===0||yt.bezierCurveTo(Ct,We+Bt*Xn,Ct+It*Xn,We,Ct+It,We),yt}(W);break;case"polygon":te=C(W,te),se=W,Ae=new w.ShapePath,Ye=0,se.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(Tt,Ct,We){var It=ee(Ct),Bt=ee(We);Ye===0?Ae.moveTo(It,Bt):Ae.lineTo(It,Bt),Ye++}),Ae.currentPath.autoClose=!0,le=Ae;break;case"polyline":te=C(W,te),q=W,ge=new w.ShapePath,oe=0,q.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(Tt,Ct,We){var It=ee(Ct),Bt=ee(We);oe===0?ge.moveTo(It,Bt):ge.lineTo(It,Bt),oe++}),ge.currentPath.autoClose=!1,le=ge;break;case"circle":te=C(W,te),le=function(Tt){var Ct=ee(Tt.getAttribute("cx")||0),We=ee(Tt.getAttribute("cy")||0),It=ee(Tt.getAttribute("r")||0),Bt=new w.Path;Bt.absarc(Ct,We,It,0,2*Math.PI,!1);var Ln=new w.ShapePath;return Ln.subPaths.push(Bt),Ln}(W);break;case"ellipse":te=C(W,te),le=function(Tt){var Ct=ee(Tt.getAttribute("cx")||0),We=ee(Tt.getAttribute("cy")||0),It=ee(Tt.getAttribute("rx")||0),Bt=ee(Tt.getAttribute("ry")||0),Ln=new w.Path;Ln.absellipse(Ct,We,It,Bt,0,2*Math.PI,void 0,void 0);var rn=new w.ShapePath;return rn.subPaths.push(Ln),rn}(W);break;case"line":te=C(W,te),ce=ee((ne=W).getAttribute("x1")||0),we=ee(ne.getAttribute("y1")||0),Ie=ee(ne.getAttribute("x2")||0),xe=ee(ne.getAttribute("y2")||0),(Be=new w.ShapePath).moveTo(ce,we),Be.lineTo(Ie,xe),Be.currentPath.autoClose=!1,le=Be;break;case"defs":Ne=!1;break;case"use":te=C(W,te);var ve=W.href.baseVal.substring(1),He=W.viewportElement.getElementById(ve);He?X(He,te):console.warn("SVGLoader: 'use node' references non-existent node id: "+ve)}if(le&&(te.fill!==void 0&&te.fill!=="none"&&le.color.setStyle(te.fill),function(Tt,Ct){function We(Yn){m.set(Yn.x,Yn.y,1).applyMatrix3(Ct),Yn.set(m.x,m.y)}for(var It=function(Yn){return Yn.elements[1]!==0||Yn.elements[3]!==0}(Ct),Bt=Tt.subPaths,Ln=0,rn=Bt.length;Ln<rn;Ln++)for(var Xn=Bt[Ln].curves,yt=0;yt<Xn.length;yt++){var ze=Xn[yt];ze.isLineCurve?(We(ze.v1),We(ze.v2)):ze.isCubicBezierCurve?(We(ze.v0),We(ze.v1),We(ze.v2),We(ze.v3)):ze.isQuadraticBezierCurve?(We(ze.v0),We(ze.v1),We(ze.v2)):ze.isEllipseCurve&&(It&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),c.set(ze.aX,ze.aY),We(c),ze.aX=c.x,ze.aY=c.y,ze.xRadius*=(An=Ct.elements,Math.sqrt(An[0]*An[0]+An[1]*An[1])),ze.yRadius*=(Zt=Ct.elements,Math.sqrt(Zt[3]*Zt[3]+Zt[4]*Zt[4])))}var Zt,An}(le,E),F.push(le),le.userData={node:W,style:te}),Ne)for(var nt=W.childNodes,ht=0;ht<nt.length;ht++)X(nt[ht],te);Ge&&(J.pop(),0<J.length?E.copy(J[J.length-1]):E.identity())}}(U.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:F,xml:U.documentElement}},G.createShapes=function(k){var D=999999999,f={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},O={loc:f.ORIGIN,t:0};function C(T,B,N,u){var c=T.x,m=B.x,E=N.x,U=u.x,X=T.y,W=B.y,te=N.y,ne=u.y,ce=(U-E)*(X-te)-(ne-te)*(c-E),we=(ne-te)*(m-c)-(U-E)*(W-X),Ie=ce/we,xe=((m-c)*(X-te)-(W-X)*(c-E))/we;if(we==0&&ce!=0||Ie<=0||1<=Ie||xe<0||1<xe)return null;if(ce==0&&we==0){for(var Be=0;Be<2;Be++){if(j(Be===0?N:u,T,B),O.loc==f.ORIGIN)return{x:(q=Be===0?N:u).x,y:q.y,t:O.t};if(O.loc==f.BETWEEN)return{x:+(c+O.t*(m-c)).toPrecision(10),y:+(X+O.t*(W-X)).toPrecision(10),t:O.t}}return null}for(Be=0;Be<2;Be++){var q;if(j(Be===0?N:u,T,B),O.loc==f.ORIGIN)return{x:(q=Be===0?N:u).x,y:q.y,t:O.t}}return{x:+(c+Ie*(m-c)).toPrecision(10),y:+(X+Ie*(W-X)).toPrecision(10),t:Ie}}function j(T,B,N){var u,c=N.x-B.x,m=N.y-B.y,E=T.x-B.x,U=T.y-B.y,X=c*U-E*m;return T.x===B.x&&T.y===B.y?(O.loc=f.ORIGIN,O.t=0):T.x===N.x&&T.y===N.y?(O.loc=f.DESTINATION,O.t=1,0):void(X<-Number.EPSILON?O.loc=f.LEFT:X>Number.EPSILON?O.loc=f.RIGHT:c*E<0||m*U<0?O.loc=f.BEHIND:Math.sqrt(c*c+m*m)<Math.sqrt(E*E+U*U)?O.loc=f.BEYOND:(u=c!=0?E/c:U/m,O.loc=f.BETWEEN,O.t=u))}function V(T,B,N){var u=new w.Vector2;B.getCenter(u);var c=[];return N.forEach(function(m){m.boundingBox.containsPoint(u)&&function(E,U){for(var X=[],W=[],te=1;te<E.length;te++)for(var ne=E[te-1],ce=E[te],we=function(xe){var Be=U[xe-1],q=U[xe],ge=C(ne,ce,Be,q);ge!==null&&X.find(function(oe){return oe.t<=ge.t+Number.EPSILON&&oe.t>=ge.t-Number.EPSILON})===void 0&&(X.push(ge),W.push(new w.Vector2(ge.x,ge.y)))},Ie=1;Ie<U.length;Ie++)we(Ie);return W}(T,m.points).forEach(function(E){c.push({identifier:m.identifier,isCW:m.isCW,point:E})})}),c.sort(function(m,E){return m.point.x-E.point.x}),c}var R=0,M=D,ee=-D,F=k.subPaths.map(function(T){for(var B=T.getPoints(),N=-D,u=D,c=-D,m=D,E=0;E<B.length;E++){var U=B[E];U.y>N&&(N=U.y),U.y<u&&(u=U.y),U.x>c&&(c=U.x),U.x<m&&(m=U.x)}return ee<=c&&(ee=c+1),m<=M&&(M=m-1),{curves:T.curves,points:B,isCW:w.ShapeUtils.isClockWise(B),identifier:R++,boundingBox:new w.Box2(new w.Vector2(m,u),new w.Vector2(c,N))}});F=F.filter(function(T){return 1<T.points.length}),R=0;var _=(F=F.map(function(T){return T.identifier=R,R++,T})).map(function(T){return function(B,N,u,c,m){m!=null&&m!==""||(m="nonzero");var E=new w.Vector2;B.boundingBox.getCenter(E);var U=V([new w.Vector2(u,E.y),new w.Vector2(c,E.y)],B.boundingBox,N);U.sort(function(ge,oe){return ge.point.x-oe.point.x});var X=[],W=[];U.forEach(function(ge){ge.identifier===B.identifier?X.push(ge):W.push(ge)});for(var te=X[0].point.x,ne=[],ce=0;ce<W.length&&W[ce].point.x<te;)0<ne.length&&ne[ne.length-1]===W[ce].identifier?ne.pop():ne.push(W[ce].identifier),ce++;if(ne.push(B.identifier),m==="evenodd"){var we=ne.length%2==0,Ie=ne[ne.length-2];return{identifier:B.identifier,isHole:we,for:Ie}}if(m==="nonzero"){we=!0;for(var xe=Ie=null,Be=0;Be<ne.length;Be++){var q=ne[Be];we?(xe=N[q].isCW,we=!1,Ie=q):xe!==N[q].isCW&&(xe=N[q].isCW,we=!0)}return{identifier:B.identifier,isHole:we,for:Ie}}console.warn('fill-rule: "'+m+'" is currently not implemented.')}(T,F,M,ee,k.userData.style.fillRule)}),J=[];return F.forEach(function(T){if(!_[T.identifier].isHole){var B=new w.Shape;B.curves=T.curves,_.filter(function(N){return N.isHole&&N.for===T.identifier}).forEach(function(N){var u=F[N.identifier],c=new w.Path;c.curves=u.curves,B.holes.push(c)}),J.push(B)}}),J},G.getStrokeStyle=function(k,D,f,O,C){return{strokeColor:D=D!==void 0?D:"#000",strokeWidth:k=k!==void 0?k:1,strokeLineJoin:f=f!==void 0?f:"miter",strokeLineCap:O=O!==void 0?O:"butt",strokeMiterLimit:C=C!==void 0?C:4}},G.pointsToStroke=function(k,D,f,O){var C=[],j=[],V=[];if(G.pointsToStrokeWithBuffers(k,D,f,O,C,j,V)===0)return null;var R=new w.BufferGeometry;return R.setAttribute("position",new w.Float32BufferAttribute(C,3)),R.setAttribute("normal",new w.Float32BufferAttribute(j,3)),R.setAttribute("uv",new w.Float32BufferAttribute(V,2)),R},G.pointsToStrokeWithBuffers=function(k,D,f,O,C,j,V,R){var M=new w.Vector2,ee=new w.Vector2,F=new w.Vector2,_=new w.Vector2,J=new w.Vector2,T=new w.Vector2,B=new w.Vector2,N=new w.Vector2,u=new w.Vector2,c=new w.Vector2,m=new w.Vector2,E=new w.Vector2,U=new w.Vector2,X=new w.Vector2,W=new w.Vector2,te=new w.Vector2,ne=new w.Vector2;f=f!==void 0?f:12,O=O!==void 0?O:.001,R=R!==void 0?R:0;var ce=(k=function(qt){for(var xn=!1,nn=1,er=qt.length-1;nn<er;nn++)if(qt[nn].distanceTo(qt[nn+1])<O){xn=!0;break}if(!xn)return qt;var kr=[];for(kr.push(qt[0]),nn=1,er=qt.length-1;nn<er;nn++)qt[nn].distanceTo(qt[nn+1])>=O&&kr.push(qt[nn]);return kr.push(qt[qt.length-1]),kr}(k)).length;if(ce<2)return 0;var we,Ie,xe,Be,q,ge,oe=k[0].equals(k[ce-1]),se=k[0],Ae=D.strokeWidth/2,Ye=1/(ce-1),Ge=0,Ne=!1,le=0,ve=3*R,He=2*R;yt(k[0],k[1],M).multiplyScalar(Ae),N.copy(k[0]).sub(M),u.copy(k[0]).add(M),c.copy(N),m.copy(u);for(var nt=1;nt<ce;nt++){we=k[nt],Ie=nt===ce-1?oe?k[1]:void 0:k[nt+1];var ht=M;if(yt(se,we,ht),F.copy(ht).multiplyScalar(Ae),E.copy(we).sub(F),U.copy(we).add(F),xe=Ge+Ye,Be=!1,Ie!==void 0){yt(we,Ie,ee),F.copy(ee).multiplyScalar(Ae),X.copy(we).sub(F),W.copy(we).add(F),q=!0,F.subVectors(Ie,se),ht.dot(F)<0&&(q=!1),nt===1&&(Ne=q),F.subVectors(Ie,we),F.normalize();var Tt=Math.abs(ht.dot(F));if(Tt!==0){var Ct=Ae/Tt;F.multiplyScalar(-Ct),_.subVectors(we,se),J.copy(_).setLength(Ct).add(F),te.copy(J).negate();var We=J.length(),It=_.length();_.divideScalar(It),T.subVectors(Ie,we);var Bt=T.length();switch(T.divideScalar(Bt),_.dot(te)<It&&T.dot(te)<Bt&&(Be=!0),ne.copy(J).add(we),te.add(we),ge=!1,Be?q?(W.copy(te),U.copy(te)):(X.copy(te),E.copy(te)):An(),D.strokeLineJoin){case"bevel":Yn(q,Be,xe);break;case"round":pt(q,Be),q?Zt(we,E,X,xe,0):Zt(we,W,U,xe,1);break;default:var Ln=Ae*D.strokeMiterLimit/We;if(Ln<1){if(D.strokeLineJoin!=="miter-clip"){Yn(q,Be,xe);break}pt(q,Be),q?(T.subVectors(ne,E).multiplyScalar(Ln).add(E),B.subVectors(ne,X).multiplyScalar(Ln).add(X),ze(E,xe,0),ze(T,xe,0),ze(we,xe,.5),ze(we,xe,.5),ze(T,xe,0),ze(B,xe,0),ze(we,xe,.5),ze(B,xe,0),ze(X,xe,0)):(T.subVectors(ne,U).multiplyScalar(Ln).add(U),B.subVectors(ne,W).multiplyScalar(Ln).add(W),ze(U,xe,1),ze(T,xe,1),ze(we,xe,.5),ze(we,xe,.5),ze(T,xe,1),ze(B,xe,1),ze(we,xe,.5),ze(B,xe,1),ze(W,xe,1))}else Be?(q?(ze(u,Ge,1),ze(N,Ge,0),ze(ne,xe,0),ze(u,Ge,1),ze(ne,xe,0),ze(te,xe,1)):(ze(u,Ge,1),ze(N,Ge,0),ze(ne,xe,1),ze(N,Ge,0),ze(te,xe,0),ze(ne,xe,1)),q?X.copy(ne):W.copy(ne)):q?(ze(E,xe,0),ze(ne,xe,0),ze(we,xe,.5),ze(we,xe,.5),ze(ne,xe,0),ze(X,xe,0)):(ze(U,xe,1),ze(ne,xe,1),ze(we,xe,.5),ze(we,xe,.5),ze(ne,xe,1),ze(W,xe,1)),ge=!0}}else An()}else An();oe||nt!==ce-1||st(k[0],c,m,q,!0,Ge),Ge=xe,se=we,N.copy(X),u.copy(W)}if(oe){if(Be&&C){var rn=ne,Xn=te;Ne!==q&&(rn=te,Xn=ne),q?(ge||Ne)&&(Xn.toArray(C,0),Xn.toArray(C,9),ge&&rn.toArray(C,3)):!ge&&Ne||(Xn.toArray(C,3),Xn.toArray(C,9),ge&&rn.toArray(C,0))}}else st(we,E,U,q,!1,xe);return le;function yt(qt,xn,nn){return nn.subVectors(xn,qt),nn.set(-nn.y,nn.x).normalize()}function ze(qt,xn,nn){C&&(C[ve]=qt.x,C[ve+1]=qt.y,C[ve+2]=0,j&&(j[ve]=0,j[ve+1]=0,j[ve+2]=1),ve+=3,V&&(V[He]=xn,V[He+1]=nn,He+=2)),le+=3}function Zt(qt,xn,nn,er,kr){M.copy(xn).sub(qt).normalize(),ee.copy(nn).sub(qt).normalize();var ct=Math.PI,Ue=M.dot(ee);Math.abs(Ue)<1&&(ct=Math.abs(Math.acos(Ue))),ct/=f,F.copy(xn);for(var lt=0,Wt=f-1;lt<Wt;lt++)_.copy(F).rotateAround(qt,ct),ze(F,er,kr),ze(_,er,kr),ze(qt,er,.5),F.copy(_);ze(_,er,kr),ze(nn,er,kr),ze(qt,er,.5)}function An(){ze(u,Ge,1),ze(N,Ge,0),ze(E,xe,0),ze(u,Ge,1),ze(E,xe,1),ze(U,xe,0)}function Yn(qt,xn,nn){xn?(qt?(ze(u,Ge,1),ze(N,Ge,0),ze(E,xe,0),ze(u,Ge,1),ze(E,xe,0),ze(te,xe,1),ze(E,nn,0),ze(X,nn,0)):(ze(u,Ge,1),ze(N,Ge,0),ze(U,xe,1),ze(N,Ge,0),ze(te,xe,0),ze(U,xe,1),ze(U,nn,1),ze(W,nn,0)),ze(te,nn,.5)):(qt?(ze(E,nn,0),ze(X,nn,0)):(ze(U,nn,1),ze(W,nn,0)),ze(we,nn,.5))}function pt(qt,xn){xn&&(qt?(ze(u,Ge,1),ze(N,Ge,0),ze(E,xe,0),ze(u,Ge,1),ze(E,xe,0),ze(te,xe,1),ze(E,Ge,0),ze(we,xe,.5),ze(te,xe,1),ze(we,xe,.5),ze(X,Ge,0),ze(te,xe,1)):(ze(u,Ge,1),ze(N,Ge,0),ze(U,xe,1),ze(N,Ge,0),ze(te,xe,0),ze(U,xe,1),ze(U,Ge,1),ze(te,xe,0),ze(we,xe,.5),ze(we,xe,.5),ze(te,xe,0),ze(W,Ge,1)))}function st(qt,xn,nn,er,kr,ct){switch(D.strokeLineCap){case"round":kr?Zt(qt,nn,xn,ct,.5):Zt(qt,xn,nn,ct,.5);break;case"square":if(kr)M.subVectors(xn,qt),ee.set(M.y,-M.x),F.addVectors(M,ee).add(qt),_.subVectors(ee,M).add(qt),er?(F.toArray(C,3),_.toArray(C,0),_.toArray(C,9)):(F.toArray(C,3),F.toArray(C,9),_.toArray(C,0));else{M.subVectors(nn,qt),ee.set(M.y,-M.x),F.addVectors(M,ee).add(qt),_.subVectors(ee,M).add(qt);var Ue=C.length;er?(F.toArray(C,Ue-3),_.toArray(C,Ue-6)):(F.toArray(C,Ue-6),_.toArray(C,Ue-3)),_.toArray(C,Ue-12)}}}},G);function G(k){var D=h.call(this,k)||this;return D.defaultDPI=90,D.defaultUnit="px",D}o.SVGLoader=L},{three:19}],61:[function(b,r,o){var a,v=this&&this.__extends||(a=function(u,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,E){m.__proto__=E}||function(m,E){for(var U in E)Object.prototype.hasOwnProperty.call(E,U)&&(m[U]=E[U])})(u,c)},function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function m(){this.constructor=u}a(u,c),u.prototype=c===null?Object.create(c):(m.prototype=c.prototype,new m)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxTest=void 0;var h,w,L,G=b("../Operate/MrxDbgUiPrBase"),k=b("../Operate/MrxDbgUiPrPoint"),D=b("../MxThreeJS"),f=b("three"),O=b("../MxFun"),C=b("../View/MxDbEntity"),j=b("../MrxDbgUtils"),V=b("../Operate/MrxDbgUiPrDist"),R=(b("../MxString"),v(M,h=C.MxDbEntityUserObject),M.prototype.worldDraw=function(u){var c=new f.Vector3(this.pt.x-this.r,this.pt.y-this.r,0),m=new f.Vector3(this.pt.x+this.r,this.pt.y+this.r,0);new f.Vector3(c.x,m.y);var E=new f.Vector3(m.x,c.y);u.setDashLineDisplay(!0),u.setDash(.1,.2),u.drawLine(E,c)},M.prototype.setPoint=function(u){this.pt=u},M.prototype.setR=function(u){this.r=u},M.prototype.getTypeName=function(){return"MxDbTest"},M.prototype.getGripPoints=function(){var u=[];return u.push(this.pt),u},M.prototype.moveGripPointsAt=function(u,c){return u==0&&this.pt.add(c),!0},M.prototype.dwgIn=function(u){return h.prototype.dwgIn.call(this,u),this.pt.copy(u.pt),this.r=u.r,!0},M.prototype.dwgOut=function(u){return h.prototype.dwgOut.call(this,u),u.pt=this.pt,u.r=this.r,u},M.prototype.create=function(){return new M},M);function M(){var u=h!==null&&h.apply(this,arguments)||this;return u.pt=new f.Vector3,u.r=100,u}function ee(u){var c=new k.MrxDbgUiPrPoint;c.setMessage(`
指定第一点:`),c.go(function(m){if(m==0){var E=c.value(),U=new f.Vector3;U.x=E.x,U.y=E.y;var X=new G.McEdGetPointWorldDrawObject;X.setDraw(function(W,te){te.setColor(255),te.drawLine(W,U)}),c.setUserDraw(X),c.setMessage(`
指定下一点:`),c.go(function(W){if(W==0){var te=c.value(),ne=O.MxFun.getCurrentDraw(),ce=D.MxThreeJS.createLine(E,te,16777215);ne.addObject(ce)}})}})}function F(){var u=new k.MrxDbgUiPrPoint;u.setMessage(`
指定第一点:`),u.go(function(c){if(c==0){var m=O.MxFun.getCurrentDraw(),E=new R;E.setColor(16711680),E.setPoint(u.value()),E.setR(m.viewCoordLong2Cad(100)),m.addMxEntity(E),m.addMxCurrentSelect(E.objectId())}})}function _(){j.MrxDbgUtils.selectEnt("Test").then(function(u){console.log(u)})}function J(){var u=O.MxFun.getCurrentDraw();L?(u.eraseAllMxEntity(),u.loadMxEntityFromJson(L)):(L=u.saveMxEntityToJson(),console.log(L))}function T(){O.MxFun.openFile("demo/buf/hhhh.dwg?token=123456")}function B(){var u=new k.MrxDbgUiPrPoint;u.setMessage(`
指定第一点:`),u.go(function(c){if(c==0){var m=u.value();j.MrxDbgUtils.getCorner(m,"Test",!0).then(function(E){console.log("xxxdddd"),console.log(E)})}})}function N(){var u=new V.MrxDbgUiPrDist;u.setMessage(`
输入距离:`),u.go(function(c){if(c==0){var m=u.value();console.log(m)}})}(w||(o.MxTest=w={})).registerCommand=function(){console.log("regist mx test"),new R().init(),O.MxFun.addCommand("MxTest_GetPoint",ee),O.MxFun.addCommand("MxTest_GetDist",N),O.MxFun.addCommand("MxTest_DrawCustomEntity",F),O.MxFun.addCommand("MxTest_EntSel",_),O.MxFun.addCommand("MxTest_SaveMxDbEntityToJson",J),O.MxFun.addCommand("MxTest_OpenFile",T),O.MxFun.addCommand("MxTest_GetCorner",B),O.MxFun.addWindowsEvent(function(u,c){if(u=="mouseup"){if(O.MxFun.isRunningCommand()||c.button!=0)return 0;var m=c.srcElement;if(m&&m.tagName=="CANVAS"){var E=O.MxFun.getCurrentDraw(),U=new f.Vector3(c.offsetX,c.offsetY,0);E.findMxEntityAtPoint(U,!1).length&&c.preventDefault()}return 0}})}},{"../MrxDbgUtils":20,"../MxFun":27,"../MxString":34,"../MxThreeJS":37,"../Operate/MrxDbgUiPrBase":45,"../Operate/MrxDbgUiPrDist":46,"../Operate/MrxDbgUiPrPoint":47,"../View/MxDbEntity":69,three:19}],62:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.MxUiObject=exports.MxToolBarItem=exports.MxMenuItem=void 0;var MxFun_1=require("../MxFun"),MxMenuItem=function(){this.id=-1,this.text="",this.evalString="",this.parentId=-1};exports.MxMenuItem=MxMenuItem;var MxToolBarItem=function(){this.isMxCommand=!1,this.itemid=""};exports.MxToolBarItem=MxToolBarItem;var MxUiObject=function(){function MxUiObject(){this.vecMenuItem=new Array,this.vecToolBarItem=new Array,this.uiPath="./ui",this.idMenuItemCount=100,this.isShowTitle=!1,this.isShowStructTree=!1,this.isEnableLoading=!0,this.isShowLayer=!1,this.isShowTakeColor=!1,this.isShowLayout=!1,this.isEnableObjectProperty=!1,this.isShowToolbar=!1,this.isShowMainMenu=!1,this.sTitle="",this.sLanguageTable={layout:"布局",layer:"图层",visible:"可见",color:"颜色",name:"名字",status:"状态",openComplete:"提示：打开图纸完成"}}return MxUiObject.prototype.SetLayoutData=function(b){this.vecLayoutData=b},MxUiObject.prototype.CallMxCommand=function(b){MxFun_1.MxFun.callCommand(b,"")},MxUiObject.prototype.EvalJs=function(value){eval(value)},MxUiObject.prototype.SetLayerData=function(b){this.vecLayerData=b},MxUiObject.prototype.SetSketchLayerData=function(b){this.vecSketchLayerData=b},MxUiObject.prototype.init=function(){this.onInit()},MxUiObject.prototype.addMenuItem=function(b,r,o,a){r===void 0&&(r=""),o===void 0&&(o=-1),a===void 0&&(a=-1);var v=new MxMenuItem;v.text=b,v.evalString=r,a==-1&&(a=this.idMenuItemCount,this.idMenuItemCount++),v.id=a,v.parentId=o,this.vecMenuItem.push(v)},MxUiObject.prototype.addToolBarItem=function(b,r,o,a,v){r===void 0&&(r=""),o===void 0&&(o=""),a===void 0&&(a=!1),v===void 0&&(v="");var h=new MxToolBarItem;h.image=b,h.evalString=o,h.text=r,h.isMxCommand=a,h.itemid=v,this.vecToolBarItem.push(h)},MxUiObject.prototype.setPath=function(b){this.uiPath=b},MxUiObject.prototype.getPath=function(){return this.uiPath},MxUiObject.prototype.create=function(){this.onCreate()},MxUiObject.prototype.writeUICSS=function(){var b=this.uiPath;MxFun_1.MxFun.isPC()?(document.write("<link rel='stylesheet' href='"+b+"/css/mxbimpcm.css'>"),this.isShowMainMenu&&(document.write("<link rel='stylesheet' href='"+b+"/css/rightfacefonts2.css'>"),document.write("<link rel='stylesheet' href='"+b+"/css/rightmnu.css'>"),document.write("<script type='text/javascript' src='"+b+"/hc-mobile-nav.js'><\/script>"))):(document.write("<link rel='stylesheet' href='"+b+"/css/mxmobile.css'>"),this.isShowMainMenu&&(document.write("<link href='"+b+"/css/font-awesome.min.css' rel='stylesheet'>"),document.write("<link rel='stylesheet' href='"+b+"/css/rightfacefonts1.css'>"),document.write("<link rel='stylesheet' href='"+b+"/css/rightfacefonts2.css'>"),document.write("<link rel='stylesheet' href='"+b+"/css/rightmnu.css'>"),document.write("<script type='text/javascript' src='"+b+"/hc-mobile-nav.js'><\/script>")))},MxUiObject}();exports.MxUiObject=MxUiObject},{"../MxFun":27}],63:[function(b,r,o){var a,v=this&&this.__extends||(a=function(D,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,C){O.__proto__=C}||function(O,C){for(var j in C)Object.prototype.hasOwnProperty.call(C,j)&&(O[j]=C[j])})(D,f)},function(D,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function O(){this.constructor=D}a(D,f),D.prototype=f===null?Object.create(f):(O.prototype=f.prototype,new O)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxUiObjectMobile=void 0;var h,w=b("./MxUiObject"),L=b("../MxFun"),G=(v(k,h=w.MxUiObject),k.prototype.onCreate=function(){this.isShowTitle&&this.WriteTitle(),this.WriteStructTree(),this.isEnableLoading&&this.WriteLoading(),this.WriteLayer(),this.WriteTakeColor(),this.WriteLayout(),this.isEnableObjectProperty&&this.WriteObjectProperty(),this.isShowToolbar&&this.WriteToolbar()},k.prototype.onInit=function(){this.InitEvent()},k.prototype.ShowLoading=function(){this.isEnableLoading&&($(".Prompt").css("background","rgba(0, 0, 0, 0)"),$(".Prompt").fadeIn(100),$(".Prompt span").css("display","none"))},k.prototype.HideLoading=function(){this.isEnableLoading&&($(".Prompt").css("background","rgba(0, 0, 0, 0.8)"),$(".Prompt div").fadeOut(100),$(".Prompt span").fadeIn(200),setTimeout(function(){$(".Prompt").fadeOut(1e3)},1e3))},k.prototype.ShowObjectProperty=function(D){if(D.length!=0){var f;f=typeof D=="string"?JSON.parse(D):D;var O="";for(var C in f){var j=f[C];for(var V in O+='<tbody class="bf-group undefined bf-collapse">',O+='<tr class="bf-group-title">',O+='<td colspan="2"><i class="bf-icon" style=" padding: 12px;"></i>'+j.name+"</td>",O+="</tr>",j.datas){var R=j.datas[V];O+="<tr class='bf-group-content'>",O+="<td class='bf-key'>"+R.name+"</td>",O+="<td class='bf-value'>"+R.value+"</td>",O+="</tr>"}O+="</tbody>"}document.getElementById("ComponentContent").innerHTML=O,$(".bf-group").click(function(){$(this).hasClass("bf-collapse")?$(this).removeClass("bf-collapse"):$(this).addClass("bf-collapse")})}},k.prototype.HideObjectProp=function(){},k.prototype.SwitchShowLayer=function(){var D=document.getElementById("LayerInterface");D.style.display=="none"?(D.style.display="block",D.style.left="80px",D.style.top="50px"):D.style.display="none"},k.prototype.SwitchShowStructTree=function(){},k.prototype.Chosecolor=function(){document.getElementById("color-picker").click()},k.prototype.ColorChange=function(D){document.getElementById("colorbox").style.backgroundColor=D,L.MxFun.setCurrentColor(D)},k.prototype.SwitchShowLayout=function(){var D=document.getElementById("LayerOutInterface");D.style.display=="none"?D.style.display="block":D.style.display="none"},k.prototype.WriteTitle=function(){var D=this.uiPath;document.write("<div class='bar1'>"),document.write("<img src='"+D+"/image/mxcad.png' style='height: 50%;position: absolute;top: 12px;left: 10px;'>"),document.write("<span  class='barspan'  style='position: absolute;left: 45px;'>"),document.write("</span>"),document.write("<div id='container'>"),this.isShowMainMenu&&(document.write("<header>"),document.write("<div class='wrapper cf'style='z-index: 999'>"),document.write("<nav id='main-nav' >"),document.write("</nav>"),document.write("<a class='toggle'>"),document.write("<span></span>"),document.write("</a>"),document.write("</div>"),document.write("</header>")),document.write("</div>"),document.write("</div>")},k.prototype.WriteToolbar=function(){document.write("<div id='MainMenuContent' class='bf-toolbar bf-toolbar-bottom'>"),document.write("</div>")},k.prototype.WriteLoading=function(){var D=this.uiPath;document.write("<div class='Prompt' style='width: 100px;height:30px;position:"),document.write("absolute;top: 60px;left: 50%;margin-left: -50px;color: #fff;text-align: center;'>"),document.write("<div style='text-align: center;'>"),document.write("<img src='"+D+"/image/loading.gif' alt='' style='width:30px;height:30px;float: left'>"),document.write("<p style='color:black;vertical-align: middle;float: left;  margin-top: 5px;margin-left: 5px;'>加载中.....</p>"),document.write("</div>"),document.write("<span style='vertical-align: middle;display: none'>图纸加载完毕</span>"),document.write("</div>")},k.prototype.WriteLayer=function(){var D=this.uiPath;this.isShowLayer&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' title='ModelTree' style='position: absolute; top:111px;left: 0px;' onclick='uiObj.SwitchShowLayer()'>"),document.write("<div class='bf-button mxbim-bf-tree' title='图层'>"),document.write("<img src='"+D+"/image/layer.png.gif' alt='' style='width: 24px;'>"),document.write("</div>"),document.write("</div>")),document.write("<div class='bf-panel bf-has-title bf-sizable' id='LayerInterface' title='图层'"),document.write("style='left: 0px;"),document.write("top: 0px;"),document.write("width: 100%;"),document.write("height: 100%;"),document.write("display: none;'>"),document.write("<div class='bf-close' onclick='uiObj.SwitchShowLayer()' style='text-align: center;'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' style='cursor: move; user-select: none;'>图层</div>"),document.write("<div>"),document.write("<div class='layer-title' style='width: 12.5%;'>可见</div>"),document.write("<div class='layer-title' style='width: 12.5%;'>颜色</div>"),document.write("<div class='layer-title' style='width: 62.5%'>名字</div>"),document.write("<div class='layer-title' style='width: 12.5%'>状态</div>"),document.write("</div>"),document.write("<div id='Layer-Info'  style='margin-top: 26px;height: 79%;width: 100%; position: absolute;overflow-y: auto;'>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteStructTree=function(){this.isShowStructTree&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='Fmj' title='ModelTree'"),document.write("style='position: absolute; top:60px;left: 0px;' onclick='uiObj.SwitchShowStructTree()'>"),document.write("<div class='bf-button mxbim-bf-tree' title='构件树'><i class='fa fa-sitemap' aria-hidden='true' style='font-size: 24px;'></i></div>"),document.write("</div>")),document.write("<div class='bf-panel  bf-has-title bf-sizable tree-panel' id='dv' title='目录树' style='left: 0px; top: 0px; width: 100%; height: 100%; display: none;'>"),document.write("<div class='bf-close' onclick='uiObj.SwitchShowStructTree()'><i class='fa fa-times fa-2x' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' style='cursor: move; user-select: none;'>目录树</div>"),document.write("<div class='bf-panel-body' style='padding-top: 57px;overflow-y: scroll;'>"),document.write("<div class='bf-panel-header'>"),document.write("<div class='bf-panel-header'>"),document.write("<div class='bf-tree-header' style='margin-top: -57px;'>"),document.write("<div class='bf-tabs bf-tabs-tree'>"),document.write("<ul class='bf-tabs-list'>"),document.write("<li class='bf-tabs-option my-option undefined active' id='component'>构件</li>"),document.write("<li class='bf-tabs-option my-option undefined' id='area'>空间</li>"),document.write("<li class='bf-tabs-option my-option undefined' id='drawing'>图纸</li>"),document.write("</ul>"),document.write("</div>"),document.write("</div>"),document.write("</div>"),document.write("</div>"),document.write("<div class='' style='margin-bottom: 100px;' id='DirectoryContent'>"),document.write("</div>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteTakeColor=function(){var D=this.uiPath;this.isShowTakeColor&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='TakeColor'"),document.write("style='position: absolute;left: 0px; top: 162px;width: 45px; '>"),document.write("<div class='bf-button' onclick='uiObj.Chosecolor()' style='opacity: 1;width: 45px;'>"),document.write("<div  style='position: relative;margin-left: 10px;margin-top: -5px;'>"),document.write("<img src='"+D+"/image/color.png' alt='' style='width: 40px;margin-left: -21px;'>"),document.write("</div>"),document.write("<div id='colorbox' style='width: 30px;height: 5px;background-color: #cccccc;margin-left: -3px;margin-top: -5px;'>"),document.write("</div>"),document.write("<div style='width: 18px;height: 40px;float: right;margin-top: -38px;margin-left: 14px;position: absolute;'>"),document.write("<img src='"+D+"/image/daojiao.png' alt='' style='width: 15px;margin-top: 10px;z-index: 999;position: relative'>"),document.write("<input id='color-picker' type='color' value='#c0c0c0'   style='display: none' onchange='colorChange(value)'>"),document.write("</div>"),document.write("</div>"),document.write("</div>"))},k.prototype.WriteLayout=function(){var D=this.uiPath;this.isShowLayout&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='LayerOut'"),document.write("style='position: absolute;left: 0px; top: 213px; ' onclick='uiObj.SwitchShowLayout()'>"),document.write("<div class='bf-button'>"),document.write("<img src='"+D+"/image/layout.png' alt='' style='width: 24px;'>"),document.write("</div>"),document.write("</div>")),document.write("<div class='bf-panel bf-has-title bf-sizable' id='LayerOutInterface'"),document.write("style='left: 0; top: 0; width: 100%;display:none'>"),document.write("<div class='bf-close' onclick='uiObj.SwitchShowLayout()'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' id='buju' style='cursor: move; user-select: none;'>布局</div>"),document.write("<div>"),document.write("</div>"),document.write("<div id=''>"),document.write("<div>"),document.write("<table  class='bf-table'>"),document.write("<tbody class='bf-group'>"),document.write("<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>"),document.write("<td class='bf_layerout_td'  style='width: 60px' >"),document.write("<div class='bf_layer_div layer_on'></div>"),document.write("</td>"),document.write("<td  style='width: 238px' >"),document.write("<span  style='color: white;cursor: pointer;'>LayerOut</span>"),document.write("</td>"),document.write("</tr>"),document.write("<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>"),document.write("<td class='bf_layerout_td'  style='width: 60px' >"),document.write("<div class='bf_layer_div' ></div>"),document.write("</td>"),document.write("<td  style='width: 238px' >"),document.write("<span  style='color: white;cursor: pointer;'>LayerOut</span>"),document.write("</td>"),document.write("</tr>"),document.write("<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>"),document.write("<td class='bf_layerout_td'  style='width: 60px' >"),document.write("<div class='bf_layer_div' ></div>"),document.write("</td>"),document.write("<td  style='width: 238px' >"),document.write("<span  style='color: white;cursor: pointer;'>LayerOut</span>"),document.write("</td>"),document.write("</tr>"),document.write("<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>"),document.write("<td class='bf_layerout_td'  style='width: 60px' >"),document.write("<div class='bf_layer_div'></div>"),document.write("</td>"),document.write("<td  style='width: 238px' >"),document.write("<span  style='color: white;cursor: pointer;'>LayerOut</span>"),document.write("</td>"),document.write("</tr>"),document.write("</tbody>"),document.write("</table>"),document.write("</div>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteObjectProperty=function(){document.write("<div class='bf-panel bf-has-title bf-sizable property-panel' id='fmj2' title='构件详情' style='left: 0px; top: 0px; width: 100%; height: 100%;display: none;'>"),document.write("<div class='bf-close' id='close2' style='top:4.0em;'><i class='fa fa-times fa-2x' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' style='cursor: move; user-select: none;'>构件详情</div>"),document.write("<div class='bf-panel-body' style='padding-top: 41px;'>"),document.write("<div class='bf-panel-container bf-scroll-bar' style='top:0;width: 100%;height: 100%;overflow-y: auto;position: relative;'>"),document.write("<table class='bf-table' id='ComponentContent'>"),document.write("</table>"),document.write("</div>"),document.write("</div>"),document.write("</div>")},k.prototype.UpDisplayLayout=function(){},k.prototype.UpDisplayLayer=function(){var D=this.uiPath,f=this.vecLayerData,O=this.vecSketchLayerData,C="";if(O!=null){var j=O;for(var V in j){C+="<div>";var R="hide.png";j[V].off==0&&(R="show.png");var M="unlock.png";C+="<table class='bf-table'>",C+="<tbody class='bf-group'>",C+="<tr class='bf-group-title'>",C+='<td><img class="layer-enable" sketch=1 id='+j[V].id+' src="'+D+"/image/"+R+'"/></td>',C+='<td><span class="layer-color" style="background-color:'+j[V].color+'"></span></td>',C+='<td><span class="layer-text">草图_'+j[V].name+"</span></td>",C+='<td><img class="layer-state" src="'+D+"/image/"+M+'"/></td>',C+="</tr>",C+="</tbody>",C+="</table>",C+="</div>"}}if(f!=null)for(var V in j=f)C+="<div>",R="hide.png",j[V].off==0&&(R="show.png"),M="lock.png",C+="<table class='bf-table'>",C+="<tbody class='bf-group'>",C+="<tr class='bf-group-title'>",C+='<td><img class="layer-enable" sketch=0 id='+j[V].id+' src="'+D+"/image/"+R+'"/></td>',C+='<td><span class="layer-color" style="background-color:'+j[V].color+'"></span></td>',C+='<td><span class="layer-text">'+j[V].name+"</span></td>",C+='<td><img class="layer-state" src="'+D+"/image/"+M+'"/></td>',C+="</tr>",C+="</tbody>",C+="</table>",C+="</div>";var ee=document.getElementById("Layer-Info");ee!=null&&(ee.innerHTML=C)},k.prototype.WriteFooter=function(){document.write("<div class='footer' style='background: rgba(0, 0, 0, 0.7);min-width: auto;position: fixed;left: 0;bottom: 0;width: 100%;'>"),document.write("<div style='line-height: 40px;font-size: 12px;color: #999;padding: 0 10px;'>"),document.write("<p style='float: right;line-height: 15px;font-size: 12px;color: #999;display: block;'>"),document.write("<a style='color: #4a90e2;text-decoration: none;outline: none;' href='http://www.mxdraw.com/' target='_blank'>梦想CAD</a>旗下产品"),document.write("</p>"),document.write("<a style='color: #4a90e2;text-decoration: none;outline: none;' href='http://www.mxdraw.com' target='_blank'>MX3D</a> 蜀ICP备15011727号"),document.write("</div>"),document.write("</div>")},k.prototype.CreateToolBar=function(D){if(this.isShowToolbar){var f="";for(var O in D){var C=D[O],j="uiObj.CallMxCommand";C.isMxCommand||(j="uiObj.EvalJs"),0<C.itemid.length?f+='<div class="bf-button" onclick="'+j+"('"+D[O].evalString+`')"><img class="mainimage-bf-butto" id="`+C.itemid+'" src="'+this.uiPath+"\\image\\"+C.image+'" title="'+D[O].text+'"></div>':f+='<div class="bf-button" onclick="'+j+"('"+D[O].evalString+`')"><img class="mainimage-bf-butto" src="`+this.uiPath+"\\image\\"+C.image+'" title="'+D[O].text+'"></div>'}document.getElementById("MainMenuContent").innerHTML=f}},k.prototype.InitEvent=function(){var D=document.getElementById("LayerInterface");this.CreateToolBar(this.vecToolBarItem),D.style.display="none";var f=this.vecMenuItem;this.isShowMainMenu&&function(R){var M="";(function B(N,u){var c=function(E,U){var X=new Array;for(var W in U)U[W].parentId==E&&X.push(U[W]);return X}(N,u);if(0<c.length){for(var m in M+="<ul>",c)c[m].evalString.length!=0?(M+='<li><p class="li_option" ',M+=`onclick="uiObj.EvalJs('`+c[m].evalString+`')"`,M+=">"+c[m].text+"</p>"):(M+="<li><a ",M+=">"+c[m].text+"</a>"),B(c[m].id,u),M+="</li>";M+="</br>",M+="</br>",M+="</br>",M+="</ul>"}})(-1,f),R("#main-nav").append(M);var ee=R("#main-nav"),F=R(".toggle"),_={maxWidth:!1,customToggle:F,levelTitles:!0},J=null,T={};J&&J.remove(),F.off("click"),J=ee.clone(),R.extend(T,{side:"right"}),J.hcMobileNav(R.extend({},_,T))}(jQuery);var O=window.location.href,C=O.length,j=O.indexOf("?"),V=O.substr(j,C).split("=")[1];$(".barspan").html(decodeURIComponent(V)),$("#close2").click(function(){$(this).parent("div").fadeOut(200)}),$(".bf-select-current").click(function(){$(this).hasClass("bf-open")?$(this).removeClass("bf-open"):$(this).addClass("bf-open")}),$(".my-option").click(function(){var R=$(this);$(".my-option").each(function(){$(this).removeClass("active")}),R.addClass("active")}),$(".bf-select-option").click(function(){$(this).parent("ul").prev("span").html($(this).text()),$(this).parent("ul").prev("span").removeClass("bf-open")}),$(document).on("click",".layer-enable",function(){var R=L.MxFun.getUiObj().getPath(),M=parseInt($(this).attr("id")),ee=!0;$(this).attr("src")==R+"/image/show.png"?($(this).attr("src",R+"/image/hide.png"),ee=!1):$(this).attr("src",R+"/image/show.png"),L.MxFun.showLayer(M,ee)})},k.prototype.Fullscreen=function(){var D=document.documentElement;D.requestFullscreen?D.requestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.webkitRequestFullScreen&&D.webkitRequestFullScreen(),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.IsFullStatus()?($("img[title='取消全屏']").attr("src",this.uiPath+"/image\\fullscreen1.gif"),$("img[title='取消全屏']").attr("title","全屏")):($("img[title='全屏']").attr("src",this.uiPath+"/image\\escscreen1.gif"),$("img[title='全屏']").attr("title","取消全屏"))},k.prototype.IsFullStatus=function(){return(document.fullscreenEnabled||document.mozFullscreenElement||document.webkitFullscreenElement)!=null},k);function k(){return h!==null&&h.apply(this,arguments)||this}o.MxUiObjectMobile=G},{"../MxFun":27,"./MxUiObject":62}],64:[function(b,r,o){var a,v=this&&this.__extends||(a=function(D,f){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,C){O.__proto__=C}||function(O,C){for(var j in C)Object.prototype.hasOwnProperty.call(C,j)&&(O[j]=C[j])})(D,f)},function(D,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function O(){this.constructor=D}a(D,f),D.prototype=f===null?Object.create(f):(O.prototype=f.prototype,new O)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxUiObjectPC=void 0;var h,w=b("./MxUiObject"),L=b("../MxFun"),G=(v(k,h=w.MxUiObject),k.prototype.onCreate=function(){this.isShowTitle&&this.WriteTitle(),this.WriteStructTree(),this.isEnableLoading&&this.WriteLoading(),this.WriteLayer(),this.WriteTakeColor(),this.WriteLayout(),this.isEnableObjectProperty&&this.WriteObjectProperty(),this.isShowToolbar&&this.WriteToolbar()},k.prototype.onInit=function(){this.InitEvent()},k.prototype.WriteTitle=function(){var D=this.uiPath;document.write("<div id='all'>"),document.write("   <div class='bar1'>"),document.write("   <img src="+D+"/image/mxcad.png style='height: 50%;position: absolute;top: 12px;left: 10px;'>"),document.write("   <span  class='barspan' style='position: absolute;left: 45px;'>"),document.write("   </span>"),document.write("   <div id='container'>"),this.isShowMainMenu&&(document.write("   <header>"),document.write("    <div class='wrapper cf'style='z-index: 999'>"),document.write("   <nav id='main-nav' >"),document.write("    </nav>"),document.write("    <a class='toggle'>"),document.write("   <span></span>"),document.write("    </a>"),document.write("    </div>"),document.write("    </header>")),document.write("    </div>"),document.write("    </div>")},k.prototype.WriteStructTree=function(){this.isShowStructTree&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='ModelTreeThumbnail' title='目录树'"),document.write("style='position: absolute;left: 10px; top: 97px; ' onclick='uiObj.SwitchShowStructTree()'>"),document.write("<div class='bf-button mxbim-bf-tree' title='目录树'><i class='fa fa-sitemap' aria-hidden='true'></i></div>"),document.write("</div>")),document.write("<div class='bf-panel bf-has-title bf-sizable' id='ModelTreeInterface' title='目录树'"),document.write("style='left:0px; top: 0px; width: 300px; height: 416px;display: none'>"),document.write("   <div class='bf-close' onclick='uiObj.SwitchShowStructTree()'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' style='cursor: move; user-select: none;' id='mulushu'>目录树</div>"),document.write("<div class='bf-panel-body' style='padding-top: 36px;'>"),document.write("<div class='bf-panel-header'>"),document.write("<div class='bf-tree-header' style='margin-top: -36px;'>"),document.write("<div class='bf-select bf-select-tree'>"),document.write("<span class='bf-select-current'>构件</span>"),document.write("<ul class='bf-select-list'>"),document.write("<li class='bf-select-option' id='type'>构件</li>"),document.write("<li class='bf-select-option' id='file'>文件</li>"),document.write("<li class='bf-select-option' id='area'>空间</li>"),document.write("<li class='bf-select-option' id='drawing'>图纸</li>"),document.write("</ul>"),document.write("</div>"),document.write("</div>"),document.write("</div>"),document.write("<div id='DirectoryContent' class='bf-panel-container TreeInfo'>"),document.write("</div>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteLoading=function(){var D=this.uiPath;document.write("<div class='Prompt'>"),document.write("<div style='text-align: center;'>"),document.write("<img src='"+D+"/image/loading.gif' alt='' style='width:30px;height:30px;float: left'>"),document.write("<p  style='color:black;vertical-align: middle;float: left; margin-top: 5px;margin-left: 5px;'>加载中.....</p>"),document.write("</div>"),document.write("<span style='display: none'>"+this.sLanguageTable.openComplete+"</span>"),document.write("</div>")},k.prototype.WriteLayer=function(){var D=this.uiPath;this.isShowLayer&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='LayerThumbnail' title='"+this.sLanguageTable.layer+"'"),document.write("style='position: absolute;left: 10px; top: 45px; ' onclick='uiObj.SwitchShowLayer()'>"),document.write("<div class='bf-button'>"),document.write("<img src='"+D+"/image/layer.png.gif' alt='' style='width: 32px;'>"),document.write("</div>"),document.write("</div>")),document.write("<div class='bf-panel bf-has-title bf-sizable' id='LayerInterface'"),document.write("style='left: 10px; top: 50px; width: 300px; height: 416px;display: none'>"),document.write("<div class='bf-close' onclick='uiObj.SwitchShowLayer(false)'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' id='tuceng' style='cursor: move; user-select: none;'>"+this.sLanguageTable.layer+"</div>"),document.write("<div>"),document.write("<div class='layer-title' style='width: 50px;font-size: 14px'>"+this.sLanguageTable.visible+"</div>"),document.write("<div class='layer-title' style='width: 50px;font-size: 14px'>"+this.sLanguageTable.color+"</div>"),document.write("<div class='layer-title' style='width: 148px;font-size: 14px'>"+this.sLanguageTable.name+"</div>"),document.write("<div class='layer-title' style='width: 50px;font-size: 14px'>"+this.sLanguageTable.status+"</div>"),document.write("</div>"),document.write("<div id='Layer-Info' style='margin-top: 25px;height: 349px;position: absolute;overflow-y: auto;'>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteTakeColor=function(){var D=this.uiPath;this.isShowTakeColor&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='TakeColor' title='选择颜色'"),document.write("style='position: absolute;left: 10px; top: 149px; '>"),document.write("<div class='bf-button' onclick='uiObj.Chosecolor()' style='opacity: 1;'>"),document.write("<img src='"+D+"/image/color.png' alt='' style='width: 40px;margin-left: -10px;'>"),document.write("<div id='colorbox' style='width: 35px;height: 5px;background-color: #cccccc;margin-left: -3px'>"),document.write("</div>"),document.write("<div style='width: 18px;height: 40px;float: right;margin-top: -42px;margin-left: 14px;'>"),document.write("<img src='"+D+"/image/daojiao.png' alt='' style='width: 15px;margin-top: 10px;z-index: 999;position: relative'>"),document.write("<input id='color-picker' type='color' value='#c0c0c0'   style='display: none' onchange='uiObj.ColorChange(value)'>"),document.write("</div>"),document.write("</div>"),document.write("</div>"))},k.prototype.WriteLayout=function(){var D=this.uiPath;this.isShowLayout&&(document.write("<div class='bf-toolbar bf-toolbar bf-tree-toolbar' id='LayerOut' title='"+this.sLanguageTable.layout+"'"),document.write("style='position: absolute;left: 10px; top: 97px; ' onclick='uiObj.SwitchShowLayout()'>"),document.write("<div class='bf-button'>"),document.write("<img src='"+D+"/image/layout.png' alt='' style='width: 32px;'>"),document.write("</div>"),document.write("</div>")),document.write("<div class='bf-panel bf-has-title bf-sizable' id='LayerOutInterface'"),document.write("style='left: 10px; top: 50px; width: 300px;display:none'>"),document.write("<div class='bf-close' onclick='uiObj.SwitchShowLayout()'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' id='buju' style='cursor: move; user-select: none;'>"+this.sLanguageTable.layout+"</div>"),document.write("<div>"),document.write("</div>"),document.write("<div id='layout-Info'>"),document.write("</div>"),document.write("</div>")},k.prototype.WriteObjectProperty=function(){document.write("<div class='bf-panel bf-has-title bf-sizable' id='StrcutInfoBase' title='属性'"),document.write("style='right: 10px; top: 45px; width: 300px; height: 416px;display: none'>"),document.write("<div class='bf-close' id='close2'><i class='fa fa-times' aria-hidden='true'></i></div>"),document.write("<div class='bf-title' style='cursor: move; user-select: none;'>属性</div>"),document.write("<div id='ComponentContent' class='bf-panel-body StructInfo'></div>"),document.write("<div class='bf-resize'></div>"),document.write("</div>")},k.prototype.WriteToolbar=function(){document.write("<div id='MainMenuContent' class='bf-toolbar bf-toolbar-bottom' style='position: fixed'></div>")},k.prototype.CreateToolBar=function(D){if(this.isShowToolbar){var f="";for(var O in D){var C=D[O],j="uiObj.CallMxCommand";C.isMxCommand||(j="uiObj.EvalJs"),0<C.itemid.length?f+='<div class="bf-button" onclick="'+j+"('"+D[O].evalString+`')"><img class="mainimage-bf-butto" id="`+C.itemid+'" src="'+this.uiPath+"\\image\\"+C.image+'" title="'+D[O].text+'"></div>':f+='<div class="bf-button" onclick="'+j+"('"+D[O].evalString+`')"><img class="mainimage-bf-butto" src="`+this.uiPath+"\\image\\"+C.image+'" title="'+D[O].text+'"></div>'}document.getElementById("MainMenuContent").innerHTML=f}},k.prototype.UpDisplayLayer=function(){var D=this.uiPath,f=this.vecLayerData,O=this.vecSketchLayerData,C="";if(O!=null){var j=O;for(var V in j){C+="<div>";var R="hide.png";j[V].off==0&&(R="show.png");var M="unlock.png";C+="<table class='bf-table'>",C+="<tbody class='bf-group'>",C+="<tr class='bf-group-title'>",C+='<td><img class="layer-enable" sketch=1 id='+j[V].id+' src="'+D+"/image/"+R+'"/></td>',C+='<td><span class="layer-color" style="background-color:'+j[V].color+'"></span></td>',C+='<td><span class="layer-text">草图_'+j[V].name+"</span></td>",C+='<td><img class="layer-state" src="'+D+"/image/"+M+'"/></td>',C+="</tr>",C+="</tbody>",C+="</table>",C+="</div>"}}if(f!=null)for(var V in j=f)C+="<div>",R="hide.png",j[V].off==0&&(R="show.png"),M="lock.png",C+="<table class='bf-table'>",C+="<tbody class='bf-group'>",C+="<tr class='bf-group-title'>",C+='<td><img class="layer-enable" sketch=0 id='+j[V].id+' src="'+D+"/image/"+R+'"/></td>',C+='<td><span class="layer-color" style="background-color:'+j[V].color+'"></span></td>',C+='<td><span class="layer-text">'+j[V].name+"</span></td>",C+='<td><img class="layer-state" src="'+D+"/image/"+M+'"/></td>',C+="</tr>",C+="</tbody>",C+="</table>",C+="</div>";var ee=document.getElementById("Layer-Info");ee!=null&&(ee.innerHTML=C)},k.prototype.UpDisplayLayout=function(){var D=this.vecLayoutData,f="";if(f+="<div>",f+="<table  class='bf-table'>",f+="<tbody class='bf-group'>",f+="<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>",f+="<td class='bf_layerout_td'  style='width: 60px' >",f+="<div class='bf_layer_div layer_on'></div>",f+="</td>",f+="<td  style='width: 238px' >",f+="<span  class='layout-name' name='Model' style='color: white;cursor: pointer;'>Model</span>",f+="</td>",f+="</tr>",D!=null){var O=D;for(var C in O)f+="<tr class='bf-group-title  bf_layerout' style='height: 30px;cursor: pointer;'>",f+="<td class='bf_layerout_td'  style='width: 60px' >",f+="<div class='bf_layer_div layer_on'></div>",f+="</td>",f+="<td style='width: 238px' >",f+="<span class='layout-name' name='"+O[C]+"' style='color: white;cursor: pointer;'>"+O[C]+"</span>",f+="</td>",f+="</tr>"}f+="</tbody>",f+="</table>",f+="</div>";var j=document.getElementById("layout-Info");j!=null&&(j.innerHTML=f)},k.prototype.InitEvent=function(){var D=document.getElementById("ModelTreeInterface"),f=document.getElementById("LayerInterface"),O=document.getElementById("LayerOutInterface"),C=document.getElementById("tuceng"),j=document.getElementById("mulushu"),V=document.getElementById("buju"),R=0,M=0,ee=0,F=0,_=!1;j.onmousedown=function(m){R=m.clientX,M=m.clientY,ee=D.offsetLeft,F=D.offsetTop,_=!0,D.style.cursor="move"},C.onmousedown=function(m){R=m.clientX,M=m.clientY,ee=f.offsetLeft,F=f.offsetTop,_=!0,f.style.cursor="move"},V.onmousedown=function(m){R=m.clientX,M=m.clientY,ee=O.offsetLeft,F=O.offsetTop,_=!0,O.style.cursor="move"},window.onmousemove=function(m){if(_!=0){var E=m.clientX,U=m.clientY,X=E-(R-ee),W=U-(M-F);D.style.left=X+"px",D.style.top=W+"px",f.style.left=X+"px",f.style.top=W+"px",O.style.left=X+"px",O.style.top=W+"px"}},j.onmouseup=function(){_=!1,D.style.cursor="default"},C.onmouseup=function(){_=!1,f.style.cursor="default"},V.onmouseup=function(){_=!1,O.style.cursor="default"},$("#close2").click(function(){$(this).parent("div").fadeOut(200)}),$("#menu4").click(function(){$("#StrcutInfoBase").hasClass("hide")?($("#StrcutInfoBase").fadeIn(200),$("#StrcutInfoBase").removeClass("hide")):($("#StrcutInfoBase").fadeOut(200),$("#StrcutInfoBase").addClass("hide"))}),$(".bf-select-current").click(function(){$(this).hasClass("bf-open")?$(this).removeClass("bf-open"):$(this).addClass("bf-open")}),$(".bf-select-option").click(function(){$(this).parent("ul").prev("span").html($(this).text()),$(this).parent("ul").prev("span").removeClass("bf-open")});var J=$("#StrcutInfoBase");J.bind("mousedown",function(m){var E=$(this)[0].offsetLeft,U=$(this)[0].offsetTop,X=m.pageX,W=m.pageY;$(document).bind("mousemove",function(te){var ne=te.pageX-X,ce=te.pageY-W,we=E+ne+"px",Ie=U+ce+"px";J.css({top:Ie,left:we})})}),$(document).bind("mouseup",function(){$(this).unbind("mousemove")}),this.CreateToolBar(this.vecToolBarItem);var T=this.vecMenuItem;if(this.isShowMainMenu&&function(m){var E="";(function ce(we,Ie){var xe=function(q,ge){var oe=new Array;for(var se in ge)ge[se].parentId==q&&oe.push(ge[se]);return oe}(we,Ie);if(0<xe.length){for(var Be in E+="<ul>",xe)xe[Be].evalString.length!=0?(E+='<li><p class="li_option" ',E+=`onclick="uiObj.EvalJs('`+xe[Be].evalString+`')"`,E+=">"+xe[Be].text+"</p>"):(E+="<li><a ",E+=">"+xe[Be].text+"</a>"),ce(xe[Be].id,Ie),E+="</li>";E+="</br>",E+="</br>",E+="</br>",E+="</ul>"}})(-1,T),m("#main-nav").append(E);var U=m("#main-nav"),X=m(".toggle"),W={maxWidth:!1,customToggle:X,levelTitles:!0},te=null,ne={};te&&te.remove(),X.off("click"),te=U.clone(),m.extend(ne,{side:"right"}),te.hcMobileNav(m.extend({},W,ne))}(jQuery),$(".li_option").click(function(){var m=$(this);$(".li_option").each(function(){$(this).removeClass("active")}),m.addClass("active")}),this.sTitle==""){var B=window.location.href,N=B.length,u=B.indexOf("?"),c=B.substr(u,N).split("=")[1];c!=null&&(this.sTitle=c)}$(".barspan").html(decodeURIComponent(this.sTitle)),$(document).on("click",".layer-enable",function(){var m=L.MxFun.getUiObj().getPath(),E=parseInt($(this).attr("id")),U=(parseInt($(this).attr("sketch")),!0);$(this).attr("src")==m+"/image/show.png"?($(this).attr("src",m+"/image/hide.png"),U=!1):$(this).attr("src",m+"/image/show.png"),L.MxFun.showLayer(E,U)}),$(document).on("click",".layout-name",function(){var m=$(this).attr("name");m=="Model"&&(m=""),L.MxFun.getCurrentDraw().gotoLayout(m)})},k.prototype.WriteFooter=function(){document.write("<div class='footer' style='background: rgba(0, 0, 0, 0.7);position: fixed;left: 0;bottom: 0;width: 100%;'>"),document.write("   <div style='line-height: 40px;font-size: 12px;color: #999;padding: 0 10px;'>"),document.write("    <p style='float: right;line-height: 15px;font-size: 12px;color: #999;display: block;'>"),document.write("    <a style='color: #4a90e2;text-decoration: none;outline: none;' href='http://www.mxdraw.com/' target='_blank'>MxDraw </a>旗下产品"),document.write("    </p>"),document.write("    <a style='color: #4a90e2;text-decoration: none;outline: none;' href='http://www.mxdraw.com' target='_blank'>MX3D </a> 蜀ICP备15011727号"),document.write("    </div>"),document.write("   </div>")},k.prototype.ShowLoading=function(){this.isEnableLoading&&($(".Prompt").css("background","rgba(0, 0, 0, 0)"),$(".Prompt").fadeIn(100),$(".Prompt span").css("display","none"))},k.prototype.HideLoading=function(){this.isEnableLoading&&($(".Prompt").css("background","rgba(0, 0, 0, 0.8)"),$(".Prompt div").fadeOut(100),$(".Prompt span").fadeIn(200),setTimeout(function(){$(".Prompt").fadeOut(1e3)},1e3))},k.prototype.ShowObjectProperty=function(D){if(D.length!=0){var f;f=typeof D=="string"?JSON.parse(D):D;var O="";for(var C in f){var j=f[C];for(var V in O+="<table class='bf-table'>",O+="<tbody class='bf-group'>",O+="<tr class='bf-group-title'>",O+="<td colspan='2'><i class='bf-icon'></i>"+j.name+"</td>",O+="</tr>",j.datas){var R=j.datas[V];O+="<tr class='bf-group-content'>",O+="<td class='bf-key'>"+R.name+"</td>",O+="<td class='bf-value'>"+R.value+"</td>",O+="</tr>"}O+="</tbody>",O+="</table>"}document.getElementById("ComponentContent").innerHTML=O,$(".bf-group").click(function(){$(this).hasClass("bf-collapse")?$(this).removeClass("bf-collapse"):$(this).addClass("bf-collapse")}),$("#StrcutInfoBase").fadeIn(200),$("#StrcutInfoBase").removeClass("hide")}},k.prototype.HideObjectProp=function(){$("#StrcutInfoBase").hasClass("hide")||($("#StrcutInfoBase").fadeOut(200),$("#StrcutInfoBase").addClass("hide"))},k.prototype.SwitchShowLayer=function(){var D=document.getElementById("ModelTreeInterface"),f=document.getElementById("ModelTreeThumbnail"),O=document.getElementById("LayerThumbnail"),C=document.getElementById("LayerInterface"),j=document.getElementById("LayerOut"),V=document.getElementById("LayerOutInterface");D.style.display="none",(V.style.display="none")==C.style.display?(O.style.display="block",C.style.display="block",C.style.left="80px",C.style.top="50px",f!=null&&(f.style.display="block"),j!=null&&(j.style.display="block"),D.style.display="none",V.style.display="none"):(C.style.display="none",f!=null&&(f.style.display="block"),O.style.display="block",j!=null&&(j.style.display="block"))},k.prototype.SwitchShowStructTree=function(){var D=document.getElementById("ModelTreeInterface"),f=document.getElementById("ModelTreeThumbnail"),O=document.getElementById("LayerThumbnail"),C=document.getElementById("LayerInterface"),j=document.getElementById("LayerOut"),V=document.getElementById("LayerOutInterface");C.style.display="none",(V.style.display="none")==D.style.display?(f!=null&&(f.style.display="block"),D.style.display="block",D.style.left="80px",D.style.top="50px",O.style.display="block",j!=null&&(j.style.display="block"),C.style.display="none",V.style.display="none"):(D.style.display="none",f!=null&&(f.style.display="block"),O.style.display="block",j!=null&&(j.style.display="block"))},k.prototype.Chosecolor=function(){document.getElementById("color-picker").click()},k.prototype.ColorChange=function(D){document.getElementById("colorbox").style.backgroundColor=D,L.MxFun.setCurrentColor(D)},k.prototype.SwitchShowLayout=function(){var D=document.getElementById("ModelTreeInterface"),f=document.getElementById("ModelTreeThumbnail"),O=document.getElementById("LayerThumbnail"),C=document.getElementById("LayerInterface"),j=document.getElementById("LayerOut"),V=document.getElementById("LayerOutInterface");D.style.display="none",C.style.display="none",V&&V.style.display=="none"?(j&&(j.style.display="block"),V.style.display="block",V.style.left="80px",V.style.top="120px",f!=null&&(f.style.display="block"),O&&(O.style.display="block"),D.style.display="none",C.style.display="none"):(V&&(V.style.display="none"),f!=null&&(f.style.display="block"),O&&(O.style.display="block"),j&&(j.style.display="block"))},k.prototype.Fullscreen=function(){var D=document.documentElement;D.requestFullscreen?D.requestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.webkitRequestFullScreen&&D.webkitRequestFullScreen(),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.IsFullStatus()?($("img[title='取消全屏']").attr("src",this.uiPath+"/image\\fullscreen1.gif"),$("img[title='取消全屏']").attr("title","全屏")):($("img[title='全屏']").attr("src",this.uiPath+"/image\\escscreen1.gif"),$("img[title='全屏']").attr("title","取消全屏"))},k.prototype.IsFullStatus=function(){return(document.fullscreenEnabled||document.mozFullscreenElement||document.webkitFullscreenElement)!=null},k);function k(){return h!==null&&h.apply(this,arguments)||this}o.MxUiObjectPC=G},{"../MxFun":27,"./MxUiObject":62}],65:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxUiVue=void 0;var a,v,h,w,L,G=b("three"),k=b("../MxFun"),D=b("../Operate/MxJigCmdManager"),f=b("../MxTools"),O=b("../Operate/MxCmdRunManager");function C(_){if(_==32||_==13)if(D.MxJigCmdManager.isRunning())D.MxJigCmdManager.OnEnter(_);else{var J=M(),T="";T=J.length==0?O.MxCmdRunManager.GetPrvCmd():J,ee(""),T=f.MxTools.stringTrimLeftSpace(T),k.MxFun.sendStringToExecute(T)}else if(_==38)D.MxJigCmdManager.isRunning()||(O.MxCmdRunManager.MoveUpKey(),(B=O.MxCmdRunManager.GetListCommad()).length!=0&&(ee(B),R()));else if(_==40){var B;D.MxJigCmdManager.isRunning()||(O.MxCmdRunManager.MoveDownKey(),(B=O.MxCmdRunManager.GetListCommad()).length!=0&&(ee(B),R()))}}function j(_,J){J===void 0&&(J=!0);var T=_.length;if(!(T<1)){for(var B=w.getCmdLine(),N=B.getCmdTip(),u=B.getCmdText(),c=_.indexOf(`
`),m=0,E=!0;c!=-1&&(E?(B.addCmdDisplay(`
`+N+u+_.substring(m,c-m)),u=N="",E=!1):B.addCmdDisplay(`
`+_.substring(m,c-m)),(m=c+1)<T);)c=_.indexOf(`
`,m);if(E){var U=_.substring(m,T-m),X=U.indexOf("\r"),W=U.length;N=X==-1?N+u+U:X+1<W?U.substring(X+1,W-X-1):""}else m<T&&(N=_.substring(m,T));u="",J&&(N+=" "),B.setCmdTip(N),B.setCmdText(u),B.upDisplay()}}function V(_){for(var J=[],T=1;T<arguments.length;T++)J[T-1]=arguments[T];if(w!=null){for(var B=arguments,N=B[0],u=0;u<B.length-1;u++){var c=new RegExp("\\{"+u+"\\}","gm");N=N.replace(c,B[u+1])}j(N,!0)}}function R(){w!=null&&w.getCmdLine().upDisplay()}function M(){if(w==null)return"";var _=w.getCmdLine();return f.MxTools.stringTrimLeftRightSpace(_.getCmdText())}function ee(_){if(w!=null)return w.getCmdLine().setCmdText(_)}function F(_){var J=D.MxJigCmdManager.getCurCmd();J!=null&&(J.getDynImput().onKeyDonw(_)||C(_))}v=a||(o.MxUiVue=a={}),w=void 0,L=new G.Vector3,v.SetLasetPoint=function(_){L=_},v.GetLasetPoint=function(){return L},(h=v.CursorType||(v.CursorType={}))[h.kNormal=0]="kNormal",h[h.kRect=1]="kRect",h[h.kCross=2]="kCross",h[h.kPan=3]="kPan",v.isNull=function(){return w==null},v.init=function(_){(w=_).mountKeydownEvent(C),w.getDynamicInput().mountKeydownEvent(F)},v.setTipCoord=function(_){w!=null&&w.setTipCoord(_)},v.setCursorType=function(_){w!=null&&w.setCursorType(_)},v.AcutPrintfNoFormat=j,v.acutPrintf=V,v.cmdLineUpDisplay=R,v.getCmdText=M,v.setCmdText=ee,v.getCmdDisplay=function(){return w==null?"":w.getCmdLine().getCmdDisplay()},v.setCmdDisplay=function(_){if(w!=null)return w.getCmdLine().setCmdDisplay(_)},v.getCmdTip=function(){return w==null?"":w.getCmdLine().getCmdTip()},v.setCmdTip=function(_){if(w!=null)return w.getCmdLine().setCmdTip(_)},v.restoreCmdStatus=function(){if(w!=null){var _=w.getCmdLine();_.getCmdTip()==" "&&_.getCmdText().length==0?(_.setCmdTip(""),V("{0}:","命令")):V(`
{0}:`,"命令")}},v.DynamicInput_upDisplay=function(){w!=null&&v.OnMxEvent({name:"dynInputUpDisplay"})},v.DynamicInput_setType=function(_){w!=null&&w.getDynamicInput().setType(_)},v.DynamicInput_getType=function(){return w==null?D.MxJigCmdManager.DynamicInputType.kNoInput:w.getDynamicInput().getType()},v.DynamicInput_setPos=function(_){w!=null&&w.getDynamicInput().setPos([_.x,_.y])},v.DynamicInput_setTip=function(_){w!=null&&w.getDynamicInput().setTip(_)},v.DynamicInput_setValue1=function(_){w!=null&&w.getDynamicInput().setValue1(_)},v.DynamicInput_getValue1=function(){return w==null?"":w.getDynamicInput().getValue1()},v.DynamicInput_setValue1Pos=function(_){w!=null&&w.getDynamicInput().setValue1Pos([_.x,_.y])},v.DynamicInput_setValue2=function(_){w!=null&&w.getDynamicInput().setValue2(_)},v.DynamicInput_getValue2=function(){return w==null?"":w.getDynamicInput().getValue2()},v.DynamicInput_getFocusValue=function(){return w==null?"":w.getDynamicInput().getFocusValue()},v.DynamicInput_getFocusIndex=function(){return w==null?0:w.getDynamicInput().getFocusIndex()},v.DynamicInput_setValue2Pos=function(_){w!=null&&w.getDynamicInput().setValue2Pos([_.x,_.y])},v.DynamicInput_setShow=function(_){w!=null&&w.getDynamicInput().setShow(_)},v.DynamicInput_isShow=function(){return w!=null&&w.getDynamicInput().isShow()},v.OnMxEvent=function(_){if(w==null)return!1;w.OnMxEvent(_)}},{"../MxFun":27,"../MxTools":38,"../Operate/MxCmdRunManager":48,"../Operate/MxJigCmdManager":54,three:19}],66:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.ExternalReferenceManager=o.ExternalReferenceDatabase=o.Blocks=o.Block=o.Layer=o.MxNewDisplayMemorySection=o.MxNewDisplayMemorySectionType=o.TextureData=o.BlockInstance=o.BlockRef=o.ClipPlans=o.ClipPlan=void 0;var a=b("three"),v=b("../MxShader"),h=b("./MxBrowseLayerData"),w=b("../MxManager"),L=b("../MxNetData"),G=b("../MxStencilObject"),k=b("../MxFun"),D=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0};o.ClipPlan=D;var f=function(){this.ver=4,this.id=1,this.clipPlanArray=new Array,this.clipPoints=[],this.instansClipePoints=[]};o.ClipPlans=f;var O=function(){this.ver=4,this.mat=new a.Matrix4,this.blkRecId=-1,this.blkOwnerId=0,this.layerId=-1,this.color=16777215,this.clipPlans=new f};o.BlockRef=O;var C=function(){this.mat=new a.Matrix4,this.color=new Array,this.topLayerColor=new Array,this.clipPlans=new f,this.clipMat=new a.Matrix4};o.BlockInstance=C;var j,V,R=function(){};o.TextureData=R,(V=j||(o.MxNewDisplayMemorySectionType=j={}))[V.kLinesType=1]="kLinesType",V[V.kTriangleType=2]="kTriangleType",V[V.kLinesType_Float=3]="kLinesType_Float",V[V.kTriangleType_Float=4]="kTriangleType_Float",V[V.kPointType_Float=5]="kPointType_Float",V[V.kPointType=6]="kPointType",o.MxNewDisplayMemorySection=function(){this.id=0,this.type=j.kLinesType,this.blockId=0,this.layerId=0,this.color=0,this.points=[]};var M=(ee.prototype.Show=function(c){for(var m=0,E=this._entitys.length;m<E;m++)this._entitys[m].visible=c},ee.prototype.updataClipMaterial=function(c){for(var m=this._material_clip.length,E=.5*c.width,U=.5*c.height,X=0;X<m;X++)this._material_clip[X].uniforms.vieww.value=E,this._material_clip[X].uniforms.viewh.value=U},ee.prototype.createThreejsObjForMesh_Clip=function(c,m,E){c.size!=0&&c.forEach(function(U){var X=U;if(X.length!=0){var W=[],te=[],ne=X[0].clipPlans;ne.ver<=3&&(W.push(ne.clipPlanArray[0].x1,ne.clipPlanArray[0].y1),te.push(ne.clipPlanArray[0].x2,ne.clipPlanArray[0].y2));for(var ce=[],we=[],Ie=[],xe=[],Be=[],q=[],ge=[],oe=0;oe<X.length;oe++){var se=X[oe];ce=ce.concat(se.mat.elements.slice(0,4)),we=we.concat(se.mat.elements.slice(4,8)),Ie=Ie.concat(se.mat.elements.slice(8,12)),xe=xe.concat(se.mat.elements.slice(12,16)),Be.push(0),q=q.concat(X[oe].color)}if(0<this._geometryMeshPositionsByBlock.length)for(oe=0;oe<X.length;oe++)q=q.concat(X[oe].color);if(0<this._geometryMeshPositionsByBlock_ZeroLayer.length)for(oe=0;oe<X.length;oe++)ge=ge.concat(X[oe].topLayerColor);var Ae,Ye=.5*E.width,Ge=.5*E.height;ne.ver<=3?(Ae=new a.RawShaderMaterial({uniforms:{clippt1:{value:W},clippt2:{value:te},vieww:{value:Ye},viewh:{value:Ge}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_CLIP,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_CLIP,linewidth:1,transparent:!0,side:a.DoubleSide}),this._material_clip.push(Ae)):Ae=new a.RawShaderMaterial({vertexShader:v.MxShader.VSHADER_COLOR_POINT,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,linewidth:1,transparent:!0,side:a.DoubleSide});for(var Ne=0;Ne<this._geometryMeshPostion.length;Ne++)(ve=new a.InstancedBufferGeometry).maxInstancedCount=X.length,ve.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPostion[Ne],2)),ve.setAttribute("color",new a.Float32BufferAttribute(this._geometryMeshColor[Ne],3)),ve.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(ce),4)),ve.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(we),4)),ve.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),ve.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(xe),4)),ve.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Be),1)),(He=new a.Mesh(ve,Ae)).frustumCulled=!1,He.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(He),this._entitys.push(He),4<=ne.ver&&0<ne.instansClipePoints.length&&new G.MxStencilObject().associateObject(He,ne.instansClipePoints);for(Ne=0;Ne<this._geometryMeshPositionsByBlock.length;Ne++)(ve=new a.InstancedBufferGeometry).maxInstancedCount=X.length,ve.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByBlock[Ne],2)),ve.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(q),3)),ve.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(ce),4)),ve.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(we),4)),ve.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),ve.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(xe),4)),ve.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Be),1)),(He=new a.Mesh(ve,Ae)).frustumCulled=!1,He.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(He),this._entitys.push(He),4<=ne.ver&&0<ne.instansClipePoints.length&&new G.MxStencilObject().associateObject(He,ne.instansClipePoints);for(Ne=0;Ne<this._geometryMeshPositionsByBlock_ZeroLayer.length;Ne++)(ve=new a.InstancedBufferGeometry).maxInstancedCount=X.length,ve.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByBlock_ZeroLayer[Ne],2)),ve.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(ge),3)),ve.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(ce),4)),ve.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(we),4)),ve.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),ve.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(xe),4)),ve.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Be),1)),(He=new a.Mesh(ve,Ae)).frustumCulled=!1,He.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(He),this._entitys.push(He),4<=ne.ver&&0<ne.instansClipePoints.length&&new G.MxStencilObject().associateObject(He,ne.instansClipePoints);var le=new a.RawShaderMaterial({uniforms:{color:{value:this._color},clippt1:{value:W},clippt2:{value:te},vieww:{value:Ye},viewh:{value:Ge}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_BYLAYER_CLIP,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_CLIP,linewidth:1,transparent:!0,side:a.DoubleSide});for(this._material_clip.push(le),Ne=0;Ne<this._geometryMeshPositionsByLayer.length;Ne++){var ve,He;(ve=new a.InstancedBufferGeometry).maxInstancedCount=X.length,ve.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByLayer[Ne],2)),ve.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(ce),4)),ve.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(we),4)),ve.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),ve.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(xe),4)),ve.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Be),1)),(He=new a.Mesh(ve,le)).frustumCulled=!1,He.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(He),this._entitys.push(He),4<=ne.ver&&0<ne.instansClipePoints.length&&new G.MxStencilObject().associateObject(He,ne.instansClipePoints)}}},this)},ee.prototype.createThreejsObjForCurve_Clip=function(c,m,E){c.size!=0&&c.forEach(function(U,X,W){var te=U;if(te.length!=0){var ne=[],ce=[],we=te[0].clipPlans;we.ver<=3&&(ne.push(we.clipPlanArray[0].x1,we.clipPlanArray[0].y1),ce.push(we.clipPlanArray[0].x2,we.clipPlanArray[0].y2));for(var Ie=[],xe=[],Be=[],q=[],ge=[],oe=[],se=[],Ae=0;Ae<te.length;Ae++){var Ye=te[Ae];Ie=Ie.concat(Ye.mat.elements.slice(0,4)),xe=xe.concat(Ye.mat.elements.slice(4,8)),Be=Be.concat(Ye.mat.elements.slice(8,12)),q=q.concat(Ye.mat.elements.slice(12,16)),ge.push(0)}if(0<this._geometryCurvePositionsByBlock.length)for(Ae=0;Ae<te.length;Ae++)oe=oe.concat(te[Ae].color);if(0<this._geometryCurvePositionsByBlock_ZeroLayer.length)for(Ae=0;Ae<te.length;Ae++)se=se.concat(te[Ae].topLayerColor);var Ge,Ne=.5*E.width,le=.5*E.height;we.ver<=3?(Ge=new a.RawShaderMaterial({uniforms:{clippt1:{value:ne},clippt2:{value:ce},vieww:{value:Ne},viewh:{value:le}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_CLIP,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_CLIP,linewidth:1,transparent:!0,side:a.DoubleSide}),this._material_clip.push(Ge)):Ge=new a.RawShaderMaterial({vertexShader:v.MxShader.VSHADER_COLOR_POINT,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,linewidth:1,transparent:!0,side:a.DoubleSide});for(var ve=0;ve<this._geometryCurvePostion.length;ve++)(nt=new a.InstancedBufferGeometry).maxInstancedCount=te.length,nt.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePostion[ve],2)),nt.setAttribute("color",new a.Float32BufferAttribute(this._geometryCurveColor[ve],3)),nt.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),nt.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(xe),4)),nt.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Be),4)),nt.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(q),4)),nt.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ge),1)),(ht=new a.LineSegments(nt,Ge)).frustumCulled=!1,ht.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(ht),this._entitys.push(ht),4<=we.ver&&0<we.instansClipePoints.length&&new G.MxStencilObject().associateObject(ht,we.instansClipePoints);for(ve=0;ve<this._geometryCurvePositionsByBlock.length;ve++)(nt=new a.InstancedBufferGeometry).maxInstancedCount=te.length,nt.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByBlock[ve],2)),nt.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(oe),3)),nt.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),nt.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(xe),4)),nt.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Be),4)),nt.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(q),4)),nt.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ge),1)),(ht=new a.LineSegments(nt,Ge)).frustumCulled=!1,ht.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(ht),this._entitys.push(ht),4<=we.ver&&0<we.instansClipePoints.length&&new G.MxStencilObject().associateObject(ht,we.instansClipePoints);for(ve=0;ve<this._geometryCurvePositionsByBlock_ZeroLayer.length;ve++)(nt=new a.InstancedBufferGeometry).maxInstancedCount=te.length,nt.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByBlock_ZeroLayer[ve],2)),nt.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(se),3)),nt.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),nt.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(xe),4)),nt.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Be),4)),nt.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(q),4)),nt.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ge),1)),(ht=new a.LineSegments(nt,Ge)).frustumCulled=!1,ht.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(ht),this._entitys.push(ht),4<=we.ver&&0<we.instansClipePoints.length&&new G.MxStencilObject().associateObject(ht,we.instansClipePoints);var He=new a.RawShaderMaterial({uniforms:{color:{value:this._color},clippt1:{value:ne},clippt2:{value:ce},vieww:{value:Ne},viewh:{value:le}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_BYLAYER_CLIP,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_CLIP,linewidth:1,transparent:!0,side:a.DoubleSide});for(this._material_clip.push(He),ve=0;ve<this._geometryCurvePositionsByLayer.length;ve++){var nt,ht;(nt=new a.InstancedBufferGeometry).maxInstancedCount=te.length,nt.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByLayer[ve],2)),nt.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),nt.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(xe),4)),nt.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Be),4)),nt.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(q),4)),nt.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ge),1)),(ht=new a.LineSegments(nt,He)).frustumCulled=!1,ht.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(ht),this._entitys.push(ht),4<=we.ver&&0<we.instansClipePoints.length&&new G.MxStencilObject().associateObject(ht,we.instansClipePoints)}}},this)},ee.prototype.createThreejsObjForCurve=function(c,m){if(c.length!=0){for(var E=[],U=[],X=[],W=[],te=[],ne=[],ce=[],we=0;we<c.length;we++){var Ie=c[we];E=E.concat(Ie.mat.elements.slice(0,4)),U=U.concat(Ie.mat.elements.slice(4,8)),X=X.concat(Ie.mat.elements.slice(8,12)),W=W.concat(Ie.mat.elements.slice(12,16)),te.push(0)}if(0<this._geometryCurvePositionsByBlock.length)for(we=0;we<c.length;we++)ne=ne.concat(c[we].color);if(0<this._geometryCurvePositionsByBlock_ZeroLayer.length)for(we=0;we<c.length;we++)ce=ce.concat(c[we].topLayerColor);for(var xe=new a.RawShaderMaterial({vertexShader:v.MxShader.VSHADER_COLOR_POINT,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,linewidth:1,transparent:!0,side:a.DoubleSide}),Be=0;Be<this._geometryCurvePostion.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePostion[Be],2)),ge.setAttribute("color",new a.Float32BufferAttribute(this._geometryCurveColor[Be],3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.LineSegments(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(oe),this._entitys.push(oe);for(Be=0;Be<this._geometryCurvePositionsByBlock.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByBlock[Be],2)),ge.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(ne),3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.LineSegments(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(oe),this._entitys.push(oe);for(Be=0;Be<this._geometryCurvePositionsByBlock_ZeroLayer.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByBlock_ZeroLayer[Be],2)),ge.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(ce),3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.LineSegments(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(oe),this._entitys.push(oe);var q=new a.RawShaderMaterial({uniforms:{color:{value:this._color}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_BYLAYER,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,linewidth:1,transparent:!0,side:a.DoubleSide});for(Be=0;Be<this._geometryCurvePositionsByLayer.length;Be++){var ge,oe;(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryCurvePositionsByLayer[Be],2)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.LineSegments(ge,q)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(oe),this._entitys.push(oe)}}},ee.prototype.createThreejsObjForMemorySections_clip=function(c,m,E){c.size!=0&&c.forEach(function(U){var X=U;if(X.length!=0){for(var W=X[0].clipPlans,te=[],ne=[],ce=[],we=[],Ie=[],xe=0;xe<X.length;xe++){var Be=X[xe];te.push.apply(te,Be.mat.elements.slice(0,4)),ne.push.apply(ne,Be.mat.elements.slice(4,8)),ce.push.apply(ce,Be.mat.elements.slice(8,12)),we.push.apply(we,Be.mat.elements.slice(12,16)),Ie.push(0)}for(var q=this._MemorySections.length,ge=0;ge<q;ge++){var oe=this._MemorySections[ge],se=E.automaticInversionColor2(oe.color),Ae=[];if((4278190080&se)==16777216?Ae=this._color:Ae.push((255&se)/255,(se>>8&255)/255,(se>>16&255)/255),oe.type==j.kLinesType){var Ye=new a.RawShaderMaterial({uniforms:{color:{value:Ae}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,linewidth:1,transparent:!0,side:a.DoubleSide});(Ne=new a.InstancedBufferGeometry).maxInstancedCount=X.length,Ne.setAttribute("position",new a.Float32BufferAttribute(oe.points,3)),Ne.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ne.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(ne),4)),Ne.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(ce),4)),Ne.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(we),4)),Ne.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Ie),1)),(le=new a.LineSegments(Ne,Ye)).frustumCulled=!1,le.renderOrder=w.MxData.iCADCurveRenderOrder,4<=W.ver&&0<W.instansClipePoints.length&&new G.MxStencilObject().associateObject(le,W.instansClipePoints),m.add(le),this._entitys.push(le)}else if(oe.type==j.kTriangleType){Ye=new a.RawShaderMaterial({uniforms:{color:{value:Ae}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,transparent:!0,side:a.DoubleSide}),(Ne=new a.InstancedBufferGeometry).maxInstancedCount=X.length,Ne.setAttribute("position",new a.Float32BufferAttribute(oe.points,3)),Ne.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ne.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(ne),4)),Ne.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(ce),4)),Ne.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(we),4)),Ne.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Ie),1));var Ge=new a.Mesh(Ne,Ye);Ge.frustumCulled=!1,Ge.renderOrder=w.MxData.iCADMeshRenderOrder,4<=W.ver&&0<W.instansClipePoints.length&&new G.MxStencilObject().associateObject(Ge,W.instansClipePoints),m.add(Ge),this._entitys.push(Ge)}else if(oe.type==j.kPointType){var Ne,le;Ye=new a.RawShaderMaterial({uniforms:{color:{value:Ae}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,transparent:!0,side:a.DoubleSide}),(Ne=new a.InstancedBufferGeometry).maxInstancedCount=X.length,Ne.setAttribute("position",new a.Float32BufferAttribute(oe.points,3)),Ne.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ne.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(ne),4)),Ne.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(ce),4)),Ne.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(we),4)),Ne.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Ie),1)),(le=new a.Points(Ne,Ye)).frustumCulled=!1,le.renderOrder=w.MxData.iCADCurveRenderOrder,4<=W.ver&&0<W.instansClipePoints.length&&new G.MxStencilObject().associateObject(le,W.instansClipePoints),m.add(le),this._entitys.push(le)}}}},this)},ee.prototype.createThreejsObjForMemorySections=function(c,m,E){if(c.length!=0){for(var U=[],X=[],W=[],te=[],ne=[],ce=0;ce<c.length;ce++){var we=c[ce];U.push.apply(U,we.mat.elements.slice(0,4)),X.push.apply(X,we.mat.elements.slice(4,8)),W.push.apply(W,we.mat.elements.slice(8,12)),te.push.apply(te,we.mat.elements.slice(12,16)),ne.push(0)}for(var Ie=this._MemorySections.length,xe=0;xe<Ie;xe++){var Be=this._MemorySections[xe],q=E.automaticInversionColor2(Be.color),ge=[];if((4278190080&q)==16777216?(ge=this._color,this._colorValue):ge.push((255&q)/255,(q>>8&255)/255,(q>>16&255)/255),Be.type==j.kLinesType){var oe=new a.RawShaderMaterial({uniforms:{color:{value:ge}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,linewidth:1,transparent:!0,side:a.DoubleSide});(Ae=new a.InstancedBufferGeometry).maxInstancedCount=c.length,Ae.setAttribute("position",new a.Float32BufferAttribute(Be.points,3)),Ae.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(U),4)),Ae.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(X),4)),Ae.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(W),4)),Ae.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ae.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ne),1)),(Ye=new a.LineSegments(Ae,oe)).frustumCulled=!1,Ye.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(Ye),this._entitys.push(Ye)}else if(Be.type==j.kTriangleType){oe=new a.RawShaderMaterial({uniforms:{color:{value:ge}},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,transparent:!0,side:a.DoubleSide}),(Ae=new a.InstancedBufferGeometry).maxInstancedCount=c.length,Ae.setAttribute("position",new a.Float32BufferAttribute(Be.points,3)),Ae.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(U),4)),Ae.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(X),4)),Ae.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(W),4)),Ae.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ae.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ne),1));var se=new a.Mesh(Ae,oe);se.frustumCulled=!1,se.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(se),this._entitys.push(se)}else if(Be.type==j.kPointType){var Ae,Ye;oe=new a.RawShaderMaterial({uniforms:{color:{value:ge},size:1},vertexShader:v.MxShader.VSHADER_COLOR_POINT_FORMXCAD,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_FORMXCAD,transparent:!0,side:a.DoubleSide}),(Ae=new a.InstancedBufferGeometry).maxInstancedCount=c.length,Ae.setAttribute("position",new a.Float32BufferAttribute(Be.points,3)),Ae.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(U),4)),Ae.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(X),4)),Ae.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(W),4)),Ae.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(te),4)),Ae.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ne),1)),(Ye=new a.Points(Ae,oe)).frustumCulled=!1,Ye.renderOrder=w.MxData.iCADCurveRenderOrder,m.add(Ye),this._entitys.push(Ye)}}}},ee.prototype.createThreejsObjForTexture=function(c,m,E){if(c.length!=0){var U=[],X=[],W=[],te=[],ne=[],ce=E.getCurrentLoadUrl(),we=k.MxFun.dwgDir();we.length!=0&&ce.substring(ce.lastIndexOf("/buf/")).toLowerCase()!="/buf/"&&(ce=ce+we+"/buf/");for(var Ie=0;Ie<c.length;Ie++){var xe=c[Ie];U=U.concat(xe.mat.elements.slice(0,4)),X=X.concat(xe.mat.elements.slice(4,8)),W=W.concat(xe.mat.elements.slice(8,12)),te=te.concat(xe.mat.elements.slice(12,16)),ne.push(0)}for(var Be=0;Be<this._TextureData.length;Be++){var q=this._TextureData[Be],ge=new a.InstancedBufferGeometry;ge.maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(q.pos,2)),ge.setAttribute("uv",new a.Float32BufferAttribute(q.textureCoord,2)),ge.setAttribute("color",new a.Float32BufferAttribute(q.color,3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(te),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(ne),1));var oe=ce+q.sFileName,se={texture:{value:new a.TextureLoader().load(oe,function(Ge){Ge&&E.updateDisplay()})}};se.texture.value.wrapS=se.texture.value.wrapT=a.RepeatWrapping;var Ae=new a.RawShaderMaterial({uniforms:se,vertexShader:v.MxShader.VSHADER_COLOR_POINT_TEXTURE,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_TEXTURE,transparent:!0,side:a.DoubleSide}),Ye=new a.Mesh(ge,Ae);Ye.renderOrder=w.MxData.iCADMeshRenderOrder,Ye.frustumCulled=!1,m.add(Ye),this._entitys.push(Ye)}}},ee.prototype.createThreejsObjForTexture_Clip=function(c,m,E){if(c.size!=0){var U=E.getCurrentLoadUrl(),X=k.MxFun.dwgDir();X.length!=0&&U.substring(U.lastIndexOf("/buf/")).toLowerCase()!="/buf/"&&(U=U+X+"/buf/"),c.forEach(function(W){var te=W;if(te.length!=0){for(var ne=te[0].clipPlans,ce=[],we=[],Ie=[],xe=[],Be=[],q=0;q<te.length;q++){var ge=te[q];ce=ce.concat(ge.mat.elements.slice(0,4)),we=we.concat(ge.mat.elements.slice(4,8)),Ie=Ie.concat(ge.mat.elements.slice(8,12)),xe=xe.concat(ge.mat.elements.slice(12,16)),Be.push(0)}for(var oe=0;oe<this._TextureData.length;oe++){var se=this._TextureData[oe],Ae=new a.InstancedBufferGeometry;Ae.maxInstancedCount=te.length,Ae.setAttribute("position",new a.Float32BufferAttribute(se.pos,2)),Ae.setAttribute("uv",new a.Float32BufferAttribute(se.textureCoord,2)),Ae.setAttribute("color",new a.Float32BufferAttribute(se.color,3)),Ae.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(ce),4)),Ae.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(we),4)),Ae.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(Ie),4)),Ae.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(xe),4)),Ae.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(Be),1));var Ye=U+se.sFileName,Ge={texture:{value:new a.TextureLoader().load(Ye,function(ve){ve&&E.updateDisplay()})}};Ge.texture.value.wrapS=Ge.texture.value.wrapT=a.RepeatWrapping;var Ne=new a.RawShaderMaterial({uniforms:Ge,vertexShader:v.MxShader.VSHADER_COLOR_POINT_TEXTURE,fragmentShader:v.MxShader.FSHADER_COLOR_POINT_TEXTURE,transparent:!0,side:a.DoubleSide}),le=new a.Mesh(Ae,Ne);le.renderOrder=w.MxData.iCADMeshRenderOrder,le.frustumCulled=!1,4<=ne.ver&&0<ne.instansClipePoints.length&&new G.MxStencilObject().associateObject(le,ne.instansClipePoints),m.add(le),this._entitys.push(le)}}},this)}},ee.prototype.createThreejsObjForMesh=function(c,m){if(c.length!=0){for(var E=[],U=[],X=[],W=[],te=[],ne=[],ce=[],we=0;we<c.length;we++){var Ie=c[we];E=E.concat(Ie.mat.elements.slice(0,4)),U=U.concat(Ie.mat.elements.slice(4,8)),X=X.concat(Ie.mat.elements.slice(8,12)),W=W.concat(Ie.mat.elements.slice(12,16)),te.push(0),ne=ne.concat(c[we].color)}if(0<this._geometryMeshPositionsByBlock.length)for(we=0;we<c.length;we++)ne=ne.concat(c[we].color);if(0<this._geometryMeshPositionsByBlock_ZeroLayer.length)for(we=0;we<c.length;we++)ce=ce.concat(c[we].topLayerColor);for(var xe=new a.RawShaderMaterial({vertexShader:v.MxShader.VSHADER_COLOR_POINT,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,transparent:!0,side:a.DoubleSide}),Be=0;Be<this._geometryMeshPostion.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPostion[Be],2)),ge.setAttribute("color",new a.Float32BufferAttribute(this._geometryMeshColor[Be],3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.Mesh(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(oe),this._entitys.push(oe);for(Be=0;Be<this._geometryMeshPositionsByBlock.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByBlock[Be],2)),ge.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(ne),3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.Mesh(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(oe),this._entitys.push(oe);for(Be=0;Be<this._geometryMeshPositionsByBlock_ZeroLayer.length;Be++)(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByBlock_ZeroLayer[Be],2)),ge.setAttribute("color",new a.InstancedBufferAttribute(new Float32Array(ce),3)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.Mesh(ge,xe)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(oe),this._entitys.push(oe);var q=new a.RawShaderMaterial({uniforms:{color:{value:this._color}},vertexShader:v.MxShader.VSHADER_COLOR_POINT,fragmentShader:v.MxShader.FSHADER_COLOR_POINT,transparent:!0,side:a.DoubleSide});for(Be=0;Be<this._geometryMeshPositionsByLayer.length;Be++){var ge,oe;(ge=new a.InstancedBufferGeometry).maxInstancedCount=c.length,ge.setAttribute("position",new a.Float32BufferAttribute(this._geometryMeshPositionsByLayer[Be],2)),ge.setAttribute("tran1",new a.InstancedBufferAttribute(new Float32Array(E),4)),ge.setAttribute("tran2",new a.InstancedBufferAttribute(new Float32Array(U),4)),ge.setAttribute("tran3",new a.InstancedBufferAttribute(new Float32Array(X),4)),ge.setAttribute("tran4",new a.InstancedBufferAttribute(new Float32Array(W),4)),ge.setAttribute("ishide",new a.InstancedBufferAttribute(new Float32Array(te),1)),(oe=new a.Mesh(ge,q)).frustumCulled=!1,oe.renderOrder=w.MxData.iCADMeshRenderOrder,m.add(oe),this._entitys.push(oe)}}},ee.prototype.addGeometryCurve=function(c,m,E,U,X){0<c.length&&(this._geometryCurvePostion.push(c),this._geometryCurveColor.push(m)),0<E.length&&this._geometryCurvePositionsByBlock.push(E),0<U.length&&this._geometryCurvePositionsByLayer.push(U),0<X.length&&this._geometryCurvePositionsByBlock_ZeroLayer.push(X)},ee.prototype.addGeometryMesh=function(c,m,E,U,X){0<c.length&&(this._geometryMeshPostion.push(c),this._geometryMeshColor.push(m)),0<E.length&&this._geometryMeshPositionsByBlock.push(E),0<U.length&&this._geometryMeshPositionsByLayer.push(U),0<X.length&&this._geometryMeshPositionsByBlock_ZeroLayer.push(X)},ee.prototype.addGeometryTexture=function(c,m,E,U,X,W,te){var ne=new R;ne.pos=c,ne.textureCoord=m,ne.color=E,ne.sFileName=U,ne.dAngel=X,ne.ptRotationPostionX=W,ne.ptRotationPostionY=te,this._TextureData.push(ne)},ee.prototype.addMemorySections=function(c){this._MemorySections.push(c)},ee.prototype.createThreejsObj=function(c,m,E,U,X){var W=E.getScene(),te=E.getCanvas();if(c.length!=0){if(this._color==null){var ne=U.getColor(X);this._color=[],this._color.push((255&ne)/255,(ne>>8&255)/255,(ne>>16&255)/255),this._colorValue=16777215&ne}this._geometryCurvePostion.length==0&&this._geometryCurvePositionsByBlock.length==0&&this._geometryCurvePositionsByLayer.length==0&&this._geometryCurvePositionsByBlock_ZeroLayer.length==0||this.createThreejsObjForCurve(c,W),this._geometryMeshPostion.length==0&&this._geometryMeshPositionsByBlock.length==0&&this._geometryMeshPositionsByLayer.length==0&&this._geometryMeshPositionsByBlock_ZeroLayer.length==0||this.createThreejsObjForMesh(c,W),this._TextureData.length!=0&&this.createThreejsObjForTexture(c,W,E),this._MemorySections.length!=0&&this.createThreejsObjForMemorySections(c,W,E)}m.size!=0&&(this._color==null&&(ne=U.getColor(X),this._color=[],this._color.push((255&ne)/255,(ne>>8&255)/255,(ne>>16&255)/255),this._colorValue=16777215&ne),this._geometryCurvePostion.length==0&&this._geometryCurvePositionsByBlock.length==0&&this._geometryCurvePositionsByLayer.length==0&&this._geometryCurvePositionsByBlock_ZeroLayer.length==0||this.createThreejsObjForCurve_Clip(m,W,te),this._geometryMeshPostion.length==0&&this._geometryMeshPositionsByBlock.length==0&&this._geometryMeshPositionsByLayer.length==0&&this._geometryMeshPositionsByBlock_ZeroLayer.length==0||this.createThreejsObjForMesh_Clip(m,W,te),this._TextureData.length!=0&&this.createThreejsObjForTexture_Clip(m,W,E),this._MemorySections.length!=0&&this.createThreejsObjForMemorySections_clip(m,W,E)),this._geometryCurvePostion=[],this._geometryCurvePositionsByBlock=[],this._geometryCurvePositionsByLayer=[],this._geometryCurvePositionsByBlock_ZeroLayer=[],this._geometryCurveColor=[],this._geometryMeshPostion=[],this._geometryMeshPositionsByBlock=[],this._geometryMeshPositionsByLayer=[],this._geometryMeshPositionsByBlock_ZeroLayer=[],this._geometryMeshColor=[],this._TextureData=[],this._MemorySections=[]},ee);function ee(c){this._blockRecId=0,this._TextureData=[],this._MemorySections=[],this._geometryCurvePostion=new Array,this._geometryCurveColor=new Array,this._geometryMeshPostion=new Array,this._geometryMeshColor=new Array,this._geometryCurvePositionsByBlock=new Array,this._geometryMeshPositionsByBlock=new Array,this._geometryCurvePositionsByLayer=new Array,this._geometryMeshPositionsByLayer=new Array,this._geometryCurvePositionsByBlock_ZeroLayer=new Array,this._geometryMeshPositionsByBlock_ZeroLayer=new Array,this._entitys=new Array,this._color=void 0,this._colorValue=16777215,this._material_clip=[],this._blockRecId=c}o.Layer=M;var F=(_.prototype.showLayer=function(c,m){var E=this._layerTogeometry.get(c);E!=null&&E.Show(m)},_.prototype.updataClipMaterial=function(c){var m=c.getCanvas();this._layerTogeometry.forEach(function(E,U,X){E.updataClipMaterial(m)})},_.prototype.getId=function(){return this._id},_.prototype.getBlkRef=function(){return this._blkRef},_.prototype.createThreejsObj=function(c,m){var E=this;this._layerTogeometry.forEach(function(U,X,W){U.createThreejsObj(E._instance,E._instance_clip,c,m,X)})},_.prototype.addGeometryCurve=function(c,m,E,U,X,W){var te=this._layerTogeometry.get(E);te==null&&(te=new M(this._id),this._layerTogeometry.set(E,te)),te.addGeometryCurve(c,m,U,X,W)},_.prototype.addMemorySections=function(c){var m=this._layerTogeometry.get(c.layerId);m==null&&(m=new M(this._id),this._layerTogeometry.set(c.layerId,m)),m.addMemorySections(c)},_.prototype.addGeometryTexture=function(c,m,E,U,X,W,te,ne){var ce=this._layerTogeometry.get(U);ce==null&&(ce=new M(this._id),this._layerTogeometry.set(U,ce)),ce.addGeometryTexture(c,m,E,X,W,te,ne)},_.prototype.addGeometryMesh=function(c,m,E,U,X,W){var te=this._layerTogeometry.get(E);te==null&&(te=new M(this._id),this._layerTogeometry.set(E,te)),te.addGeometryMesh(c,m,U,X,W)},_.prototype.addInstance=function(c){var m;c.clipPlans.ver<=3?c.clipPlans.clipPlanArray.length==0?this._instance.length<5e4&&this._instance.push(c):((m=this._instance_clip.get(c.clipPlans.id))==null&&(m=[],this._instance_clip.set(c.clipPlans.id,m)),m.push(c)):c.clipPlans.instansClipePoints.length==0||100<this._instance_clip.size?this._instance.length<5e4&&this._instance.push(c):((m=this._instance_clip.get(c.clipPlans.id))==null&&(m=[],this._instance_clip.set(c.clipPlans.id,m)),m.push(c))},_.prototype.addBlkRef=function(c){this._blkRef.push(c)},_);function _(c){this._id=0,this._layerTogeometry=new Map,this._blkRef=[],this._instance=[],this._instance_clip=new Map,this._id=c}o.Block=F;var J=(T.prototype.crateBlock=function(c){var m=this._mapBlock.get(c);return m==null&&(m=new F(c),this._mapBlock.set(c,m)),m},T.prototype.getBlock=function(c){return this._mapBlock.get(c)},T.prototype.addBlockRef=function(c){this.crateBlock(c.blkOwnerId).addBlkRef(c)},T.prototype.showLayer=function(c,m){this._mapBlock.forEach(function(E,U){var X=E,W=U;return function(te,ne,ce){te.showLayer(X,W)}}.call(this,c,m))},T.prototype.createBlocks_30=function(c,m){if(!this._isCreate){this.crateBlock(0);for(var E=1,U=c.getInt32(12,!0),X=80,W=0;W<U;W++){var te=c.getInt32(X,!0);X+=4;var ne=c.getInt32(X,!0);X+=4;var ce=c.getInt32(X,!0);X+=4;var we=c.getInt32(X,!0);X+=4;for(var Ie=new Array,xe=0;xe<16;xe++){var Be=c.getFloat32(X,!0);X+=4,Ie.push(Be)}var q=c.getInt32(X,!0);X+=4;var ge=new f;ge.id=E,ge.ver=3,E++,ge.clipPlanArray=[];for(var oe=0;oe<q;oe++){var se=c.getFloat32(X,!0);X+=4;var Ae=c.getFloat32(X,!0);X+=4;var Ye=c.getFloat32(X,!0);X+=4;var Ge=c.getFloat32(X,!0);X+=4;var Ne=new D;Ne.x1=se,Ne.y1=Ae,Ne.x2=Ye,Ne.y2=Ge,ge.clipPlanArray.push(Ne)}var le=new O;le.ver=3,le.mat=new a.Matrix4,le.mat.fromArray(Ie),le.blkRecId=ce,le.blkOwnerId=te,le.layerId=ne,le.color=we,le.clipPlans=ge,this.crateBlock(ce),this.addBlockRef(le)}this._isGetAllBlocks=!0,this._isCreate=!0}},T.prototype.createBlocks_40=function(c,m){if(!this._isCreate){this.crateBlock(0);for(var E=1,U=c.getInt32(12,!0),X=80,W=0;W<U;W++){var te=c.getInt32(X,!0);X+=4;var ne=c.getInt32(X,!0);X+=4;var ce=c.getInt32(X,!0);X+=4;var we=c.getInt32(X,!0);X+=4;for(var Ie=new Array,xe=0;xe<16;xe++){var Be=c.getFloat32(X,!0);X+=4,Ie.push(Be)}var q=c.getInt32(X,!0);X+=4;var ge=new f;ge.id=E,ge.ver=4,E++,ge.clipPoints=[];for(var oe=0;oe<q;oe++){var se=new a.Vector2;se.x=c.getFloat32(X,!0),X+=4,se.y=c.getFloat32(X,!0),X+=4,ge.clipPoints.push(se)}var Ae=new O;Ae.ver=4,Ae.mat=new a.Matrix4,Ae.mat.fromArray(Ie),Ae.blkRecId=ce,Ae.blkOwnerId=te,Ae.layerId=ne,Ae.color=we,Ae.clipPlans=ge,this.crateBlock(ce),this.addBlockRef(Ae)}this._isGetAllBlocks=!0,this._isCreate=!0}},T.prototype.createBlocks=function(c,m){this._isCreate||(new L.MxNetData(c).getVersion_MwBlobHead()<=3?this.createBlocks_30(c,m):this.createBlocks_40(c,m))},T.prototype.updataClipMaterial=function(c){this._mapBlock.forEach(function(m,E,U){m.updataClipMaterial(c)})},T.prototype.createAllInstance=function(c){var m=this.getBlock(0);if(m==null||this._rootBlockRef==null)return!1;var E=new a.Matrix4,U=new Map,X=new f;return this._iClipIdCount=1,X.id=this._iClipIdCount,this._iClipIdCount++,this.createAllInstanceCall(m,this._rootBlockRef,E,U,16777215,c,void 0,X),!0},T.prototype.createThreejsObj=function(c,m,E){this._mapNeedCreateThreejsObj.get(c.getId())==null&&this._mapNeedCreateThreejsObj.set(c.getId(),c),this._isCreateAllInstance||this._isGetAllBlocks&&E.isInitComplete()&&(this._isCreateAllInstance=this.createAllInstance(E)),this._isCreateAllInstance&&(this._mapNeedCreateThreejsObj.forEach(function(U,X,W){U.createThreejsObj(m,E)}),this._mapNeedCreateThreejsObj.clear())},T.prototype.createAllInstanceCall=function(c,m,E,U,X,W,te,ne){if(U[c.getId()]!=1){U[c.getId()]=!0;var ce=new C;if(ce.mat=new a.Matrix4,ce.mat.copy(E),ce.mat.multiply(m.mat),m.ver<=3)if(m.clipPlans.clipPlanArray.length==0)ce.clipPlans=ne;else{ce.clipPlans=m.clipPlans,ce.clipPlans.ver=3;for(var we,Ie,xe,Be,q=ce.clipPlans.clipPlanArray.length,ge=function(){we=new a.Vector3(ce.clipPlans.clipPlanArray[oe].x1,ce.clipPlans.clipPlanArray[oe].y1,0),Ie=new a.Vector3(ce.clipPlans.clipPlanArray[oe].x2,ce.clipPlans.clipPlanArray[oe].y2,0),xe=new a.Vector3(ce.clipPlans.clipPlanArray[oe].x1,ce.clipPlans.clipPlanArray[oe].y2,0),Be=new a.Vector3(ce.clipPlans.clipPlanArray[oe].x2,ce.clipPlans.clipPlanArray[oe].y1,0),we.applyMatrix4(ce.mat),Ie.applyMatrix4(ce.mat),xe.applyMatrix4(ce.mat),Be.applyMatrix4(ce.mat);var ht=we.x,Tt=we.x,Ct=we.y,We=we.y,It=[];It.push(Ie),It.push(xe),It.push(Be),It.forEach(function(Bt){ht>Bt.x&&(ht=Bt.x),Tt<Bt.x&&(Tt=Bt.x),Ct>Bt.y&&(Ct=Bt.y),We<Bt.y&&(We=Bt.y)}),ce.clipPlans.clipPlanArray[oe].x1=ht,ce.clipPlans.clipPlanArray[oe].y1=Ct,ce.clipPlans.clipPlanArray[oe].x2=Tt,ce.clipPlans.clipPlanArray[oe].y2=We},oe=0;oe<q;oe++)ge()}else if(m.clipPlans.clipPoints.length==0)ce.clipPlans=ne;else{ce.clipPlans=new f,ce.clipPlans.ver=4,ce.clipPlans.id=this._iClipIdCount,this._iClipIdCount++,ce.clipPlans.instansClipePoints=ne.instansClipePoints.slice(0);var se=[],Ae=m.clipPlans.clipPoints;for(q=Ae.length,oe=0;oe<q;oe++){var Ye=new a.Vector3(Ae[oe].x,Ae[oe].y,0);Ye.applyMatrix4(ce.mat),se.push(new a.Vector2(Ye.x,Ye.y))}ce.clipPlans.instansClipePoints.push(se)}te==null?ce.topLayerColor.push(1,1,1):ce.topLayerColor.push(te[0],te[1],te[2]);var Ge=m.color>>24&255;if(Ge==2)ce.color.push((255&X)/255,(X>>8&255)/255,(X>>16&255)/255);else if(Ge==1){var Ne=W.getColor(m.layerId);ce.color.push((255&Ne)/255,(Ne>>8&255)/255,(Ne>>16&255)/255),X=Ne}else ce.color.push((255&m.color)/255,(m.color>>8&255)/255,(m.color>>16&255)/255),X=m.color;c.addInstance(ce);for(var le=c.getBlkRef(),ve=te==null,He=0;He<le.length;He++)if(le[He].blkRecId!=0){var nt=this.getBlock(le[He].blkRecId);if(nt==null)return;ve&&(te=[],Ne=W.getColor(le[He].layerId),te.push((255&Ne)/255,(Ne>>8&255)/255,(Ne>>16&255)/255)),this.createAllInstanceCall(nt,le[He],ce.mat,U,X,W,te,ce.clipPlans)}U[c.getId()]=!1}},T.prototype.initRootBlockRef=function(c){c==null&&((c=new O).mat=new a.Matrix4,c.blkRecId=0,c.blkOwnerId=-1,c.layerId=-1,c.color=16777215),this._rootBlockRef=c},T);function T(){this._mapBlock=new Map,this._mapNeedCreateThreejsObj=new Map,this._isCreate=!1,this._isGetAllBlocks=!1,this._isCreateAllInstance=!1,this._rootBlockRef=void 0,this._iClipIdCount=1}o.Blocks=J;var B=function(){this.blocks=new J,this.layers=new h.MxBrowseLayerData};o.ExternalReferenceDatabase=B;var N=(u.prototype.createTzDwgExternalReferences=function(c){this._mapId2ExternalDatabase.get(c)||this.getBlocks(c).initRootBlockRef()},u.prototype.createExternalReferences=function(c){for(var m=c.getInt32(12,!0),E=80,U=0;U<m;U++){for(var X=new Array,W=0;W<16;W++){var te=c.getFloat32(E,!0);E+=4,X.push(te)}var ne=c.getInt32(E,!0);E+=4;var ce=c.getInt32(E,!0);if(E+=4,c.getInt32(E,!0),E+=4,ne!=0){var we=this.getBlocks(ne),Ie=new O;Ie.mat=new a.Matrix4,Ie.mat.fromArray(X),Ie.blkRecId=0,Ie.blkOwnerId=-1,Ie.layerId=-1,Ie.color=ce,we.initRootBlockRef(Ie)}else console.log("mx error iDatabaseIndex")}},u.prototype.getBlocks=function(c){if(c!=0){var m=this._mapId2ExternalDatabase.get(c);return m==null&&(m=new B,this._mapId2ExternalDatabase.set(c,m)),m.blocks}console.log("mx error iDatabaseIndex")},u.prototype.getLayers=function(c){if(c!=0){var m=this._mapId2ExternalDatabase.get(c);return m==null&&(m=new B,this._mapId2ExternalDatabase.set(c,m)),m.layers}console.log("mx error iDatabaseIndex")},u);function u(){this._mapId2ExternalDatabase=new Map}o.ExternalReferenceManager=N},{"../MxFun":27,"../MxManager":29,"../MxNetData":31,"../MxShader":32,"../MxStencilObject":33,"./MxBrowseLayerData":67,three:19}],67:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxBrowseLayerData=void 0;var a=(v.prototype.add=function(h,w,L){this._layerColor[h]=w,this._nametoId[L]=h},v.prototype.setZeroLayerId=function(h){this._zeroLayerId=h},v.prototype.getZeroLayerId=function(){return this._zeroLayerId},v.prototype.getLayerIdForName=function(h){return this._nametoId[h]==null?0:this._nametoId[h]},v.prototype.getColor=function(h){return this._layerColor[h]==null?16777215:this._layerColor[h]},v.prototype.initComplete=function(){this._isSetInstanceComplete=!0},v.prototype.isInitComplete=function(){return this._isSetInstanceComplete},v);function v(){this._isSetInstanceComplete=!1,this._layerColor=new Map,this._nametoId=new Map,this._zeroLayerId=0}o.MxBrowseLayerData=a},{}],68:[function(b,r,o){var a=this&&this.__awaiter||function(M,ee,F,_){return new(F=F||Promise)(function(J,T){function B(c){try{u(_.next(c))}catch(m){T(m)}}function N(c){try{u(_.throw(c))}catch(m){T(m)}}function u(c){var m;c.done?J(c.value):((m=c.value)instanceof F?m:new F(function(E){E(m)})).then(B,N)}u((_=_.apply(M,ee||[])).next())})},v=this&&this.__generator||function(M,ee){var F,_,J,T,B={label:0,sent:function(){if(1&J[0])throw J[1];return J[1]},trys:[],ops:[]};return T={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function N(u){return function(c){return function(m){if(F)throw new TypeError("Generator is already executing.");for(;T&&m[T=0]&&(B=0),B;)try{if(F=1,_&&(J=2&m[0]?_.return:m[0]?_.throw||((J=_.return)&&J.call(_),0):_.next)&&!(J=J.call(_,m[1])).done)return J;switch(_=0,J&&(m=[2&m[0],J.value]),m[0]){case 0:case 1:J=m;break;case 4:return B.label++,{value:m[1],done:!1};case 5:B.label++,_=m[1],m=[0];continue;case 7:m=B.ops.pop(),B.trys.pop();continue;default:if(!(J=0<(J=B.trys).length&&J[J.length-1])&&(m[0]===6||m[0]===2)){B=0;continue}if(m[0]===3&&(!J||m[1]>J[0]&&m[1]<J[3])){B.label=m[1];break}if(m[0]===6&&B.label<J[1]){B.label=J[1],J=m;break}if(J&&B.label<J[2]){B.label=J[2],B.ops.push(m);break}J[2]&&B.ops.pop(),B.trys.pop();continue}m=ee.call(M,B)}catch(E){m=[6,E],_=0}finally{F=J=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbDatabase=void 0;var h=b("three"),w=b("../MxFun"),L=b("./MxDbEntity"),G=b("./MxDbEntityGrip"),k=b("./MxDbEntitySelect"),D=b("../MxManager"),f=b("../MxType"),O=b("./MxDbLayerTable"),C=b("./MxDbGroup"),j=b("../MxTools"),V=(R.prototype.getAllEntity=function(){return this.mapIdToEntity},R.prototype.getGroupDictionary=function(){return this.groupDictionary},R.prototype.regenAllMxDbEntity=function(){return this.mapIdToEntity.forEach(function(M){M.upDisplay(),M.setDirtyDisplay(!1)}),!0},R.prototype.upDirtyDisplay=function(){var M=!1;return this.mapIdToEntity.forEach(function(ee){ee.getDirtyDisplay()&&(ee.upDisplay(),ee.setDirtyDisplay(!1),M=!0)}),M},R.prototype.onViewChange=function(){var M=!1;return this.mapIdToEntity.forEach(function(ee){ee.onViewChange()&&(M=!0)}),M},R.prototype.toJsonObject=function(M){var ee={ver:1},F=new h.Vector3(0,0,0),_=new h.Vector3(this.mxObj.getViewWidth(),this.mxObj.getViewHeight(),0),J=f.MxType.MxCloneType.kMxFileClone;M&&(J=f.MxType.MxCloneType.kSaveDwgClone);var T=this.mxObj.screenCoord2Current(F.x,F.y,0),B=this.mxObj.screenCoord2Current(_.x,_.y,0);ee.view={ptView1:T,ptView2:B};var N=[];return this.mapNameToLayer.forEach(function(u){var c={type:J};u.dwgOut(c),c.TypeName="MxDbLayerTableRecord",N.push(c)}),ee.layers=N,this.groupDictionary.dwgOut(ee),ee},R.prototype.saveJson=function(M){var ee=this,F=this.toJsonObject(M),_=f.MxType.MxCloneType.kMxFileClone;M&&(_=f.MxType.MxCloneType.kSaveDwgClone);var J=[];return this.mapIdToEntity.forEach(function(T){var B=T.getUserObject(),N={type:_};B.dwgOut(N),N.TypeName=B.getTypeName(),N.group=ee.groupDictionary.getEntityInGroupName(T.objectId()),J.push(N)}),F.entitys=J,F},R.prototype.reInit=function(){this.eraseAllEntity(),this.groupDictionary=new C.MxDbGroupDictionary;var M=this.parentObject.matrix;this.init(this.mxObj),this.initObjectMatrix(M)},R.prototype.init=function(M){this.mxObj=M,this.scene=M.getScene(),w.MxFun.removeThreejsObject(this.parentObject,this.scene),w.MxFun.removeThreejsObject(this.parentObject_SmallCoord,this.scene),this.parentObject=new h.Object3D,this.parentObject.renderOrder=D.MxData.iMxEntityRenderOrder,this.scene.add(this.parentObject),this.parentObject_SmallCoord=new h.Object3D,this.parentObject_SmallCoord.renderOrder=D.MxData.iMxEntityRenderOrder,this.scene.add(this.parentObject_SmallCoord),this.initLayerTable()},R.prototype.loadJson=function(M){return a(this,void 0,void 0,function(){var ee,F,_,J,T,B,N,u,c,m,E=this;return v(this,function(U){switch(U.label){case 0:if(this.reInit(),(ee=M).view&&(F=ee.view,this.mxObj.zoomW(new h.Vector3(F.ptView1.x,F.ptView1.y,0),new h.Vector3(F.ptView2.x,F.ptView2.y,0),!1)),_=ee.layers)for(J=_.length,m=0;m<J;m++)T=_[m],this.addLayer(T.name).dwgIn(T);this.groupDictionary.dwgIn(ee),B=ee.entitys,N=B.length,u=function(X){var W,te,ne,ce;return v(this,function(we){switch(we.label){case 0:return W=B[X],[4,D.MxManager.getMxDbEntityClassHierarchy().createMxEntity(W.TypeName)];case 1:return(te=we.sent())?(te.dwgIn(W),(ne=new L.MxDbEntity).initUserObject(te),c.addEntityImp(ne),(ce=W.group)&&0<ce.length&&ce.forEach(function(Ie){E.groupDictionary.add(Ie).append(ne.objectId())}),[2]):[2,"continue"]}})},c=this,m=0,U.label=1;case 1:return m<N?[5,u(m)]:[3,4];case 2:U.sent(),U.label=3;case 3:return m++,[3,1];case 4:return[2,new Promise(function(X){X(!0)})]}})})},R.prototype.getMxObject=function(){return this.mxObj},R.prototype.getGripManager=function(){return this.gripManager},R.prototype.getSelectManager=function(){return this.selectManager},R.prototype.clearMxCurrentSelect=function(){var M=!1;return this.gripManager.removeAllGrips()&&(M=!0),this.selectManager.removeAllEntity()&&(M=!0),M},R.prototype.eraseAllEntity=function(){this.mapIdToEntity.forEach(function(M){M.clearDisplayImp()}),this.mapIdToEntity=new Map,this.clearMxCurrentSelect()},R.prototype.initObjectMatrix=function(M){this.parentObject.matrix=M,this.parentObject.matrixAutoUpdate=!1,this.parentObject_SmallCoord.matrix=new h.Matrix4,this.parentObject_SmallCoord.matrixAutoUpdate=!1},R.prototype.initLayerTable=function(){this.mapNameToLayer=new Map,this.curLayer="0";var M=new O.MxDbLayerTableRecord;M.init(this.curLayer,this.parentObject,this.parentObject_SmallCoord),this.mapNameToLayer.set(this.curLayer,M)},R.prototype.getEntity=function(M){return this.mapIdToEntity.get(M)},R.prototype.isValidId=function(M){return this.mapIdToEntity.has(M)},R.prototype.setRenderOrder=function(M){var ee=this.parentObject.renderOrder;return this.parentObject.renderOrder=M,this.parentObject_SmallCoord.renderOrder=M,ee},R.prototype.eraseEntity=function(M){this.gripManager.deleteGripData(M),this.selectManager.deleteSelect(M),this.mapIdToEntity.delete(M)},R.prototype.showLayer=function(M,ee){var F=this.getLayer(M);F&&F.setVisible(ee)},R.prototype.setCurrentLayer=function(M){if(M.length!=0)return this.curLayer=M,this.addLayer(M)},R.prototype.addLayer=function(M){var ee=this.mapNameToLayer.get(M);return ee||((ee=new O.MxDbLayerTableRecord).init(M,this.parentObject,this.parentObject_SmallCoord),this.mapNameToLayer.set(M,ee),ee)},R.prototype.getLayer=function(M){return this.mapNameToLayer.get(M)},R.prototype.addMxEntity=function(M){if(M.getImp())return M.objectId();var ee=new L.MxDbEntity;return ee.initUserObject(M),M.initGuid(j.MxTools.generateUUID()),this.addEntityImp(ee)},R.prototype.addEntityImp=function(M){return this.mapIdToEntity.set(this.idCount,M),M.setMxDatabase(this),M.setObjectId(this.idCount),M.getLayer().length==0&&M.setLayer(this.curLayer),M.upDisplay(),this.idCount++},R.prototype.getThreeJSParentObject=function(){return this.parentObject},R.prototype.getThreeJSParentObject_SmallCoord=function(){return this.parentObject_SmallCoord},R.prototype.getIntersectObjects=function(M){var ee=this.getIntersectObjects_imp(M),F=this.getIntersectObjects_SmallCoord_imp(M);return ee.concat(F)},R.prototype.getIntersectObjects_imp=function(M){return this.mxObj.getMxDrawThreeJs().createRaycaster(M).intersectObjects(this.parentObject.children,!0)},R.prototype.getIntersectObjects_SmallCoord_imp=function(M){return this.mxObj.getMxDrawThreeJs().createRaycaster(M).intersectObjects(this.parentObject_SmallCoord.children,!0)},R);function R(){this.mapIdToEntity=new Map,this.mxObj=null,this.scene=null,this.idCount=1,this.parentObject=null,this.parentObject_SmallCoord=null,this.mapNameToLayer=new Map,this.curLayer="0",this.gripManager=new G.MxDbEntityGrip(this),this.selectManager=new k.MxDbEntitySelect(this),this.groupDictionary=new C.MxDbGroupDictionary}o.MxDbDatabase=V},{"../MxFun":27,"../MxManager":29,"../MxTools":38,"../MxType":39,"./MxDbEntity":69,"./MxDbEntityGrip":70,"./MxDbEntitySelect":71,"./MxDbGroup":72,"./MxDbLayerTable":73,three:19}],69:[function(b,r,o){var a=this&&this.__awaiter||function(R,M,ee,F){return new(ee=ee||Promise)(function(_,J){function T(u){try{N(F.next(u))}catch(c){J(c)}}function B(u){try{N(F.throw(u))}catch(c){J(c)}}function N(u){var c;u.done?_(u.value):((c=u.value)instanceof ee?c:new ee(function(m){m(c)})).then(T,B)}N((F=F.apply(R,M||[])).next())})},v=this&&this.__generator||function(R,M){var ee,F,_,J,T={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return J={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(J[Symbol.iterator]=function(){return this}),J;function B(N){return function(u){return function(c){if(ee)throw new TypeError("Generator is already executing.");for(;J&&c[J=0]&&(T=0),T;)try{if(ee=1,F&&(_=2&c[0]?F.return:c[0]?F.throw||((_=F.return)&&_.call(F),0):F.next)&&!(_=_.call(F,c[1])).done)return _;switch(F=0,_&&(c=[2&c[0],_.value]),c[0]){case 0:case 1:_=c;break;case 4:return T.label++,{value:c[1],done:!1};case 5:T.label++,F=c[1],c=[0];continue;case 7:c=T.ops.pop(),T.trys.pop();continue;default:if(!(_=0<(_=T.trys).length&&_[_.length-1])&&(c[0]===6||c[0]===2)){T=0;continue}if(c[0]===3&&(!_||c[1]>_[0]&&c[1]<_[3])){T.label=c[1];break}if(c[0]===6&&T.label<_[1]){T.label=_[1],_=c;break}if(_&&T.label<_[2]){T.label=_[2],T.ops.push(c);break}_[2]&&T.ops.pop(),T.trys.pop();continue}c=M.call(R,T)}catch(m){c=[6,m],F=0}finally{ee=_=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([N,u])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbEntity=o.MxDbEntityClassHierarchy=o.MxDbEntityUserObject=void 0;var h=b("three"),w=b("../Operate/McGiWorldDraw"),L=b("../MxManager"),G=b("../MxTools"),k=b("../MxType"),D=(f.prototype.getClosestPointTo=function(R,M){return null},f.prototype.getTypeName=function(){return""},f.prototype.isUseSmallcoordDisplay=function(){return this.use_smallcoord_display},f.prototype.toSmallcoord=function(R,M){return this.use_smallcoord_display?R.toSmallcoord(M):M},f.prototype.initGuid=function(R){0<this.sGuid.length?console.log("mx: init guid error"):this.sGuid=R},f.prototype.guid=function(){return this.sGuid},f.prototype.setGuid=function(R){this.sGuid=R},f.prototype.setLayer=function(R){var M=this.getImp();M&&M.nodifySetLayer(),this.layer=R},f.prototype.getLayer=function(){return this.layer},f.prototype.setDash=function(R,M){this.dDashArray=R,this.dDashRatio=M,this.dLineWidth==0&&(this.dLineWidth=6,this.lineWidthByPixels=!0)},f.prototype.getDash=function(){return{dDashArray:this.dDashArray,dDashRatio:this.dDashRatio}},f.prototype.setDashLineDisplay=function(R){R?(this.dDashArray=.03,this.dDashRatio=.1,this.dLineWidth==0&&(this.dLineWidth=6,this.lineWidthByPixels=!0)):(this.dDashArray=0,this.dDashRatio=0)},f.prototype.isDashLineDisplay=function(){return 0<this.dDashArray&&0<this.dDashRatio},f.prototype.setLineWidthByPixels=function(R){this.lineWidthByPixels=R},f.prototype.getLineWidthByPixels=function(){return this.lineWidthByPixels},f.prototype.setLineWidth=function(R){this.dLineWidth=R},f.prototype.getLineWidth=function(){return this.dLineWidth},f.prototype.getMxObject=function(){var R=this.getImp();return R?R.getMxObject():null},f.prototype.onViewChange=function(){return!1},f.prototype.getImp=function(){return this.MxDbEntityImp},f.prototype.upDisplay=function(){var R=this.getImp();return!!R&&R.upDisplay()},f.prototype.erase=function(){var R=this.getImp();return!!R&&R.erase()},f.prototype.setColor=function(R){this.iColor=R},f.prototype.getColor=function(){return this.iColor},f.prototype.setRenderOrder=function(R){this.iRenderOrder=R},f.prototype.getRenderOrder=function(){return this.iRenderOrder},f.prototype.onEndGripEidt=function(){},f.prototype.onStartGripEidt=function(){},f.prototype.dwgIn=function(R){return this.iColor=R.iColor,this.iRenderOrder=R.iRenderOrder,this.opacity=R.opacity,this.visible=R.visible,this.dLineWidth=R.lineWidth,this.lineWidthByPixels=R.lineWidthByPixels,this.dDashArray=R.dashArray,this.dDashRatio=R.dashRatio,this.layer=R.layer,R.guid&&(this.sGuid=R.guid),!0},f.prototype.dwgOut=function(R){return R.iColor=this.iColor,R.iRenderOrder=this.iRenderOrder,R.opacity=this.opacity,R.visible=this.visible,R.lineWidth=this.dLineWidth,R.lineWidthByPixels=this.lineWidthByPixels,R.dashArray=this.dDashArray,R.dashRatio=this.dDashRatio,R.layer=this.layer,R.guid=this.sGuid,R},f.prototype.clone=function(R){var M=this.create(),ee={type:R||k.MxType.MxCloneType.kClone};return this.dwgOut(ee),M.dwgIn(ee),M.sGuid="",M},f.prototype.init=function(){L.MxManager.getMxDbEntityClassHierarchy().init(this)},f.prototype.transformBy=function(R){},f.prototype.objectId=function(){var R=this.getImp();return R?R.objectId():0},f);function f(){this.iColor=16777215,this.iRenderOrder=L.MxData.iMxEntityRenderOrder,this.opacity=1,this.visible=!0,this.dLineWidth=0,this.lineWidthByPixels=!0,this.dDashArray=0,this.dDashRatio=0,this.layer="",this.sGuid="",this.use_smallcoord_display=!1}o.MxDbEntityUserObject=D;var O=(C.prototype.init=function(R){var M=R.getTypeName();this.mapType2Create.get(M)&&console.log("MxError:already has this class name "+M),this.mapType2Create.set(M,{type:0,createfun:R})},C.prototype.initDynamic=function(R){this.dynmaicCreate=R},C.prototype.createMxEntity=function(R){return a(this,void 0,void 0,function(){var M,ee;return v(this,function(F){switch(F.label){case 0:return(M=this.mapType2Create.get(R))?[3,3]:this.dynmaicCreate?[4,this.dynmaicCreate(R)]:[3,2];case 1:return(ee=F.sent())?(this.mapType2Create.set(R,{type:1,createfun:ee}),[2,new Promise(function(_,J){_(new ee)})]):[2,new Promise(function(_,J){_(null)})];case 2:return[2,new Promise(function(_,J){_(null)})];case 3:return M.type==0?[2,new Promise(function(_,J){_(M.createfun.create())})]:M.type==1?[2,new Promise(function(_,J){_(new M.createfun)})]:[2,new Promise(function(_,J){_(null)})]}})})},C);function C(){this.mapType2Create=new Map,this.dynmaicCreate=null}o.MxDbEntityClassHierarchy=O;var j=(V.prototype.setObjectId=function(R){this.id=R},V.prototype.nodifySetLayer=function(){this.layerObjectGroup&&this.clearDisplayImp()},V.prototype.setLayer=function(R){this.userObject.setLayer(R)},V.prototype.getLayer=function(){return this.userObject.getLayer()},V.prototype.setDirtyDisplay=function(R){this.isDirtyDisplay=R},V.prototype.getDirtyDisplay=function(){return this.isDirtyDisplay},V.prototype.setMxDatabase=function(R){this.mxDatabase=R},V.prototype.objectId=function(){return this.id},V.prototype.initUserObject=function(R){(this.userObject=R).MxDbEntityImp=this},V.prototype.upDisplay=function(){if(!this.mxDatabase)return console.log("mxassert(0) this.mxDatabase is null"),!1;this.updateDisplayImp(this.mxDatabase.getMxObject())},V.prototype.erase=function(){if(this.id==0)return!1;this.clearDisplayImp(),this.userObject=null,this.mxDatabase.eraseEntity(this.id),this.id=0,this.mxDatabase=null},V.prototype.clearDisplayImp=function(){this.layerObjectGroup&&(this.threeObjectGroup&&(this.threeObjectGroup.traverse(function(R){R.type==="Mesh"&&(R.geometry.dispose(),R.material.dispose())}),this.layerObjectGroup.remove(this.threeObjectGroup)),this.threeObjectGroup=null,this.layerObjectGroup=null)},V.prototype.updateDisplayImp=function(R){if(this.clearDisplayImp(),this.userObject){if(this.userObject.visible){var M=this.mxDatabase.addLayer(this.userObject.getLayer());if(!M)return console.log("mxassert(0) this.layerRecord is null"),!1;this.threeObjectGroup=new h.Object3D;var ee=new w.McGiWorldDraw(R,w.McGiWorldDrawType.kWorldDraw);ee.setupForEntity(this.userObject),this.worldDraw(ee);for(var F=ee.getEntitys(),_=F.length,J=0;J<_;J++){var T=F[J];(T.MxDbEntity=this).threeObjectGroup.add(T)}this.userObject.isUseSmallcoordDisplay()?this.layerObjectGroup=M.getGroup_SmallCoord():this.layerObjectGroup=M.getGroup(),this.layerObjectGroup.add(this.threeObjectGroup)}}else G.MxTools.MxASSERT(!1,"this.userObject == null")},V.prototype.worldDraw=function(R){this.userObject.worldDraw(R)},V.prototype.getGripPoints=function(){return this.userObject.getGripPoints()},V.prototype.getClosestPointTo=function(R,M){return this.userObject.getClosestPointTo(R,M)},V.prototype.getUserObject=function(){return this.userObject},V.prototype.clone=function(R){var M=new V;return M.initUserObject(this.userObject.clone(R)),M},V.prototype.transformBy=function(R){this.userObject.transformBy(R)},V.prototype.setColor=function(R){this.userObject.setColor(R)},V.prototype.onEndGripEidt=function(){this.userObject.onEndGripEidt()},V.prototype.onStartGripEidt=function(){return this.userObject.onStartGripEidt()},V.prototype.getColor=function(){return this.userObject.getColor()},V.prototype.getMxObject=function(){return this.mxDatabase?this.mxDatabase.getMxObject():null},V.prototype.onViewChange=function(){return!!this.userObject&&this.userObject.onViewChange()},V);function V(){this.threeObjectGroup=null,this.userObject=null,this.mxDatabase=null,this.isDirtyDisplay=!1,this.layerObjectGroup=null,this.id=0}o.MxDbEntity=j},{"../MxManager":29,"../MxTools":38,"../MxType":39,"../Operate/McGiWorldDraw":44,three:19}],70:[function(b,r,o){var a,v=this&&this.__extends||(a=function(_,J){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,B){T.__proto__=B}||function(T,B){for(var N in B)Object.prototype.hasOwnProperty.call(B,N)&&(T[N]=B[N])})(_,J)},function(_,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");function T(){this.constructor=_}a(_,J),_.prototype=J===null?Object.create(J):(T.prototype=J.prototype,new T)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbEntityGrip=o.MxDbEntityGripJig=o.MxGetWordDrawxDataForThreeJsObject=o.MxGetMxDbEntitForThreeJsObject=o.MxDbEntityGripData=void 0;var h=b("three"),w=b("../MxFun"),L=b("../MxDrawData"),G=b("../Operate/MxJig"),k=b("../Operate/MxJigCmdManager"),D=b("../Operate/McGiWorldDraw"),f=b("../MxManager"),O=b("../MxType"),C=function(){this.threeObject=null};function j(_){for(var J=null;_&&!(J=_.MxDbEntity)&&_.parent;)_=_.parent;return J}o.MxDbEntityGripData=C,o.MxGetMxDbEntitForThreeJsObject=j,o.MxGetWordDrawxDataForThreeJsObject=function(_){for(var J=null;_&&!(J=_.MxWordDrawXData)&&_.parent;)_=_.parent;return J};var V,R=(v(M,V=G.McEdJigCommand),M.prototype.sampler=function(){var _=k.MxJigCmdManager.InType.kGetBegan|k.MxJigCmdManager.InType.kGetEnd,J=this.acquirePoint(_);return J.status==k.MxJigCmdManager.DragStatus.kNormal&&(this.currPt=J.pt),J.status},M.prototype.getTypeName=function(){return"MxGripEdit"},M.prototype.onStartCommand=function(){this.iscallOnStartCommand=!0,V.prototype.onStartCommand.call(this)},M.prototype.done=function(_){if(_==k.MxJigCmdManager.DragStatus.kNormal){var J=this.currPt.clone();J.sub(this.dragBasePt);for(var T=this.getMxObject(),B=T.getMxDatabase(),N=T.getMxDatabase().getGripManager(),u=this.grips.length,c=new Set,m=[],E=0;E<u;E++){var U=this.grips[E],X=this.ents[E];N.deleteGripData(X.objectId()),X.getUserObject().moveGripPointsAt(U.iIndex,J),N.addGripFromEntity(X),X.upDisplay(),c.add(X.objectId());var W={type:"mxdraw",id:X.objectId(),index:U.iIndex,curentPoint:this.currPt,point:U.point,offset_x:J.x,offset_y:J.y};m.push(W)}T.updateDisplay(),0<m.length&&T.callEvent("objectGripEdit",m),B.getSelectManager().upSelectDilsplay(c)}var te=this.ents.length;for(E=0;E<te;E++)(X=this.ents[E]).onEndGripEidt(),_!=k.MxJigCmdManager.DragStatus.kNormal&&X.upDisplay();return k.MxJigCmdManager.DoneStatius.kExitCommand},M.prototype.upDisplay=function(){var _=this.currPt.clone();if(_.sub(this.dragBasePt),!(_.length()<.001)){if(this.iscallOnStartCommand){for(var J=this.ents.length,T=0;T<J;T++){var B=this.ents[T];this.aryParam.push(B.onStartGripEidt())}this.iscallOnStartCommand=!1}var N=this.getMxObject(),u=this.grips.length;for(T=0;T<u;T++){var c=this.grips[T],m=(B=this.ents[T],this.aryParam[T]),E=B.clone(O.MxType.MxCloneType.kDragClone);E.getUserObject().moveGripPointsAt(c.iIndex,_);var U=new D.McGiWorldDraw(N,D.McGiWorldDrawType.kDynDragDraw);U.setupForEntity(E.getUserObject()),E.worldDraw(U);var X=U.getEntitys(),W=X.length,te=31;m&&m.renderOrder&&(te=m.renderOrder);for(var ne=0;ne<W;ne++)this.drawEntity(X[ne],te,E.getUserObject().isUseSmallcoordDisplay())}}},M);function M(_,J,T){var B=V.call(this)||this;return B.aryParam=[],B.iscallOnStartCommand=!0,B.dragBasePt=_,B.grips=J,B.ents=T,B.currPt=_,B.iscallOnStartCommand=!0,B}o.MxDbEntityGripJig=R;var ee=(F.prototype.getAllSelect=function(){var _=[];return this.mapGrips.forEach(function(J,T){_.push(T)}),_},F.prototype.getParentGroup=function(){return this.drawGroup||(this.drawGroup=new h.Group,this.drawGroup.renderOrder=f.MxData.iGripRenderOrder,this.database.getMxObject().getTheTempDrawContainer_SmallCoord().add(this.drawGroup)),this.drawGroup},F.prototype.reInit=function(){this.removeAllGrips(),this.drawGroup&&w.MxFun.removeThreejsObject(this.drawGroup,this.database.getMxObject().getTheTempDrawContainer_SmallCoord()),this.drawGroup=null},F.prototype.removeAllGrips=function(){if(this.mapGrips.size==0)return!1;var _=this.getParentGroup();return this.mapGrips.forEach(function(J,T,B){for(var N=J.length,u=0;u<N;u++){var c=J[u];w.MxFun.removeThreejsObject(c.threeObject,_)}}),this.mapGrips=new Map,!0},F.prototype.deleteGripData=function(_){var J=this.getParentGroup(),T=this.mapGrips.get(_);if(T)for(var B=T.length,N=0;N<B;N++){var u=T[N];w.MxFun.removeThreejsObject(u.threeObject,J)}this.mapGrips.delete(_)},F.prototype.createGripDisplayObject=function(_){var J=this.database.getMxObject(),T=this.getParentGroup();_.geometry=new h.Geometry;var B=J.toSmallcoord2(_.point.x,_.point.y,_.point.z),N=J.screenCoordLong2World(L.MxDrawData.m_dInputRectWidth/2);_.geometry.vertices.push(new h.Vector3(B.x-N,B.y-N,0)),_.geometry.vertices.push(new h.Vector3(B.x-N,B.y+N,0)),_.geometry.vertices.push(new h.Vector3(B.x+N,B.y+N,0)),_.geometry.vertices.push(new h.Vector3(B.x+N,B.y-N,0)),_.geometry.faces.push(new h.Face3(0,1,2)),_.geometry.faces.push(new h.Face3(2,3,0)),_.geometry.computeFaceNormals(),_.geometry.computeVertexNormals();var u=new h.MeshBasicMaterial({color:255,transparent:!0,depthTest:!1,side:h.DoubleSide,opacity:.9}),c=new h.Mesh(_.geometry,u);T.add(c),_.threeObject=c},F.prototype.addGripData=function(_,J,T){var B=this.mapGrips.get(_);B==null&&(B=new Array,this.mapGrips.set(_,B));var N=new C;return N.iIndex=J,N.point=new h.Vector3(T.x,T.y,0),B.push(N),N},F.prototype.hitTest=function(_){var J=this,T={grips:new Array,ents:new Array,pt:_},B=new h.Vector3(_.x,_.y,0),N=this.database.getMxObject(),u=N.viewCoordLong2Cad(L.MxDrawData.m_dInputRectWidth/2);return this.mapGrips.forEach(function(c,m){for(var E=c.length,U=0;U<E;U++){var X=c[U];if(X.point.distanceTo(B)<=u){var W=J.database.getEntity(m),te=!0;N.hasEvent("whetherEditTheGripPoint")&&(te=N.callEvent("whetherEditTheGripPoint",{entity:W.getUserObject(),index:X.iIndex})),te&&(T.grips.push(X),T.ents.push(W));break}}}),T},F.prototype.onMouseLBDown=function(_){if(!L.MxDrawData.m_isEnableGripEidt)return!1;var J=this.hitTest(_);return J.grips.length!=0&&(w.MxFun.sendStringToExecute("Mx_FrontEndWebpageGripEdit",J),!0)},F.prototype.gripEditImp=function(_){var J=_.grips,T=_.ents,B=_.pt,N=new R(B,J,T);N.setDisableDynInput(!0),N.setDisableOsnap(!0),k.MxJigCmdManager.runCmd(N)},F.prototype.doWindowsSelect=function(_,J){},F.prototype.addGripFromEntity=function(_){if(L.MxDrawData.m_isEnableGripEidt){var J=_.getGripPoints(),T=_.objectId();this.deleteGripData(T);for(var B=0;B<J.length;B++){var N=this.addGripData(T,B,J[B]);this.createGripDisplayObject(N)}}},F.prototype.addSelect=function(_,J,T){T===void 0&&(T=!0);var B=this.database.getSelectManager(),N=!1;if(this.getAllSelect().forEach(function(m){m==_&&(N=!0)}),N)return!1;var u=this.database.getMxObject().getMxEntity(_);if(!u)return!1;var c=new Set;return c.add(_),T&&this.addGripFromEntity(u),B.upSelectDilsplay(c),J&&this.fireMxEntitySelectChange(),!0},F.prototype.fireMxEntitySelectChange=function(){var _=this.database.getMxObject();this.isCallingMxEntitySelectChange||(this.isCallingMxEntitySelectChange=!0,_.callEvent("mxdrawSelectChange",this.getAllSelect()),this.isCallingMxEntitySelectChange=!1)},F.prototype.doPointSelect=function(_){for(var J=!1,T=this.database.getSelectManager(),B=this.database.getMxObject(),N=T.isEmptySelect(),u=!1,c=B.viewCoordLong2Cad(.5*L.MxDrawData.m_dInputRectWidth),m=function(){B.pointMultipleSelect()||(E.removeAllGrips()&&(u=!0),T.removeAllEntity()&&(u=!0),B.getMcObject().isValid()&&(u=B.getMcObject().getGripManager().clearAll()));var U=E.database.getIntersectObjects(_);if(U.length==0)return B.updateDisplay(),"break";var X=B.screenCoord2Current(_.x,_.y,_.z),W=E,te=new Set;U.forEach(function(we){var Ie=j(we.object);if(Ie){var xe=Ie.objectId();if(W.database.isValidId(xe)&&!te.has(xe)){var Be=Ie.getClosestPointTo(X,1),q=!1;(!Be||Be.distanceTo(X)<c)&&(q=!0),q&&(te.add(xe),W.addGripFromEntity(Ie))}}});var ne=new Set,ce=E.database.getGroupDictionary();return te.forEach(function(we){ne.add(we),ce.getEntityInGroup(we).forEach(function(Ie){Ie.getAll().forEach(function(xe){W.database.isValidId(xe)&&ne.add(xe)})})}),u=!0,T.upSelectDilsplay(ne),B.updateDisplay(),J=!0,"break"},E=this;m()!=="break";);return!u&&N==T.isEmptySelect()||this.fireMxEntitySelectChange(),J},F);function F(_){this.database=null,this.mapGrips=new Map,this.isCallingMxEntitySelectChange=!1,this.drawGroup=null,this.database=_}o.MxDbEntityGrip=ee},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxType":39,"../Operate/McGiWorldDraw":44,"../Operate/MxJig":53,"../Operate/MxJigCmdManager":54,three:19}],71:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbEntitySelect=void 0;var a=b("three"),v=b("../MxFun"),h=b("three.meshline"),w=b("../Operate/McGiWorldDraw"),L=b("../MxManager"),G=(k.prototype.setRenderOrder=function(D){this.iRenderOrder=D},k.prototype.getRenderOrder=function(){return this.iRenderOrder},k.prototype.setCanvasSize=function(D,f){this.canvasWidth==D&&this.canvasHeight==f||(this.canvasWidth=D,this.canvasHeight=f,this.material.resolution=new a.Vector2(this.canvasWidth,this.canvasHeight),this.material.needsUpdate=!0)},k.prototype.removeAllEntity=function(){return this.mapIdToThreeObject.size!=0&&(this.mapIdToThreeObject.forEach(function(D){for(var f=D.length,O=0;O<f;O++){var C=D[O];v.MxFun.removeThreejsObject(C,C.parentObject)}}),this.mapIdToThreeObject.clear(),!0)},k.prototype.isEmptySelect=function(){return this.mapIdToThreeObject.size==0},k.prototype.getParentObject=function(D){return D?this.mxDatabase.getMxObject().getTheTempDrawContainer_SmallCoord():this.mxDatabase.getMxObject().getTheTempDrawContainer()},k.prototype.getAllSelect=function(){var D=[];return this.mapIdToThreeObject.forEach(function(f,O){D.push(O)}),D},k.prototype.setPrvCommandSelect=function(D){this.aryPrvCommandSelect=D},k.prototype.getPrvCommandSelect=function(){return this.aryPrvCommandSelect},k.prototype.deleteSelect=function(D){var f=this.mapIdToThreeObject.get(D);if(f){for(var O=f.length,C=0;C<O;C++){var j=f[C];v.MxFun.removeThreejsObject(j,j.parentObject)}this.mapIdToThreeObject.delete(D)}},k.prototype.upSelectDilsplayFromId=function(D){var f=new Set;f.add(D),this.upSelectDilsplay(f)},k.prototype.upSelectDilsplay=function(D){var f=this,O=new w.McGiWorldDrawSelect(this.mxDatabase.getMxObject(),this);D.forEach(function(C){f.deleteSelect(C);var j=f.mxDatabase.getEntity(C);j&&(O.setSmallCoordDraw(j.getUserObject().isUseSmallcoordDisplay()),O.setCurEntityId(C),j.worldDraw(O))})},k.prototype.addCircleDisplay=function(D,f,O,C){var j=new a.CircleGeometry(O,64,3,2*Math.PI);if(j.vertices.shift(),j.vertices.length!=0){j.vertices.push(j.vertices[0]);var V=3*j.vertices.length;if(V!=0){for(var R=this.getParentObject(C),M=new Float32Array(V),ee=0,F=0;ee+2<V;ee+=3,F++)M[ee]=j.vertices[F].x+f.x,M[ee+1]=j.vertices[F].y+f.y,M[ee+2]=f.z;var _=new h.MeshLine;_.setGeometry(M);var J=new a.Mesh(_.geometry,this.material);J.renderOrder=this.iRenderOrder,(J.parentObject=R).add(J);var T=this.mapIdToThreeObject.get(D);T||(T=new Array,this.mapIdToThreeObject.set(D,T)),T.push(J)}}},k.prototype.addLineDisplay=function(D,f,O,C){var j=this.getParentObject(C),V=new Float32Array(6);V[0]=f.x,V[1]=f.y,V[2]=0,V[3]=O.x,V[4]=O.y,V[5]=0;var R=new h.MeshLine;R.setGeometry(V);var M=new a.Mesh(R.geometry,this.material);M.renderOrder=this.iRenderOrder,(M.parentObject=j).add(M);var ee=this.mapIdToThreeObject.get(D);ee||(ee=new Array,this.mapIdToThreeObject.set(D,ee)),ee.push(M)},k);function k(D){this.mapIdToThreeObject=new Map,this.canvasWidth=800,this.canvasHeight=500,this.mxDatabase=null,this.material=new h.MeshLineMaterial({useMap:!1,color:new a.Color(2641557),opacity:.8,resolution:new a.Vector2(800,500),sizeAttenuation:!1,lineWidth:10,transparent:!0,depthTest:!1}),this.iRenderOrder=L.MxData.iSelectRenderOrder,this.aryPrvCommandSelect=[],this.mxDatabase=D}o.MxDbEntitySelect=G},{"../MxFun":27,"../MxManager":29,"../Operate/McGiWorldDraw":44,three:19,"three.meshline":18}],72:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbGroupDictionary=o.MxDbGroup=void 0;var a=(v.prototype.name=function(){return this.sName},v.prototype.append=function(L){this.has(L)||this.setId.add(L)},v.prototype.clear=function(){this.setId=new Set},v.prototype.getAll=function(){var L=[];return this.setId.forEach(function(G){L.push(G)}),L},v.prototype.has=function(L){return this.setId.has(L)},v.prototype.delete=function(L){return this.setId.delete(L)},v);function v(L){this.setId=new Set,this.sName="",this.sName=L}o.MxDbGroup=a;var h=(w.prototype.getAt=function(L){return this.mapNameToGroup.get(L)},w.prototype.delete=function(L){return!!this.mapNameToGroup.has(L)&&this.mapNameToGroup.delete(L)},w.prototype.add=function(L){var G=this.mapNameToGroup.get(L);return G||(G=new a(L),this.mapNameToGroup.set(L,G),G)},w.prototype.dwgOut=function(L){var G=[];return this.mapNameToGroup.forEach(function(k,D){G.push(D)}),L.groups=G,L},w.prototype.dwgIn=function(L){var G=this;return L.groups.forEach(function(k){var D=new a(k);G.mapNameToGroup.set(k,D)}),!0},w.prototype.getEntityInGroup=function(L){var G=[];return this.mapNameToGroup.forEach(function(k){k.has(L)&&G.push(k)}),G},w.prototype.getEntityInGroupName=function(L){var G=[];return this.mapNameToGroup.forEach(function(k,D){k.has(L)&&G.push(D)}),G},w);function w(){this.mapNameToGroup=new Map}o.MxDbGroupDictionary=h},{}],73:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbLayerTableRecord=void 0;var a=b("three"),v=(h.prototype.getGroup=function(){return this.group},h.prototype.getGroup_SmallCoord=function(){return this.group_SmallCoord},h.prototype.getName=function(){return this.name},h.prototype.setName=function(w){this.name=w},h.prototype.setVisible=function(w){this.visible=w,this.group.visible=w,this.group_SmallCoord.visible=w},h.prototype.getVisible=function(){return this.visible},h.prototype.init=function(w,L,G){return this.name=w,L.add(this.group),G.add(this.group_SmallCoord),!0},h.prototype.dwgIn=function(w){return this.visible=w.visible,this.name=w.name,this.group.visible=this.visible,this.group_SmallCoord.visible=this.visible,!0},h.prototype.dwgOut=function(w){return w.visible=this.visible,w.name=this.name,w},h);function h(){this.group=new a.Group,this.group_SmallCoord=new a.Group,this.name="",this.visible=!0}o.MxDbLayerTableRecord=v},{three:19}],74:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MxDbTextureManager=void 0;var a=b("three"),v=(h.prototype.loadImage=function(w,L){var G=this.mapImageUrlToMaterialTexture.get(w);if(G)L(G);else{var k=this;new a.TextureLoader().load(w,function(D){var f=new a.MeshLambertMaterial({map:D,transparent:!0,side:a.DoubleSide});f.map&&(f.map.needsUpdate=!0),k.mapImageUrlToMaterialTexture.set(w,f),L&&L(f)},void 0,function(D){console.log(D),L&&L(null)})}},h);function h(){this.mapImageUrlToMaterialTexture=new Map}o.MxDbTextureManager=v},{three:19}],75:[function(b,r,o){var a,v=this&&this.__extends||(a=function(u,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,E){m.__proto__=E}||function(m,E){for(var U in E)Object.prototype.hasOwnProperty.call(E,U)&&(m[U]=E[U])})(u,c)},function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function m(){this.constructor=u}a(u,c),u.prototype=c===null?Object.create(c):(m.prototype=c.prototype,new m)});Object.defineProperty(o,"__esModule",{value:!0}),o.MxDrawObject3dThreeJS=o.MxDrawMapBoxThreeJS=o.MxDrawObject2dThreeJS=o.MxDrawThreeJS=o.MxThreeJSType=void 0;var h,w,L,G=b("three"),k=b("../Operate/MxJigCmdManager"),D=b("three-orbitcontrols"),f=b("../UI/MxUiVue"),O=(v(C,h=D.OrbitControls),C.prototype.update=function(){},C);function C(u,c){return h.call(this,u,c)||this}(L=w||(o.MxThreeJSType=w={}))[L.k2d=0]="k2d",L[L.k3d=1]="k3d",L[L.kMapBox=2]="kMapBox";var j=(V.prototype.screenCoord2World=function(u,c,m){return this.mxObject.screenCoord2World_mxdrawThreeJS_call(u,c,m)},V.prototype.worldCoord2Screen=function(u,c,m){return this.mxObject.worldCoord2Screen_mxdrawThreeJS_call(u,c,m)},V.prototype.getDomMousePos=function(u){},V.prototype.createRaycaster=function(u){var c=new G.Raycaster;c.linePrecision=this.mxObject.screenCoordLong2World(10);var m=this.mxObject.getCanvas(),E=m.clientWidth,U=m.clientHeight,X=new G.Vector2(u.x/E*2-1,-u.y/U*2+1);return c.setFromCamera(X,this.mxObject.getCamera()),c},V.prototype.zoomW=function(u,c,m,E,U){return this.mxObject.zoomW_call(u,c,m,U)},V.prototype.zoomCenter=function(u,c,m){return this.mxObject.zoomCenter_call(u,c)},V.prototype.zoomScale=function(u,c){return this.mxObject.zoomScale_call(u)},V.prototype.setViewAngle=function(u){return this.mxObject.setViewAngle_call(u)},V.prototype.startPanCommand=function(){return this.mxObject.startPanCommand_call()},V.prototype.endPanCommand=function(){return this.mxObject.endPanCommand_call()},V.prototype.isPaningCommand=function(){return this.mxObject.isPaningCommand_call()},V);function V(u){this.mxObject=u}o.MxDrawThreeJS=j;var R,M=(v(ee,R=j),ee.prototype.onInitThreejs=function(){this.proxyObj.onInitThreejs()},ee.prototype.onInitScene=function(){this.proxyObj.onInitScene()},ee.prototype.getType=function(){return w.k2d},ee.prototype.updateCameraDisplayRange=function(u,c,m){this.proxyObj.updateCameraDisplayRangeImp(u,c,m)},ee.prototype.addControlsChangeEvent=function(){var u=this.mxObject;this.mxObject.getOrbitControls().addEventListener("change",function(){k.MxJigCmdManager.OnThreeControlsChage(),u.callViewChange(),u.getMxDatabase().onViewChange(),u.getMcObject().isValid()&&u.getMcObject().getGripManager().onControlsChage(),u.getTempMarkDraw().clear(!0),u.updateDisplay()})},ee.prototype.updateDisplay=function(u){u===void 0&&(u=!1),this.mxObject.updateDisplayImplement(u)},ee.prototype.getRegistEventObject=function(){return this.mxObject.getCanvas()},ee);function ee(u){var c=R.call(this,u)||this;return c.proxyObj=u,c}o.MxDrawObject2dThreeJS=M;var F,_=(v(J,F=j),J.prototype.startPanCommand=function(){this.mapBox.map&&(this.isPaning=!0,this.bakPan=this.mapBox.map.dragPan.useMouseMiddle(!1),f.MxUiVue.setCursorType(f.MxUiVue.CursorType.kPan))},J.prototype.endPanCommand=function(){this.mapBox.map&&this.isPaning&&(this.isPaning=!1,this.mapBox.map.dragPan.useMouseMiddle(this.bakPan),f.MxUiVue.setCursorType(f.MxUiVue.CursorType.kNormal))},J.prototype.isPaningCommand=function(){return this.mapBox.map,this.isPaning},J.prototype.mercatorCoord2CAD=function(u,c){var m=new G.Vector3(u,c,0);return m.applyMatrix4(this.mapBox.matMapToCad),m},J.prototype.cadToMercatorCoord=function(u){return u.applyMatrix4(this.mapBox.matCadToMap),u},J.prototype.setViewAngle=function(u){this.mapBox.map&&this.mapBox.map.setBearing(180*u/Math.PI)},J.prototype.zoomCenter=function(u,c,m){if(this.mapBox.map){var E=this.cadToMercatorCoord(new G.Vector3(u,c,0)),U=this.mapBox.map.mercator_to_lnglat(E.x,E.y,0),X=this.mapBox.map.getBounds(),W=.5*(X._ne.wrap().lng-X._sw.wrap().lng),te=.5*(X._ne.wrap().lat-X._sw.wrap().lat);this.mapBox.map.fitBounds([[U.lng-W,U.lat-te],[U.lng+W,U.lat+te]],{animate:!!m})}},J.prototype.zoomScale=function(u,c){if(this.mapBox.map){var m=this.mapBox.map.getBounds(),E=.5*(m._ne.wrap().lng-m._sw.wrap().lng),U=.5*(m._ne.wrap().lat-m._sw.wrap().lat),X=m._sw.wrap().lng+E,W=m._sw.wrap().lat+U;E*=u,U*=u,this.mapBox.map.fitBounds([[X-E,W-U],[X+E,W+U]],{animate:!!c})}},J.prototype.zoomW=function(u,c,m,E,U){if(this.mapBox.map)if(u.distanceTo(c)<1e-7)console.log("Mx:ZoomW param invalid");else{m!==void 0&&m&&(u=this.mxObject2d.docCoord2Cad(u.x,u.y,0),c=this.mxObject2d.docCoord2Cad(c.x,c.y,0));var X=this.cadToMercatorCoord(u),W=this.cadToMercatorCoord(c),te=this.mapBox.map.mercator_to_lnglat(X.x,X.y,0),ne=this.mapBox.map.mercator_to_lnglat(W.x,W.y,0),ce=Math.min(te.lng,ne.lng),we=Math.max(te.lng,ne.lng),Ie=Math.min(te.lat,ne.lat),xe=Math.max(te.lat,ne.lat);this.mapBox.map.fitBounds([[ce,Ie],[we,xe]],{animate:!!E})}},J.prototype.onInitScene=function(){},J.prototype.addControlsChangeEvent=function(){},J.prototype.updateDisplay=function(u){this.mapBox.map&&(this.mapBox.map.repaint=!0)},J.prototype.createRaycaster=function(u){if(this.mapBox.map){var c=u.x/this.mapBox.map.transform.width*2-1,m=-u.y/this.mapBox.map.transform.height*2+1,E=this.mxObject2d.getCamera(),U=new G.Raycaster;U.linePrecision=this.mxObject2d.screenCoordLong2World(10);var X=new G.Matrix4().getInverse(E.projectionMatrix),W=new G.Vector3().applyMatrix4(X),te=new G.Vector3(c,m,1).applyMatrix4(X).clone().sub(W).normalize();return U.setFromCamera(new G.Vector2(c,m),E),U.set(W,te),U}return F.prototype.createRaycaster.call(this,u)},J.prototype.getRegistEventObject=function(){return this.mapBox.canvasContainer},J.prototype.getType=function(){return w.kMapBox},J.prototype.getDomMousePos=function(u){return this.mapBox.map?this.mapBox.map.dom_mousePos(u):void 0},J.prototype.screenCoord2World=function(u,c,m){if(this.mapBox.map){var E=this.mapBox.map.unproject({x:u,y:c}),U=this.mapBox.map.lnglat_to_mercator(E.lng,E.lat),X=new G.Vector3(U.x,U.y,0);return X.applyMatrix4(this.mapBox.matMapToCADDrawCoord),X}return F.prototype.screenCoord2World.call(this,u,c,m)},J.prototype.worldCoord2Screen=function(u,c,m){if(this.mapBox.map){var E=new G.Vector3(u,c,m);E.applyMatrix4(this.mapBox.matCADDrawCoordToMap);var U=this.mapBox.map.mercator_to_lnglat(E.x,E.y,0),X=this.mapBox.map.project([U.lng,U.lat]);return new G.Vector3(X.x,X.y,0)}F.prototype.worldCoord2Screen.call(this,u,c,m)},J.prototype.onInitThreejs=function(){var u=this,c=this.mapBox.threebox;if(c){var m=c.camera,E=c.scene,U=this.mapBox.canvas,X=c.renderer;this.canvas=U,X.autoClear=!1;var W=new O(m,U);this.mxObject2d.mapBoxInitThreeJSObject(E,m,X,W)}else{this.mxObject2d.onInitViewScene(),E=new G.Scene;var te=(U=this.mapBox.canvas).clientHeight,ne=U.clientWidth;m=new G.OrthographicCamera(ne/-2,ne/2,te/2,te/-2,.1,1e21),this.canvas=U;var ce=new G.DirectionalLight(16777215);ce.position.set(0,-70,100).normalize(),E.add(ce);var we=new G.DirectionalLight(16777215);we.position.set(0,70,100).normalize(),E.add(we);var Ie=this.mxObject2d.getRendererParam();(Ie=Ie||{}).canvas=U,Ie.context=this.mapBox.gl,(X=new G.WebGLRenderer(Ie)).autoClear=!1,(W=new O(new G.Camera,U)).enabled=!1,this.mxObject2d.mapBoxInitThreeJSObject(E,m,X,W)}this.mxObject2d.initRendererParam({retver:"webgl2",webgl2:!0});var xe=this;this.mapBox.render=function(Be,q){var ge=new G.Matrix4().fromArray(q);ge.multiply(u.matCADDrawCoordToMap);var oe=new G.Vector3(0,0,0);if(oe.applyMatrix4(ge),1<oe.z){var se=1-oe.z-1e-5;ge=new G.Matrix4().makeTranslation(0,0,se).multiply(ge)}xe.mxObject2d.mapBoxRender(Be,ge,!!xe.mapBox.threebox),xe.mxObject2d.isRenderLoop()&&u.mapBox.map&&(u.mapBox.map.repaint=!0)},this.mapBox.onResize=function(){xe.mxObject2d.mapBox_onResizeImp(xe.canvas.clientWidth,xe.canvas.clientHeight)}},J.prototype.updateCameraDisplayRange=function(u,c,m){if(this.mxObject2d.isCppMxCAD()){(X=new G.Matrix4).makeTranslation(-this.mapBox.cadOrigin.x,-this.mapBox.cadOrigin.y,-this.mapBox.cadOrigin.z),(W=new G.Matrix4).makeTranslation(this.mapBox.mapOrigin.x,this.mapBox.mapOrigin.y,this.mapBox.elevation),(te=new G.Matrix4).makeScale(this.mapBox.mapLenInCADUnits,-this.mapBox.mapLenInCADUnits,this.mapBox.mapLenInCADUnits);var E=W.multiply(te).multiply(X),U=this.mxObject2d.getDoc2CADMatrix();this.matCADDrawCoordToMap=E.clone().multiply(U),this.mapBox.matcadtsmall=new G.Matrix4,this.mapBox.matcadtsmall.getInverse(U),this.mapBox.matCADDrawCoordToMap=this.matCADDrawCoordToMap,this.mapBox.matMapToCADDrawCoord=new G.Matrix4,this.mapBox.matMapToCADDrawCoord.getInverse(this.matCADDrawCoordToMap),this.mapBox.matCadToMap=E,this.mapBox.matMapToCad=new G.Matrix4,this.mapBox.matMapToCad.getInverse(E),1e-5<Math.abs(m)&&this.setViewAngle(m),this.zoomW(u,c,!0,!1)}else{var X,W,te;(X=new G.Matrix4).makeTranslation(-this.mapBox.cadOrigin.x,-this.mapBox.cadOrigin.y,-this.mapBox.cadOrigin.z),(W=new G.Matrix4).makeTranslation(this.mapBox.mapOrigin.x,this.mapBox.mapOrigin.y,this.mapBox.elevation),(te=new G.Matrix4).makeScale(this.mapBox.mapLenInCADUnits,-this.mapBox.mapLenInCADUnits,this.mapBox.mapLenInCADUnits);var ne=W.multiply(te).multiply(X),ce=this.mxObject2d.getWorldToDoc();this.matCADDrawCoordToMap=ne.clone().multiply(ce),this.mapBox.matcadtsmall=new G.Matrix4,this.mapBox.matcadtsmall.getInverse(ce),this.mapBox.matCADDrawCoordToMap=this.matCADDrawCoordToMap,this.mapBox.matMapToCADDrawCoord=new G.Matrix4,this.mapBox.matMapToCADDrawCoord.getInverse(this.matCADDrawCoordToMap),this.mapBox.matCadToMap=ne,this.mapBox.matMapToCad=new G.Matrix4,this.mapBox.matMapToCad.getInverse(ne)}},J);function J(u,c){var m=F.call(this,c)||this;return m.matCADDrawCoordToMap=new G.Matrix4,m.isPaning=!1,m.bakPan=!0,m.mapBox=u,m.mxObject2d=c,m.mapBox.matMapToCad=m.mapBox.matCadToMap=m.mapBox.matCADDrawCoordToMap=m.mapBox.matMapToCADDrawCoord=new G.Matrix4,m}o.MxDrawMapBoxThreeJS=_;var T,B=(v(N,T=j),N.prototype.onInitThreejs=function(){this.proxyObj.onInitThreejs()},N.prototype.onInitScene=function(){this.proxyObj.onInitScene()},N.prototype.getType=function(){return w.k3d},N.prototype.updateCameraDisplayRange=function(u,c,m){},N.prototype.addControlsChangeEvent=function(){var u=this.mxObject;this.mxObject.getOrbitControls().addEventListener("change",function(){k.MxJigCmdManager.OnThreeControlsChage(),u.callViewChange(),u.getMxDatabase().onViewChange(),u.getMcObject().isValid()&&u.getMcObject().getGripManager().onControlsChage(),u.getTempMarkDraw().clear(!0),u.updateDisplay()})},N.prototype.updateDisplay=function(u){u===void 0&&(u=!1),this.mxObject.updateDisplayImplement(u)},N.prototype.getRegistEventObject=function(){return this.mxObject.getCanvas()},N);function N(u){var c=T.call(this,u)||this;return c.proxyObj=u,c}o.MxDrawObject3dThreeJS=B},{"../Operate/MxJigCmdManager":54,"../UI/MxUiVue":65,three:19,"three-orbitcontrols":17}],76:[function(b,r,o){var a,v=this&&this.__extends||(a=function(_,J){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,B){T.__proto__=B}||function(T,B){for(var N in B)Object.prototype.hasOwnProperty.call(B,N)&&(T[N]=B[N])})(_,J)},function(_,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");function T(){this.constructor=_}a(_,J),_.prototype=J===null?Object.create(J):(T.prototype=J.prototype,new T)});Object.defineProperty(o,"__esModule",{value:!0}),o.McDrawGripJig=o.McDrawGrip=o.McDrawSlect=o.McDrawGripData=void 0;var h=b("three"),w=b("../MxFun"),L=b("../Operate/MxJig"),G=b("../Operate/MxJigCmdManager"),k=b("../MxManager"),D=b("../MxDrawData"),f=b("../MxTools"),O=function(){this.threeObject=null};o.McDrawGripData=O;var C=(j.prototype.add=function(_){return!this.setId.has(_)&&(this.setId.add(_),this.mcObj.HighlightEntity(_,!0),!0)},j.prototype.remove=function(_){this.setId.has(_)&&(this.setId.delete(_),this.mcObj.HighlightEntity(_,!1))},j.prototype.removeAll=function(){var _=this;this.setId.forEach(function(J){_.mcObj.HighlightEntity(J,!1)}),this.setId.clear()},j.prototype.getAllSelect=function(){var _=[];return this.setId.forEach(function(J,T){_.push(T)}),_},j.prototype.getSelectCount=function(){return this.setId.size},j.prototype.isEmpty=function(){return this.setId.size==0},j);function j(_){this.mcObj=null,this.setId=new Set,this.mcObj=_}o.McDrawSlect=C;var V=(R.prototype.fireSelectChange=function(){this.isCallingSelectChange||(this.isCallingSelectChange=!0,this.mxObj.callEvent("selectChange",this.getAllSelect()),this.isCallingSelectChange=!1)},R.prototype.getParentGroup=function(){return this.drawGroup||(this.drawGroup=new h.Group,this.drawGroup.renderOrder=k.MxData.iGripRenderOrder,this.mxObj.getTheTempDrawContainer_SmallCoord().add(this.drawGroup)),this.drawGroup},R.prototype.reInit=function(){this.clearAll(),this.drawGroup&&w.MxFun.removeThreejsObject(this.drawGroup,this.mxObj.getTheTempDrawContainer_SmallCoord()),this.drawGroup=null,this.selectPoint1=null,this.selectPoint2=null},R.prototype.removeAllEntity=function(){var _=this.getParentGroup();this.mapGrips.forEach(function(J,T,B){for(var N=J.length,u=0;u<N;u++){var c=J[u];w.MxFun.removeThreejsObject(c.threeObject,_)}}),this.mapGrips=new Map},R.prototype.deleteGripData=function(_){var J=this.getParentGroup(),T=this.mapGrips.get(_);if(T)for(var B=T.length,N=0;N<B;N++){var u=T[N];w.MxFun.removeThreejsObject(u.threeObject,J)}this.mapGrips.delete(_)},R.prototype.addGripData=function(_,J,T,B){var N=this.mapGrips.get(_);N==null&&(N=new Array,this.mapGrips.set(_,N));var u=new O;return u.iIndex=J,u.point=new h.Vector3(T,B),N.push(u),u},R.prototype.createGripDisplayObject=function(_){var J=this.getParentGroup();_.geometry=new h.Geometry;var T=this.mxObj.toSmallcoord2(_.point.x,_.point.y,_.point.z),B=this.mxObj.screenCoordLong2World(.5*D.MxDrawData.m_dInputRectWidth);_.geometry.vertices.push(new h.Vector3(T.x-B,T.y-B,0)),_.geometry.vertices.push(new h.Vector3(T.x-B,T.y+B,0)),_.geometry.vertices.push(new h.Vector3(T.x+B,T.y+B,0)),_.geometry.vertices.push(new h.Vector3(T.x+B,T.y-B,0)),_.geometry.faces.push(new h.Face3(0,1,2)),_.geometry.faces.push(new h.Face3(2,3,0)),_.geometry.computeFaceNormals(),_.geometry.computeVertexNormals();var N=f.MxTools.getColor(D.MxDrawData.m_gripPointColor),u=f.MxTools.getOpacity(D.MxDrawData.m_gripPointColor),c=new h.MeshBasicMaterial({color:N,transparent:!0,depthTest:!1,side:h.DoubleSide,opacity:u}),m=new h.Mesh(_.geometry,c);J.add(m),_.threeObject=m},R.prototype.setPrvCommandSelect=function(_){this.aryPrvCommandSelect=_},R.prototype.getPrvCommandSelect=function(){return this.aryPrvCommandSelect},R.prototype.getAllSelect=function(){return this.mcSelect.getAllSelect()},R.prototype.getSelectPoints=function(){var _=this.selectPoint1!==null;return _&&this.mcSelect.getSelectCount()==0&&this.aryPrvCommandSelect.length==0&&(_=!1),{point1:this.selectPoint1,point2:this.selectPoint2,isvalid:_}},R.prototype.clearAll=function(){var _=this.mcSelect.isEmpty();return this.mcSelect.removeAll(),this.mapGrips.size==0?!_:(this.removeAllEntity(),!0)},R.prototype.onControlsChage=function(){var _=this;if(this.mapGrips.size!=0){var J=this.mxObj.screenCoordLong2World(.5*D.MxDrawData.m_dInputRectWidth),T=!1;this.mapGrips.forEach(function(B,N,u){for(var c=B.length,m=0;m<c;m++){var E=B[m];if(E.geometry.vertices.length==4){var U=_.mxObj.cadCoord2Doc(E.point.x,E.point.y,E.point.z);E.geometry.vertices[0].x=U.x-J,E.geometry.vertices[0].y=U.y-J,E.geometry.vertices[1].x=U.x-J,E.geometry.vertices[1].y=U.y+J,E.geometry.vertices[2].x=U.x+J,E.geometry.vertices[2].y=U.y+J,E.geometry.vertices[3].x=U.x+J,E.geometry.vertices[3].y=U.y-J,E.geometry.computeFaceNormals(),E.geometry.computeVertexNormals(),E.geometry.verticesNeedUpdate=!0,T=!0}}}),T&&this.mxObj.resetRenderer()}},R.prototype.getGripNum=function(_){for(var J=new Set,T=_.length(),B=0;B<T;B++)J.add(_.at(B));var N=0;return this.mapGrips.forEach(function(u,c){J.has(c)||(N+=u.length)}),N},R.prototype.hitTest=function(_){var J={grips:new Array,ids:new Array,pt:_},T=new h.Vector3(_.x,_.y,0),B=this.mxObj.viewCoordLong2Cad(32);return this.mapGrips.forEach(function(N,u){for(var c=N.length,m=0;m<c;m++){var E=N[m];if(E.point.distanceTo(T)<=B){J.grips.push(E),J.ids.push(u),J.pt=E.point;break}}}),J},R.prototype.onMouseLBDown=function(_){if(!D.MxDrawData.m_isEnableGripEidt)return!1;var J=this.hitTest(_);return J.grips.length!=0&&(w.MxFun.sendStringToExecute("McDraw_GripEdit",J),!0)},R.prototype.gripEditImp=function(_){var J=_.grips,T=_.ids,B=_.pt,N=new ee(B,J,T,this.mcObj);G.MxJigCmdManager.runCmd(N)},R.prototype.addGridDisplay=function(_,J){var T=this;_&&_.length()!=0&&(this.deleteGripData(J),_.forEach(function(B,N){var u=T.addGripData(J,N,B.x,B.y);T.createGripDisplayObject(u)}))},R.prototype.upEntityGridDisplay=function(_){if(!D.MxDrawData.m_isEnableGripEidt||_==0)return 0;var J=this.mcObj.ObjectIdToObject(_);if(!J)return 0;var T=J.getGripPoints();return this.addGridDisplay(T,_),T.length()},R.prototype.doPointSelect=function(_){if(!this.mcObj.mcObjectImp)return!1;var J=this.mxObj.docCoordLong2Cad(this.mxObj.screenCoordLong2Doc(10)),T=this.mxObj.screenCoord2Doc(_.x,_.y,0),B=this.mxObj.docCoord2Cad(T.x,T.y,T.z),N=this.mcObj.mcObjectImp.IntelliSelect_PointSelect(B.x,B.y,J),u=N.length();if(u==0)return this.mcObj.mxappimp.DestroyMdGeLongArray(N),!1;this.mxObj.pointMultipleSelect()||(this.mxObj.getMxDatabase().clearMxCurrentSelect(),this.clearAll());for(var c=u+this.mcSelect.getSelectCount(),m=0;m<u;m++){var E=N.at(m);this.mcSelect.add(E),c<100&&this.upEntityGridDisplay(E)}return this.selectPoint1=B,this.selectPoint2=B,this.fireSelectChange(),this.mcObj.mxappimp.DestroyMdGeLongArray(N),!0},R.prototype.doRangeSelect=function(_,J){if(this.mcObj.mcObjectImp){var T,B=_.clone(),N=J.clone();T=J.x<_.x?0:1;for(var u=this.mcObj.mcObjectImp.IntelliSelect_RangeSelect(B.x,B.y,N.x,N.y,T),c=u.length(),m=c+this.mcSelect.getSelectCount(),E=this.getGripNum(u),U=0;U<c;U++){var X=u.at(U);this.mcSelect.add(X),m<50&&E<200&&(E+=this.upEntityGridDisplay(X))}0<c&&(this.selectPoint1=B,this.selectPoint2=N,this.fireSelectChange()),this.mcObj.mxappimp.DestroyMdGeLongArray(u)}},R.prototype.addSelect=function(_,J,T){if(T===void 0&&(T=!0),_==0)return!1;var B=this.mcSelect.add(_);return T&&this.upEntityGridDisplay(_),J&&this.fireSelectChange(),B},R);function R(_,J){this.mxObj=null,this.mcObj=null,this.mcSelect=null,this.mapGrips=new Map,this.aryPrvCommandSelect=[],this.drawGroup=null,this.isCallingSelectChange=!1,this.selectPoint1=null,this.selectPoint2=null,this.mxObj=_,this.mcObj=J,this.mcSelect=new C(J)}o.McDrawGrip=V;var M,ee=(v(F,M=L.McEdJigCommand),F.prototype.onExitCommand=function(_){this.tempEntity=null,this.tempEntityWordDraw=null,M.prototype.onExitCommand.call(this,_)},F.prototype.sampler=function(){var _=G.MxJigCmdManager.InType.kGetBegan|G.MxJigCmdManager.InType.kGetEnd,J=this.acquirePoint(_);if(J.status==G.MxJigCmdManager.DragStatus.kNormal&&(this.currPt=J.pt,this.tempEntity)){var T=new h.Vector3(J.pt.x,J.pt.y,J.pt.z),B=new h.Vector3(this.pt.x,this.pt.y,this.pt.z);this.tempEntityWordDraw=this.tempEntity.clone(),this.tempEntityWordDraw&&this.tempEntityWordDraw.moveGripPointsAt(this.grips[0].iIndex,T.x-B.x,T.y-B.y,T.z-B.z)}return J.status},F.prototype.getTypeName=function(){return"McDrawGripEdit"},F.prototype.done=function(_){if(_==G.MxJigCmdManager.DragStatus.kNormal){for(var J=new h.Vector3(this.pt.x,this.pt.y,this.pt.z),T=new h.Vector3(this.currPt.x,this.currPt.y,this.currPt.z),B=T.x-J.x,N=T.y-J.y,u=this.getMxObject().getMcObject().getGripManager(),c=this.grips.length,m=[],E=0;E<c;E++){var U=this.grips[E],X=this.ids[E],W=this.mcObj.ObjectIdToObject(X);W&&W.moveGripPointsAt(U.iIndex,B,N,0),u.upEntityGridDisplay(X),m.push({type:"mxcad",id:X,index:U.iIndex,curentPoint:this.currPt,point:U.point,offset_x:B,offset_y:N})}0<m.length&&this._mxObject.callEvent("objectGripEdit",m)}return G.MxJigCmdManager.DoneStatius.kExitCommand},F.prototype.upDisplay=function(){this.mcObj.onReadyJigUpdateDispla(),this.tempEntityWordDraw.tempRelationObject(),this.mcObj.onJigDrawEntityDisplay(this.tempEntityWordDraw.getImp()),this.tempEntityWordDraw.freeTempRelationObject()},F);function F(_,J,T,B){var N=M.call(this)||this;return N.pt=_,N.grips=J,N.ids=T,N.currPt=_,N.mcObj=B,N.ids.length&&(N.tempEntity=B.ObjectIdToObject(N.ids[0])),N}o.McDrawGripJig=ee},{"../MxDrawData":22,"../MxFun":27,"../MxManager":29,"../MxTools":38,"../Operate/MxJig":53,"../Operate/MxJigCmdManager":54,three:19}],77:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.McDrawObject=void 0;var a=b("../MxManager"),v=b("three"),h=b("../MxFun"),w=b("./McDrawGrip"),L=b("./McTextureManager"),G=window;G.McDrawObjectEvent_openFileComplete=function(f,O,C){var j=a.MxManager.getMxObject(O);j&&j.getMcObject().openFileComplete(f,C)},G.McDrawObjectEvent_call=function(f,O,C){if(O=="mxpost")try{var j=JSON.parse(C);if(j&&j.url&&j.data){var V=new XMLHttpRequest;V.open("POST",j.url,!0),V.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),V.onreadystatechange=function(){V.readyState===4&&V.status},V.send(j.data)}}catch{}else if(O=="regen_complete"){if(!(R=a.MxManager.getMxObject(f)))return;R.regenAllMxDbEntity()}else{var R;if(!(R=a.MxManager.getMxObject(f)))return;R.callEvent(O,C)}},G.McDrawObjectEvent_synchronizeuUdateDisplayRange=function(f,O){var C=a.MxManager.getMxObject(f);C&&C.getMcObject().updateDisplayRange(O==1)},G.McDrawObjectEvent_osnapComplete=function(f,O){var C=a.MxManager.getMxObject(f);C&&C.getMcObject().callOsnapComplete(O)},G.McDrawObjectEvent_mcutPrintf=function(f){h.MxFun.acutPrintf(f)},G.McDrawObjectEvent_updateDisplay=function(f){var O=a.MxManager.getMxObject(f);O&&O.updateDisplay()},G.McDrawObjectEvent_loadImages=function(f,O,C,j){var V=a.MxManager.getMxObject(f);if(V){V.getMcObject().getTextureManager().clear();var R=0,M=[];j.substring(0,5)=="blob:"&&(j=j.substring(5)),O.forEach(function(ee){var F=a.MxManager.getMxCpp().decodeFromGb2312(ee),_=F;F.lastIndexOf("/")==-1?(C&&0<C.length&&(_=C+"/"+_),j&&0<j.length&&(_=j+"/"+_)):F=F.substring(F.lastIndexOf("/")+1).toLowerCase(),M.push(_),V.getMcObject().getTextureManager().loadImage(_,F,function(){++R==O.length&&(M.forEach(function(J){V.getMcObject().getTextureManager().createOpenGLTexture(J)}),V.updateDisplay(!1))})})}},G.McDrawObjectEvent_loadImagesBase64=function(f,O){var C=a.MxManager.getMxObject(f);if(C){var j=O.indexOf("data:image/png;base64");if(j!=-1){var V=O.substring(0,j);O=O.substring(j),C.getMcObject().getTextureManager().loadImageBase64(V,O,function(){C.getMcObject().getTextureManager().createOpenGLTexture(V),C.updateDisplay(!1)})}}};var k=(D.prototype.getTextureManager=function(){return this.textureManager},D.prototype.isValid=function(){return this.mcObjectImp!==null},D.prototype.isPaperSpaceDisplay=function(){return!!this.mcObjectImp&&this.mcObjectImp.isPaperSpaceDisplay()},D.prototype.fireStartRunCommand=function(f,O){this.mcObjectImp&&this.mcObjectImp.fireStartRunCommand(f,O)},D.prototype.fireEndRunCommand=function(f,O){this.mcObjectImp&&this.mcObjectImp.fireEndRunCommand(f,O)},D.prototype.undo=function(){this.mcObjectImp&&this.mcObjectImp.undo()},D.prototype.redo=function(){this.mcObjectImp&&this.mcObjectImp.redo()},D.prototype.initCAD2Doc=function(f,O){this.matCad2doc=f,this.matDoc2cad=O},D.prototype.getSysVarLong=function(f){return this.mcObjectImp.GetSysVarLong(f)},D.prototype.getSysVarDouble=function(f){return this.mcObjectImp.GetSysVarDouble(f)},D.prototype.getSysVarPoint=function(f){var O=this.mcObjectImp.GetSysVarPoint(f);return new v.Vector3(O.x,O.y,O.z)},D.prototype.ObjectIdToMdObjectImp=function(f){return this.mcObjectImp?this.mxcpp.App.getImp().ObjectIdToMdObject(f):null},D.prototype.DestroyObject=function(f){if(!this.mcObjectImp)return null;this.mcObject.destroyObject(f)},D.prototype.onJigCommandEnd=function(){this.mcObjectImp&&this.mcObjectImp.EntityTempWordDraw_onJigCommandEnd()},D.prototype.callOsnapComplete=function(f){if(this.m_retCall&&f)try{var O=f;if(typeof f=="string"&&(O=JSON.parse(f)),O.callId!=this.m_lOsnapCallCount)return;this.m_retCall(O)}catch{}},D.prototype.doc2cad1=function(f){return f},D.prototype.doc2cad2=function(f,O){return new v.Vector3(f,O,0)},D.prototype.cad2doc1=function(f){return f},D.prototype.cad2doc2=function(f,O){return new v.Vector3(f,O,0)},D.prototype.onNotifyOsnap=function(f,O){if(this.mcObjectImp){this.m_lOsnapCallCount++,this.m_retCall=O,1e5<this.m_lOsnapCallCount&&(this.m_lOsnapCallCount=1);var C,j=this.doc2cad2(f.ptx,f.pty);f.isValidPrvInputPoint&&(C=this.doc2cad2(f.prvPtx,f.prvPty)),this.mcObjectImp.Osnap_NotifyOsnap(j.x,j.y,f.isValidPrvInputPoint,f.isValidPrvInputPoint?C.x:0,f.isValidPrvInputPoint?C.y:0,f.osmode,f.SearchRnge,this.m_lOsnapCallCount)}},D.prototype.DrawEntity=function(f,O,C){f&&this.mcObjectImp&&(O&&f.SetTrueColor(this.THREEColor2MdCmColor(O)),this.mcObjectImp.DrawEntity(f,C))},D.prototype.onJigDrawEntityDisplay=function(f,O,C){f&&this.mcObjectImp&&(O&&f.SetTrueColor(this.THREEColor2MdCmColor(O)),this.mcObjectImp.EntityTempWordDraw_onJigDrawEntityDisplay(f,C===!0))},D.prototype.THREEColor2MdCmColor=function(f){var O=new v.Color(f),C=new this.mxcppImp.MdCmColor;return C.setRGB(255*O.r,255*O.g,255*O.b),C},D.prototype.onJigDrawEntityDisplay_line=function(f,O,C,j,V,R,M){if(this.mcObjectImp){var ee=new this.mxcppImp.MdDbLine,F=new this.mxcppImp.MdGePoint3d;F.x=f,F.y=O,F.z=C,ee.setStartPoint(F);var _=new this.mxcppImp.MdGePoint3d;_.x=j,_.y=V,_.z=R,ee.setEndPoint(_),ee.SetTrueColor(this.THREEColor2MdCmColor(M)),this.mcObjectImp.EntityTempWordDraw_onJigDrawEntityDisplay(ee,!1)}},D.prototype.DrawLine=function(f,O,C,j,V,R,M){if(this.mcObjectImp){var ee=new this.mxcppImp.MdDbLine,F=new this.mxcppImp.MdGePoint3d;F.x=f,F.y=O,F.z=C,ee.setStartPoint(F);var _=new this.mxcppImp.MdGePoint3d;_.x=j,_.y=V,_.z=R,ee.setEndPoint(_),ee.SetTrueColor(this.THREEColor2MdCmColor(M)),this.mcObjectImp.DrawEntity(ee,!1)}},D.prototype.HighlightEntity=function(f,O){if(!this.mcDrawUtility)return!1;this.mcDrawUtility.highlightEntity(f,O)},D.prototype.onReadyJigUpdateDispla=function(){this.mcObjectImp&&this.mcObjectImp.EntityTempWordDraw_onReadyJigUpdateDispla()},D.prototype.onJigClearDisplay=function(){this.mcObjectImp&&this.mcObjectImp.EntityTempWordDraw_onJigClearDisplay()},D.prototype.ObjectIdToObject=function(f){return this.mcObject?this.mxcpp.App.objectIdToObject(f):null},D.prototype.init=function(f,O){O.initMxObject(f),this.mxObject=f,this.mcObject=O,this.mcObjectImp=O.getImp(),this.mxcpp=O.getMxCpp(),this.mxcppImp=this.mxcpp.mxcadassemblyimp,this.mxapp=this.mxcpp.App,this.mxappimp=this.mxapp.getImp(),this.grip=new w.McDrawGrip(f,this),this.mcDrawUtility=new this.mxcppImp.McDrawUtility,this.textureManager=new L.McTextureManager(this,f.getRenderer().getContext());var C=this;this.mxObject.addEvent("dragWillEnd",function(){C.mcObjectImp.fireEventDragWillEnd()})},D.prototype.setSize=function(f,O){if(!this.mcObjectImp)return!1;this.mcObjectImp.fireEventWindowSize(f,O)},D.prototype.getGripManager=function(){return this.grip},D.prototype.updateDisplayRange=function(f){if(f===void 0&&(f=!1),this.mcObjectImp){var O=this.mcObjectImp.getViewDataJsonParam(f);O=O.replace(/\\/g,"\\\\");try{var C=JSON.parse(O),j=this.mxObject;if(C!=null){j.intiDoc2Wold(new v.Matrix4),j.initCAD2Doc(JSON.parse(C.DToSMat)),j.initializingObjectMatrix(),j.updateCameraDisplayRange(new v.Vector3(C.pt1x,C.pt1y,0),new v.Vector3(C.pt2x,C.pt2y,0),C.viewangle),j.initAllLayoutName(JSON.parse(C.layout)),j.updateDisplay(!0);var V=h.MxFun.getUiObj();V!=null&&(V.SetLayoutData(C.layout),V.UpDisplayLayout())}}catch{console.log("getViewDataJsonParam exception")}}},D.prototype.openFileComplete=function(f,O){this.updateDisplayRange(),this.mxObject.callOpenFileComplete(f,O)},D.prototype.updateDisplayMapBox=function(f){return!!this.mcObjectImp&&(this.mxObject.getScene().background!==null&&console.log("mxerror: background must be empty"),this.mcObjectImp_updateDisplay(new v.Matrix4().elements,f.elements))},D.prototype.mcObjectImp_updateDisplay=function(f,O){if(this.m_isCallingUpDisplay)return!0;var C=!(this.m_isCallingUpDisplay=!0);try{C=this.mcObjectImp.updateDisplay(f,O),this.m_isCallingUpDisplay=!1}catch(j){this.m_isCallingUpDisplay=!1,console.log(j)}return C},D.prototype.updateDisplay=function(){if(!this.mcObjectImp)return!1;var f=this.mxObject.getCamera();this.mxObject.getScene().background!==null&&console.log("mxerror: background must be empty");var O=new v.Matrix4;O.multiplyMatrices(f.matrixWorldInverse,this.mxObject.getDoc2World());var C=f.projectionMatrix;return this.mcObjectImp_updateDisplay(O.elements,C.elements)},D.prototype.updateDisplayMatrixData=function(f){if(this.mcObjectImp){var O=this.mxObject.getCamera(),C=new v.Matrix4;C.multiplyMatrices(O.matrixWorldInverse,this.mxObject.getDoc2World());var j=O.projectionMatrix;return this.mcObjectImp.updateDisplayMatrixData(C.elements,j.elements,!!f)}},D.prototype.setViewAngle=function(f){this.mcObjectImp&&this.mcObjectImp.fireViewAngleChange(f)},D.prototype.createTexture=function(){return this.mcObjectImp.createTexture()},D.prototype.deleteTexture=function(f){return this.mcObjectImp.deleteTexture(f)},D.prototype.bindTexture=function(f,O){return this.mcObjectImp.bindTexture(f,O)},D.prototype.allocTextureHandle=function(f){return this.mcObjectImp.allocTextureHandle(f)},D.prototype.registTexture=function(f,O){return this.mcObjectImp.registTexture(f,O)},D.prototype.makeCurrent=function(){this.mcObjectImp&&this.mcObjectImp.makeCurrent()},D);function D(){this.grip=null,this.mcObjectImp=null,this.mxcppImp=null,this.mxcpp=null,this.mcObject=null,this.mxapp=null,this.mxappimp=null,this.mcDrawUtility=null,this.m_lOsnapCallCount=1,this.m_retCall=null,this.matCad2doc=new v.Matrix4,this.matDoc2cad=new v.Matrix4,this.m_isCallingUpDisplay=!1}o.McDrawObject=k},{"../MxFun":27,"../MxManager":29,"./McDrawGrip":76,"./McTextureManager":78,three:19}],78:[function(b,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.McTextureManager=void 0;var a=b("three"),v=b("../MxManager"),h=(w.prototype.get=function(k){if(this.extensions[k]!==void 0)return this.extensions[k];var D;switch(k){case"WEBGL_depth_texture":D=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":D=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":D=this.gl.getExtension("WEBGL_compressed_texture_s3tc")||this.gl.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||this.gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":D=this.gl.getExtension("WEBGL_compressed_texture_pvrtc")||this.gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:D=this.gl.getExtension(k)}return D===null&&console.warn("THREE.WebGLRenderer: "+k+" extension not supported."),this.extensions[k]=D},w);function w(k){this.extensions={},this.gl=k}var L=(G.prototype.allocHandle=function(k){return this.mcObject.allocTextureHandle(v.MxManager.getMxCpp().encodeToGb2312(k))},G.prototype.convert=function(k){var D;if(k===a.UnsignedByteType)return 5121;if(k===a.UnsignedShort4444Type)return 32819;if(k===a.UnsignedShort5551Type)return 32820;if(k===a.UnsignedShort565Type)return 33635;if(k===a.ByteType)return 5120;if(k===a.ShortType)return 5122;if(k===a.UnsignedShortType)return 5123;if(k===a.IntType)return 5124;if(k===a.UnsignedIntType)return 5125;if(k===a.FloatType)return 5126;if(k===a.HalfFloatType)return this.isWebGL2?5131:(D=this.extensions.get("OES_texture_half_float"))!==null?D.HALF_FLOAT_OES:null;if(k===a.AlphaFormat)return 6406;if(k===a.RGBFormat)return 6407;if(k===a.RGBAFormat)return 6408;if(k===a.LuminanceFormat)return 6409;if(k===a.LuminanceAlphaFormat)return 6410;if(k===a.DepthFormat)return 6402;if(k===a.DepthStencilFormat)return 34041;if(k===a.RedFormat)return 6403;if(k===a.RedIntegerFormat)return 36244;if(k===a.RGFormat)return 33319;if(k===a.RGIntegerFormat)return 33320;if(k===a.RGBIntegerFormat)return 36248;if(k===a.RGBAIntegerFormat)return 36249;if(k===a.RGB_S3TC_DXT1_Format||k===a.RGBA_S3TC_DXT1_Format||k===a.RGBA_S3TC_DXT3_Format||k===a.RGBA_S3TC_DXT5_Format){if((D=this.extensions.get("WEBGL_compressed_texture_s3tc"))===null)return null;if(k===a.RGB_S3TC_DXT1_Format)return D.COMPRESSED_RGB_S3TC_DXT1_EXT;if(k===a.RGBA_S3TC_DXT1_Format)return D.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(k===a.RGBA_S3TC_DXT3_Format)return D.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(k===a.RGBA_S3TC_DXT5_Format)return D.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(k===a.RGB_PVRTC_4BPPV1_Format||k===a.RGB_PVRTC_2BPPV1_Format||k===a.RGBA_PVRTC_4BPPV1_Format||k===a.RGBA_PVRTC_2BPPV1_Format){if((D=this.extensions.get("WEBGL_compressed_texture_pvrtc"))===null)return null;if(k===a.RGB_PVRTC_4BPPV1_Format)return D.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(k===a.RGB_PVRTC_2BPPV1_Format)return D.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(k===a.RGBA_PVRTC_4BPPV1_Format)return D.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(k===a.RGBA_PVRTC_2BPPV1_Format)return D.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return k===a.RGB_ETC1_Format?(D=this.extensions.get("WEBGL_compressed_texture_etc1"))!==null?D.COMPRESSED_RGB_ETC1_WEBGL:null:k===a.RGBA_ASTC_4x4_Format||k===a.RGBA_ASTC_5x4_Format||k===a.RGBA_ASTC_5x5_Format||k===a.RGBA_ASTC_6x5_Format||k===a.RGBA_ASTC_6x6_Format||k===a.RGBA_ASTC_8x5_Format||k===a.RGBA_ASTC_8x6_Format||k===a.RGBA_ASTC_8x8_Format||k===a.RGBA_ASTC_10x5_Format||k===a.RGBA_ASTC_10x6_Format||k===a.RGBA_ASTC_10x8_Format||k===a.RGBA_ASTC_10x10_Format||k===a.RGBA_ASTC_12x10_Format||k===a.RGBA_ASTC_12x12_Format?(D=this.extensions.get("WEBGL_compressed_texture_astc"))!==null?k:null:k===a.UnsignedInt248Type?this.isWebGL2?34042:(D=this.extensions.get("WEBGL_depth_texture"))!==null?D.UNSIGNED_INT_24_8_WEBGL:null:void 0},G.prototype.textureNeedsPowerOfTwo=function(k){return k.wrapS!==1001||k.wrapT!==1001||k.minFilter!==1003&&k.minFilter!==1006},G.prototype.createCanvas=function(k,D){return document.createElementNS("http://www.w3.org/1999/xhtml","canvas")},G.prototype.floorPowerOfTwo=function(k){return Math.pow(2,Math.floor(Math.log(k)/Math.LN2))},G.prototype.resizeImage=function(k,D,f,O){var C=1;if((k.width>O||k.height>O)&&(C=O/Math.max(k.width,k.height)),C<1||D===!0){if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){var j=D?this.floorPowerOfTwo:Math.floor,V=j(C*k.width),R=j(C*k.height);this._canvas===void 0&&(this._canvas=this.createCanvas(V,R));var M=f?this.createCanvas(V,R):this._canvas;return M.width=V,M.height=R,M.getContext("2d").drawImage(k,0,0,V,R),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+V+"x"+R+")."),M}return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k}return k},G.prototype.mathIsPowerOfTwo=function(k){return(k&k-1)==0&&k!==0},G.prototype.isPowerOfTwo=function(k){return this.mathIsPowerOfTwo(k.width)&&this.mathIsPowerOfTwo(k.height)},G.prototype.getInternalFormat=function(k,D,f){if(this.isWebGL2===!1)return D;if(k!==null){if(this._gl[k]!==void 0)return this._gl[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}var O=D;return D===6403&&(f===5126&&(O=33326),f===5131&&(O=33325),f===5121&&(O=33321)),D===6407&&(f===5126&&(O=34837),f===5131&&(O=34843),f===5121&&(O=32849)),D===6408&&(f===5126&&(O=34836),f===5131&&(O=34842),f===5121&&(O=32856)),O===33325||O===33326||O===34842||O===34836?this.extensions.get("EXT_color_buffer_float"):O!==34843&&O!==34837||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),O},G.prototype.filterFallback=function(k){return k===a.NearestFilter||k===a.NearestMipmapNearestFilter||k===a.NearestMipmapLinearFilter?9728:9729},G.prototype.setTextureParameters=function(k,D,f){var O={};O[a.RepeatWrapping]=10497,O[a.ClampToEdgeWrapping]=33071,O[a.MirroredRepeatWrapping]=33648;var C={};C[a.NearestFilter]=9728,C[a.NearestMipmapNearestFilter]=9984,C[a.NearestMipmapLinearFilter]=9986,C[a.LinearFilter]=9729,C[a.LinearMipmapNearestFilter]=9985,C[a.LinearMipmapLinearFilter]=9987,f?(this._gl.texParameteri(k,10242,O[D.wrapS]),this._gl.texParameteri(k,10243,O[D.wrapT]),k!==32879&&k!==35866||this._gl.texParameteri(k,32882,O[D.wrapR]),this._gl.texParameteri(k,10240,C[D.magFilter]),this._gl.texParameteri(k,10241,C[D.minFilter])):(this._gl.texParameteri(k,10242,33071),this._gl.texParameteri(k,10243,33071),k!==32879&&k!==35866||this._gl.texParameteri(k,32882,33071),D.wrapS===a.ClampToEdgeWrapping&&D.wrapT===a.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),this._gl.texParameteri(k,10240,this.filterFallback(D.magFilter)),this._gl.texParameteri(k,10241,this.filterFallback(D.minFilter)),D.minFilter!==a.NearestFilter&&D.minFilter!==a.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."))},G.prototype.textureNeedsGenerateMipmaps=function(k,D){return k.generateMipmaps&&D&&k.minFilter!==a.NearestFilter&&k.minFilter!==a.LinearFilter},G.prototype.generateMipmap=function(k,D,f,O,C){this._gl.generateMipmap(D)},G.prototype.clear=function(){var k=this;Object.keys(this.mapImagePathToTexture).forEach(function(D){var f=k.mapImagePathToTexture[D];f&&f.webglTexture&&k.mcObject.deleteTexture(f.webglTexture)}),this.mapImagePathToTexture={}},G.prototype.loadImage=function(k,D,f){if(this.mapImagePathToTexture[k]){var O=this.mapImagePathToTexture[k];return O&&O.isload&&O.texture?f(!0,O.texture.image):f(!1,void 0),0}var C={isload:!1,texture:null,handle:this.allocHandle(D),webglTexture:void 0};return this.mapImagePathToTexture[k]=C,new a.TextureLoader().load(k,function(j){C.isload=!0,C.texture=j,f(!0,j.image)},void 0,function(j){C.isload=!1,f(!1,void 0)}),C.handle},G.prototype.loadImageBase64=function(k,D,f){if(this.mapImagePathToTexture[k]){var O=this.mapImagePathToTexture[k];return O&&O.isload&&O.texture?f(!0,O.texture.image):f(!1,void 0),0}var C={isload:!1,texture:null,handle:this.allocHandle(k),webglTexture:void 0};return this.mapImagePathToTexture[k]=C,new a.TextureLoader().load(D,function(j){C.isload=!0,C.texture=j,f(!0,j.image)},void 0,function(j){C.isload=!1,f(!1,void 0)}),C.handle},G.prototype.createOpenGLTexture=function(k){var D=this.mapImagePathToTexture[k];if(!D||!D.isload||D.webglTexture)return!1;var f=D.texture;D.webglTexture=this.mcObject.createTexture(),this._gl.activeTexture(33984),this.mcObject.bindTexture(3553,D.webglTexture),this._gl.pixelStorei(37440,f.flipY),this._gl.pixelStorei(37441,f.premultiplyAlpha),this._gl.pixelStorei(3317,f.unpackAlignment);var O=this._gl.getParameter(3379),C=this.textureNeedsPowerOfTwo(f)&&this.isPowerOfTwo(f.image)===!1,j=this.resizeImage(f.image,C,!1,O),V=this.isPowerOfTwo(j)||this.isWebGL2,R=this.convert(f.format),M=this.convert(f.type),ee=this.getInternalFormat(f.internalFormat,R,M);this.setTextureParameters(3553,f,V);var F,_=f.mipmaps;if(0<_.length&&V){for(var J=0,T=_.length;J<T;J++)F=_[J],this._gl.texImage2D(3553,J,ee,R,M,F);f.generateMipmaps=!1}else this._gl.texImage2D(3553,0,ee,R,M,j);this.textureNeedsGenerateMipmaps(f,V)&&this.generateMipmap(D,3553,f,j.width,j.height),this.mcObject.registTexture(D.handle,D.webglTexture)},G);function G(k,D){this.mapImagePathToTexture={},this.mcObject=k,this._gl=D,this.extensions=new h(D),this.isWebGL2=typeof WebGL2RenderingContext<"u"&&D instanceof WebGL2RenderingContext}o.McTextureManager=L},{"../MxManager":29,three:19}]},{},[58])}function registerMxDbEntity(){store.events.emit("MxDbEntityRegister")}let registerList=[];function addRegisterMxDbEntity(b){b.isRegister=!1;const r=()=>{!b.isRegister&&b.register&&b.register(),store.events.off("stateChange",r)};registerList.push(r)}const callRegisterMxDbEntityLists=()=>{registerList.forEach(b=>{b&&b()}),registerList=[]};store.events.on("MxDbEntityRegister",callRegisterMxDbEntityLists);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function unwrapExports(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function createCommonjsModule(b,r){return b(r={exports:{}},r.exports),r.exports}var jquery=createCommonjsModule(function(b){var r,o;r=typeof window<"u"?window:commonjsGlobal,o=function(a,v){var h=[],w=Object.getPrototypeOf,L=h.slice,G=h.flat?function(y){return h.flat.call(y)}:function(y){return h.concat.apply([],y)},k=h.push,D=h.indexOf,f={},O=f.toString,C=f.hasOwnProperty,j=C.toString,V=j.call(Object),R={},M=function(y){return typeof y=="function"&&typeof y.nodeType!="number"&&typeof y.item!="function"},ee=function(y){return y!=null&&y===y.window},F=a.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function J(y,S,Z){var re,de,fe=(Z=Z||F).createElement("script");if(fe.text=y,S)for(re in _)(de=S[re]||S.getAttribute&&S.getAttribute(re))&&fe.setAttribute(re,de);Z.head.appendChild(fe).parentNode.removeChild(fe)}function T(y){return y==null?y+"":typeof y=="object"||typeof y=="function"?f[O.call(y)]||"object":typeof y}var B="3.7.0",N=/HTML$/i,u=function(y,S){return new u.fn.init(y,S)};function c(y){var S=!!y&&"length"in y&&y.length,Z=T(y);return!M(y)&&!ee(y)&&(Z==="array"||S===0||typeof S=="number"&&S>0&&S-1 in y)}function m(y,S){return y.nodeName&&y.nodeName.toLowerCase()===S.toLowerCase()}u.fn=u.prototype={jquery:B,constructor:u,length:0,toArray:function(){return L.call(this)},get:function(y){return y==null?L.call(this):y<0?this[y+this.length]:this[y]},pushStack:function(y){var S=u.merge(this.constructor(),y);return S.prevObject=this,S},each:function(y){return u.each(this,y)},map:function(y){return this.pushStack(u.map(this,function(S,Z){return y.call(S,Z,S)}))},slice:function(){return this.pushStack(L.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(u.grep(this,function(y,S){return(S+1)%2}))},odd:function(){return this.pushStack(u.grep(this,function(y,S){return S%2}))},eq:function(y){var S=this.length,Z=+y+(y<0?S:0);return this.pushStack(Z>=0&&Z<S?[this[Z]]:[])},end:function(){return this.prevObject||this.constructor()},push:k,sort:h.sort,splice:h.splice},u.extend=u.fn.extend=function(){var y,S,Z,re,de,fe,_e=arguments[0]||{},Me=1,Se=arguments.length,je=!1;for(typeof _e=="boolean"&&(je=_e,_e=arguments[Me]||{},Me++),typeof _e=="object"||M(_e)||(_e={}),Me===Se&&(_e=this,Me--);Me<Se;Me++)if((y=arguments[Me])!=null)for(S in y)re=y[S],S!=="__proto__"&&_e!==re&&(je&&re&&(u.isPlainObject(re)||(de=Array.isArray(re)))?(Z=_e[S],fe=de&&!Array.isArray(Z)?[]:de||u.isPlainObject(Z)?Z:{},de=!1,_e[S]=u.extend(je,fe,re)):re!==void 0&&(_e[S]=re));return _e},u.extend({expando:"jQuery"+(B+Math.random()).replace(/\D/g,""),isReady:!0,error:function(y){throw new Error(y)},noop:function(){},isPlainObject:function(y){var S,Z;return!(!y||O.call(y)!=="[object Object]"||(S=w(y))&&(typeof(Z=C.call(S,"constructor")&&S.constructor)!="function"||j.call(Z)!==V))},isEmptyObject:function(y){var S;for(S in y)return!1;return!0},globalEval:function(y,S,Z){J(y,{nonce:S&&S.nonce},Z)},each:function(y,S){var Z,re=0;if(c(y))for(Z=y.length;re<Z&&S.call(y[re],re,y[re])!==!1;re++);else for(re in y)if(S.call(y[re],re,y[re])===!1)break;return y},text:function(y){var S,Z="",re=0,de=y.nodeType;if(de){if(de===1||de===9||de===11)return y.textContent;if(de===3||de===4)return y.nodeValue}else for(;S=y[re++];)Z+=u.text(S);return Z},makeArray:function(y,S){var Z=S||[];return y!=null&&(c(Object(y))?u.merge(Z,typeof y=="string"?[y]:y):k.call(Z,y)),Z},inArray:function(y,S,Z){return S==null?-1:D.call(S,y,Z)},isXMLDoc:function(y){var S=y&&y.namespaceURI,Z=y&&(y.ownerDocument||y).documentElement;return!N.test(S||Z&&Z.nodeName||"HTML")},merge:function(y,S){for(var Z=+S.length,re=0,de=y.length;re<Z;re++)y[de++]=S[re];return y.length=de,y},grep:function(y,S,Z){for(var re=[],de=0,fe=y.length,_e=!Z;de<fe;de++)!S(y[de],de)!==_e&&re.push(y[de]);return re},map:function(y,S,Z){var re,de,fe=0,_e=[];if(c(y))for(re=y.length;fe<re;fe++)(de=S(y[fe],fe,Z))!=null&&_e.push(de);else for(fe in y)(de=S(y[fe],fe,Z))!=null&&_e.push(de);return G(_e)},guid:1,support:R}),typeof Symbol=="function"&&(u.fn[Symbol.iterator]=h[Symbol.iterator]),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(y,S){f["[object "+S+"]"]=S.toLowerCase()});var E=h.pop,U=h.sort,X=h.splice,W="[\\x20\\t\\r\\n\\f]",te=new RegExp("^"+W+"+|((?:^|[^\\\\])(?:\\\\.)*)"+W+"+$","g");u.contains=function(y,S){var Z=S&&S.parentNode;return y===Z||!(!Z||Z.nodeType!==1||!(y.contains?y.contains(Z):y.compareDocumentPosition&&16&y.compareDocumentPosition(Z)))};var ne=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function ce(y,S){return S?y==="\0"?"�":y.slice(0,-1)+"\\"+y.charCodeAt(y.length-1).toString(16)+" ":"\\"+y}u.escapeSelector=function(y){return(y+"").replace(ne,ce)};var we=F,Ie=k;(function(){var y,S,Z,re,de,fe,_e,Me,Se,je,rt=Ie,mt=u.expando,ut=0,Lt=0,kn=li(),At=li(),Hn=li(),Zr=li(),Fr=function(Le,ot){return Le===ot&&(de=!0),0},la="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Ma="(?:\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",dr="\\["+W+"*("+Ma+")(?:"+W+"*([*^$|!~]?=)"+W+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Ma+"))|)"+W+"*\\]",_a=":("+Ma+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+dr+")*)|.*)\\)|)",xr=new RegExp(W+"+","g"),Wn=new RegExp("^"+W+"*,"+W+"*"),so=new RegExp("^"+W+"*([>+~]|"+W+")"+W+"*"),zo=new RegExp(W+"|>"),ca=new RegExp(_a),Uo=new RegExp("^"+Ma+"$"),Ta={ID:new RegExp("^#("+Ma+")"),CLASS:new RegExp("^\\.("+Ma+")"),TAG:new RegExp("^("+Ma+"|[*])"),ATTR:new RegExp("^"+dr),PSEUDO:new RegExp("^"+_a),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+W+"*(even|odd|(([+-]|)(\\d*)n|)"+W+"*(?:([+-]|)"+W+"*(\\d+)|))"+W+"*\\)|)","i"),bool:new RegExp("^(?:"+la+")$","i"),needsContext:new RegExp("^"+W+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+W+"*((?:-\\d)?\\d*)"+W+"*\\)|)(?=[^-]|$)","i")},Xi=/^(?:input|select|textarea|button)$/i,lo=/^h\d$/i,Fi=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Kr=/[+~]/,$r=new RegExp("\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\([^\\r\\n\\f])","g"),Oi=function(Le,ot){var Qe="0x"+Le.slice(1)-65536;return ot||(Qe<0?String.fromCharCode(Qe+65536):String.fromCharCode(Qe>>10|55296,1023&Qe|56320))},Ua=function(){Vi()},wi=Eo(function(Le){return Le.disabled===!0&&m(Le,"fieldset")},{dir:"parentNode",next:"legend"});try{rt.apply(h=L.call(we.childNodes),we.childNodes),h[we.childNodes.length].nodeType}catch{rt={apply:function(ot,Qe){Ie.apply(ot,L.call(Qe))},call:function(ot){Ie.apply(ot,L.call(arguments,1))}}}function Jn(Le,ot,Qe,St){var jt,gn,yn,Rn,kt,Mr,Cn,en=ot&&ot.ownerDocument,Rr=ot?ot.nodeType:9;if(Qe=Qe||[],typeof Le!="string"||!Le||Rr!==1&&Rr!==9&&Rr!==11)return Qe;if(!St&&(Vi(ot),ot=ot||fe,Me)){if(Rr!==11&&(kt=Fi.exec(Le)))if(jt=kt[1]){if(Rr===9){if(!(yn=ot.getElementById(jt)))return Qe;if(yn.id===jt)return rt.call(Qe,yn),Qe}else if(en&&(yn=en.getElementById(jt))&&Jn.contains(ot,yn)&&yn.id===jt)return rt.call(Qe,yn),Qe}else{if(kt[2])return rt.apply(Qe,ot.getElementsByTagName(Le)),Qe;if((jt=kt[3])&&ot.getElementsByClassName)return rt.apply(Qe,ot.getElementsByClassName(jt)),Qe}if(!(Zr[Le+" "]||Se&&Se.test(Le))){if(Cn=Le,en=ot,Rr===1&&(zo.test(Le)||so.test(Le))){for((en=Kr.test(Le)&&ua(ot.parentNode)||ot)==ot&&R.scope||((Rn=ot.getAttribute("id"))?Rn=u.escapeSelector(Rn):ot.setAttribute("id",Rn=mt)),gn=(Mr=Ha(Le)).length;gn--;)Mr[gn]=(Rn?"#"+Rn:":scope")+" "+xo(Mr[gn]);Cn=Mr.join(",")}try{return rt.apply(Qe,en.querySelectorAll(Cn)),Qe}catch{Zr(Le,!0)}finally{Rn===mt&&ot.removeAttribute("id")}}}return Sl(Le.replace(te,"$1"),ot,Qe,St)}function li(){var Le=[];return function ot(Qe,St){return Le.push(Qe+" ")>S.cacheLength&&delete ot[Le.shift()],ot[Qe+" "]=St}}function ni(Le){return Le[mt]=!0,Le}function Ar(Le){var ot=fe.createElement("fieldset");try{return!!Le(ot)}catch{return!1}finally{ot.parentNode&&ot.parentNode.removeChild(ot),ot=null}}function Ca(Le){return function(ot){return m(ot,"input")&&ot.type===Le}}function Ms(Le){return function(ot){return(m(ot,"input")||m(ot,"button"))&&ot.type===Le}}function Tl(Le){return function(ot){return"form"in ot?ot.parentNode&&ot.disabled===!1?"label"in ot?"label"in ot.parentNode?ot.parentNode.disabled===Le:ot.disabled===Le:ot.isDisabled===Le||ot.isDisabled!==!Le&&wi(ot)===Le:ot.disabled===Le:"label"in ot&&ot.disabled===Le}}function na(Le){return ni(function(ot){return ot=+ot,ni(function(Qe,St){for(var jt,gn=Le([],Qe.length,ot),yn=gn.length;yn--;)Qe[jt=gn[yn]]&&(Qe[jt]=!(St[jt]=Qe[jt]))})})}function ua(Le){return Le&&Le.getElementsByTagName!==void 0&&Le}function Vi(Le){var ot,Qe=Le?Le.ownerDocument||Le:we;return Qe!=fe&&Qe.nodeType===9&&Qe.documentElement&&(_e=(fe=Qe).documentElement,Me=!u.isXMLDoc(fe),je=_e.matches||_e.webkitMatchesSelector||_e.msMatchesSelector,we!=fe&&(ot=fe.defaultView)&&ot.top!==ot&&ot.addEventListener("unload",Ua),R.getById=Ar(function(St){return _e.appendChild(St).id=u.expando,!fe.getElementsByName||!fe.getElementsByName(u.expando).length}),R.disconnectedMatch=Ar(function(St){return je.call(St,"*")}),R.scope=Ar(function(){return fe.querySelectorAll(":scope")}),R.cssHas=Ar(function(){try{return fe.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),R.getById?(S.filter.ID=function(St){var jt=St.replace($r,Oi);return function(gn){return gn.getAttribute("id")===jt}},S.find.ID=function(St,jt){if(jt.getElementById!==void 0&&Me){var gn=jt.getElementById(St);return gn?[gn]:[]}}):(S.filter.ID=function(St){var jt=St.replace($r,Oi);return function(gn){var yn=gn.getAttributeNode!==void 0&&gn.getAttributeNode("id");return yn&&yn.value===jt}},S.find.ID=function(St,jt){if(jt.getElementById!==void 0&&Me){var gn,yn,Rn,kt=jt.getElementById(St);if(kt){if((gn=kt.getAttributeNode("id"))&&gn.value===St)return[kt];for(Rn=jt.getElementsByName(St),yn=0;kt=Rn[yn++];)if((gn=kt.getAttributeNode("id"))&&gn.value===St)return[kt]}return[]}}),S.find.TAG=function(St,jt){return jt.getElementsByTagName!==void 0?jt.getElementsByTagName(St):jt.querySelectorAll(St)},S.find.CLASS=function(St,jt){if(jt.getElementsByClassName!==void 0&&Me)return jt.getElementsByClassName(St)},Se=[],Ar(function(St){var jt;_e.appendChild(St).innerHTML="<a id='"+mt+"' href='' disabled='disabled'></a><select id='"+mt+"-\r\\' disabled='disabled'><option selected=''></option></select>",St.querySelectorAll("[selected]").length||Se.push("\\["+W+"*(?:value|"+la+")"),St.querySelectorAll("[id~="+mt+"-]").length||Se.push("~="),St.querySelectorAll("a#"+mt+"+*").length||Se.push(".#.+[+~]"),St.querySelectorAll(":checked").length||Se.push(":checked"),(jt=fe.createElement("input")).setAttribute("type","hidden"),St.appendChild(jt).setAttribute("name","D"),_e.appendChild(St).disabled=!0,St.querySelectorAll(":disabled").length!==2&&Se.push(":enabled",":disabled"),(jt=fe.createElement("input")).setAttribute("name",""),St.appendChild(jt),St.querySelectorAll("[name='']").length||Se.push("\\["+W+"*name"+W+"*="+W+`*(?:''|"")`)}),R.cssHas||Se.push(":has"),Se=Se.length&&new RegExp(Se.join("|")),Fr=function(St,jt){if(St===jt)return de=!0,0;var gn=!St.compareDocumentPosition-!jt.compareDocumentPosition;return gn||(1&(gn=(St.ownerDocument||St)==(jt.ownerDocument||jt)?St.compareDocumentPosition(jt):1)||!R.sortDetached&&jt.compareDocumentPosition(St)===gn?St===fe||St.ownerDocument==we&&Jn.contains(we,St)?-1:jt===fe||jt.ownerDocument==we&&Jn.contains(we,jt)?1:re?D.call(re,St)-D.call(re,jt):0:4&gn?-1:1)}),fe}for(y in Jn.matches=function(Le,ot){return Jn(Le,null,null,ot)},Jn.matchesSelector=function(Le,ot){if(Vi(Le),Me&&!Zr[ot+" "]&&(!Se||!Se.test(ot)))try{var Qe=je.call(Le,ot);if(Qe||R.disconnectedMatch||Le.document&&Le.document.nodeType!==11)return Qe}catch{Zr(ot,!0)}return Jn(ot,fe,null,[Le]).length>0},Jn.contains=function(Le,ot){return(Le.ownerDocument||Le)!=fe&&Vi(Le),u.contains(Le,ot)},Jn.attr=function(Le,ot){(Le.ownerDocument||Le)!=fe&&Vi(Le);var Qe=S.attrHandle[ot.toLowerCase()],St=Qe&&C.call(S.attrHandle,ot.toLowerCase())?Qe(Le,ot,!Me):void 0;return St!==void 0?St:Le.getAttribute(ot)},Jn.error=function(Le){throw new Error("Syntax error, unrecognized expression: "+Le)},u.uniqueSort=function(Le){var ot,Qe=[],St=0,jt=0;if(de=!R.sortStable,re=!R.sortStable&&L.call(Le,0),U.call(Le,Fr),de){for(;ot=Le[jt++];)ot===Le[jt]&&(St=Qe.push(jt));for(;St--;)X.call(Le,Qe[St],1)}return re=null,Le},u.fn.uniqueSort=function(){return this.pushStack(u.uniqueSort(L.apply(this)))},(S=u.expr={cacheLength:50,createPseudo:ni,match:Ta,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Le){return Le[1]=Le[1].replace($r,Oi),Le[3]=(Le[3]||Le[4]||Le[5]||"").replace($r,Oi),Le[2]==="~="&&(Le[3]=" "+Le[3]+" "),Le.slice(0,4)},CHILD:function(Le){return Le[1]=Le[1].toLowerCase(),Le[1].slice(0,3)==="nth"?(Le[3]||Jn.error(Le[0]),Le[4]=+(Le[4]?Le[5]+(Le[6]||1):2*(Le[3]==="even"||Le[3]==="odd")),Le[5]=+(Le[7]+Le[8]||Le[3]==="odd")):Le[3]&&Jn.error(Le[0]),Le},PSEUDO:function(Le){var ot,Qe=!Le[6]&&Le[2];return Ta.CHILD.test(Le[0])?null:(Le[3]?Le[2]=Le[4]||Le[5]||"":Qe&&ca.test(Qe)&&(ot=Ha(Qe,!0))&&(ot=Qe.indexOf(")",Qe.length-ot)-Qe.length)&&(Le[0]=Le[0].slice(0,ot),Le[2]=Qe.slice(0,ot)),Le.slice(0,3))}},filter:{TAG:function(Le){var ot=Le.replace($r,Oi).toLowerCase();return Le==="*"?function(){return!0}:function(Qe){return m(Qe,ot)}},CLASS:function(Le){var ot=kn[Le+" "];return ot||(ot=new RegExp("(^|"+W+")"+Le+"("+W+"|$)"))&&kn(Le,function(Qe){return ot.test(typeof Qe.className=="string"&&Qe.className||Qe.getAttribute!==void 0&&Qe.getAttribute("class")||"")})},ATTR:function(Le,ot,Qe){return function(St){var jt=Jn.attr(St,Le);return jt==null?ot==="!=":!ot||(jt+="",ot==="="?jt===Qe:ot==="!="?jt!==Qe:ot==="^="?Qe&&jt.indexOf(Qe)===0:ot==="*="?Qe&&jt.indexOf(Qe)>-1:ot==="$="?Qe&&jt.slice(-Qe.length)===Qe:ot==="~="?(" "+jt.replace(xr," ")+" ").indexOf(Qe)>-1:ot==="|="&&(jt===Qe||jt.slice(0,Qe.length+1)===Qe+"-"))}},CHILD:function(Le,ot,Qe,St,jt){var gn=Le.slice(0,3)!=="nth",yn=Le.slice(-4)!=="last",Rn=ot==="of-type";return St===1&&jt===0?function(kt){return!!kt.parentNode}:function(kt,Mr,Cn){var en,Rr,tr,ci,bi,pi=gn!==yn?"nextSibling":"previousSibling",be=kt.parentNode,Mi=Rn&&kt.nodeName.toLowerCase(),on=!Cn&&!Rn,Tr=!1;if(be){if(gn){for(;pi;){for(tr=kt;tr=tr[pi];)if(Rn?m(tr,Mi):tr.nodeType===1)return!1;bi=pi=Le==="only"&&!bi&&"nextSibling"}return!0}if(bi=[yn?be.firstChild:be.lastChild],yn&&on){for(Tr=(ci=(en=(Rr=be[mt]||(be[mt]={}))[Le]||[])[0]===ut&&en[1])&&en[2],tr=ci&&be.childNodes[ci];tr=++ci&&tr&&tr[pi]||(Tr=ci=0)||bi.pop();)if(tr.nodeType===1&&++Tr&&tr===kt){Rr[Le]=[ut,ci,Tr];break}}else if(on&&(Tr=ci=(en=(Rr=kt[mt]||(kt[mt]={}))[Le]||[])[0]===ut&&en[1]),Tr===!1)for(;(tr=++ci&&tr&&tr[pi]||(Tr=ci=0)||bi.pop())&&(!(Rn?m(tr,Mi):tr.nodeType===1)||!++Tr||(on&&((Rr=tr[mt]||(tr[mt]={}))[Le]=[ut,Tr]),tr!==kt)););return(Tr-=jt)===St||Tr%St==0&&Tr/St>=0}}},PSEUDO:function(Le,ot){var Qe,St=S.pseudos[Le]||S.setFilters[Le.toLowerCase()]||Jn.error("unsupported pseudo: "+Le);return St[mt]?St(ot):St.length>1?(Qe=[Le,Le,"",ot],S.setFilters.hasOwnProperty(Le.toLowerCase())?ni(function(jt,gn){for(var yn,Rn=St(jt,ot),kt=Rn.length;kt--;)jt[yn=D.call(jt,Rn[kt])]=!(gn[yn]=Rn[kt])}):function(jt){return St(jt,0,Qe)}):St}},pseudos:{not:ni(function(Le){var ot=[],Qe=[],St=Ri(Le.replace(te,"$1"));return St[mt]?ni(function(jt,gn,yn,Rn){for(var kt,Mr=St(jt,null,Rn,[]),Cn=jt.length;Cn--;)(kt=Mr[Cn])&&(jt[Cn]=!(gn[Cn]=kt))}):function(jt,gn,yn){return ot[0]=jt,St(ot,null,yn,Qe),ot[0]=null,!Qe.pop()}}),has:ni(function(Le){return function(ot){return Jn(Le,ot).length>0}}),contains:ni(function(Le){return Le=Le.replace($r,Oi),function(ot){return(ot.textContent||u.text(ot)).indexOf(Le)>-1}}),lang:ni(function(Le){return Uo.test(Le||"")||Jn.error("unsupported lang: "+Le),Le=Le.replace($r,Oi).toLowerCase(),function(ot){var Qe;do if(Qe=Me?ot.lang:ot.getAttribute("xml:lang")||ot.getAttribute("lang"))return(Qe=Qe.toLowerCase())===Le||Qe.indexOf(Le+"-")===0;while((ot=ot.parentNode)&&ot.nodeType===1);return!1}}),target:function(Le){var ot=a.location&&a.location.hash;return ot&&ot.slice(1)===Le.id},root:function(Le){return Le===_e},focus:function(Le){return Le===function(){try{return fe.activeElement}catch{}}()&&fe.hasFocus()&&!!(Le.type||Le.href||~Le.tabIndex)},enabled:Tl(!1),disabled:Tl(!0),checked:function(Le){return m(Le,"input")&&!!Le.checked||m(Le,"option")&&!!Le.selected},selected:function(Le){return Le.parentNode&&Le.parentNode.selectedIndex,Le.selected===!0},empty:function(Le){for(Le=Le.firstChild;Le;Le=Le.nextSibling)if(Le.nodeType<6)return!1;return!0},parent:function(Le){return!S.pseudos.empty(Le)},header:function(Le){return lo.test(Le.nodeName)},input:function(Le){return Xi.test(Le.nodeName)},button:function(Le){return m(Le,"input")&&Le.type==="button"||m(Le,"button")},text:function(Le){var ot;return m(Le,"input")&&Le.type==="text"&&((ot=Le.getAttribute("type"))==null||ot.toLowerCase()==="text")},first:na(function(){return[0]}),last:na(function(Le,ot){return[ot-1]}),eq:na(function(Le,ot,Qe){return[Qe<0?Qe+ot:Qe]}),even:na(function(Le,ot){for(var Qe=0;Qe<ot;Qe+=2)Le.push(Qe);return Le}),odd:na(function(Le,ot){for(var Qe=1;Qe<ot;Qe+=2)Le.push(Qe);return Le}),lt:na(function(Le,ot,Qe){var St;for(St=Qe<0?Qe+ot:Qe>ot?ot:Qe;--St>=0;)Le.push(St);return Le}),gt:na(function(Le,ot,Qe){for(var St=Qe<0?Qe+ot:Qe;++St<ot;)Le.push(St);return Le})}}).pseudos.nth=S.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[y]=Ca(y);for(y in{submit:!0,reset:!0})S.pseudos[y]=Ms(y);function _s(){}function Ha(Le,ot){var Qe,St,jt,gn,yn,Rn,kt,Mr=At[Le+" "];if(Mr)return ot?0:Mr.slice(0);for(yn=Le,Rn=[],kt=S.preFilter;yn;){for(gn in Qe&&!(St=Wn.exec(yn))||(St&&(yn=yn.slice(St[0].length)||yn),Rn.push(jt=[])),Qe=!1,(St=so.exec(yn))&&(Qe=St.shift(),jt.push({value:Qe,type:St[0].replace(te," ")}),yn=yn.slice(Qe.length)),S.filter)!(St=Ta[gn].exec(yn))||kt[gn]&&!(St=kt[gn](St))||(Qe=St.shift(),jt.push({value:Qe,type:gn,matches:St}),yn=yn.slice(Qe.length));if(!Qe)break}return ot?yn.length:yn?Jn.error(Le):At(Le,Rn).slice(0)}function xo(Le){for(var ot=0,Qe=Le.length,St="";ot<Qe;ot++)St+=Le[ot].value;return St}function Eo(Le,ot,Qe){var St=ot.dir,jt=ot.next,gn=jt||St,yn=Qe&&gn==="parentNode",Rn=Lt++;return ot.first?function(kt,Mr,Cn){for(;kt=kt[St];)if(kt.nodeType===1||yn)return Le(kt,Mr,Cn);return!1}:function(kt,Mr,Cn){var en,Rr,tr=[ut,Rn];if(Cn){for(;kt=kt[St];)if((kt.nodeType===1||yn)&&Le(kt,Mr,Cn))return!0}else for(;kt=kt[St];)if(kt.nodeType===1||yn)if(Rr=kt[mt]||(kt[mt]={}),jt&&m(kt,jt))kt=kt[St]||kt;else{if((en=Rr[gn])&&en[0]===ut&&en[1]===Rn)return tr[2]=en[2];if(Rr[gn]=tr,tr[2]=Le(kt,Mr,Cn))return!0}return!1}}function Cl(Le){return Le.length>1?function(ot,Qe,St){for(var jt=Le.length;jt--;)if(!Le[jt](ot,Qe,St))return!1;return!0}:Le[0]}function di(Le,ot,Qe,St,jt){for(var gn,yn=[],Rn=0,kt=Le.length,Mr=ot!=null;Rn<kt;Rn++)(gn=Le[Rn])&&(Qe&&!Qe(gn,St,jt)||(yn.push(gn),Mr&&ot.push(Rn)));return yn}function Ai(Le,ot,Qe,St,jt,gn){return St&&!St[mt]&&(St=Ai(St)),jt&&!jt[mt]&&(jt=Ai(jt,gn)),ni(function(yn,Rn,kt,Mr){var Cn,en,Rr,tr,ci=[],bi=[],pi=Rn.length,be=yn||function(on,Tr,wr){for(var Yi=0,Wa=Tr.length;Yi<Wa;Yi++)Jn(on,Tr[Yi],wr);return wr}(ot||"*",kt.nodeType?[kt]:kt,[]),Mi=!Le||!yn&&ot?be:di(be,ci,Le,kt,Mr);if(Qe?Qe(Mi,tr=jt||(yn?Le:pi||St)?[]:Rn,kt,Mr):tr=Mi,St)for(Cn=di(tr,bi),St(Cn,[],kt,Mr),en=Cn.length;en--;)(Rr=Cn[en])&&(tr[bi[en]]=!(Mi[bi[en]]=Rr));if(yn){if(jt||Le){if(jt){for(Cn=[],en=tr.length;en--;)(Rr=tr[en])&&Cn.push(Mi[en]=Rr);jt(null,tr=[],Cn,Mr)}for(en=tr.length;en--;)(Rr=tr[en])&&(Cn=jt?D.call(yn,Rr):ci[en])>-1&&(yn[Cn]=!(Rn[Cn]=Rr))}}else tr=di(tr===Rn?tr.splice(pi,tr.length):tr),jt?jt(null,Rn,tr,Mr):rt.apply(Rn,tr)})}function Ws(Le){for(var ot,Qe,St,jt=Le.length,gn=S.relative[Le[0].type],yn=gn||S.relative[" "],Rn=gn?1:0,kt=Eo(function(en){return en===ot},yn,!0),Mr=Eo(function(en){return D.call(ot,en)>-1},yn,!0),Cn=[function(en,Rr,tr){var ci=!gn&&(tr||Rr!=Z)||((ot=Rr).nodeType?kt(en,Rr,tr):Mr(en,Rr,tr));return ot=null,ci}];Rn<jt;Rn++)if(Qe=S.relative[Le[Rn].type])Cn=[Eo(Cl(Cn),Qe)];else{if((Qe=S.filter[Le[Rn].type].apply(null,Le[Rn].matches))[mt]){for(St=++Rn;St<jt&&!S.relative[Le[St].type];St++);return Ai(Rn>1&&Cl(Cn),Rn>1&&xo(Le.slice(0,Rn-1).concat({value:Le[Rn-2].type===" "?"*":""})).replace(te,"$1"),Qe,Rn<St&&Ws(Le.slice(Rn,St)),St<jt&&Ws(Le=Le.slice(St)),St<jt&&xo(Le))}Cn.push(Qe)}return Cl(Cn)}function Ri(Le,ot){var Qe,St=[],jt=[],gn=Hn[Le+" "];if(!gn){for(ot||(ot=Ha(Le)),Qe=ot.length;Qe--;)(gn=Ws(ot[Qe]))[mt]?St.push(gn):jt.push(gn);(gn=Hn(Le,function(yn,Rn){var kt=Rn.length>0,Mr=yn.length>0,Cn=function(en,Rr,tr,ci,bi){var pi,be,Mi,on=0,Tr="0",wr=en&&[],Yi=[],Wa=Z,Gi=en||Mr&&S.find.TAG("*",bi),wo=ut+=Wa==null?1:Math.random()||.1,ha=Gi.length;for(bi&&(Z=Rr==fe||Rr||bi);Tr!==ha&&(pi=Gi[Tr])!=null;Tr++){if(Mr&&pi){for(be=0,Rr||pi.ownerDocument==fe||(Vi(pi),tr=!Me);Mi=yn[be++];)if(Mi(pi,Rr||fe,tr)){rt.call(ci,pi);break}bi&&(ut=wo)}kt&&((pi=!Mi&&pi)&&on--,en&&wr.push(pi))}if(on+=Tr,kt&&Tr!==on){for(be=0;Mi=Rn[be++];)Mi(wr,Yi,Rr,tr);if(en){if(on>0)for(;Tr--;)wr[Tr]||Yi[Tr]||(Yi[Tr]=E.call(ci));Yi=di(Yi)}rt.apply(ci,Yi),bi&&!en&&Yi.length>0&&on+Rn.length>1&&u.uniqueSort(ci)}return bi&&(ut=wo,Z=Wa),wr};return kt?ni(Cn):Cn}(jt,St))).selector=Le}return gn}function Sl(Le,ot,Qe,St){var jt,gn,yn,Rn,kt,Mr=typeof Le=="function"&&Le,Cn=!St&&Ha(Le=Mr.selector||Le);if(Qe=Qe||[],Cn.length===1){if((gn=Cn[0]=Cn[0].slice(0)).length>2&&(yn=gn[0]).type==="ID"&&ot.nodeType===9&&Me&&S.relative[gn[1].type]){if(!(ot=(S.find.ID(yn.matches[0].replace($r,Oi),ot)||[])[0]))return Qe;Mr&&(ot=ot.parentNode),Le=Le.slice(gn.shift().value.length)}for(jt=Ta.needsContext.test(Le)?0:gn.length;jt--&&(yn=gn[jt],!S.relative[Rn=yn.type]);)if((kt=S.find[Rn])&&(St=kt(yn.matches[0].replace($r,Oi),Kr.test(gn[0].type)&&ua(ot.parentNode)||ot))){if(gn.splice(jt,1),!(Le=St.length&&xo(gn)))return rt.apply(Qe,St),Qe;break}}return(Mr||Ri(Le,Cn))(St,ot,!Me,Qe,!ot||Kr.test(Le)&&ua(ot.parentNode)||ot),Qe}_s.prototype=S.filters=S.pseudos,S.setFilters=new _s,R.sortStable=mt.split("").sort(Fr).join("")===mt,Vi(),R.sortDetached=Ar(function(Le){return 1&Le.compareDocumentPosition(fe.createElement("fieldset"))}),u.find=Jn,u.expr[":"]=u.expr.pseudos,u.unique=u.uniqueSort,Jn.compile=Ri,Jn.select=Sl,Jn.setDocument=Vi,Jn.escape=u.escapeSelector,Jn.getText=u.text,Jn.isXML=u.isXMLDoc,Jn.selectors=u.expr,Jn.support=u.support,Jn.uniqueSort=u.uniqueSort})();var xe=function(y,S,Z){for(var re=[],de=Z!==void 0;(y=y[S])&&y.nodeType!==9;)if(y.nodeType===1){if(de&&u(y).is(Z))break;re.push(y)}return re},Be=function(y,S){for(var Z=[];y;y=y.nextSibling)y.nodeType===1&&y!==S&&Z.push(y);return Z},q=u.expr.match.needsContext,ge=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function oe(y,S,Z){return M(S)?u.grep(y,function(re,de){return!!S.call(re,de,re)!==Z}):S.nodeType?u.grep(y,function(re){return re===S!==Z}):typeof S!="string"?u.grep(y,function(re){return D.call(S,re)>-1!==Z}):u.filter(S,y,Z)}u.filter=function(y,S,Z){var re=S[0];return Z&&(y=":not("+y+")"),S.length===1&&re.nodeType===1?u.find.matchesSelector(re,y)?[re]:[]:u.find.matches(y,u.grep(S,function(de){return de.nodeType===1}))},u.fn.extend({find:function(y){var S,Z,re=this.length,de=this;if(typeof y!="string")return this.pushStack(u(y).filter(function(){for(S=0;S<re;S++)if(u.contains(de[S],this))return!0}));for(Z=this.pushStack([]),S=0;S<re;S++)u.find(y,de[S],Z);return re>1?u.uniqueSort(Z):Z},filter:function(y){return this.pushStack(oe(this,y||[],!1))},not:function(y){return this.pushStack(oe(this,y||[],!0))},is:function(y){return!!oe(this,typeof y=="string"&&q.test(y)?u(y):y||[],!1).length}});var se,Ae=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(u.fn.init=function(y,S,Z){var re,de;if(!y)return this;if(Z=Z||se,typeof y=="string"){if(!(re=y[0]==="<"&&y[y.length-1]===">"&&y.length>=3?[null,y,null]:Ae.exec(y))||!re[1]&&S)return!S||S.jquery?(S||Z).find(y):this.constructor(S).find(y);if(re[1]){if(S=S instanceof u?S[0]:S,u.merge(this,u.parseHTML(re[1],S&&S.nodeType?S.ownerDocument||S:F,!0)),ge.test(re[1])&&u.isPlainObject(S))for(re in S)M(this[re])?this[re](S[re]):this.attr(re,S[re]);return this}return(de=F.getElementById(re[2]))&&(this[0]=de,this.length=1),this}return y.nodeType?(this[0]=y,this.length=1,this):M(y)?Z.ready!==void 0?Z.ready(y):y(u):u.makeArray(y,this)}).prototype=u.fn,se=u(F);var Ye=/^(?:parents|prev(?:Until|All))/,Ge={children:!0,contents:!0,next:!0,prev:!0};function Ne(y,S){for(;(y=y[S])&&y.nodeType!==1;);return y}u.fn.extend({has:function(y){var S=u(y,this),Z=S.length;return this.filter(function(){for(var re=0;re<Z;re++)if(u.contains(this,S[re]))return!0})},closest:function(y,S){var Z,re=0,de=this.length,fe=[],_e=typeof y!="string"&&u(y);if(!q.test(y)){for(;re<de;re++)for(Z=this[re];Z&&Z!==S;Z=Z.parentNode)if(Z.nodeType<11&&(_e?_e.index(Z)>-1:Z.nodeType===1&&u.find.matchesSelector(Z,y))){fe.push(Z);break}}return this.pushStack(fe.length>1?u.uniqueSort(fe):fe)},index:function(y){return y?typeof y=="string"?D.call(u(y),this[0]):D.call(this,y.jquery?y[0]:y):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(y,S){return this.pushStack(u.uniqueSort(u.merge(this.get(),u(y,S))))},addBack:function(y){return this.add(y==null?this.prevObject:this.prevObject.filter(y))}}),u.each({parent:function(y){var S=y.parentNode;return S&&S.nodeType!==11?S:null},parents:function(y){return xe(y,"parentNode")},parentsUntil:function(y,S,Z){return xe(y,"parentNode",Z)},next:function(y){return Ne(y,"nextSibling")},prev:function(y){return Ne(y,"previousSibling")},nextAll:function(y){return xe(y,"nextSibling")},prevAll:function(y){return xe(y,"previousSibling")},nextUntil:function(y,S,Z){return xe(y,"nextSibling",Z)},prevUntil:function(y,S,Z){return xe(y,"previousSibling",Z)},siblings:function(y){return Be((y.parentNode||{}).firstChild,y)},children:function(y){return Be(y.firstChild)},contents:function(y){return y.contentDocument!=null&&w(y.contentDocument)?y.contentDocument:(m(y,"template")&&(y=y.content||y),u.merge([],y.childNodes))}},function(y,S){u.fn[y]=function(Z,re){var de=u.map(this,S,Z);return y.slice(-5)!=="Until"&&(re=Z),re&&typeof re=="string"&&(de=u.filter(re,de)),this.length>1&&(Ge[y]||u.uniqueSort(de),Ye.test(y)&&de.reverse()),this.pushStack(de)}});var le=/[^\x20\t\r\n\f]+/g;function ve(y){return y}function He(y){throw y}function nt(y,S,Z,re){var de;try{y&&M(de=y.promise)?de.call(y).done(S).fail(Z):y&&M(de=y.then)?de.call(y,S,Z):S.apply(void 0,[y].slice(re))}catch(fe){Z.apply(void 0,[fe])}}u.Callbacks=function(y){y=typeof y=="string"?function(rt){var mt={};return u.each(rt.match(le)||[],function(ut,Lt){mt[Lt]=!0}),mt}(y):u.extend({},y);var S,Z,re,de,fe=[],_e=[],Me=-1,Se=function(){for(de=de||y.once,re=S=!0;_e.length;Me=-1)for(Z=_e.shift();++Me<fe.length;)fe[Me].apply(Z[0],Z[1])===!1&&y.stopOnFalse&&(Me=fe.length,Z=!1);y.memory||(Z=!1),S=!1,de&&(fe=Z?[]:"")},je={add:function(){return fe&&(Z&&!S&&(Me=fe.length-1,_e.push(Z)),function rt(mt){u.each(mt,function(ut,Lt){M(Lt)?y.unique&&je.has(Lt)||fe.push(Lt):Lt&&Lt.length&&T(Lt)!=="string"&&rt(Lt)})}(arguments),Z&&!S&&Se()),this},remove:function(){return u.each(arguments,function(rt,mt){for(var ut;(ut=u.inArray(mt,fe,ut))>-1;)fe.splice(ut,1),ut<=Me&&Me--}),this},has:function(rt){return rt?u.inArray(rt,fe)>-1:fe.length>0},empty:function(){return fe&&(fe=[]),this},disable:function(){return de=_e=[],fe=Z="",this},disabled:function(){return!fe},lock:function(){return de=_e=[],Z||S||(fe=Z=""),this},locked:function(){return!!de},fireWith:function(rt,mt){return de||(mt=[rt,(mt=mt||[]).slice?mt.slice():mt],_e.push(mt),S||Se()),this},fire:function(){return je.fireWith(this,arguments),this},fired:function(){return!!re}};return je},u.extend({Deferred:function(y){var S=[["notify","progress",u.Callbacks("memory"),u.Callbacks("memory"),2],["resolve","done",u.Callbacks("once memory"),u.Callbacks("once memory"),0,"resolved"],["reject","fail",u.Callbacks("once memory"),u.Callbacks("once memory"),1,"rejected"]],Z="pending",re={state:function(){return Z},always:function(){return de.done(arguments).fail(arguments),this},catch:function(fe){return re.then(null,fe)},pipe:function(){var fe=arguments;return u.Deferred(function(_e){u.each(S,function(Me,Se){var je=M(fe[Se[4]])&&fe[Se[4]];de[Se[1]](function(){var rt=je&&je.apply(this,arguments);rt&&M(rt.promise)?rt.promise().progress(_e.notify).done(_e.resolve).fail(_e.reject):_e[Se[0]+"With"](this,je?[rt]:arguments)})}),fe=null}).promise()},then:function(fe,_e,Me){var Se=0;function je(rt,mt,ut,Lt){return function(){var kn=this,At=arguments,Hn=function(){var Fr,la;if(!(rt<Se)){if((Fr=ut.apply(kn,At))===mt.promise())throw new TypeError("Thenable self-resolution");la=Fr&&(typeof Fr=="object"||typeof Fr=="function")&&Fr.then,M(la)?Lt?la.call(Fr,je(Se,mt,ve,Lt),je(Se,mt,He,Lt)):(Se++,la.call(Fr,je(Se,mt,ve,Lt),je(Se,mt,He,Lt),je(Se,mt,ve,mt.notifyWith))):(ut!==ve&&(kn=void 0,At=[Fr]),(Lt||mt.resolveWith)(kn,At))}},Zr=Lt?Hn:function(){try{Hn()}catch(Fr){u.Deferred.exceptionHook&&u.Deferred.exceptionHook(Fr,Zr.error),rt+1>=Se&&(ut!==He&&(kn=void 0,At=[Fr]),mt.rejectWith(kn,At))}};rt?Zr():(u.Deferred.getErrorHook?Zr.error=u.Deferred.getErrorHook():u.Deferred.getStackHook&&(Zr.error=u.Deferred.getStackHook()),a.setTimeout(Zr))}}return u.Deferred(function(rt){S[0][3].add(je(0,rt,M(Me)?Me:ve,rt.notifyWith)),S[1][3].add(je(0,rt,M(fe)?fe:ve)),S[2][3].add(je(0,rt,M(_e)?_e:He))}).promise()},promise:function(fe){return fe!=null?u.extend(fe,re):re}},de={};return u.each(S,function(fe,_e){var Me=_e[2],Se=_e[5];re[_e[1]]=Me.add,Se&&Me.add(function(){Z=Se},S[3-fe][2].disable,S[3-fe][3].disable,S[0][2].lock,S[0][3].lock),Me.add(_e[3].fire),de[_e[0]]=function(){return de[_e[0]+"With"](this===de?void 0:this,arguments),this},de[_e[0]+"With"]=Me.fireWith}),re.promise(de),y&&y.call(de,de),de},when:function(y){var S=arguments.length,Z=S,re=Array(Z),de=L.call(arguments),fe=u.Deferred(),_e=function(Me){return function(Se){re[Me]=this,de[Me]=arguments.length>1?L.call(arguments):Se,--S||fe.resolveWith(re,de)}};if(S<=1&&(nt(y,fe.done(_e(Z)).resolve,fe.reject,!S),fe.state()==="pending"||M(de[Z]&&de[Z].then)))return fe.then();for(;Z--;)nt(de[Z],_e(Z),fe.reject);return fe.promise()}});var ht=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;u.Deferred.exceptionHook=function(y,S){a.console&&a.console.warn&&y&&ht.test(y.name)&&a.console.warn("jQuery.Deferred exception: "+y.message,y.stack,S)},u.readyException=function(y){a.setTimeout(function(){throw y})};var Tt=u.Deferred();function Ct(){F.removeEventListener("DOMContentLoaded",Ct),a.removeEventListener("load",Ct),u.ready()}u.fn.ready=function(y){return Tt.then(y).catch(function(S){u.readyException(S)}),this},u.extend({isReady:!1,readyWait:1,ready:function(y){(y===!0?--u.readyWait:u.isReady)||(u.isReady=!0,y!==!0&&--u.readyWait>0||Tt.resolveWith(F,[u]))}}),u.ready.then=Tt.then,F.readyState==="complete"||F.readyState!=="loading"&&!F.documentElement.doScroll?a.setTimeout(u.ready):(F.addEventListener("DOMContentLoaded",Ct),a.addEventListener("load",Ct));var We=function(y,S,Z,re,de,fe,_e){var Me=0,Se=y.length,je=Z==null;if(T(Z)==="object")for(Me in de=!0,Z)We(y,S,Me,Z[Me],!0,fe,_e);else if(re!==void 0&&(de=!0,M(re)||(_e=!0),je&&(_e?(S.call(y,re),S=null):(je=S,S=function(rt,mt,ut){return je.call(u(rt),ut)})),S))for(;Me<Se;Me++)S(y[Me],Z,_e?re:re.call(y[Me],Me,S(y[Me],Z)));return de?y:je?S.call(y):Se?S(y[0],Z):fe},It=/^-ms-/,Bt=/-([a-z])/g;function Ln(y,S){return S.toUpperCase()}function rn(y){return y.replace(It,"ms-").replace(Bt,Ln)}var Xn=function(y){return y.nodeType===1||y.nodeType===9||!+y.nodeType};function yt(){this.expando=u.expando+yt.uid++}yt.uid=1,yt.prototype={cache:function(y){var S=y[this.expando];return S||(S={},Xn(y)&&(y.nodeType?y[this.expando]=S:Object.defineProperty(y,this.expando,{value:S,configurable:!0}))),S},set:function(y,S,Z){var re,de=this.cache(y);if(typeof S=="string")de[rn(S)]=Z;else for(re in S)de[rn(re)]=S[re];return de},get:function(y,S){return S===void 0?this.cache(y):y[this.expando]&&y[this.expando][rn(S)]},access:function(y,S,Z){return S===void 0||S&&typeof S=="string"&&Z===void 0?this.get(y,S):(this.set(y,S,Z),Z!==void 0?Z:S)},remove:function(y,S){var Z,re=y[this.expando];if(re!==void 0){if(S!==void 0)for(Z=(S=Array.isArray(S)?S.map(rn):(S=rn(S))in re?[S]:S.match(le)||[]).length;Z--;)delete re[S[Z]];(S===void 0||u.isEmptyObject(re))&&(y.nodeType?y[this.expando]=void 0:delete y[this.expando])}},hasData:function(y){var S=y[this.expando];return S!==void 0&&!u.isEmptyObject(S)}};var ze=new yt,Zt=new yt,An=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Yn=/[A-Z]/g;function pt(y,S,Z){var re;if(Z===void 0&&y.nodeType===1)if(re="data-"+S.replace(Yn,"-$&").toLowerCase(),typeof(Z=y.getAttribute(re))=="string"){try{Z=function(de){return de==="true"||de!=="false"&&(de==="null"?null:de===+de+""?+de:An.test(de)?JSON.parse(de):de)}(Z)}catch{}Zt.set(y,S,Z)}else Z=void 0;return Z}u.extend({hasData:function(y){return Zt.hasData(y)||ze.hasData(y)},data:function(y,S,Z){return Zt.access(y,S,Z)},removeData:function(y,S){Zt.remove(y,S)},_data:function(y,S,Z){return ze.access(y,S,Z)},_removeData:function(y,S){ze.remove(y,S)}}),u.fn.extend({data:function(y,S){var Z,re,de,fe=this[0],_e=fe&&fe.attributes;if(y===void 0){if(this.length&&(de=Zt.get(fe),fe.nodeType===1&&!ze.get(fe,"hasDataAttrs"))){for(Z=_e.length;Z--;)_e[Z]&&(re=_e[Z].name).indexOf("data-")===0&&(re=rn(re.slice(5)),pt(fe,re,de[re]));ze.set(fe,"hasDataAttrs",!0)}return de}return typeof y=="object"?this.each(function(){Zt.set(this,y)}):We(this,function(Me){var Se;if(fe&&Me===void 0)return(Se=Zt.get(fe,y))!==void 0||(Se=pt(fe,y))!==void 0?Se:void 0;this.each(function(){Zt.set(this,y,Me)})},null,S,arguments.length>1,null,!0)},removeData:function(y){return this.each(function(){Zt.remove(this,y)})}}),u.extend({queue:function(y,S,Z){var re;if(y)return S=(S||"fx")+"queue",re=ze.get(y,S),Z&&(!re||Array.isArray(Z)?re=ze.access(y,S,u.makeArray(Z)):re.push(Z)),re||[]},dequeue:function(y,S){S=S||"fx";var Z=u.queue(y,S),re=Z.length,de=Z.shift(),fe=u._queueHooks(y,S);de==="inprogress"&&(de=Z.shift(),re--),de&&(S==="fx"&&Z.unshift("inprogress"),delete fe.stop,de.call(y,function(){u.dequeue(y,S)},fe)),!re&&fe&&fe.empty.fire()},_queueHooks:function(y,S){var Z=S+"queueHooks";return ze.get(y,Z)||ze.access(y,Z,{empty:u.Callbacks("once memory").add(function(){ze.remove(y,[S+"queue",Z])})})}}),u.fn.extend({queue:function(y,S){var Z=2;return typeof y!="string"&&(S=y,y="fx",Z--),arguments.length<Z?u.queue(this[0],y):S===void 0?this:this.each(function(){var re=u.queue(this,y,S);u._queueHooks(this,y),y==="fx"&&re[0]!=="inprogress"&&u.dequeue(this,y)})},dequeue:function(y){return this.each(function(){u.dequeue(this,y)})},clearQueue:function(y){return this.queue(y||"fx",[])},promise:function(y,S){var Z,re=1,de=u.Deferred(),fe=this,_e=this.length,Me=function(){--re||de.resolveWith(fe,[fe])};for(typeof y!="string"&&(S=y,y=void 0),y=y||"fx";_e--;)(Z=ze.get(fe[_e],y+"queueHooks"))&&Z.empty&&(re++,Z.empty.add(Me));return Me(),de.promise(S)}});var st=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,qt=new RegExp("^(?:([+-])=|)("+st+")([a-z%]*)$","i"),xn=["Top","Right","Bottom","Left"],nn=F.documentElement,er=function(y){return u.contains(y.ownerDocument,y)},kr={composed:!0};nn.getRootNode&&(er=function(y){return u.contains(y.ownerDocument,y)||y.getRootNode(kr)===y.ownerDocument});var ct=function(y,S){return(y=S||y).style.display==="none"||y.style.display===""&&er(y)&&u.css(y,"display")==="none"};function Ue(y,S,Z,re){var de,fe,_e=20,Me=re?function(){return re.cur()}:function(){return u.css(y,S,"")},Se=Me(),je=Z&&Z[3]||(u.cssNumber[S]?"":"px"),rt=y.nodeType&&(u.cssNumber[S]||je!=="px"&&+Se)&&qt.exec(u.css(y,S));if(rt&&rt[3]!==je){for(Se/=2,je=je||rt[3],rt=+Se||1;_e--;)u.style(y,S,rt+je),(1-fe)*(1-(fe=Me()/Se||.5))<=0&&(_e=0),rt/=fe;rt*=2,u.style(y,S,rt+je),Z=Z||[]}return Z&&(rt=+rt||+Se||0,de=Z[1]?rt+(Z[1]+1)*Z[2]:+Z[2],re&&(re.unit=je,re.start=rt,re.end=de)),de}var lt={};function Wt(y){var S,Z=y.ownerDocument,re=y.nodeName,de=lt[re];return de||(S=Z.body.appendChild(Z.createElement(re)),de=u.css(S,"display"),S.parentNode.removeChild(S),de==="none"&&(de="block"),lt[re]=de,de)}function $e(y,S){for(var Z,re,de=[],fe=0,_e=y.length;fe<_e;fe++)(re=y[fe]).style&&(Z=re.style.display,S?(Z==="none"&&(de[fe]=ze.get(re,"display")||null,de[fe]||(re.style.display="")),re.style.display===""&&ct(re)&&(de[fe]=Wt(re))):Z!=="none"&&(de[fe]="none",ze.set(re,"display",Z)));for(fe=0;fe<_e;fe++)de[fe]!=null&&(y[fe].style.display=de[fe]);return y}u.fn.extend({show:function(){return $e(this,!0)},hide:function(){return $e(this)},toggle:function(y){return typeof y=="boolean"?y?this.show():this.hide():this.each(function(){ct(this)?u(this).show():u(this).hide()})}});var Rt,$t,an=/^(?:checkbox|radio)$/i,hr=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,_r=/^$|^module$|\/(?:java|ecma)script/i;Rt=F.createDocumentFragment().appendChild(F.createElement("div")),($t=F.createElement("input")).setAttribute("type","radio"),$t.setAttribute("checked","checked"),$t.setAttribute("name","t"),Rt.appendChild($t),R.checkClone=Rt.cloneNode(!0).cloneNode(!0).lastChild.checked,Rt.innerHTML="<textarea>x</textarea>",R.noCloneChecked=!!Rt.cloneNode(!0).lastChild.defaultValue,Rt.innerHTML="<option></option>",R.option=!!Rt.lastChild;var qr={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ur(y,S){var Z;return Z=y.getElementsByTagName!==void 0?y.getElementsByTagName(S||"*"):y.querySelectorAll!==void 0?y.querySelectorAll(S||"*"):[],S===void 0||S&&m(y,S)?u.merge([y],Z):Z}function Gr(y,S){for(var Z=0,re=y.length;Z<re;Z++)ze.set(y[Z],"globalEval",!S||ze.get(S[Z],"globalEval"))}qr.tbody=qr.tfoot=qr.colgroup=qr.caption=qr.thead,qr.th=qr.td,R.option||(qr.optgroup=qr.option=[1,"<select multiple='multiple'>","</select>"]);var Or=/<|&#?\w+;/;function Qi(y,S,Z,re,de){for(var fe,_e,Me,Se,je,rt,mt=S.createDocumentFragment(),ut=[],Lt=0,kn=y.length;Lt<kn;Lt++)if((fe=y[Lt])||fe===0)if(T(fe)==="object")u.merge(ut,fe.nodeType?[fe]:fe);else if(Or.test(fe)){for(_e=_e||mt.appendChild(S.createElement("div")),Me=(hr.exec(fe)||["",""])[1].toLowerCase(),Se=qr[Me]||qr._default,_e.innerHTML=Se[1]+u.htmlPrefilter(fe)+Se[2],rt=Se[0];rt--;)_e=_e.lastChild;u.merge(ut,_e.childNodes),(_e=mt.firstChild).textContent=""}else ut.push(S.createTextNode(fe));for(mt.textContent="",Lt=0;fe=ut[Lt++];)if(re&&u.inArray(fe,re)>-1)de&&de.push(fe);else if(je=er(fe),_e=Ur(mt.appendChild(fe),"script"),je&&Gr(_e),Z)for(rt=0;fe=_e[rt++];)_r.test(fe.type||"")&&Z.push(fe);return mt}var Pi=/^([^.]*)(?:\.(.+)|)/;function si(){return!0}function gr(){return!1}function Wi(y,S,Z,re,de,fe){var _e,Me;if(typeof S=="object"){for(Me in typeof Z!="string"&&(re=re||Z,Z=void 0),S)Wi(y,Me,Z,re,S[Me],fe);return y}if(re==null&&de==null?(de=Z,re=Z=void 0):de==null&&(typeof Z=="string"?(de=re,re=void 0):(de=re,re=Z,Z=void 0)),de===!1)de=gr;else if(!de)return y;return fe===1&&(_e=de,(de=function(Se){return u().off(Se),_e.apply(this,arguments)}).guid=_e.guid||(_e.guid=u.guid++)),y.each(function(){u.event.add(this,S,de,re,Z)})}function H(y,S,Z){Z?(ze.set(y,S,!1),u.event.add(y,S,{namespace:!1,handler:function(re){var de,fe=ze.get(this,S);if(1&re.isTrigger&&this[S]){if(fe)(u.event.special[S]||{}).delegateType&&re.stopPropagation();else if(fe=L.call(arguments),ze.set(this,S,fe),this[S](),de=ze.get(this,S),ze.set(this,S,!1),fe!==de)return re.stopImmediatePropagation(),re.preventDefault(),de}else fe&&(ze.set(this,S,u.event.trigger(fe[0],fe.slice(1),this)),re.stopPropagation(),re.isImmediatePropagationStopped=si)}})):ze.get(y,S)===void 0&&u.event.add(y,S,si)}u.event={global:{},add:function(y,S,Z,re,de){var fe,_e,Me,Se,je,rt,mt,ut,Lt,kn,At,Hn=ze.get(y);if(Xn(y))for(Z.handler&&(Z=(fe=Z).handler,de=fe.selector),de&&u.find.matchesSelector(nn,de),Z.guid||(Z.guid=u.guid++),(Se=Hn.events)||(Se=Hn.events=Object.create(null)),(_e=Hn.handle)||(_e=Hn.handle=function(Zr){return u!==void 0&&u.event.triggered!==Zr.type?u.event.dispatch.apply(y,arguments):void 0}),je=(S=(S||"").match(le)||[""]).length;je--;)Lt=At=(Me=Pi.exec(S[je])||[])[1],kn=(Me[2]||"").split(".").sort(),Lt&&(mt=u.event.special[Lt]||{},Lt=(de?mt.delegateType:mt.bindType)||Lt,mt=u.event.special[Lt]||{},rt=u.extend({type:Lt,origType:At,data:re,handler:Z,guid:Z.guid,selector:de,needsContext:de&&u.expr.match.needsContext.test(de),namespace:kn.join(".")},fe),(ut=Se[Lt])||((ut=Se[Lt]=[]).delegateCount=0,mt.setup&&mt.setup.call(y,re,kn,_e)!==!1||y.addEventListener&&y.addEventListener(Lt,_e)),mt.add&&(mt.add.call(y,rt),rt.handler.guid||(rt.handler.guid=Z.guid)),de?ut.splice(ut.delegateCount++,0,rt):ut.push(rt),u.event.global[Lt]=!0)},remove:function(y,S,Z,re,de){var fe,_e,Me,Se,je,rt,mt,ut,Lt,kn,At,Hn=ze.hasData(y)&&ze.get(y);if(Hn&&(Se=Hn.events)){for(je=(S=(S||"").match(le)||[""]).length;je--;)if(Lt=At=(Me=Pi.exec(S[je])||[])[1],kn=(Me[2]||"").split(".").sort(),Lt){for(mt=u.event.special[Lt]||{},ut=Se[Lt=(re?mt.delegateType:mt.bindType)||Lt]||[],Me=Me[2]&&new RegExp("(^|\\.)"+kn.join("\\.(?:.*\\.|)")+"(\\.|$)"),_e=fe=ut.length;fe--;)rt=ut[fe],!de&&At!==rt.origType||Z&&Z.guid!==rt.guid||Me&&!Me.test(rt.namespace)||re&&re!==rt.selector&&(re!=="**"||!rt.selector)||(ut.splice(fe,1),rt.selector&&ut.delegateCount--,mt.remove&&mt.remove.call(y,rt));_e&&!ut.length&&(mt.teardown&&mt.teardown.call(y,kn,Hn.handle)!==!1||u.removeEvent(y,Lt,Hn.handle),delete Se[Lt])}else for(Lt in Se)u.event.remove(y,Lt+S[je],Z,re,!0);u.isEmptyObject(Se)&&ze.remove(y,"handle events")}},dispatch:function(y){var S,Z,re,de,fe,_e,Me=new Array(arguments.length),Se=u.event.fix(y),je=(ze.get(this,"events")||Object.create(null))[Se.type]||[],rt=u.event.special[Se.type]||{};for(Me[0]=Se,S=1;S<arguments.length;S++)Me[S]=arguments[S];if(Se.delegateTarget=this,!rt.preDispatch||rt.preDispatch.call(this,Se)!==!1){for(_e=u.event.handlers.call(this,Se,je),S=0;(de=_e[S++])&&!Se.isPropagationStopped();)for(Se.currentTarget=de.elem,Z=0;(fe=de.handlers[Z++])&&!Se.isImmediatePropagationStopped();)Se.rnamespace&&fe.namespace!==!1&&!Se.rnamespace.test(fe.namespace)||(Se.handleObj=fe,Se.data=fe.data,(re=((u.event.special[fe.origType]||{}).handle||fe.handler).apply(de.elem,Me))!==void 0&&(Se.result=re)===!1&&(Se.preventDefault(),Se.stopPropagation()));return rt.postDispatch&&rt.postDispatch.call(this,Se),Se.result}},handlers:function(y,S){var Z,re,de,fe,_e,Me=[],Se=S.delegateCount,je=y.target;if(Se&&je.nodeType&&!(y.type==="click"&&y.button>=1)){for(;je!==this;je=je.parentNode||this)if(je.nodeType===1&&(y.type!=="click"||je.disabled!==!0)){for(fe=[],_e={},Z=0;Z<Se;Z++)_e[de=(re=S[Z]).selector+" "]===void 0&&(_e[de]=re.needsContext?u(de,this).index(je)>-1:u.find(de,this,null,[je]).length),_e[de]&&fe.push(re);fe.length&&Me.push({elem:je,handlers:fe})}}return je=this,Se<S.length&&Me.push({elem:je,handlers:S.slice(Se)}),Me},addProp:function(y,S){Object.defineProperty(u.Event.prototype,y,{enumerable:!0,configurable:!0,get:M(S)?function(){if(this.originalEvent)return S(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[y]},set:function(Z){Object.defineProperty(this,y,{enumerable:!0,configurable:!0,writable:!0,value:Z})}})},fix:function(y){return y[u.expando]?y:new u.Event(y)},special:{load:{noBubble:!0},click:{setup:function(y){var S=this||y;return an.test(S.type)&&S.click&&m(S,"input")&&H(S,"click",!0),!1},trigger:function(y){var S=this||y;return an.test(S.type)&&S.click&&m(S,"input")&&H(S,"click"),!0},_default:function(y){var S=y.target;return an.test(S.type)&&S.click&&m(S,"input")&&ze.get(S,"click")||m(S,"a")}},beforeunload:{postDispatch:function(y){y.result!==void 0&&y.originalEvent&&(y.originalEvent.returnValue=y.result)}}}},u.removeEvent=function(y,S,Z){y.removeEventListener&&y.removeEventListener(S,Z)},u.Event=function(y,S){if(!(this instanceof u.Event))return new u.Event(y,S);y&&y.type?(this.originalEvent=y,this.type=y.type,this.isDefaultPrevented=y.defaultPrevented||y.defaultPrevented===void 0&&y.returnValue===!1?si:gr,this.target=y.target&&y.target.nodeType===3?y.target.parentNode:y.target,this.currentTarget=y.currentTarget,this.relatedTarget=y.relatedTarget):this.type=y,S&&u.extend(this,S),this.timeStamp=y&&y.timeStamp||Date.now(),this[u.expando]=!0},u.Event.prototype={constructor:u.Event,isDefaultPrevented:gr,isPropagationStopped:gr,isImmediatePropagationStopped:gr,isSimulated:!1,preventDefault:function(){var y=this.originalEvent;this.isDefaultPrevented=si,y&&!this.isSimulated&&y.preventDefault()},stopPropagation:function(){var y=this.originalEvent;this.isPropagationStopped=si,y&&!this.isSimulated&&y.stopPropagation()},stopImmediatePropagation:function(){var y=this.originalEvent;this.isImmediatePropagationStopped=si,y&&!this.isSimulated&&y.stopImmediatePropagation(),this.stopPropagation()}},u.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},u.event.addProp),u.each({focus:"focusin",blur:"focusout"},function(y,S){function Z(re){if(F.documentMode){var de=ze.get(this,"handle"),fe=u.event.fix(re);fe.type=re.type==="focusin"?"focus":"blur",fe.isSimulated=!0,de(re),fe.target===fe.currentTarget&&de(fe)}else u.event.simulate(S,re.target,u.event.fix(re))}u.event.special[y]={setup:function(){var re;if(H(this,y,!0),!F.documentMode)return!1;(re=ze.get(this,S))||this.addEventListener(S,Z),ze.set(this,S,(re||0)+1)},trigger:function(){return H(this,y),!0},teardown:function(){var re;if(!F.documentMode)return!1;(re=ze.get(this,S)-1)?ze.set(this,S,re):(this.removeEventListener(S,Z),ze.remove(this,S))},_default:function(re){return ze.get(re.target,y)},delegateType:S},u.event.special[S]={setup:function(){var re=this.ownerDocument||this.document||this,de=F.documentMode?this:re,fe=ze.get(de,S);fe||(F.documentMode?this.addEventListener(S,Z):re.addEventListener(y,Z,!0)),ze.set(de,S,(fe||0)+1)},teardown:function(){var re=this.ownerDocument||this.document||this,de=F.documentMode?this:re,fe=ze.get(de,S)-1;fe?ze.set(de,S,fe):(F.documentMode?this.removeEventListener(S,Z):re.removeEventListener(y,Z,!0),ze.remove(de,S))}}}),u.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(y,S){u.event.special[y]={delegateType:S,bindType:S,handle:function(Z){var re,de=Z.relatedTarget,fe=Z.handleObj;return de&&(de===this||u.contains(this,de))||(Z.type=fe.origType,re=fe.handler.apply(this,arguments),Z.type=S),re}}}),u.fn.extend({on:function(y,S,Z,re){return Wi(this,y,S,Z,re)},one:function(y,S,Z,re){return Wi(this,y,S,Z,re,1)},off:function(y,S,Z){var re,de;if(y&&y.preventDefault&&y.handleObj)return re=y.handleObj,u(y.delegateTarget).off(re.namespace?re.origType+"."+re.namespace:re.origType,re.selector,re.handler),this;if(typeof y=="object"){for(de in y)this.off(de,S,y[de]);return this}return S!==!1&&typeof S!="function"||(Z=S,S=void 0),Z===!1&&(Z=gr),this.each(function(){u.event.remove(this,y,Z,S)})}});var Hr=/<script|<style|<link/i,Da=/checked\s*(?:[^=]|=\s*.checked.)/i,$n=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function oa(y,S){return m(y,"table")&&m(S.nodeType!==11?S:S.firstChild,"tr")&&u(y).children("tbody")[0]||y}function No(y){return y.type=(y.getAttribute("type")!==null)+"/"+y.type,y}function Fs(y){return(y.type||"").slice(0,5)==="true/"?y.type=y.type.slice(5):y.removeAttribute("type"),y}function es(y,S){var Z,re,de,fe,_e,Me;if(S.nodeType===1){if(ze.hasData(y)&&(Me=ze.get(y).events))for(de in ze.remove(S,"handle events"),Me)for(Z=0,re=Me[de].length;Z<re;Z++)u.event.add(S,de,Me[de][Z]);Zt.hasData(y)&&(fe=Zt.access(y),_e=u.extend({},fe),Zt.set(S,_e))}}function fs(y,S){var Z=S.nodeName.toLowerCase();Z==="input"&&an.test(y.type)?S.checked=y.checked:Z!=="input"&&Z!=="textarea"||(S.defaultValue=y.defaultValue)}function to(y,S,Z,re){S=G(S);var de,fe,_e,Me,Se,je,rt=0,mt=y.length,ut=mt-1,Lt=S[0],kn=M(Lt);if(kn||mt>1&&typeof Lt=="string"&&!R.checkClone&&Da.test(Lt))return y.each(function(At){var Hn=y.eq(At);kn&&(S[0]=Lt.call(this,At,Hn.html())),to(Hn,S,Z,re)});if(mt&&(fe=(de=Qi(S,y[0].ownerDocument,!1,y,re)).firstChild,de.childNodes.length===1&&(de=fe),fe||re)){for(Me=(_e=u.map(Ur(de,"script"),No)).length;rt<mt;rt++)Se=de,rt!==ut&&(Se=u.clone(Se,!0,!0),Me&&u.merge(_e,Ur(Se,"script"))),Z.call(y[rt],Se,rt);if(Me)for(je=_e[_e.length-1].ownerDocument,u.map(_e,Fs),rt=0;rt<Me;rt++)Se=_e[rt],_r.test(Se.type||"")&&!ze.access(Se,"globalEval")&&u.contains(je,Se)&&(Se.src&&(Se.type||"").toLowerCase()!=="module"?u._evalUrl&&!Se.noModule&&u._evalUrl(Se.src,{nonce:Se.nonce||Se.getAttribute("nonce")},je):J(Se.textContent.replace($n,""),Se,je))}return y}function ts(y,S,Z){for(var re,de=S?u.filter(S,y):y,fe=0;(re=de[fe])!=null;fe++)Z||re.nodeType!==1||u.cleanData(Ur(re)),re.parentNode&&(Z&&er(re)&&Gr(Ur(re,"script")),re.parentNode.removeChild(re));return y}u.extend({htmlPrefilter:function(y){return y},clone:function(y,S,Z){var re,de,fe,_e,Me=y.cloneNode(!0),Se=er(y);if(!(R.noCloneChecked||y.nodeType!==1&&y.nodeType!==11||u.isXMLDoc(y)))for(_e=Ur(Me),re=0,de=(fe=Ur(y)).length;re<de;re++)fs(fe[re],_e[re]);if(S)if(Z)for(fe=fe||Ur(y),_e=_e||Ur(Me),re=0,de=fe.length;re<de;re++)es(fe[re],_e[re]);else es(y,Me);return(_e=Ur(Me,"script")).length>0&&Gr(_e,!Se&&Ur(y,"script")),Me},cleanData:function(y){for(var S,Z,re,de=u.event.special,fe=0;(Z=y[fe])!==void 0;fe++)if(Xn(Z)){if(S=Z[ze.expando]){if(S.events)for(re in S.events)de[re]?u.event.remove(Z,re):u.removeEvent(Z,re,S.handle);Z[ze.expando]=void 0}Z[Zt.expando]&&(Z[Zt.expando]=void 0)}}}),u.fn.extend({detach:function(y){return ts(this,y,!0)},remove:function(y){return ts(this,y)},text:function(y){return We(this,function(S){return S===void 0?u.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=S)})},null,y,arguments.length)},append:function(){return to(this,arguments,function(y){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||oa(this,y).appendChild(y)})},prepend:function(){return to(this,arguments,function(y){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var S=oa(this,y);S.insertBefore(y,S.firstChild)}})},before:function(){return to(this,arguments,function(y){this.parentNode&&this.parentNode.insertBefore(y,this)})},after:function(){return to(this,arguments,function(y){this.parentNode&&this.parentNode.insertBefore(y,this.nextSibling)})},empty:function(){for(var y,S=0;(y=this[S])!=null;S++)y.nodeType===1&&(u.cleanData(Ur(y,!1)),y.textContent="");return this},clone:function(y,S){return y=y!=null&&y,S=S??y,this.map(function(){return u.clone(this,y,S)})},html:function(y){return We(this,function(S){var Z=this[0]||{},re=0,de=this.length;if(S===void 0&&Z.nodeType===1)return Z.innerHTML;if(typeof S=="string"&&!Hr.test(S)&&!qr[(hr.exec(S)||["",""])[1].toLowerCase()]){S=u.htmlPrefilter(S);try{for(;re<de;re++)(Z=this[re]||{}).nodeType===1&&(u.cleanData(Ur(Z,!1)),Z.innerHTML=S);Z=0}catch{}}Z&&this.empty().append(S)},null,y,arguments.length)},replaceWith:function(){var y=[];return to(this,arguments,function(S){var Z=this.parentNode;u.inArray(this,y)<0&&(u.cleanData(Ur(this)),Z&&Z.replaceChild(S,this))},y)}}),u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(y,S){u.fn[y]=function(Z){for(var re,de=[],fe=u(Z),_e=fe.length-1,Me=0;Me<=_e;Me++)re=Me===_e?this:this.clone(!0),u(fe[Me])[S](re),k.apply(de,re.get());return this.pushStack(de)}});var sa=new RegExp("^("+st+")(?!px)[a-z%]+$","i"),Bo=/^--/,Ea=function(y){var S=y.ownerDocument.defaultView;return S&&S.opener||(S=a),S.getComputedStyle(y)},ms=function(y,S,Z){var re,de,fe={};for(de in S)fe[de]=y.style[de],y.style[de]=S[de];for(de in re=Z.call(y),S)y.style[de]=fe[de];return re},Vs=new RegExp(xn.join("|"),"i");function no(y,S,Z){var re,de,fe,_e,Me=Bo.test(S),Se=y.style;return(Z=Z||Ea(y))&&(_e=Z.getPropertyValue(S)||Z[S],Me&&_e&&(_e=_e.replace(te,"$1")||void 0),_e!==""||er(y)||(_e=u.style(y,S)),!R.pixelBoxStyles()&&sa.test(_e)&&Vs.test(S)&&(re=Se.width,de=Se.minWidth,fe=Se.maxWidth,Se.minWidth=Se.maxWidth=Se.width=_e,_e=Z.width,Se.width=re,Se.minWidth=de,Se.maxWidth=fe)),_e!==void 0?_e+"":_e}function gs(y,S){return{get:function(){if(!y())return(this.get=S).apply(this,arguments);delete this.get}}}(function(){function y(){if(je){Se.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",je.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",nn.appendChild(Se).appendChild(je);var rt=a.getComputedStyle(je);Z=rt.top!=="1%",Me=S(rt.marginLeft)===12,je.style.right="60%",fe=S(rt.right)===36,re=S(rt.width)===36,je.style.position="absolute",de=S(je.offsetWidth/3)===12,nn.removeChild(Se),je=null}}function S(rt){return Math.round(parseFloat(rt))}var Z,re,de,fe,_e,Me,Se=F.createElement("div"),je=F.createElement("div");je.style&&(je.style.backgroundClip="content-box",je.cloneNode(!0).style.backgroundClip="",R.clearCloneStyle=je.style.backgroundClip==="content-box",u.extend(R,{boxSizingReliable:function(){return y(),re},pixelBoxStyles:function(){return y(),fe},pixelPosition:function(){return y(),Z},reliableMarginLeft:function(){return y(),Me},scrollboxSize:function(){return y(),de},reliableTrDimensions:function(){var rt,mt,ut,Lt;return _e==null&&(rt=F.createElement("table"),mt=F.createElement("tr"),ut=F.createElement("div"),rt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",mt.style.cssText="border:1px solid",mt.style.height="1px",ut.style.height="9px",ut.style.display="block",nn.appendChild(rt).appendChild(mt).appendChild(ut),Lt=a.getComputedStyle(mt),_e=parseInt(Lt.height,10)+parseInt(Lt.borderTopWidth,10)+parseInt(Lt.borderBottomWidth,10)===mt.offsetHeight,nn.removeChild(rt)),_e}}))})();var Pa=["Webkit","Moz","ms"],ys=F.createElement("div").style,ro={};function io(y){return u.cssProps[y]||ro[y]||(y in ys?y:ro[y]=function(S){for(var Z=S[0].toUpperCase()+S.slice(1),re=Pa.length;re--;)if((S=Pa[re]+Z)in ys)return S}(y)||y)}var Xr=/^(none|table(?!-c[ea]).+)/,Sr={position:"absolute",visibility:"hidden",display:"block"},ns={letterSpacing:"0",fontWeight:"400"};function vs(y,S,Z){var re=qt.exec(S);return re?Math.max(0,re[2]-(Z||0))+(re[3]||"px"):S}function rs(y,S,Z,re,de,fe){var _e=S==="width"?1:0,Me=0,Se=0,je=0;if(Z===(re?"border":"content"))return 0;for(;_e<4;_e+=2)Z==="margin"&&(je+=u.css(y,Z+xn[_e],!0,de)),re?(Z==="content"&&(Se-=u.css(y,"padding"+xn[_e],!0,de)),Z!=="margin"&&(Se-=u.css(y,"border"+xn[_e]+"Width",!0,de))):(Se+=u.css(y,"padding"+xn[_e],!0,de),Z!=="padding"?Se+=u.css(y,"border"+xn[_e]+"Width",!0,de):Me+=u.css(y,"border"+xn[_e]+"Width",!0,de));return!re&&fe>=0&&(Se+=Math.max(0,Math.ceil(y["offset"+S[0].toUpperCase()+S.slice(1)]-fe-Se-Me-.5))||0),Se+je}function Fo(y,S,Z){var re=Ea(y),de=(!R.boxSizingReliable()||Z)&&u.css(y,"boxSizing",!1,re)==="border-box",fe=de,_e=no(y,S,re),Me="offset"+S[0].toUpperCase()+S.slice(1);if(sa.test(_e)){if(!Z)return _e;_e="auto"}return(!R.boxSizingReliable()&&de||!R.reliableTrDimensions()&&m(y,"tr")||_e==="auto"||!parseFloat(_e)&&u.css(y,"display",!1,re)==="inline")&&y.getClientRects().length&&(de=u.css(y,"boxSizing",!1,re)==="border-box",(fe=Me in y)&&(_e=y[Me])),(_e=parseFloat(_e)||0)+rs(y,S,Z||(de?"border":"content"),fe,re,_e)+"px"}function Ji(y,S,Z,re,de){return new Ji.prototype.init(y,S,Z,re,de)}u.extend({cssHooks:{opacity:{get:function(y,S){if(S){var Z=no(y,"opacity");return Z===""?"1":Z}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(y,S,Z,re){if(y&&y.nodeType!==3&&y.nodeType!==8&&y.style){var de,fe,_e,Me=rn(S),Se=Bo.test(S),je=y.style;if(Se||(S=io(Me)),_e=u.cssHooks[S]||u.cssHooks[Me],Z===void 0)return _e&&"get"in _e&&(de=_e.get(y,!1,re))!==void 0?de:je[S];(fe=typeof Z)=="string"&&(de=qt.exec(Z))&&de[1]&&(Z=Ue(y,S,de),fe="number"),Z!=null&&Z==Z&&(fe!=="number"||Se||(Z+=de&&de[3]||(u.cssNumber[Me]?"":"px")),R.clearCloneStyle||Z!==""||S.indexOf("background")!==0||(je[S]="inherit"),_e&&"set"in _e&&(Z=_e.set(y,Z,re))===void 0||(Se?je.setProperty(S,Z):je[S]=Z))}},css:function(y,S,Z,re){var de,fe,_e,Me=rn(S);return Bo.test(S)||(S=io(Me)),(_e=u.cssHooks[S]||u.cssHooks[Me])&&"get"in _e&&(de=_e.get(y,!0,Z)),de===void 0&&(de=no(y,S,re)),de==="normal"&&S in ns&&(de=ns[S]),Z===""||Z?(fe=parseFloat(de),Z===!0||isFinite(fe)?fe||0:de):de}}),u.each(["height","width"],function(y,S){u.cssHooks[S]={get:function(Z,re,de){if(re)return!Xr.test(u.css(Z,"display"))||Z.getClientRects().length&&Z.getBoundingClientRect().width?Fo(Z,S,de):ms(Z,Sr,function(){return Fo(Z,S,de)})},set:function(Z,re,de){var fe,_e=Ea(Z),Me=!R.scrollboxSize()&&_e.position==="absolute",Se=(Me||de)&&u.css(Z,"boxSizing",!1,_e)==="border-box",je=de?rs(Z,S,de,Se,_e):0;return Se&&Me&&(je-=Math.ceil(Z["offset"+S[0].toUpperCase()+S.slice(1)]-parseFloat(_e[S])-rs(Z,S,"border",!1,_e)-.5)),je&&(fe=qt.exec(re))&&(fe[3]||"px")!=="px"&&(Z.style[S]=re,re=u.css(Z,S)),vs(0,re,je)}}}),u.cssHooks.marginLeft=gs(R.reliableMarginLeft,function(y,S){if(S)return(parseFloat(no(y,"marginLeft"))||y.getBoundingClientRect().left-ms(y,{marginLeft:0},function(){return y.getBoundingClientRect().left}))+"px"}),u.each({margin:"",padding:"",border:"Width"},function(y,S){u.cssHooks[y+S]={expand:function(Z){for(var re=0,de={},fe=typeof Z=="string"?Z.split(" "):[Z];re<4;re++)de[y+xn[re]+S]=fe[re]||fe[re-2]||fe[0];return de}},y!=="margin"&&(u.cssHooks[y+S].set=vs)}),u.fn.extend({css:function(y,S){return We(this,function(Z,re,de){var fe,_e,Me={},Se=0;if(Array.isArray(re)){for(fe=Ea(Z),_e=re.length;Se<_e;Se++)Me[re[Se]]=u.css(Z,re[Se],!1,fe);return Me}return de!==void 0?u.style(Z,re,de):u.css(Z,re)},y,S,arguments.length>1)}}),u.Tween=Ji,Ji.prototype={constructor:Ji,init:function(y,S,Z,re,de,fe){this.elem=y,this.prop=Z,this.easing=de||u.easing._default,this.options=S,this.start=this.now=this.cur(),this.end=re,this.unit=fe||(u.cssNumber[Z]?"":"px")},cur:function(){var y=Ji.propHooks[this.prop];return y&&y.get?y.get(this):Ji.propHooks._default.get(this)},run:function(y){var S,Z=Ji.propHooks[this.prop];return this.options.duration?this.pos=S=u.easing[this.easing](y,this.options.duration*y,0,1,this.options.duration):this.pos=S=y,this.now=(this.end-this.start)*S+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Z&&Z.set?Z.set(this):Ji.propHooks._default.set(this),this}},Ji.prototype.init.prototype=Ji.prototype,Ji.propHooks={_default:{get:function(y){var S;return y.elem.nodeType!==1||y.elem[y.prop]!=null&&y.elem.style[y.prop]==null?y.elem[y.prop]:(S=u.css(y.elem,y.prop,""))&&S!=="auto"?S:0},set:function(y){u.fx.step[y.prop]?u.fx.step[y.prop](y):y.elem.nodeType!==1||!u.cssHooks[y.prop]&&y.elem.style[io(y.prop)]==null?y.elem[y.prop]=y.now:u.style(y.elem,y.prop,y.now+y.unit)}}},Ji.propHooks.scrollTop=Ji.propHooks.scrollLeft={set:function(y){y.elem.nodeType&&y.elem.parentNode&&(y.elem[y.prop]=y.now)}},u.easing={linear:function(y){return y},swing:function(y){return .5-Math.cos(y*Math.PI)/2},_default:"swing"},u.fx=Ji.prototype.init,u.fx.step={};var jr,K,Ce=/^(?:toggle|show|hide)$/,ue=/queueHooks$/;function Te(){K&&(F.hidden===!1&&a.requestAnimationFrame?a.requestAnimationFrame(Te):a.setTimeout(Te,u.fx.interval),u.fx.tick())}function Ke(){return a.setTimeout(function(){jr=void 0}),jr=Date.now()}function vt(y,S){var Z,re=0,de={height:y};for(S=S?1:0;re<4;re+=2-S)de["margin"+(Z=xn[re])]=de["padding"+Z]=y;return S&&(de.opacity=de.width=y),de}function Ft(y,S,Z){for(var re,de=(Xt.tweeners[S]||[]).concat(Xt.tweeners["*"]),fe=0,_e=de.length;fe<_e;fe++)if(re=de[fe].call(Z,S,y))return re}function Xt(y,S,Z){var re,de,fe=0,_e=Xt.prefilters.length,Me=u.Deferred().always(function(){delete Se.elem}),Se=function(){if(de)return!1;for(var mt=jr||Ke(),ut=Math.max(0,je.startTime+je.duration-mt),Lt=1-(ut/je.duration||0),kn=0,At=je.tweens.length;kn<At;kn++)je.tweens[kn].run(Lt);return Me.notifyWith(y,[je,Lt,ut]),Lt<1&&At?ut:(At||Me.notifyWith(y,[je,1,0]),Me.resolveWith(y,[je]),!1)},je=Me.promise({elem:y,props:u.extend({},S),opts:u.extend(!0,{specialEasing:{},easing:u.easing._default},Z),originalProperties:S,originalOptions:Z,startTime:jr||Ke(),duration:Z.duration,tweens:[],createTween:function(mt,ut){var Lt=u.Tween(y,je.opts,mt,ut,je.opts.specialEasing[mt]||je.opts.easing);return je.tweens.push(Lt),Lt},stop:function(mt){var ut=0,Lt=mt?je.tweens.length:0;if(de)return this;for(de=!0;ut<Lt;ut++)je.tweens[ut].run(1);return mt?(Me.notifyWith(y,[je,1,0]),Me.resolveWith(y,[je,mt])):Me.rejectWith(y,[je,mt]),this}}),rt=je.props;for(function(mt,ut){var Lt,kn,At,Hn,Zr;for(Lt in mt)if(At=ut[kn=rn(Lt)],Hn=mt[Lt],Array.isArray(Hn)&&(At=Hn[1],Hn=mt[Lt]=Hn[0]),Lt!==kn&&(mt[kn]=Hn,delete mt[Lt]),(Zr=u.cssHooks[kn])&&"expand"in Zr)for(Lt in Hn=Zr.expand(Hn),delete mt[kn],Hn)Lt in mt||(mt[Lt]=Hn[Lt],ut[Lt]=At);else ut[kn]=At}(rt,je.opts.specialEasing);fe<_e;fe++)if(re=Xt.prefilters[fe].call(je,y,rt,je.opts))return M(re.stop)&&(u._queueHooks(je.elem,je.opts.queue).stop=re.stop.bind(re)),re;return u.map(rt,Ft,je),M(je.opts.start)&&je.opts.start.call(y,je),je.progress(je.opts.progress).done(je.opts.done,je.opts.complete).fail(je.opts.fail).always(je.opts.always),u.fx.timer(u.extend(Se,{elem:y,anim:je,queue:je.opts.queue})),je}u.Animation=u.extend(Xt,{tweeners:{"*":[function(y,S){var Z=this.createTween(y,S);return Ue(Z.elem,y,qt.exec(S),Z),Z}]},tweener:function(y,S){M(y)?(S=y,y=["*"]):y=y.match(le);for(var Z,re=0,de=y.length;re<de;re++)Z=y[re],Xt.tweeners[Z]=Xt.tweeners[Z]||[],Xt.tweeners[Z].unshift(S)},prefilters:[function(y,S,Z){var re,de,fe,_e,Me,Se,je,rt,mt="width"in S||"height"in S,ut=this,Lt={},kn=y.style,At=y.nodeType&&ct(y),Hn=ze.get(y,"fxshow");for(re in Z.queue||((_e=u._queueHooks(y,"fx")).unqueued==null&&(_e.unqueued=0,Me=_e.empty.fire,_e.empty.fire=function(){_e.unqueued||Me()}),_e.unqueued++,ut.always(function(){ut.always(function(){_e.unqueued--,u.queue(y,"fx").length||_e.empty.fire()})})),S)if(de=S[re],Ce.test(de)){if(delete S[re],fe=fe||de==="toggle",de===(At?"hide":"show")){if(de!=="show"||!Hn||Hn[re]===void 0)continue;At=!0}Lt[re]=Hn&&Hn[re]||u.style(y,re)}if((Se=!u.isEmptyObject(S))||!u.isEmptyObject(Lt))for(re in mt&&y.nodeType===1&&(Z.overflow=[kn.overflow,kn.overflowX,kn.overflowY],(je=Hn&&Hn.display)==null&&(je=ze.get(y,"display")),(rt=u.css(y,"display"))==="none"&&(je?rt=je:($e([y],!0),je=y.style.display||je,rt=u.css(y,"display"),$e([y]))),(rt==="inline"||rt==="inline-block"&&je!=null)&&u.css(y,"float")==="none"&&(Se||(ut.done(function(){kn.display=je}),je==null&&(rt=kn.display,je=rt==="none"?"":rt)),kn.display="inline-block")),Z.overflow&&(kn.overflow="hidden",ut.always(function(){kn.overflow=Z.overflow[0],kn.overflowX=Z.overflow[1],kn.overflowY=Z.overflow[2]})),Se=!1,Lt)Se||(Hn?"hidden"in Hn&&(At=Hn.hidden):Hn=ze.access(y,"fxshow",{display:je}),fe&&(Hn.hidden=!At),At&&$e([y],!0),ut.done(function(){for(re in At||$e([y]),ze.remove(y,"fxshow"),Lt)u.style(y,re,Lt[re])})),Se=Ft(At?Hn[re]:0,re,ut),re in Hn||(Hn[re]=Se.start,At&&(Se.end=Se.start,Se.start=0))}],prefilter:function(y,S){S?Xt.prefilters.unshift(y):Xt.prefilters.push(y)}}),u.speed=function(y,S,Z){var re=y&&typeof y=="object"?u.extend({},y):{complete:Z||!Z&&S||M(y)&&y,duration:y,easing:Z&&S||S&&!M(S)&&S};return u.fx.off?re.duration=0:typeof re.duration!="number"&&(re.duration in u.fx.speeds?re.duration=u.fx.speeds[re.duration]:re.duration=u.fx.speeds._default),re.queue!=null&&re.queue!==!0||(re.queue="fx"),re.old=re.complete,re.complete=function(){M(re.old)&&re.old.call(this),re.queue&&u.dequeue(this,re.queue)},re},u.fn.extend({fadeTo:function(y,S,Z,re){return this.filter(ct).css("opacity",0).show().end().animate({opacity:S},y,Z,re)},animate:function(y,S,Z,re){var de=u.isEmptyObject(y),fe=u.speed(S,Z,re),_e=function(){var Me=Xt(this,u.extend({},y),fe);(de||ze.get(this,"finish"))&&Me.stop(!0)};return _e.finish=_e,de||fe.queue===!1?this.each(_e):this.queue(fe.queue,_e)},stop:function(y,S,Z){var re=function(de){var fe=de.stop;delete de.stop,fe(Z)};return typeof y!="string"&&(Z=S,S=y,y=void 0),S&&this.queue(y||"fx",[]),this.each(function(){var de=!0,fe=y!=null&&y+"queueHooks",_e=u.timers,Me=ze.get(this);if(fe)Me[fe]&&Me[fe].stop&&re(Me[fe]);else for(fe in Me)Me[fe]&&Me[fe].stop&&ue.test(fe)&&re(Me[fe]);for(fe=_e.length;fe--;)_e[fe].elem!==this||y!=null&&_e[fe].queue!==y||(_e[fe].anim.stop(Z),de=!1,_e.splice(fe,1));!de&&Z||u.dequeue(this,y)})},finish:function(y){return y!==!1&&(y=y||"fx"),this.each(function(){var S,Z=ze.get(this),re=Z[y+"queue"],de=Z[y+"queueHooks"],fe=u.timers,_e=re?re.length:0;for(Z.finish=!0,u.queue(this,y,[]),de&&de.stop&&de.stop.call(this,!0),S=fe.length;S--;)fe[S].elem===this&&fe[S].queue===y&&(fe[S].anim.stop(!0),fe.splice(S,1));for(S=0;S<_e;S++)re[S]&&re[S].finish&&re[S].finish.call(this);delete Z.finish})}}),u.each(["toggle","show","hide"],function(y,S){var Z=u.fn[S];u.fn[S]=function(re,de,fe){return re==null||typeof re=="boolean"?Z.apply(this,arguments):this.animate(vt(S,!0),re,de,fe)}}),u.each({slideDown:vt("show"),slideUp:vt("hide"),slideToggle:vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(y,S){u.fn[y]=function(Z,re,de){return this.animate(S,Z,re,de)}}),u.timers=[],u.fx.tick=function(){var y,S=0,Z=u.timers;for(jr=Date.now();S<Z.length;S++)(y=Z[S])()||Z[S]!==y||Z.splice(S--,1);Z.length||u.fx.stop(),jr=void 0},u.fx.timer=function(y){u.timers.push(y),u.fx.start()},u.fx.interval=13,u.fx.start=function(){K||(K=!0,Te())},u.fx.stop=function(){K=null},u.fx.speeds={slow:600,fast:200,_default:400},u.fn.delay=function(y,S){return y=u.fx&&u.fx.speeds[y]||y,S=S||"fx",this.queue(S,function(Z,re){var de=a.setTimeout(Z,y);re.stop=function(){a.clearTimeout(de)}})},function(){var y=F.createElement("input"),S=F.createElement("select").appendChild(F.createElement("option"));y.type="checkbox",R.checkOn=y.value!=="",R.optSelected=S.selected,(y=F.createElement("input")).value="t",y.type="radio",R.radioValue=y.value==="t"}();var In,Gn=u.expr.attrHandle;u.fn.extend({attr:function(y,S){return We(this,u.attr,y,S,arguments.length>1)},removeAttr:function(y){return this.each(function(){u.removeAttr(this,y)})}}),u.extend({attr:function(y,S,Z){var re,de,fe=y.nodeType;if(fe!==3&&fe!==8&&fe!==2)return y.getAttribute===void 0?u.prop(y,S,Z):(fe===1&&u.isXMLDoc(y)||(de=u.attrHooks[S.toLowerCase()]||(u.expr.match.bool.test(S)?In:void 0)),Z!==void 0?Z===null?void u.removeAttr(y,S):de&&"set"in de&&(re=de.set(y,Z,S))!==void 0?re:(y.setAttribute(S,Z+""),Z):de&&"get"in de&&(re=de.get(y,S))!==null?re:(re=u.find.attr(y,S))==null?void 0:re)},attrHooks:{type:{set:function(y,S){if(!R.radioValue&&S==="radio"&&m(y,"input")){var Z=y.value;return y.setAttribute("type",S),Z&&(y.value=Z),S}}}},removeAttr:function(y,S){var Z,re=0,de=S&&S.match(le);if(de&&y.nodeType===1)for(;Z=de[re++];)y.removeAttribute(Z)}}),In={set:function(y,S,Z){return S===!1?u.removeAttr(y,Z):y.setAttribute(Z,Z),Z}},u.each(u.expr.match.bool.source.match(/\w+/g),function(y,S){var Z=Gn[S]||u.find.attr;Gn[S]=function(re,de,fe){var _e,Me,Se=de.toLowerCase();return fe||(Me=Gn[Se],Gn[Se]=_e,_e=Z(re,de,fe)!=null?Se:null,Gn[Se]=Me),_e}});var or=/^(?:input|select|textarea|button)$/i,hi=/^(?:a|area)$/i;function ao(y){return(y.match(le)||[]).join(" ")}function Ci(y){return y.getAttribute&&y.getAttribute("class")||""}function vo(y){return Array.isArray(y)?y:typeof y=="string"&&y.match(le)||[]}u.fn.extend({prop:function(y,S){return We(this,u.prop,y,S,arguments.length>1)},removeProp:function(y){return this.each(function(){delete this[u.propFix[y]||y]})}}),u.extend({prop:function(y,S,Z){var re,de,fe=y.nodeType;if(fe!==3&&fe!==8&&fe!==2)return fe===1&&u.isXMLDoc(y)||(S=u.propFix[S]||S,de=u.propHooks[S]),Z!==void 0?de&&"set"in de&&(re=de.set(y,Z,S))!==void 0?re:y[S]=Z:de&&"get"in de&&(re=de.get(y,S))!==null?re:y[S]},propHooks:{tabIndex:{get:function(y){var S=u.find.attr(y,"tabindex");return S?parseInt(S,10):or.test(y.nodeName)||hi.test(y.nodeName)&&y.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),R.optSelected||(u.propHooks.selected={get:function(y){var S=y.parentNode;return S&&S.parentNode&&S.parentNode.selectedIndex,null},set:function(y){var S=y.parentNode;S&&(S.selectedIndex,S.parentNode&&S.parentNode.selectedIndex)}}),u.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){u.propFix[this.toLowerCase()]=this}),u.fn.extend({addClass:function(y){var S,Z,re,de,fe,_e;return M(y)?this.each(function(Me){u(this).addClass(y.call(this,Me,Ci(this)))}):(S=vo(y)).length?this.each(function(){if(re=Ci(this),Z=this.nodeType===1&&" "+ao(re)+" "){for(fe=0;fe<S.length;fe++)de=S[fe],Z.indexOf(" "+de+" ")<0&&(Z+=de+" ");_e=ao(Z),re!==_e&&this.setAttribute("class",_e)}}):this},removeClass:function(y){var S,Z,re,de,fe,_e;return M(y)?this.each(function(Me){u(this).removeClass(y.call(this,Me,Ci(this)))}):arguments.length?(S=vo(y)).length?this.each(function(){if(re=Ci(this),Z=this.nodeType===1&&" "+ao(re)+" "){for(fe=0;fe<S.length;fe++)for(de=S[fe];Z.indexOf(" "+de+" ")>-1;)Z=Z.replace(" "+de+" "," ");_e=ao(Z),re!==_e&&this.setAttribute("class",_e)}}):this:this.attr("class","")},toggleClass:function(y,S){var Z,re,de,fe,_e=typeof y,Me=_e==="string"||Array.isArray(y);return M(y)?this.each(function(Se){u(this).toggleClass(y.call(this,Se,Ci(this),S),S)}):typeof S=="boolean"&&Me?S?this.addClass(y):this.removeClass(y):(Z=vo(y),this.each(function(){if(Me)for(fe=u(this),de=0;de<Z.length;de++)re=Z[de],fe.hasClass(re)?fe.removeClass(re):fe.addClass(re);else y!==void 0&&_e!=="boolean"||((re=Ci(this))&&ze.set(this,"__className__",re),this.setAttribute&&this.setAttribute("class",re||y===!1?"":ze.get(this,"__className__")||""))}))},hasClass:function(y){var S,Z,re=0;for(S=" "+y+" ";Z=this[re++];)if(Z.nodeType===1&&(" "+ao(Ci(Z))+" ").indexOf(S)>-1)return!0;return!1}});var Co=/\r/g;u.fn.extend({val:function(y){var S,Z,re,de=this[0];return arguments.length?(re=M(y),this.each(function(fe){var _e;this.nodeType===1&&((_e=re?y.call(this,fe,u(this).val()):y)==null?_e="":typeof _e=="number"?_e+="":Array.isArray(_e)&&(_e=u.map(_e,function(Me){return Me==null?"":Me+""})),(S=u.valHooks[this.type]||u.valHooks[this.nodeName.toLowerCase()])&&"set"in S&&S.set(this,_e,"value")!==void 0||(this.value=_e))})):de?(S=u.valHooks[de.type]||u.valHooks[de.nodeName.toLowerCase()])&&"get"in S&&(Z=S.get(de,"value"))!==void 0?Z:typeof(Z=de.value)=="string"?Z.replace(Co,""):Z??"":void 0}}),u.extend({valHooks:{option:{get:function(y){var S=u.find.attr(y,"value");return S??ao(u.text(y))}},select:{get:function(y){var S,Z,re,de=y.options,fe=y.selectedIndex,_e=y.type==="select-one",Me=_e?null:[],Se=_e?fe+1:de.length;for(re=fe<0?Se:_e?fe:0;re<Se;re++)if(((Z=de[re]).selected||re===fe)&&!Z.disabled&&(!Z.parentNode.disabled||!m(Z.parentNode,"optgroup"))){if(S=u(Z).val(),_e)return S;Me.push(S)}return Me},set:function(y,S){for(var Z,re,de=y.options,fe=u.makeArray(S),_e=de.length;_e--;)((re=de[_e]).selected=u.inArray(u.valHooks.option.get(re),fe)>-1)&&(Z=!0);return Z||(y.selectedIndex=-1),fe}}}}),u.each(["radio","checkbox"],function(){u.valHooks[this]={set:function(y,S){if(Array.isArray(S))return y.checked=u.inArray(u(y).val(),S)>-1}},R.checkOn||(u.valHooks[this].get=function(y){return y.getAttribute("value")===null?"on":y.value})});var oo=a.location,Gs={guid:Date.now()},Wr=/\?/;u.parseXML=function(y){var S,Z;if(!y||typeof y!="string")return null;try{S=new a.DOMParser().parseFromString(y,"text/xml")}catch{}return Z=S&&S.getElementsByTagName("parsererror")[0],S&&!Z||u.error("Invalid XML: "+(Z?u.map(Z.childNodes,function(re){return re.textContent}).join(`
`):y)),S};var wa=/^(?:focusinfocus|focusoutblur)$/,Ia=function(y){y.stopPropagation()};u.extend(u.event,{trigger:function(y,S,Z,re){var de,fe,_e,Me,Se,je,rt,mt,ut=[Z||F],Lt=C.call(y,"type")?y.type:y,kn=C.call(y,"namespace")?y.namespace.split("."):[];if(fe=mt=_e=Z=Z||F,Z.nodeType!==3&&Z.nodeType!==8&&!wa.test(Lt+u.event.triggered)&&(Lt.indexOf(".")>-1&&(Lt=(kn=Lt.split(".")).shift(),kn.sort()),Se=Lt.indexOf(":")<0&&"on"+Lt,(y=y[u.expando]?y:new u.Event(Lt,typeof y=="object"&&y)).isTrigger=re?2:3,y.namespace=kn.join("."),y.rnamespace=y.namespace?new RegExp("(^|\\.)"+kn.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,y.result=void 0,y.target||(y.target=Z),S=S==null?[y]:u.makeArray(S,[y]),rt=u.event.special[Lt]||{},re||!rt.trigger||rt.trigger.apply(Z,S)!==!1)){if(!re&&!rt.noBubble&&!ee(Z)){for(Me=rt.delegateType||Lt,wa.test(Me+Lt)||(fe=fe.parentNode);fe;fe=fe.parentNode)ut.push(fe),_e=fe;_e===(Z.ownerDocument||F)&&ut.push(_e.defaultView||_e.parentWindow||a)}for(de=0;(fe=ut[de++])&&!y.isPropagationStopped();)mt=fe,y.type=de>1?Me:rt.bindType||Lt,(je=(ze.get(fe,"events")||Object.create(null))[y.type]&&ze.get(fe,"handle"))&&je.apply(fe,S),(je=Se&&fe[Se])&&je.apply&&Xn(fe)&&(y.result=je.apply(fe,S),y.result===!1&&y.preventDefault());return y.type=Lt,re||y.isDefaultPrevented()||rt._default&&rt._default.apply(ut.pop(),S)!==!1||!Xn(Z)||Se&&M(Z[Lt])&&!ee(Z)&&((_e=Z[Se])&&(Z[Se]=null),u.event.triggered=Lt,y.isPropagationStopped()&&mt.addEventListener(Lt,Ia),Z[Lt](),y.isPropagationStopped()&&mt.removeEventListener(Lt,Ia),u.event.triggered=void 0,_e&&(Z[Se]=_e)),y.result}},simulate:function(y,S,Z){var re=u.extend(new u.Event,Z,{type:y,isSimulated:!0});u.event.trigger(re,null,S)}}),u.fn.extend({trigger:function(y,S){return this.each(function(){u.event.trigger(y,S,this)})},triggerHandler:function(y,S){var Z=this[0];if(Z)return u.event.trigger(y,S,Z,!0)}});var ea=/\[\]$/,Vo=/\r?\n/g,xs=/^(?:submit|button|image|reset|file)$/i,vr=/^(?:input|select|textarea|keygen)/i;function zt(y,S,Z,re){var de;if(Array.isArray(S))u.each(S,function(fe,_e){Z||ea.test(y)?re(y,_e):zt(y+"["+(typeof _e=="object"&&_e!=null?fe:"")+"]",_e,Z,re)});else if(Z||T(S)!=="object")re(y,S);else for(de in S)zt(y+"["+de+"]",S[de],Z,re)}u.param=function(y,S){var Z,re=[],de=function(fe,_e){var Me=M(_e)?_e():_e;re[re.length]=encodeURIComponent(fe)+"="+encodeURIComponent(Me??"")};if(y==null)return"";if(Array.isArray(y)||y.jquery&&!u.isPlainObject(y))u.each(y,function(){de(this.name,this.value)});else for(Z in y)zt(Z,y[Z],S,de);return re.join("&")},u.fn.extend({serialize:function(){return u.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var y=u.prop(this,"elements");return y?u.makeArray(y):this}).filter(function(){var y=this.type;return this.name&&!u(this).is(":disabled")&&vr.test(this.nodeName)&&!xs.test(y)&&(this.checked||!an.test(y))}).map(function(y,S){var Z=u(this).val();return Z==null?null:Array.isArray(Z)?u.map(Z,function(re){return{name:S.name,value:re.replace(Vo,`\r
`)}}):{name:S.name,value:Z.replace(Vo,`\r
`)}}).get()}});var Si=/%20/g,Go=/#.*$/,lu=/([?&])_=[^&]*/,Yr=/^(.*?):[ \t]*([^\r\n]*)$/gm,Jr=/^(?:GET|HEAD)$/,qi=/^\/\//,zs={},Bi={},ws="*/".concat("*"),Us=F.createElement("a");function Oe(y){return function(S,Z){typeof S!="string"&&(Z=S,S="*");var re,de=0,fe=S.toLowerCase().match(le)||[];if(M(Z))for(;re=fe[de++];)re[0]==="+"?(re=re.slice(1)||"*",(y[re]=y[re]||[]).unshift(Z)):(y[re]=y[re]||[]).push(Z)}}function So(y,S,Z,re){var de={},fe=y===Bi;function _e(Me){var Se;return de[Me]=!0,u.each(y[Me]||[],function(je,rt){var mt=rt(S,Z,re);return typeof mt!="string"||fe||de[mt]?fe?!(Se=mt):void 0:(S.dataTypes.unshift(mt),_e(mt),!1)}),Se}return _e(S.dataTypes[0])||!de["*"]&&_e("*")}function ta(y,S){var Z,re,de=u.ajaxSettings.flatOptions||{};for(Z in S)S[Z]!==void 0&&((de[Z]?y:re||(re={}))[Z]=S[Z]);return re&&u.extend(!0,y,re),y}Us.href=oo.href,u.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oo.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(oo.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ws,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(y,S){return S?ta(ta(y,u.ajaxSettings),S):ta(u.ajaxSettings,y)},ajaxPrefilter:Oe(zs),ajaxTransport:Oe(Bi),ajax:function(y,S){typeof y=="object"&&(S=y,y=void 0),S=S||{};var Z,re,de,fe,_e,Me,Se,je,rt,mt,ut=u.ajaxSetup({},S),Lt=ut.context||ut,kn=ut.context&&(Lt.nodeType||Lt.jquery)?u(Lt):u.event,At=u.Deferred(),Hn=u.Callbacks("once memory"),Zr=ut.statusCode||{},Fr={},la={},Ma="canceled",dr={readyState:0,getResponseHeader:function(xr){var Wn;if(Se){if(!fe)for(fe={};Wn=Yr.exec(de);)fe[Wn[1].toLowerCase()+" "]=(fe[Wn[1].toLowerCase()+" "]||[]).concat(Wn[2]);Wn=fe[xr.toLowerCase()+" "]}return Wn==null?null:Wn.join(", ")},getAllResponseHeaders:function(){return Se?de:null},setRequestHeader:function(xr,Wn){return Se==null&&(xr=la[xr.toLowerCase()]=la[xr.toLowerCase()]||xr,Fr[xr]=Wn),this},overrideMimeType:function(xr){return Se==null&&(ut.mimeType=xr),this},statusCode:function(xr){var Wn;if(xr)if(Se)dr.always(xr[dr.status]);else for(Wn in xr)Zr[Wn]=[Zr[Wn],xr[Wn]];return this},abort:function(xr){var Wn=xr||Ma;return Z&&Z.abort(Wn),_a(0,Wn),this}};if(At.promise(dr),ut.url=((y||ut.url||oo.href)+"").replace(qi,oo.protocol+"//"),ut.type=S.method||S.type||ut.method||ut.type,ut.dataTypes=(ut.dataType||"*").toLowerCase().match(le)||[""],ut.crossDomain==null){Me=F.createElement("a");try{Me.href=ut.url,Me.href=Me.href,ut.crossDomain=Us.protocol+"//"+Us.host!=Me.protocol+"//"+Me.host}catch{ut.crossDomain=!0}}if(ut.data&&ut.processData&&typeof ut.data!="string"&&(ut.data=u.param(ut.data,ut.traditional)),So(zs,ut,S,dr),Se)return dr;for(rt in(je=u.event&&ut.global)&&u.active++==0&&u.event.trigger("ajaxStart"),ut.type=ut.type.toUpperCase(),ut.hasContent=!Jr.test(ut.type),re=ut.url.replace(Go,""),ut.hasContent?ut.data&&ut.processData&&(ut.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(ut.data=ut.data.replace(Si,"+")):(mt=ut.url.slice(re.length),ut.data&&(ut.processData||typeof ut.data=="string")&&(re+=(Wr.test(re)?"&":"?")+ut.data,delete ut.data),ut.cache===!1&&(re=re.replace(lu,"$1"),mt=(Wr.test(re)?"&":"?")+"_="+Gs.guid+++mt),ut.url=re+mt),ut.ifModified&&(u.lastModified[re]&&dr.setRequestHeader("If-Modified-Since",u.lastModified[re]),u.etag[re]&&dr.setRequestHeader("If-None-Match",u.etag[re])),(ut.data&&ut.hasContent&&ut.contentType!==!1||S.contentType)&&dr.setRequestHeader("Content-Type",ut.contentType),dr.setRequestHeader("Accept",ut.dataTypes[0]&&ut.accepts[ut.dataTypes[0]]?ut.accepts[ut.dataTypes[0]]+(ut.dataTypes[0]!=="*"?", "+ws+"; q=0.01":""):ut.accepts["*"]),ut.headers)dr.setRequestHeader(rt,ut.headers[rt]);if(ut.beforeSend&&(ut.beforeSend.call(Lt,dr,ut)===!1||Se))return dr.abort();if(Ma="abort",Hn.add(ut.complete),dr.done(ut.success),dr.fail(ut.error),Z=So(Bi,ut,S,dr)){if(dr.readyState=1,je&&kn.trigger("ajaxSend",[dr,ut]),Se)return dr;ut.async&&ut.timeout>0&&(_e=a.setTimeout(function(){dr.abort("timeout")},ut.timeout));try{Se=!1,Z.send(Fr,_a)}catch(xr){if(Se)throw xr;_a(-1,xr)}}else _a(-1,"No Transport");function _a(xr,Wn,so,zo){var ca,Uo,Ta,Xi,lo,Fi=Wn;Se||(Se=!0,_e&&a.clearTimeout(_e),Z=void 0,de=zo||"",dr.readyState=xr>0?4:0,ca=xr>=200&&xr<300||xr===304,so&&(Xi=function(Kr,$r,Oi){for(var Ua,wi,Jn,li,ni=Kr.contents,Ar=Kr.dataTypes;Ar[0]==="*";)Ar.shift(),Ua===void 0&&(Ua=Kr.mimeType||$r.getResponseHeader("Content-Type"));if(Ua){for(wi in ni)if(ni[wi]&&ni[wi].test(Ua)){Ar.unshift(wi);break}}if(Ar[0]in Oi)Jn=Ar[0];else{for(wi in Oi){if(!Ar[0]||Kr.converters[wi+" "+Ar[0]]){Jn=wi;break}li||(li=wi)}Jn=Jn||li}if(Jn)return Jn!==Ar[0]&&Ar.unshift(Jn),Oi[Jn]}(ut,dr,so)),!ca&&u.inArray("script",ut.dataTypes)>-1&&u.inArray("json",ut.dataTypes)<0&&(ut.converters["text script"]=function(){}),Xi=function(Kr,$r,Oi,Ua){var wi,Jn,li,ni,Ar,Ca={},Ms=Kr.dataTypes.slice();if(Ms[1])for(li in Kr.converters)Ca[li.toLowerCase()]=Kr.converters[li];for(Jn=Ms.shift();Jn;)if(Kr.responseFields[Jn]&&(Oi[Kr.responseFields[Jn]]=$r),!Ar&&Ua&&Kr.dataFilter&&($r=Kr.dataFilter($r,Kr.dataType)),Ar=Jn,Jn=Ms.shift()){if(Jn==="*")Jn=Ar;else if(Ar!=="*"&&Ar!==Jn){if(!(li=Ca[Ar+" "+Jn]||Ca["* "+Jn])){for(wi in Ca)if((ni=wi.split(" "))[1]===Jn&&(li=Ca[Ar+" "+ni[0]]||Ca["* "+ni[0]])){li===!0?li=Ca[wi]:Ca[wi]!==!0&&(Jn=ni[0],Ms.unshift(ni[1]));break}}if(li!==!0)if(li&&Kr.throws)$r=li($r);else try{$r=li($r)}catch(Tl){return{state:"parsererror",error:li?Tl:"No conversion from "+Ar+" to "+Jn}}}}return{state:"success",data:$r}}(ut,Xi,dr,ca),ca?(ut.ifModified&&((lo=dr.getResponseHeader("Last-Modified"))&&(u.lastModified[re]=lo),(lo=dr.getResponseHeader("etag"))&&(u.etag[re]=lo)),xr===204||ut.type==="HEAD"?Fi="nocontent":xr===304?Fi="notmodified":(Fi=Xi.state,Uo=Xi.data,ca=!(Ta=Xi.error))):(Ta=Fi,!xr&&Fi||(Fi="error",xr<0&&(xr=0))),dr.status=xr,dr.statusText=(Wn||Fi)+"",ca?At.resolveWith(Lt,[Uo,Fi,dr]):At.rejectWith(Lt,[dr,Fi,Ta]),dr.statusCode(Zr),Zr=void 0,je&&kn.trigger(ca?"ajaxSuccess":"ajaxError",[dr,ut,ca?Uo:Ta]),Hn.fireWith(Lt,[dr,Fi]),je&&(kn.trigger("ajaxComplete",[dr,ut]),--u.active||u.event.trigger("ajaxStop")))}return dr},getJSON:function(y,S,Z){return u.get(y,S,Z,"json")},getScript:function(y,S){return u.get(y,void 0,S,"script")}}),u.each(["get","post"],function(y,S){u[S]=function(Z,re,de,fe){return M(re)&&(fe=fe||de,de=re,re=void 0),u.ajax(u.extend({url:Z,type:S,dataType:fe,data:re,success:de},u.isPlainObject(Z)&&Z))}}),u.ajaxPrefilter(function(y){var S;for(S in y.headers)S.toLowerCase()==="content-type"&&(y.contentType=y.headers[S]||"")}),u._evalUrl=function(y,S,Z){return u.ajax({url:y,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(re){u.globalEval(re,S,Z)}})},u.fn.extend({wrapAll:function(y){var S;return this[0]&&(M(y)&&(y=y.call(this[0])),S=u(y,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&S.insertBefore(this[0]),S.map(function(){for(var Z=this;Z.firstElementChild;)Z=Z.firstElementChild;return Z}).append(this)),this},wrapInner:function(y){return M(y)?this.each(function(S){u(this).wrapInner(y.call(this,S))}):this.each(function(){var S=u(this),Z=S.contents();Z.length?Z.wrapAll(y):S.append(y)})},wrap:function(y){var S=M(y);return this.each(function(Z){u(this).wrapAll(S?y.call(this,Z):y)})},unwrap:function(y){return this.parent(y).not("body").each(function(){u(this).replaceWith(this.childNodes)}),this}}),u.expr.pseudos.hidden=function(y){return!u.expr.pseudos.visible(y)},u.expr.pseudos.visible=function(y){return!!(y.offsetWidth||y.offsetHeight||y.getClientRects().length)},u.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch{}};var cu={0:200,1223:204},bs=u.ajaxSettings.xhr();R.cors=!!bs&&"withCredentials"in bs,R.ajax=bs=!!bs,u.ajaxTransport(function(y){var S,Z;if(R.cors||bs&&!y.crossDomain)return{send:function(re,de){var fe,_e=y.xhr();if(_e.open(y.type,y.url,y.async,y.username,y.password),y.xhrFields)for(fe in y.xhrFields)_e[fe]=y.xhrFields[fe];for(fe in y.mimeType&&_e.overrideMimeType&&_e.overrideMimeType(y.mimeType),y.crossDomain||re["X-Requested-With"]||(re["X-Requested-With"]="XMLHttpRequest"),re)_e.setRequestHeader(fe,re[fe]);S=function(Me){return function(){S&&(S=Z=_e.onload=_e.onerror=_e.onabort=_e.ontimeout=_e.onreadystatechange=null,Me==="abort"?_e.abort():Me==="error"?typeof _e.status!="number"?de(0,"error"):de(_e.status,_e.statusText):de(cu[_e.status]||_e.status,_e.statusText,(_e.responseType||"text")!=="text"||typeof _e.responseText!="string"?{binary:_e.response}:{text:_e.responseText},_e.getAllResponseHeaders()))}},_e.onload=S(),Z=_e.onerror=_e.ontimeout=S("error"),_e.onabort!==void 0?_e.onabort=Z:_e.onreadystatechange=function(){_e.readyState===4&&a.setTimeout(function(){S&&Z()})},S=S("abort");try{_e.send(y.hasContent&&y.data||null)}catch(Me){if(S)throw Me}},abort:function(){S&&S()}}}),u.ajaxPrefilter(function(y){y.crossDomain&&(y.contents.script=!1)}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(y){return u.globalEval(y),y}}}),u.ajaxPrefilter("script",function(y){y.cache===void 0&&(y.cache=!1),y.crossDomain&&(y.type="GET")}),u.ajaxTransport("script",function(y){var S,Z;if(y.crossDomain||y.scriptAttrs)return{send:function(re,de){S=u("<script>").attr(y.scriptAttrs||{}).prop({charset:y.scriptCharset,src:y.url}).on("load error",Z=function(fe){S.remove(),Z=null,fe&&de(fe.type==="error"?404:200,fe.type)}),F.head.appendChild(S[0])},abort:function(){Z&&Z()}}});var Do,Hs=[],ba=/(=)\?(?=&|$)|\?\?/;u.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var y=Hs.pop()||u.expando+"_"+Gs.guid++;return this[y]=!0,y}}),u.ajaxPrefilter("json jsonp",function(y,S,Z){var re,de,fe,_e=y.jsonp!==!1&&(ba.test(y.url)?"url":typeof y.data=="string"&&(y.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ba.test(y.data)&&"data");if(_e||y.dataTypes[0]==="jsonp")return re=y.jsonpCallback=M(y.jsonpCallback)?y.jsonpCallback():y.jsonpCallback,_e?y[_e]=y[_e].replace(ba,"$1"+re):y.jsonp!==!1&&(y.url+=(Wr.test(y.url)?"&":"?")+y.jsonp+"="+re),y.converters["script json"]=function(){return fe||u.error(re+" was not called"),fe[0]},y.dataTypes[0]="json",de=a[re],a[re]=function(){fe=arguments},Z.always(function(){de===void 0?u(a).removeProp(re):a[re]=de,y[re]&&(y.jsonpCallback=S.jsonpCallback,Hs.push(re)),fe&&M(de)&&de(fe[0]),fe=de=void 0}),"script"}),R.createHTMLDocument=((Do=F.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",Do.childNodes.length===2),u.parseHTML=function(y,S,Z){return typeof y!="string"?[]:(typeof S=="boolean"&&(Z=S,S=!1),S||(R.createHTMLDocument?((re=(S=F.implementation.createHTMLDocument("")).createElement("base")).href=F.location.href,S.head.appendChild(re)):S=F),fe=!Z&&[],(de=ge.exec(y))?[S.createElement(de[1])]:(de=Qi([y],S,fe),fe&&fe.length&&u(fe).remove(),u.merge([],de.childNodes)));var re,de,fe},u.fn.load=function(y,S,Z){var re,de,fe,_e=this,Me=y.indexOf(" ");return Me>-1&&(re=ao(y.slice(Me)),y=y.slice(0,Me)),M(S)?(Z=S,S=void 0):S&&typeof S=="object"&&(de="POST"),_e.length>0&&u.ajax({url:y,type:de||"GET",dataType:"html",data:S}).done(function(Se){fe=arguments,_e.html(re?u("<div>").append(u.parseHTML(Se)).find(re):Se)}).always(Z&&function(Se,je){_e.each(function(){Z.apply(this,fe||[Se.responseText,je,Se])})}),this},u.expr.pseudos.animated=function(y){return u.grep(u.timers,function(S){return y===S.elem}).length},u.offset={setOffset:function(y,S,Z){var re,de,fe,_e,Me,Se,je=u.css(y,"position"),rt=u(y),mt={};je==="static"&&(y.style.position="relative"),Me=rt.offset(),fe=u.css(y,"top"),Se=u.css(y,"left"),(je==="absolute"||je==="fixed")&&(fe+Se).indexOf("auto")>-1?(_e=(re=rt.position()).top,de=re.left):(_e=parseFloat(fe)||0,de=parseFloat(Se)||0),M(S)&&(S=S.call(y,Z,u.extend({},Me))),S.top!=null&&(mt.top=S.top-Me.top+_e),S.left!=null&&(mt.left=S.left-Me.left+de),"using"in S?S.using.call(y,mt):rt.css(mt)}},u.fn.extend({offset:function(y){if(arguments.length)return y===void 0?this:this.each(function(de){u.offset.setOffset(this,y,de)});var S,Z,re=this[0];return re?re.getClientRects().length?(S=re.getBoundingClientRect(),Z=re.ownerDocument.defaultView,{top:S.top+Z.pageYOffset,left:S.left+Z.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var y,S,Z,re=this[0],de={top:0,left:0};if(u.css(re,"position")==="fixed")S=re.getBoundingClientRect();else{for(S=this.offset(),Z=re.ownerDocument,y=re.offsetParent||Z.documentElement;y&&(y===Z.body||y===Z.documentElement)&&u.css(y,"position")==="static";)y=y.parentNode;y&&y!==re&&y.nodeType===1&&((de=u(y).offset()).top+=u.css(y,"borderTopWidth",!0),de.left+=u.css(y,"borderLeftWidth",!0))}return{top:S.top-de.top-u.css(re,"marginTop",!0),left:S.left-de.left-u.css(re,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var y=this.offsetParent;y&&u.css(y,"position")==="static";)y=y.offsetParent;return y||nn})}}),u.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(y,S){var Z=S==="pageYOffset";u.fn[y]=function(re){return We(this,function(de,fe,_e){var Me;if(ee(de)?Me=de:de.nodeType===9&&(Me=de.defaultView),_e===void 0)return Me?Me[S]:de[fe];Me?Me.scrollTo(Z?Me.pageXOffset:_e,Z?_e:Me.pageYOffset):de[fe]=_e},y,re,arguments.length)}}),u.each(["top","left"],function(y,S){u.cssHooks[S]=gs(R.pixelPosition,function(Z,re){if(re)return re=no(Z,S),sa.test(re)?u(Z).position()[S]+"px":re})}),u.each({Height:"height",Width:"width"},function(y,S){u.each({padding:"inner"+y,content:S,"":"outer"+y},function(Z,re){u.fn[re]=function(de,fe){var _e=arguments.length&&(Z||typeof de!="boolean"),Me=Z||(de===!0||fe===!0?"margin":"border");return We(this,function(Se,je,rt){var mt;return ee(Se)?re.indexOf("outer")===0?Se["inner"+y]:Se.document.documentElement["client"+y]:Se.nodeType===9?(mt=Se.documentElement,Math.max(Se.body["scroll"+y],mt["scroll"+y],Se.body["offset"+y],mt["offset"+y],mt["client"+y])):rt===void 0?u.css(Se,je,Me):u.style(Se,je,rt,Me)},S,_e?de:void 0,_e)}})}),u.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(y,S){u.fn[S]=function(Z){return this.on(S,Z)}}),u.fn.extend({bind:function(y,S,Z){return this.on(y,null,S,Z)},unbind:function(y,S){return this.off(y,null,S)},delegate:function(y,S,Z,re){return this.on(S,y,Z,re)},undelegate:function(y,S,Z){return arguments.length===1?this.off(y,"**"):this.off(S,y||"**",Z)},hover:function(y,S){return this.mouseenter(y).mouseleave(S||y)}}),u.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(y,S){u.fn[S]=function(Z,re){return arguments.length>0?this.on(S,null,Z,re):this.trigger(S)}});var fr=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;u.proxy=function(y,S){var Z,re,de;if(typeof S=="string"&&(Z=y[S],S=y,y=Z),M(y))return re=L.call(arguments,2),(de=function(){return y.apply(S||this,re.concat(L.call(arguments)))}).guid=y.guid=y.guid||u.guid++,de},u.holdReady=function(y){y?u.readyWait++:u.ready(!0)},u.isArray=Array.isArray,u.parseJSON=JSON.parse,u.nodeName=m,u.isFunction=M,u.isWindow=ee,u.camelCase=rn,u.type=T,u.now=Date.now,u.isNumeric=function(y){var S=u.type(y);return(S==="number"||S==="string")&&!isNaN(y-parseFloat(y))},u.trim=function(y){return y==null?"":(y+"").replace(fr,"$1")};var _l=a.jQuery,ac=a.$;return u.noConflict=function(y){return a.$===u&&(a.$=ac),y&&a.jQuery===u&&(a.jQuery=_l),u},v===void 0&&(a.jQuery=a.$=u),u},b.exports=r.document?o(r,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return o(a)}}),jquery$1=Object.freeze({__proto__:null,default:jquery,__moduleExports:jquery});function mxcadassemblyinit(){var b,r=(b=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(b=b||__filename),function(o){var a,v,h;o=o||{},a||(a=o!==void 0?o:{}),a.ready=new Promise(function($e,Rt){v=$e,h=Rt});var w,L,G,k,D,f,O=Object.assign({},a),C=typeof window=="object",j=typeof importScripts=="function",V=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",R="";V?(R=j?xxxxx("path").dirname(R)+"/":__dirname+"/",f=()=>{D||(k=xxxxx("fs"),D=xxxxx("path"))},w=function($e,Rt){var $t=Ge($e);return $t?Rt?$t:$t.toString():(f(),$e=D.normalize($e),k.readFileSync($e,Rt?void 0:"utf8"))},G=$e=>(($e=w($e,!0)).buffer||($e=new Uint8Array($e)),$e),L=($e,Rt,$t)=>{var an=Ge($e);an&&Rt(an),f(),$e=D.normalize($e),k.readFile($e,function(hr,_r){hr?$t(hr):Rt(_r.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function($e){throw $e}),process.on("unhandledRejection",function($e){throw $e}),a.inspect=function(){return"[Emscripten Module object]"}):(C||j)&&(j?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),b&&(R=b),R=R.indexOf("blob:")!==0?R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w=$e=>{try{var Rt=new XMLHttpRequest;return Rt.open("GET",$e,!1),Rt.send(null),Rt.responseText}catch(hr){if($e=Ge($e)){Rt=[];for(var $t=0;$t<$e.length;$t++){var an=$e[$t];255<an&&(an&=255),Rt.push(String.fromCharCode(an))}return Rt.join("")}throw hr}},j&&(G=$e=>{try{var Rt=new XMLHttpRequest;return Rt.open("GET",$e,!1),Rt.responseType="arraybuffer",Rt.send(null),new Uint8Array(Rt.response)}catch($t){if($e=Ge($e))return $e;throw $t}}),L=($e,Rt,$t)=>{var an=new XMLHttpRequest;an.open("GET",$e,!0),an.responseType="arraybuffer",an.onload=()=>{if(an.status==200||an.status==0&&an.response)Rt(an.response);else{var hr=Ge($e);hr?Rt(hr.buffer):$t()}},an.onerror=$t,an.send(null)}),a.print||console.log.bind(console);var M,ee=a.printErr||console.warn.bind(console);Object.assign(a,O),O=null,a.wasmBinary&&(M=a.wasmBinary),a.noExitRuntime;var F=Error,_={};M=[],typeof _!="object"&&Ie("no native wasm support detected");var J,T,B,N,u,c=!1,m=a.INITIAL_MEMORY||16777216;(J=a.wasmMemory?a.wasmMemory:new function(){this.buffer=new ArrayBuffer(m/65536*65536)})&&(T=J.buffer),m=T.byteLength;var E=T;T=E,a.HEAP8=B=new Int8Array(E),a.HEAP16=new Int16Array(E),a.HEAP32=u=new Int32Array(E),a.HEAPU8=N=new Uint8Array(E),a.HEAPU16=new Uint16Array(E),a.HEAPU32=new Uint32Array(E),a.HEAPF32=new Float32Array(E),a.HEAPF64=new Float64Array(E);var U,X=[],W=[],te=[];function ne(){var $e=a.preRun.shift();X.unshift($e)}var ce=0,we=null;function Ie($e){throw a.onAbort&&a.onAbort($e),ee($e="Aborted("+$e+")"),c=!0,$e=new F($e+". Build with -s ASSERTIONS=1 for more info."),h($e),$e}a.preloadedImages={},a.preloadedAudios={};var xe,Be="data:application/octet-stream;base64,";if(!(xe="mxcadassembly_min.wasm").startsWith(Be)){var q=xe;xe=a.locateFile?a.locateFile(q,R):R+q}function ge(){var $e=xe;try{if($e==xe&&M)return new Uint8Array(M);var Rt=Ge($e);if(Rt)return Rt;if(G)return G($e);throw"both async and sync fetching of the wasm failed"}catch($t){Ie($t)}}function oe($e){for(;0<$e.length;){var Rt=$e.shift();if(typeof Rt=="function")Rt(a);else{var $t=Rt.U;typeof $t=="number"?Rt.G===void 0?Ae($t)():Ae($t)(Rt.G):$t(Rt.G===void 0?null:Rt.G)}}}var se=[];function Ae($e){var Rt=se[$e];return Rt||($e>=se.length&&(se.length=$e+1),se[$e]=Rt=U.get($e)),Rt}var Ye=typeof atob=="function"?atob:function($e){var Rt="",$t=0;$e=$e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var an="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($e.charAt($t++)),hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($e.charAt($t++)),_r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($e.charAt($t++)),qr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf($e.charAt($t++));an=an<<2|hr>>4,hr=(15&hr)<<4|_r>>2;var Ur=(3&_r)<<6|qr;Rt+=String.fromCharCode(an),_r!==64&&(Rt+=String.fromCharCode(hr)),qr!==64&&(Rt+=String.fromCharCode(Ur))}while($t<$e.length);return Rt};function Ge($e){if($e.startsWith(Be)){if($e=$e.slice(Be.length),typeof V=="boolean"&&V){var Rt=Buffer.from($e,"base64");Rt=new Uint8Array(Rt.buffer,Rt.byteOffset,Rt.byteLength)}else try{var $t=Ye($e),an=new Uint8Array($t.length);for($e=0;$e<$t.length;++$e)an[$e]=$t.charCodeAt($e);Rt=an}catch{throw Error("Converting base64 string to bytes failed.")}return Rt}}var Ne={f:function($e){return qt($e+16)+16},e:function($e,Rt,$t){throw new function(an){this.C=an-16,this.P=function(hr){u[this.C+4>>2]=hr},this.M=function(hr){u[this.C+8>>2]=hr},this.N=function(){u[this.C>>2]=0},this.L=function(){B[this.C+12>>0]=0},this.O=function(){B[this.C+13>>0]=0},this.K=function(hr,_r){this.P(hr),this.M(_r),this.N(),this.L(),this.O()}}($e).K(Rt,$t),$e},c:function(){Ie("")},d:function($e,Rt,$t){N.copyWithin($e,Rt,Rt+$t)},b:function(){Ie("OOM")},a:J};(function(){function $e(hr){a.asm=hr.exports,U=a.asm.A,W.unshift(a.asm.g),ce--,a.monitorRunDependencies&&a.monitorRunDependencies(ce),ce==0&&we&&(hr=we,we=null,hr())}function Rt(hr){$e(hr.instance)}function $t(hr){return function(){if(!M&&(C||j)){if(typeof fetch=="function"&&!xe.startsWith("file://"))return fetch(xe,{credentials:"same-origin"}).then(function(_r){if(!_r.ok)throw"failed to load wasm binary file at '"+xe+"'";return _r.arrayBuffer()}).catch(function(){return ge()});if(L)return new Promise(function(_r,qr){L(xe,function(Ur){_r(new Uint8Array(Ur))},qr)})}return Promise.resolve().then(function(){return ge()})}().then(function(){return{then:function(_r){_r({instance:new function(){this.exports=function(qr){for(var Ur,Gr=new Uint8Array(123),Or=25;Or>=0;--Or)Gr[48+Or]=52+Or,Gr[65+Or]=Or,Gr[97+Or]=26+Or;function Qi(Pi,si,gr){for(var Wi,H,Hr=0,Da=si,$n=gr.length,oa=si+(3*$n>>2)-(gr[$n-2]=="=")-(gr[$n-1]=="=");Hr<$n;Hr+=4)Wi=Gr[gr.charCodeAt(Hr+1)],H=Gr[gr.charCodeAt(Hr+2)],Pi[Da++]=Gr[gr.charCodeAt(Hr)]<<2|Wi>>4,Da<oa&&(Pi[Da++]=Wi<<4|H>>2),Da<oa&&(Pi[Da++]=H<<6|Gr[gr.charCodeAt(Hr+3)])}return Gr[43]=62,Gr[47]=63,function(Pi){var si=Pi.a.buffer,gr=new Int8Array(si),Wi=new Int16Array(si),H=new Int32Array(si),Hr=new Uint8Array(si),Da=new Uint32Array(si),$n=new Float64Array(si),oa=Math.imul,No=Pi.abort,Fs=Pi.b,es=Pi.c,fs=Pi.d,to=Pi.e,ts=Pi.f,sa=5245008;function Bo(K){var Ce,ue=0,Te=0,Ke=0,vt=0,Ft=0,Xt=0,In=0,Gn=0,or=0,hi=0;sa=Ce=sa-16|0;e:{t:{n:{a:{i:{l:{r:{c:{u:{s:{o:{if((K|=0)>>>0<=244){if(3&(ue=(vt=H[404])>>>(Te=(Xt=K>>>0<11?16:K+11&-8)>>>3|0)|0)){K=(Ft=H[1664+(ue=(Ke=Te+(1&(-1^ue))|0)<<3)>>2])+8|0,(0|(Te=H[Ft+8>>2]))!=(0|(ue=ue+1656|0))?(H[Te+12>>2]=ue,H[ue+8>>2]=Te):H[404]=Sr(Ke)&vt,ue=Ke<<3,H[Ft+4>>2]=3|ue,H[4+(ue=ue+Ft|0)>>2]=1|H[ue+4>>2];break e}if((hi=H[406])>>>0>=Xt>>>0)break o;if(ue){Te=K=(ue=(0-(K=(0-(K=2<<Te)|K)&ue<<Te)&K)-1|0)>>>12&16,Te|=K=(ue=ue>>>K|0)>>>5&8,Te|=K=(ue=ue>>>K|0)>>>2&4,or=H[1664+(K=(Te=((Te|=K=(ue=ue>>>K|0)>>>1&2)|(K=(ue=ue>>>K|0)>>>1&1))+(ue>>>K|0)|0)<<3)>>2],(0|(ue=H[or+8>>2]))!=(0|(K=K+1656|0))?(H[ue+12>>2]=K,H[K+8>>2]=ue):(vt=Sr(Te)&vt,H[404]=vt),K=or+8|0,H[or+4>>2]=3|Xt,Ft=(ue=Te<<3)-Xt|0,H[4+(Ke=Xt+or|0)>>2]=1|Ft,H[ue+or>>2]=Ft,hi&&(Te=1656+((ue=hi>>>3|0)<<3)|0,or=H[409],(ue=1<<ue)&vt?ue=H[Te+8>>2]:(H[404]=ue|vt,ue=Te),H[Te+8>>2]=or,H[ue+12>>2]=or,H[or+12>>2]=Te,H[or+8>>2]=ue),H[409]=Ke,H[406]=Ft;break e}if(!(In=H[405]))break o;for(Te=K=(ue=(0-In&In)-1|0)>>>12&16,Te|=K=(ue=ue>>>K|0)>>>5&8,Te|=K=(ue=ue>>>K|0)>>>2&4,ue=H[1920+(((Te|=K=(ue=ue>>>K|0)>>>1&2)|(K=(ue=ue>>>K|0)>>>1&1))+(ue>>>K|0)<<2)>>2],Ke=(-8&H[ue+4>>2])-Xt|0,Te=ue;(K=H[Te+16>>2])||(K=H[Te+20>>2]);)Ke=(Ft=(Te=(-8&H[K+4>>2])-Xt|0)>>>0<Ke>>>0)?Te:Ke,ue=Ft?K:ue,Te=K;if(Gn=H[ue+24>>2],(0|(Ft=H[ue+12>>2]))!=(0|ue)){K=H[ue+8>>2],H[K+12>>2]=Ft,H[Ft+8>>2]=K;break t}if(!(K=H[(Te=ue+20|0)>>2])){if(!(K=H[ue+16>>2]))break s;Te=ue+16|0}for(;or=Te,Ft=K,(K=H[(Te=K+20|0)>>2])||(Te=Ft+16|0,K=H[Ft+16>>2]););H[or>>2]=0;break t}if(Xt=-1,!(K>>>0>4294967231)&&(Xt=-8&(K=K+11|0),Gn=H[405])){Ke=0-Xt|0,vt=0,Xt>>>0<256||(vt=31,Xt>>>0>16777215||(K=K>>>8|0,K<<=or=K+1048320>>>16&8,vt=28+((K=((K<<=Te=K+520192>>>16&4)<<(ue=K+245760>>>16&2)>>>15|0)-(ue|Te|or)|0)<<1|Xt>>>K+21&1)|0));h:{d:{if(Te=H[1920+(vt<<2)>>2])for(K=0,ue=Xt<<((0|vt)==31?0:25-(vt>>>1|0)|0);;){if(!((or=(In=-8&H[Te+4>>2])-Xt|0)>>>0>=Ke>>>0)&&(Ke=or,Ft=Te,(0|Xt)==(0|In))){Ke=0,K=Te;break d}if(or=H[Te+20>>2],Te=H[16+((ue>>>29&4)+Te|0)>>2],K=or?(0|or)==(0|Te)?K:or:K,ue<<=1,!Te)break}else K=0;if(!(K|Ft)){if(Ft=0,!(K=(0-(K=2<<vt)|K)&Gn))break o;Te=K=(ue=(K&0-K)-1|0)>>>12&16,Te|=K=(ue=ue>>>K|0)>>>5&8,Te|=K=(ue=ue>>>K|0)>>>2&4,K=H[1920+(((Te|=K=(ue=ue>>>K|0)>>>1&2)|(K=(ue=ue>>>K|0)>>>1&1))+(ue>>>K|0)<<2)>>2]}if(!K)break h}for(;Ke=(Te=(ue=(-8&H[K+4>>2])-Xt|0)>>>0<Ke>>>0)?ue:Ke,Ft=Te?K:Ft,K=(ue=H[K+16>>2])||H[K+20>>2];);}if(!(!Ft|H[406]-Xt>>>0<=Ke>>>0)){if(vt=H[Ft+24>>2],(0|Ft)!=(0|(ue=H[Ft+12>>2]))){K=H[Ft+8>>2],H[K+12>>2]=ue,H[ue+8>>2]=K;break n}if(!(K=H[(Te=Ft+20|0)>>2])){if(!(K=H[Ft+16>>2]))break u;Te=Ft+16|0}for(;or=Te,ue=K,(K=H[(Te=K+20|0)>>2])||(Te=ue+16|0,K=H[ue+16>>2]););H[or>>2]=0;break n}}}if((Te=H[406])>>>0>=Xt>>>0){Ke=H[409],(ue=Te-Xt|0)>>>0>=16?(H[406]=ue,K=Ke+Xt|0,H[409]=K,H[K+4>>2]=1|ue,H[Te+Ke>>2]=ue,H[Ke+4>>2]=3|Xt):(H[409]=0,H[406]=0,H[Ke+4>>2]=3|Te,H[4+(K=Te+Ke|0)>>2]=1|H[K+4>>2]),K=Ke+8|0;break e}if((Gn=H[407])>>>0>Xt>>>0){ue=Gn-Xt|0,H[407]=ue,K=(Te=H[410])+Xt|0,H[410]=K,H[K+4>>2]=1|ue,H[Te+4>>2]=3|Xt,K=Te+8|0;break e}if(K=0,In=Xt+47|0,H[522]?Te=H[524]:(H[525]=-1,H[526]=-1,H[523]=4096,H[524]=4096,H[522]=Ce+12&-16^1431655768,H[527]=0,H[515]=0,Te=4096),(Te=(or=In+Te|0)&(Ft=0-Te|0))>>>0<=Xt>>>0||(Ke=H[514])&&(vt=(ue=H[512])+Te|0)>>>0>Ke>>>0|ue>>>0>=vt>>>0)break e;if(4&Hr[2060])break l;o:{h:{if(Ke=H[410])for(K=2064;;){if((ue=H[K>>2])>>>0<=Ke>>>0&Ke>>>0<ue+H[K+4>>2]>>>0)break h;if(!(K=H[K+8>>2]))break}if((0|(ue=ro(0)))==-1||(vt=Te,(K=(Ke=H[523])-1|0)&ue&&(vt=(Te-ue|0)+(K+ue&0-Ke)|0),vt>>>0<=Xt>>>0|vt>>>0>2147483646)||(Ke=H[514])&&Ke>>>0<(Ft=(K=H[512])+vt|0)>>>0|K>>>0>=Ft>>>0)break r;if((0|ue)!=(0|(K=ro(vt))))break o;break i}if((vt=Ft&or-Gn)>>>0>2147483646)break r;if((0|(ue=ro(vt)))==(H[K>>2]+H[K+4>>2]|0))break c;K=ue}if(!((0|K)==-1|Xt+48>>>0<=vt>>>0)){if((ue=(ue=H[524])+(In-vt|0)&0-ue)>>>0>2147483646){ue=K;break i}if((0|ro(ue))!=-1){vt=ue+vt|0,ue=K;break i}ro(0-vt|0);break r}if(ue=K,(0|K)!=-1)break i;break r}Ft=0;break t}ue=0;break n}if((0|ue)!=-1)break i}H[515]=4|H[515]}if(Te>>>0>2147483646||(0|(ue=ro(Te)))==-1|(0|(K=ro(0)))==-1|K>>>0<=ue>>>0||(vt=K-ue|0)>>>0<=Xt+40>>>0)break a}K=H[512]+vt|0,H[512]=K,K>>>0>Da[513]&&(H[513]=K);i:{l:{r:{if(In=H[410]){for(K=2064;;){if(((Ke=H[K>>2])+(Te=H[K+4>>2])|0)==(0|ue))break r;if(!(K=H[K+8>>2]))break}break l}for((K=H[408])>>>0<=ue>>>0&&K||(H[408]=ue),K=0,H[517]=vt,H[516]=ue,H[412]=-1,H[413]=H[522],H[519]=0;Te=1656+(Ke=K<<3)|0,H[Ke+1664>>2]=Te,H[Ke+1668>>2]=Te,(0|(K=K+1|0))!=32;);Te=(Ke=vt-40|0)-(K=ue+8&7?-8-ue&7:0)|0,H[407]=Te,K=K+ue|0,H[410]=K,H[K+4>>2]=1|Te,H[4+(ue+Ke|0)>>2]=40,H[411]=H[526];break i}if(!(8&Hr[K+12|0]|Ke>>>0>In>>>0|ue>>>0<=In>>>0)){H[K+4>>2]=Te+vt,Te=(K=In+8&7?-8-In&7:0)+In|0,H[410]=Te,K=(ue=H[407]+vt|0)-K|0,H[407]=K,H[Te+4>>2]=1|K,H[4+(ue+In|0)>>2]=40,H[411]=H[526];break i}}Da[408]>ue>>>0&&(H[408]=ue),Te=ue+vt|0,K=2064;l:{r:{c:{u:{s:{o:{for(;;){if((0|Te)!=H[K>>2]){if(K=H[K+8>>2])continue;break o}break}if(!(8&Hr[K+12|0]))break s}for(K=2064;;){if((Te=H[K>>2])>>>0<=In>>>0&&(Ft=Te+H[K+4>>2]|0)>>>0>In>>>0)break u;K=H[K+8>>2]}}if(H[K>>2]=ue,H[K+4>>2]=H[K+4>>2]+vt,H[4+(or=(ue+8&7?-8-ue&7:0)+ue|0)>>2]=3|Xt,Xt=(vt=Te+(Te+8&7?-8-Te&7:0)|0)-(Gn=Xt+or|0)|0,(0|vt)==(0|In)){H[410]=Gn,K=H[407]+Xt|0,H[407]=K,H[Gn+4>>2]=1|K;break r}if(H[409]==(0|vt)){H[409]=Gn,K=H[406]+Xt|0,H[406]=K,H[Gn+4>>2]=1|K,H[K+Gn>>2]=K;break r}if((3&(K=H[vt+4>>2]))==1){Ft=-8&K;s:if(K>>>0<=255){if(Te=H[vt+8>>2],K=K>>>3|0,(0|(ue=H[vt+12>>2]))==(0|Te)){H[404]=H[404]&Sr(K);break s}H[Te+12>>2]=ue,H[ue+8>>2]=Te}else{if(In=H[vt+24>>2],(0|vt)==(0|(ue=H[vt+12>>2])))if((Ke=H[(K=vt+20|0)>>2])||(Ke=H[(K=vt+16|0)>>2])){for(;Te=K,(Ke=H[(K=(ue=Ke)+20|0)>>2])||(K=ue+16|0,Ke=H[ue+16>>2]););H[Te>>2]=0}else ue=0;else K=H[vt+8>>2],H[K+12>>2]=ue,H[ue+8>>2]=K;if(In){Te=H[vt+28>>2];o:{if(H[(K=1920+(Te<<2)|0)>>2]==(0|vt)){if(H[K>>2]=ue,ue)break o;H[405]=H[405]&Sr(Te);break s}if(H[In+(H[In+16>>2]==(0|vt)?16:20)>>2]=ue,!ue)break s}H[ue+24>>2]=In,(K=H[vt+16>>2])&&(H[ue+16>>2]=K,H[K+24>>2]=ue),(K=H[vt+20>>2])&&(H[ue+20>>2]=K,H[K+24>>2]=ue)}}Xt=Ft+Xt|0,vt=vt+Ft|0}if(H[vt+4>>2]=-2&H[vt+4>>2],H[Gn+4>>2]=1|Xt,H[Xt+Gn>>2]=Xt,Xt>>>0<=255){ue=1656+((K=Xt>>>3|0)<<3)|0,(Te=H[404])&(K=1<<K)?K=H[ue+8>>2]:(H[404]=K|Te,K=ue),H[ue+8>>2]=Gn,H[K+12>>2]=Gn,H[Gn+12>>2]=ue,H[Gn+8>>2]=K;break r}if(K=31,Xt>>>0<=16777215&&(K=Xt>>>8|0,K<<=Ke=K+1048320>>>16&8,K=28+((K=((K<<=Te=K+520192>>>16&4)<<(ue=K+245760>>>16&2)>>>15|0)-(ue|Te|Ke)|0)<<1|Xt>>>K+21&1)|0),H[Gn+28>>2]=K,H[Gn+16>>2]=0,H[Gn+20>>2]=0,Ke=1920+(K<<2)|0,(Te=H[405])&(ue=1<<K)){for(K=Xt<<((0|K)==31?0:25-(K>>>1|0)|0),ue=H[Ke>>2];;){if(Te=ue,(-8&H[ue+4>>2])==(0|Xt))break c;if(ue=K>>>29|0,K<<=1,!(ue=H[16+(Ke=Te+(4&ue)|0)>>2]))break}H[Ke+16>>2]=Gn,H[Gn+24>>2]=Te}else H[405]=ue|Te,H[Ke>>2]=Gn,H[Gn+24>>2]=Ke;H[Gn+12>>2]=Gn,H[Gn+8>>2]=Gn;break r}for(Te=(Ke=vt-40|0)-(K=ue+8&7?-8-ue&7:0)|0,H[407]=Te,K=K+ue|0,H[410]=K,H[K+4>>2]=1|Te,H[4+(ue+Ke|0)>>2]=40,H[411]=H[526],H[(Te=(K=(Ft+(Ft-39&7?39-Ft&7:0)|0)-47|0)>>>0<In+16>>>0?In:K)+4>>2]=27,K=H[519],H[Te+16>>2]=H[518],H[Te+20>>2]=K,K=H[517],H[Te+8>>2]=H[516],H[Te+12>>2]=K,H[518]=Te+8,H[517]=vt,H[516]=ue,H[519]=0,K=Te+24|0;H[K+4>>2]=7,ue=K+8|0,K=K+4|0,ue>>>0<Ft>>>0;);if((0|Te)==(0|In))break i;if(H[Te+4>>2]=-2&H[Te+4>>2],Ft=Te-In|0,H[In+4>>2]=1|Ft,H[Te>>2]=Ft,Ft>>>0<=255){ue=1656+((K=Ft>>>3|0)<<3)|0,(Te=H[404])&(K=1<<K)?K=H[ue+8>>2]:(H[404]=K|Te,K=ue),H[ue+8>>2]=In,H[K+12>>2]=In,H[In+12>>2]=ue,H[In+8>>2]=K;break i}if(K=31,H[In+16>>2]=0,H[In+20>>2]=0,Ft>>>0<=16777215&&(K=Ft>>>8|0,K<<=Ke=K+1048320>>>16&8,K=28+((K=((K<<=Te=K+520192>>>16&4)<<(ue=K+245760>>>16&2)>>>15|0)-(ue|Te|Ke)|0)<<1|Ft>>>K+21&1)|0),H[In+28>>2]=K,Ke=1920+(K<<2)|0,(Te=H[405])&(ue=1<<K)){for(K=Ft<<((0|K)==31?0:25-(K>>>1|0)|0),ue=H[Ke>>2];;){if(Te=ue,(0|Ft)==(-8&H[ue+4>>2]))break l;if(ue=K>>>29|0,K<<=1,!(ue=H[16+(Ke=Te+(4&ue)|0)>>2]))break}H[Ke+16>>2]=In,H[In+24>>2]=Te}else H[405]=ue|Te,H[Ke>>2]=In,H[In+24>>2]=Ke;H[In+12>>2]=In,H[In+8>>2]=In;break i}K=H[Te+8>>2],H[K+12>>2]=Gn,H[Te+8>>2]=Gn,H[Gn+24>>2]=0,H[Gn+12>>2]=Te,H[Gn+8>>2]=K}K=or+8|0;break e}K=H[Te+8>>2],H[K+12>>2]=In,H[Te+8>>2]=In,H[In+24>>2]=0,H[In+12>>2]=Te,H[In+8>>2]=K}if(!((K=H[407])>>>0<=Xt>>>0)){ue=K-Xt|0,H[407]=ue,K=(Te=H[410])+Xt|0,H[410]=K,H[K+4>>2]=1|ue,H[Te+4>>2]=3|Xt,K=Te+8|0;break e}}H[403]=48,K=0;break e}n:if(vt){Te=H[Ft+28>>2];a:{if(H[(K=1920+(Te<<2)|0)>>2]==(0|Ft)){if(H[K>>2]=ue,ue)break a;Gn=Sr(Te)&Gn,H[405]=Gn;break n}if(H[vt+(H[vt+16>>2]==(0|Ft)?16:20)>>2]=ue,!ue)break n}H[ue+24>>2]=vt,(K=H[Ft+16>>2])&&(H[ue+16>>2]=K,H[K+24>>2]=ue),(K=H[Ft+20>>2])&&(H[ue+20>>2]=K,H[K+24>>2]=ue)}n:if(Ke>>>0<=15)K=Ke+Xt|0,H[Ft+4>>2]=3|K,H[4+(K=K+Ft|0)>>2]=1|H[K+4>>2];else if(H[Ft+4>>2]=3|Xt,H[4+(vt=Ft+Xt|0)>>2]=1|Ke,H[vt+Ke>>2]=Ke,Ke>>>0<=255)ue=1656+((K=Ke>>>3|0)<<3)|0,(Te=H[404])&(K=1<<K)?K=H[ue+8>>2]:(H[404]=K|Te,K=ue),H[ue+8>>2]=vt,H[K+12>>2]=vt,H[vt+12>>2]=ue,H[vt+8>>2]=K;else{K=31,Ke>>>0<=16777215&&(K=Ke>>>8|0,K<<=or=K+1048320>>>16&8,K=28+((K=((K<<=Te=K+520192>>>16&4)<<(ue=K+245760>>>16&2)>>>15|0)-(ue|Te|or)|0)<<1|Ke>>>K+21&1)|0),H[vt+28>>2]=K,H[vt+16>>2]=0,H[vt+20>>2]=0,ue=1920+(K<<2)|0;a:{if((Te=1<<K)&Gn){for(K=Ke<<((0|K)==31?0:25-(K>>>1|0)|0),Te=H[ue>>2];;){if((-8&H[(ue=Te)+4>>2])==(0|Ke))break a;if(Te=K>>>29|0,K<<=1,!(Te=H[16+(or=(4&Te)+ue|0)>>2]))break}H[or+16>>2]=vt}else H[405]=Te|Gn,H[ue>>2]=vt;H[vt+24>>2]=ue,H[vt+12>>2]=vt,H[vt+8>>2]=vt;break n}K=H[ue+8>>2],H[K+12>>2]=vt,H[ue+8>>2]=vt,H[vt+24>>2]=0,H[vt+12>>2]=ue,H[vt+8>>2]=K}K=Ft+8|0;break e}t:if(Gn){Te=H[ue+28>>2];n:{if(H[(K=1920+(Te<<2)|0)>>2]==(0|ue)){if(H[K>>2]=Ft,Ft)break n;H[405]=Sr(Te)&In;break t}if(H[Gn+(H[Gn+16>>2]==(0|ue)?16:20)>>2]=Ft,!Ft)break t}H[Ft+24>>2]=Gn,(K=H[ue+16>>2])&&(H[Ft+16>>2]=K,H[K+24>>2]=Ft),(K=H[ue+20>>2])&&(H[Ft+20>>2]=K,H[K+24>>2]=Ft)}Ke>>>0<=15?(K=Ke+Xt|0,H[ue+4>>2]=3|K,H[4+(K=K+ue|0)>>2]=1|H[K+4>>2]):(H[ue+4>>2]=3|Xt,H[4+(Ft=ue+Xt|0)>>2]=1|Ke,H[Ke+Ft>>2]=Ke,hi&&(Te=1656+((K=hi>>>3|0)<<3)|0,or=H[409],(K=1<<K)&vt?K=H[Te+8>>2]:(H[404]=K|vt,K=Te),H[Te+8>>2]=or,H[K+12>>2]=or,H[or+12>>2]=Te,H[or+8>>2]=K),H[409]=Ft,H[406]=Ke),K=ue+8|0}return sa=Ce+16|0,0|K}function Ea(K){var Ce=0,ue=0,Te=0,Ke=0,vt=0,Ft=0,Xt=0;e:if(K){vt=(Te=K-8|0)+(K=-8&(Ce=H[K-4>>2]))|0;t:if(!(1&Ce)){if(!(3&Ce)||(Te=Te-(Ce=H[Te>>2])|0)>>>0<Da[408])break e;if(K=K+Ce|0,H[409]==(0|Te)){if((3&(Ce=H[vt+4>>2]))==3)return H[406]=K,H[vt+4>>2]=-2&Ce,H[Te+4>>2]=1|K,void(H[K+Te>>2]=K)}else{if(Ce>>>0<=255){if(Ke=H[Te+8>>2],Ce=Ce>>>3|0,(0|(ue=H[Te+12>>2]))==(0|Ke)){H[404]=H[404]&Sr(Ce);break t}H[Ke+12>>2]=ue,H[ue+8>>2]=Ke;break t}if(Xt=H[Te+24>>2],(0|Te)==(0|(Ce=H[Te+12>>2])))if((ue=H[(Ke=Te+20|0)>>2])||(ue=H[(Ke=Te+16|0)>>2])){for(;Ft=Ke,(ue=H[(Ke=(Ce=ue)+20|0)>>2])||(Ke=Ce+16|0,ue=H[Ce+16>>2]););H[Ft>>2]=0}else Ce=0;else ue=H[Te+8>>2],H[ue+12>>2]=Ce,H[Ce+8>>2]=ue;if(!Xt)break t;Ke=H[Te+28>>2];n:{if(H[(ue=1920+(Ke<<2)|0)>>2]==(0|Te)){if(H[ue>>2]=Ce,Ce)break n;H[405]=H[405]&Sr(Ke);break t}if(H[Xt+(H[Xt+16>>2]==(0|Te)?16:20)>>2]=Ce,!Ce)break t}if(H[Ce+24>>2]=Xt,(ue=H[Te+16>>2])&&(H[Ce+16>>2]=ue,H[ue+24>>2]=Ce),!(ue=H[Te+20>>2]))break t;H[Ce+20>>2]=ue,H[ue+24>>2]=Ce}}if(!(Te>>>0>=vt>>>0)&&1&(Ce=H[vt+4>>2])){t:{if(!(2&Ce)){if(H[410]==(0|vt)){if(H[410]=Te,K=H[407]+K|0,H[407]=K,H[Te+4>>2]=1|K,H[409]!=(0|Te))break e;return H[406]=0,void(H[409]=0)}if(H[409]==(0|vt))return H[409]=Te,K=H[406]+K|0,H[406]=K,H[Te+4>>2]=1|K,void(H[K+Te>>2]=K);K=(-8&Ce)+K|0;n:if(Ce>>>0<=255){if(Ke=H[vt+8>>2],Ce=Ce>>>3|0,(0|(ue=H[vt+12>>2]))==(0|Ke)){H[404]=H[404]&Sr(Ce);break n}H[Ke+12>>2]=ue,H[ue+8>>2]=Ke}else{if(Xt=H[vt+24>>2],(0|vt)==(0|(Ce=H[vt+12>>2])))if((ue=H[(Ke=vt+20|0)>>2])||(ue=H[(Ke=vt+16|0)>>2])){for(;Ft=Ke,(ue=H[(Ke=(Ce=ue)+20|0)>>2])||(Ke=Ce+16|0,ue=H[Ce+16>>2]););H[Ft>>2]=0}else Ce=0;else ue=H[vt+8>>2],H[ue+12>>2]=Ce,H[Ce+8>>2]=ue;if(Xt){Ke=H[vt+28>>2];a:{if(H[(ue=1920+(Ke<<2)|0)>>2]==(0|vt)){if(H[ue>>2]=Ce,Ce)break a;H[405]=H[405]&Sr(Ke);break n}if(H[Xt+(H[Xt+16>>2]==(0|vt)?16:20)>>2]=Ce,!Ce)break n}H[Ce+24>>2]=Xt,(ue=H[vt+16>>2])&&(H[Ce+16>>2]=ue,H[ue+24>>2]=Ce),(ue=H[vt+20>>2])&&(H[Ce+20>>2]=ue,H[ue+24>>2]=Ce)}}if(H[Te+4>>2]=1|K,H[K+Te>>2]=K,H[409]!=(0|Te))break t;return void(H[406]=K)}H[vt+4>>2]=-2&Ce,H[Te+4>>2]=1|K,H[K+Te>>2]=K}if(K>>>0<=255)return Ce=1656+((K=K>>>3|0)<<3)|0,(ue=H[404])&(K=1<<K)?K=H[Ce+8>>2]:(H[404]=K|ue,K=Ce),H[Ce+8>>2]=Te,H[K+12>>2]=Te,H[Te+12>>2]=Ce,void(H[Te+8>>2]=K);Ke=31,H[Te+16>>2]=0,H[Te+20>>2]=0,K>>>0<=16777215&&(Ce=K>>>8|0,Ce<<=Ft=Ce+1048320>>>16&8,Ke=28+((Ce=((Ce<<=Ke=Ce+520192>>>16&4)<<(ue=Ce+245760>>>16&2)>>>15|0)-(ue|Ke|Ft)|0)<<1|K>>>Ce+21&1)|0),H[Te+28>>2]=Ke,Ft=1920+(Ke<<2)|0;t:{n:{if((ue=H[405])&(Ce=1<<Ke)){for(Ke=K<<((0|Ke)==31?0:25-(Ke>>>1|0)|0),Ce=H[Ft>>2];;){if(ue=Ce,(-8&H[Ce+4>>2])==(0|K))break n;if(Ce=Ke>>>29|0,Ke<<=1,!(Ce=H[16+(Ft=ue+(4&Ce)|0)>>2]))break}H[Ft+16>>2]=Te,H[Te+24>>2]=ue}else H[405]=Ce|ue,H[Ft>>2]=Te,H[Te+24>>2]=Ft;H[Te+12>>2]=Te,H[Te+8>>2]=Te;break t}K=H[ue+8>>2],H[K+12>>2]=Te,H[ue+8>>2]=Te,H[Te+24>>2]=0,H[Te+12>>2]=ue,H[Te+8>>2]=K}K=H[412]-1|0,H[412]=K||-1}}}function ms(K,Ce,ue){var Te,Ke=0,vt=0;if(ue>>>0>=512)return fs(0|K,0|Ce,0|ue),K;Te=K+ue|0;e:if(3&(K^Ce))if(Te>>>0<4)ue=K;else if((Ke=Te-4|0)>>>0<K>>>0)ue=K;else for(ue=K;gr[0|ue]=Hr[0|Ce],gr[ue+1|0]=Hr[Ce+1|0],gr[ue+2|0]=Hr[Ce+2|0],gr[ue+3|0]=Hr[Ce+3|0],Ce=Ce+4|0,Ke>>>0>=(ue=ue+4|0)>>>0;);else{t:if(3&K)if(ue)for(ue=K;;){if(gr[0|ue]=Hr[0|Ce],Ce=Ce+1|0,!(3&(ue=ue+1|0)))break t;if(!(ue>>>0<Te>>>0))break}else ue=K;else ue=K;if(!((Ke=-4&Te)>>>0<64||(vt=Ke+-64|0)>>>0<ue>>>0))for(;H[ue>>2]=H[Ce>>2],H[ue+4>>2]=H[Ce+4>>2],H[ue+8>>2]=H[Ce+8>>2],H[ue+12>>2]=H[Ce+12>>2],H[ue+16>>2]=H[Ce+16>>2],H[ue+20>>2]=H[Ce+20>>2],H[ue+24>>2]=H[Ce+24>>2],H[ue+28>>2]=H[Ce+28>>2],H[ue+32>>2]=H[Ce+32>>2],H[ue+36>>2]=H[Ce+36>>2],H[ue+40>>2]=H[Ce+40>>2],H[ue+44>>2]=H[Ce+44>>2],H[ue+48>>2]=H[Ce+48>>2],H[ue+52>>2]=H[Ce+52>>2],H[ue+56>>2]=H[Ce+56>>2],H[ue+60>>2]=H[Ce+60>>2],Ce=Ce- -64|0,vt>>>0>=(ue=ue- -64|0)>>>0;);if(ue>>>0>=Ke>>>0)break e;for(;H[ue>>2]=H[Ce>>2],Ce=Ce+4|0,Ke>>>0>(ue=ue+4|0)>>>0;);}if(ue>>>0<Te>>>0)for(;gr[0|ue]=Hr[0|Ce],Ce=Ce+1|0,(0|Te)!=(0|(ue=ue+1|0)););return K}function Vs(K,Ce){var ue=0;if(Ce&&(gr[0|K]=0,gr[(ue=K+Ce|0)-1|0]=0,!(Ce>>>0<3||(gr[K+2|0]=0,gr[K+1|0]=0,gr[ue-3|0]=0,gr[ue-2|0]=0,Ce>>>0<7||(gr[K+3|0]=0,gr[ue-4|0]=0,Ce>>>0<9||(H[(K=(ue=0-K&3)+K|0)>>2]=0,H[(Ce=(ue=Ce-ue&-4)+K|0)-4>>2]=0,ue>>>0<9||(H[K+8>>2]=0,H[K+4>>2]=0,H[Ce-8>>2]=0,H[Ce-12>>2]=0,ue>>>0<25||(H[K+24>>2]=0,H[K+20>>2]=0,H[K+16>>2]=0,H[K+12>>2]=0,H[Ce-16>>2]=0,H[Ce-20>>2]=0,H[Ce-24>>2]=0,H[Ce-28>>2]=0,(Ce=(Ce=ue)-(ue=4&K|24)|0)>>>0<32))))))))for(K=K+ue|0;H[K+24>>2]=0,H[K+28>>2]=0,H[K+16>>2]=0,H[K+20>>2]=0,H[K+8>>2]=0,H[K+12>>2]=0,H[K>>2]=0,H[K+4>>2]=0,K=K+32|0,(Ce=Ce-32|0)>>>0>31;);}function no(K){var Ce,ue=0,Te=0,Ke=0;Ce=0|ts(8),H[Ce>>2]=1348,H[Ce>>2]=1392;e:{t:{if(3&(ue=K))for(;;){if(!Hr[0|ue])break t;if(!(3&(ue=ue+1|0)))break}for(;Te=ue,ue=ue+4|0,!((-1^(Ke=H[Te>>2]))&Ke-16843009&-2139062144););if(ue=Te-K|0,!(255&Ke))break e;for(;Ke=Hr[Te+1|0],Te=ue=Te+1|0,Ke;);}ue=ue-K|0}Te=io(ue+13|0),H[Te+8>>2]=0,H[Te+4>>2]=ue,H[Te>>2]=ue,H[Ce+4>>2]=ms(Te+12|0,K,ue+1|0),H[Ce>>2]=1440,to(0|Ce,1472,1),No()}function gs(K,Ce,ue,Te){gr[K+53|0]=1;e:if(H[K+4>>2]==(0|ue)){gr[K+52|0]=1;t:{if(!(ue=H[K+16>>2])){if(H[K+36>>2]=1,H[K+24>>2]=Te,H[K+16>>2]=Ce,(0|Te)!=1)break e;if(H[K+48>>2]==1)break t;break e}if((0|Ce)==(0|ue)){if((0|(ue=H[K+24>>2]))==2&&(H[K+24>>2]=Te,ue=Te),H[K+48>>2]!=1)break e;if((0|ue)==1)break t;break e}H[K+36>>2]=H[K+36>>2]+1}gr[K+54|0]=1}}function Pa(K,Ce,ue){var Te=0;if(!ue)return H[K+4>>2]==H[Ce+4>>2];if((0|K)==(0|Ce))return 1;Te=H[K+4>>2],K=Hr[0|Te],ue=H[Ce+4>>2];e:if(!(!K|(0|(Ce=Hr[0|ue]))!=(0|K)))for(;;){if(Ce=Hr[ue+1|0],!(K=Hr[Te+1|0]))break e;if(ue=ue+1|0,Te=Te+1|0,(0|K)!=(0|Ce))break}return(0|K)==(0|Ce)}function ys(K,Ce,ue){var Te;if(!(Te=H[K+16>>2]))return H[K+36>>2]=1,H[K+24>>2]=ue,void(H[K+16>>2]=Ce);e:{if((0|Ce)==(0|Te)){if(H[K+24>>2]!=2)break e;return void(H[K+24>>2]=ue)}gr[K+54|0]=1,H[K+24>>2]=2,H[K+36>>2]=H[K+36>>2]+1}}function ro(K){var Ce,ue;return(K=(Ce=H[377])+(ue=K+3&-4)|0)>>>0<=Ce>>>0&&ue||K>>>0>(si.byteLength/65536|0)<<16>>>0&&!(0|Fs(0|K))?(H[403]=48,-1):(H[377]=K,Ce)}function io(K){var Ce=0;K=K||1;e:{for(;;){if(Ce=Bo(K))break e;if(!(Ce=H[528]))break;jr[0|Ce]()}es(),No()}return Ce}function Xr(K){var Ce,ue;return H[(K|=0)>>2]=1392,Ce=H[K+4>>2]-12|0,ue=H[Ce+8>>2]-1|0,H[Ce+8>>2]=ue,(0|ue)<0&&Ea(Ce),0|K}function Sr(K){var Ce;return(-1>>>(Ce=31&K)&-2)<<Ce|(-1<<(K=0-K&31)&-2)>>>K}function ns(K){(K|=0)&&Ea(K)}function vs(K){Xr(K|=0),Ea(K)}function rs(K){return 0|K}function Fo(K){Ea(K|=0)}function Ji(K){}Qi(Ur=Hr,1024,"dmVjdG9yAHN0ZDo6ZXhjZXB0aW9uAGFsbG9jYXRvcjxUPjo6YWxsb2NhdGUoc2l6ZV90IG4pICduJyBleGNlZWRzIG1heGltdW0gc3VwcG9ydGVkIHNpemUATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAOgEAABaBAAA3AUAAE4xMF9fY3h4YWJpdjExN19fY2xhc3NfdHlwZV9pbmZvRQAAAOgEAACIBAAAfAQAAAAAAACsBAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAMAUAAAIAAAAKAAAABAAAAAUAAAAGAAAACwAAAAwAAAANAAAATjEwX19jeHhhYml2MTIwX19zaV9jbGFzc190eXBlX2luZm9FAAAAAOgEAAAIBQAArAQAAAAAAABgBQAADgAAAA8AAAAQAAAAU3Q5ZXhjZXB0aW9uAAAAAMAEAABQBQAAAAAAAIwFAAABAAAAEQAAABIAAABTdDExbG9naWNfZXJyb3IA6AQAAHwFAABgBQAAAAAAAMAFAAABAAAAEwAAABIAAABTdDEybGVuZ3RoX2Vycm9yAAAAAOgEAACsBQAAjAUAAFN0OXR5cGVfaW5mbwAAAADABAAAzAU="),Qi(Ur,1508,"UAhQ");var jr=function(K){return K.grow=function(Ce){var ue=this.length;return this.length=this.length+Ce,ue},K.set=function(Ce,ue){this[Ce]=ue},K.get=function(Ce){return this[Ce]},K}([null,Xr,rs,Fo,Ji,Ji,function(K,Ce,ue){ue|=0;var Te,Ke=0,vt=0,Ft=0,Xt=0;if(sa=Te=sa+-64|0,Ke=1,!Pa(K|=0,Ce|=0,0)&&(Ke=0,Ce)){sa=Ke=sa+-64|0,vt=H[Ce>>2],Ft=H[vt-4>>2],Xt=H[vt-8>>2],H[Ke+20>>2]=0,H[Ke+16>>2]=1148,H[Ke+12>>2]=Ce,H[Ke+8>>2]=1196,vt=0,Vs(Ke+24|0,39),Ce=Ce+Xt|0;e:if(Pa(Ft,1196,0))H[Ke+56>>2]=1,jr[H[H[Ft>>2]+20>>2]](Ft,Ke+8|0,Ce,Ce,1,0),vt=H[Ke+32>>2]==1?Ce:0;else{jr[H[H[Ft>>2]+24>>2]](Ft,Ke+8|0,Ce,1,0);t:switch(H[Ke+44>>2]){case 0:vt=H[Ke+48>>2]==1&&H[Ke+36>>2]==1&&H[Ke+40>>2]==1?H[Ke+28>>2]:0;break e;case 1:break t;default:break e}H[Ke+32>>2]!=1&&H[Ke+48>>2]|H[Ke+36>>2]!=1|H[Ke+40>>2]!=1||(vt=H[Ke+24>>2])}sa=Ke- -64|0,Ke=0,vt&&(Vs(4|(Ce=Te+8|0),52),H[Te+56>>2]=1,H[Te+20>>2]=-1,H[Te+16>>2]=K,H[Te+8>>2]=vt,jr[H[H[vt>>2]+28>>2]](vt,Ce,H[ue>>2],1),(0|(K=H[Te+32>>2]))==1&&(H[ue>>2]=H[Te+24>>2]),Ke=(0|K)==1)}return sa=Te- -64|0,0|Ke},function(K,Ce,ue,Te,Ke,vt){ue|=0,Te|=0,Ke|=0,vt|=0,Pa(K|=0,H[8+(Ce|=0)>>2],vt)&&gs(Ce,ue,Te,Ke)},function(K,Ce,ue,Te,Ke){if(ue|=0,Te|=0,Ke|=0,Pa(K|=0,H[8+(Ce|=0)>>2],Ke))H[Ce+28>>2]==1|H[Ce+4>>2]!=(0|ue)||(H[Ce+28>>2]=Te);else e:if(Pa(K,H[Ce>>2],Ke)){if(!(H[Ce+16>>2]!=(0|ue)&H[Ce+20>>2]!=(0|ue))){if((0|Te)!=1)break e;return void(H[Ce+32>>2]=1)}H[Ce+20>>2]=ue,H[Ce+32>>2]=Te,H[Ce+40>>2]=H[Ce+40>>2]+1,H[Ce+36>>2]!=1|H[Ce+24>>2]!=2||(gr[Ce+54|0]=1),H[Ce+44>>2]=4}},function(K,Ce,ue,Te){ue|=0,Te|=0,Pa(K|=0,H[8+(Ce|=0)>>2],0)&&ys(Ce,ue,Te)},Fo,function(K,Ce,ue,Te,Ke,vt){ue|=0,Te|=0,Ke|=0,vt|=0,Pa(K|=0,H[8+(Ce|=0)>>2],vt)?gs(Ce,ue,Te,Ke):(K=H[K+8>>2],jr[H[H[K>>2]+20>>2]](K,Ce,ue,Te,Ke,vt))},function(K,Ce,ue,Te,Ke){if(ue|=0,Te|=0,Ke|=0,Pa(K|=0,H[8+(Ce|=0)>>2],Ke))H[Ce+28>>2]==1|H[Ce+4>>2]!=(0|ue)||(H[Ce+28>>2]=Te);else e:{if(Pa(K,H[Ce>>2],Ke)){if(!(H[Ce+16>>2]!=(0|ue)&H[Ce+20>>2]!=(0|ue))){if((0|Te)!=1)break e;return void(H[Ce+32>>2]=1)}H[Ce+32>>2]=Te;t:if(H[Ce+44>>2]!=4){if(Wi[Ce+52>>1]=0,K=H[K+8>>2],jr[H[H[K>>2]+20>>2]](K,Ce,ue,ue,1,Ke),Hr[Ce+53|0]){if(H[Ce+44>>2]=3,!Hr[Ce+52|0])break t;break e}H[Ce+44>>2]=4}if(H[Ce+20>>2]=ue,H[Ce+40>>2]=H[Ce+40>>2]+1,H[Ce+36>>2]!=1|H[Ce+24>>2]!=2)break e;return void(gr[Ce+54|0]=1)}K=H[K+8>>2],jr[H[H[K>>2]+24>>2]](K,Ce,ue,Te,Ke)}},function(K,Ce,ue,Te){ue|=0,Te|=0,Pa(K|=0,H[8+(Ce|=0)>>2],0)?ys(Ce,ue,Te):(K=H[K+8>>2],jr[H[H[K>>2]+28>>2]](K,Ce,ue,Te))},rs,Fo,function(K){return 1031},vs,function(K){return H[4+(K|=0)>>2]},vs]);return{g:function(){},h:ns,i:function(){var K;return K=io(24),H[K>>2]=0,H[K+4>>2]=0,H[K+16>>2]=0,H[K+20>>2]=0,H[K+8>>2]=0,H[K+12>>2]=0,0|K},j:function(K,Ce,ue){var Te;return K=+K,Ce=+Ce,ue=+ue,Te=io(24),$n[Te+16>>3]=ue,$n[Te+8>>3]=Ce,$n[Te>>3]=K,0|Te},k:function(K,Ce){Ce|=0,$n[(K|=0)>>3]=$n[K>>3]+$n[Ce>>3],$n[K+8>>3]=$n[K+8>>3]+$n[Ce+8>>3],$n[K+16>>3]=$n[K+16>>3]+$n[Ce+16>>3]},l:function(K,Ce){Ce|=0,$n[(K|=0)>>3]=$n[K>>3]-$n[Ce>>3],$n[K+8>>3]=$n[K+8>>3]-$n[Ce+8>>3],$n[K+16>>3]=$n[K+16>>3]-$n[Ce+16>>3]},m:function(K){return+$n[(K|=0)>>3]},n:function(K,Ce){Ce=+Ce,$n[(K|=0)>>3]=Ce},o:function(K){return+$n[8+(K|=0)>>3]},p:function(K,Ce){Ce=+Ce,$n[8+(K|=0)>>3]=Ce},q:function(K){return+$n[16+(K|=0)>>3]},r:function(K,Ce){Ce=+Ce,$n[16+(K|=0)>>3]=Ce},s:ns,t:function(){var K;return K=io(12),H[K+8>>2]=0,H[K>>2]=0,H[K+4>>2]=0,0|K},u:function(K,Ce){Ce|=0;var ue=0,Te=0,Ke=0,vt=0,Ft=0,Xt=0;e:if((0|(ue=H[4+(K|=0)>>2]))==H[K+8>>2]){t:{if((Ke=1+(ue=(0|(Xt=ue-(Te=H[K>>2])|0))/24|0)|0)>>>0<178956971){if(vt=ue<<1,Ke=ue>>>0<89478485?Ke>>>0<vt>>>0?vt:Ke:178956970){if(Ke>>>0>=178956971)break t;vt=io(oa(Ke,24))}else vt=0;ue=vt+oa(ue,24)|0,Ft=H[Ce+4>>2],H[ue>>2]=H[Ce>>2],H[ue+4>>2]=Ft,Ft=H[Ce+20>>2],H[ue+16>>2]=H[Ce+16>>2],H[ue+20>>2]=Ft,Ft=H[Ce+12>>2],H[ue+8>>2]=H[Ce+8>>2],H[ue+12>>2]=Ft,Ce=ue+oa((0|Xt)/-24|0,24)|0,(0|Xt)>0&&ms(Ce,Te,Xt),H[K+8>>2]=vt+oa(Ke,24),H[K+4>>2]=ue+24,H[K>>2]=Ce,Te&&Ea(Te);break e}no(1024),No()}no(1046),No()}else Te=H[Ce+4>>2],H[ue>>2]=H[Ce>>2],H[ue+4>>2]=Te,Te=H[Ce+20>>2],H[ue+16>>2]=H[Ce+16>>2],H[ue+20>>2]=Te,Te=H[Ce+12>>2],H[ue+8>>2]=H[Ce+8>>2],H[ue+12>>2]=Te,H[K+4>>2]=ue+24},v:function(K){var Ce=0;(K|=0)&&((Ce=H[K>>2])&&(H[K+4>>2]=Ce,Ea(Ce)),Ea(K))},w:function(){return 0|io(1)},x:function(K,Ce){K|=0;var ue=0,Te=0,Ke=0,vt=0,Ft=0,Xt=0,In=0,Gn=0,or=0,hi=0,ao=0,Ci=0;if(K=H[(Ce|=0)>>2],(Te=(0|(Ke=H[Ce+4>>2]-K|0))/24|0)>>>0>=2){if(!(Ke-24>>>0<24)){if(ue=$n[K+8>>3],Ce=1,ao=1&(Te=Te-1|0),Ft=$n[K>>3],Ke-48>>>0<24)Xt=ue;else for(Ci=-2&Te,Te=0,In=Ft,Gn=ue;Ke=K+oa(Ce,24)|0,vt=.5*((Ft=$n[Ke+24>>3])-(or=$n[Ke>>3]))*((hi=$n[Ke+8>>3]-ue)+((Xt=$n[Ke+32>>3])-ue))+(.5*(or-In)*(Gn-ue+hi)+vt),Ce=Ce+2|0,In=Ft,Gn=Xt,(0|Ci)!=(0|(Te=Te+2|0)););ao&&(K=K+oa(Ce,24)|0,vt=.5*($n[K>>3]-Ft)*(Xt-ue+($n[K+8>>3]-ue))+vt)}ue=vt<0?-vt:vt}else ue=0;return+ue},y:function(K,Ce,ue){K|=0,Ce|=0;var Te,Ke=0,vt=0,Ft=0,Xt=0,In=0,Gn=0,or=0;if((Te=((K=H[4+(ue|=0)>>2])-(ue=H[ue>>2])|0)/24|0)>>>0>=3)for(K=Te-1|0,Ke=$n[Ce+8>>3],or=$n[Ce>>3],Ce=0;Xt=ue+oa(K,24)|0,Ft=$n[Xt+8>>3],K=Ce,Ce=ue+oa(Ce,24)|0,!(Ke<Ft&(vt=$n[Ce+8>>3])<=Ke)&(!(Ke>=Ft)|!(Ke<vt))||or-(In=$n[Ce>>3])<(Ke-vt)*($n[Xt>>3]-In)/(Ft-vt)&&(Gn^=1),(0|Te)!=(0|(Ce=K+1|0)););return 1&Gn},z:ns,A:jr,B:Bo}}(qr)}(Ne)}})}}}).then(function(_r){return _r}).then(hr,function(_r){ee("failed to asynchronously prepare wasm: "+_r),Ie(_r)})}var an={a:Ne};if(ce++,a.monitorRunDependencies&&a.monitorRunDependencies(ce),a.instantiateWasm)try{return a.instantiateWasm(an,$e)}catch(hr){return ee("Module.instantiateWasm callback failed with error: "+hr),!1}(M||typeof _.instantiateStreaming!="function"||xe.startsWith(Be)||xe.startsWith("file://")||typeof fetch!="function"?$t(Rt):fetch(xe,{credentials:"same-origin"}).then(function(hr){return _.instantiateStreaming(hr,an).then(Rt,function(_r){return ee("wasm streaming compile failed: "+_r),ee("falling back to ArrayBuffer instantiation"),$t(Rt)})})).catch(h)})(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.g).apply(null,arguments)};var le,ve=a._emscripten_bind_VoidPtr___destroy___0=function(){return(ve=a._emscripten_bind_VoidPtr___destroy___0=a.asm.h).apply(null,arguments)},He=a._emscripten_bind_McGePoint3d_McGePoint3d_0=function(){return(He=a._emscripten_bind_McGePoint3d_McGePoint3d_0=a.asm.i).apply(null,arguments)},nt=a._emscripten_bind_McGePoint3d_McGePoint3d_3=function(){return(nt=a._emscripten_bind_McGePoint3d_McGePoint3d_3=a.asm.j).apply(null,arguments)},ht=a._emscripten_bind_McGePoint3d_op_add_1=function(){return(ht=a._emscripten_bind_McGePoint3d_op_add_1=a.asm.k).apply(null,arguments)},Tt=a._emscripten_bind_McGePoint3d_op_sub_1=function(){return(Tt=a._emscripten_bind_McGePoint3d_op_sub_1=a.asm.l).apply(null,arguments)},Ct=a._emscripten_bind_McGePoint3d_get_x_0=function(){return(Ct=a._emscripten_bind_McGePoint3d_get_x_0=a.asm.m).apply(null,arguments)},We=a._emscripten_bind_McGePoint3d_set_x_1=function(){return(We=a._emscripten_bind_McGePoint3d_set_x_1=a.asm.n).apply(null,arguments)},It=a._emscripten_bind_McGePoint3d_get_y_0=function(){return(It=a._emscripten_bind_McGePoint3d_get_y_0=a.asm.o).apply(null,arguments)},Bt=a._emscripten_bind_McGePoint3d_set_y_1=function(){return(Bt=a._emscripten_bind_McGePoint3d_set_y_1=a.asm.p).apply(null,arguments)},Ln=a._emscripten_bind_McGePoint3d_get_z_0=function(){return(Ln=a._emscripten_bind_McGePoint3d_get_z_0=a.asm.q).apply(null,arguments)},rn=a._emscripten_bind_McGePoint3d_set_z_1=function(){return(rn=a._emscripten_bind_McGePoint3d_set_z_1=a.asm.r).apply(null,arguments)},Xn=a._emscripten_bind_McGePoint3d___destroy___0=function(){return(Xn=a._emscripten_bind_McGePoint3d___destroy___0=a.asm.s).apply(null,arguments)},yt=a._emscripten_bind_McGePoint3dArray_McGePoint3dArray_0=function(){return(yt=a._emscripten_bind_McGePoint3dArray_McGePoint3dArray_0=a.asm.t).apply(null,arguments)},ze=a._emscripten_bind_McGePoint3dArray_append_1=function(){return(ze=a._emscripten_bind_McGePoint3dArray_append_1=a.asm.u).apply(null,arguments)},Zt=a._emscripten_bind_McGePoint3dArray___destroy___0=function(){return(Zt=a._emscripten_bind_McGePoint3dArray___destroy___0=a.asm.v).apply(null,arguments)},An=a._emscripten_bind_McGeTool_McGeTool_0=function(){return(An=a._emscripten_bind_McGeTool_McGeTool_0=a.asm.w).apply(null,arguments)},Yn=a._emscripten_bind_McGeTool_calcArea_1=function(){return(Yn=a._emscripten_bind_McGeTool_calcArea_1=a.asm.x).apply(null,arguments)},pt=a._emscripten_bind_McGeTool_pointInPolyline_2=function(){return(pt=a._emscripten_bind_McGeTool_pointInPolyline_2=a.asm.y).apply(null,arguments)},st=a._emscripten_bind_McGeTool___destroy___0=function(){return(st=a._emscripten_bind_McGeTool___destroy___0=a.asm.z).apply(null,arguments)},qt=a._malloc=function(){return(qt=a._malloc=a.asm.B).apply(null,arguments)};function xn(){function $e(){if(!le&&(le=!0,a.calledRun=!0,!c)){if(oe(W),v(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;){var Rt=a.postRun.shift();te.unshift(Rt)}oe(te)}}if(!(0<ce)){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)ne();oe(X),0<ce||(a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),$e()},1)):$e())}}if(we=function $e(){le||xn(),le||(we=$e)},a.run=xn,a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();function nn(){}function er($e){return($e||nn).F}function kr($e,Rt){var $t=er(Rt),an=$t[$e];return an||((an=Object.create((Rt||nn).prototype)).C=$e,$t[$e]=an)}function ct(){throw"cannot construct a VoidPtr, no constructor in IDL"}function Ue($e,Rt,$t){$e&&typeof $e=="object"&&($e=$e.C),Rt&&typeof Rt=="object"&&(Rt=Rt.C),$t&&typeof $t=="object"&&($t=$t.C),this.C=$e===void 0?He():Rt===void 0?_emscripten_bind_McGePoint3d_McGePoint3d_1($e):$t===void 0?_emscripten_bind_McGePoint3d_McGePoint3d_2($e,Rt):nt($e,Rt,$t),er(Ue)[this.C]=this}function lt(){this.C=yt(),er(lt)[this.C]=this}function Wt(){this.C=An(),er(Wt)[this.C]=this}return xn(),nn.prototype=Object.create(nn.prototype),nn.prototype.constructor=nn,nn.prototype.D=nn,nn.F={},a.WrapperObject=nn,a.getCache=er,a.wrapPointer=kr,a.castObject=function($e,Rt){return kr($e.C,Rt)},a.NULL=kr(0),a.destroy=function($e){if(!$e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";$e.__destroy__(),delete er($e.D)[$e.C]},a.compare=function($e,Rt){return $e.C===Rt.C},a.getPointer=function($e){return $e.C},a.getClass=function($e){return $e.D},ct.prototype=Object.create(nn.prototype),ct.prototype.constructor=ct,ct.prototype.D=ct,ct.F={},a.VoidPtr=ct,ct.prototype.__destroy__=function(){ve(this.C)},Ue.prototype=Object.create(nn.prototype),Ue.prototype.constructor=Ue,Ue.prototype.D=Ue,Ue.F={},a.McGePoint3d=Ue,Ue.prototype.op_add=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),ht(Rt,$e)},Ue.prototype.op_sub=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),Tt(Rt,$e)},Ue.prototype.get_x=Ue.prototype.H=function(){return Ct(this.C)},Ue.prototype.set_x=Ue.prototype.R=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),We(Rt,$e)},Object.defineProperty(Ue.prototype,"x",{get:Ue.prototype.H,set:Ue.prototype.R}),Ue.prototype.get_y=Ue.prototype.I=function(){return It(this.C)},Ue.prototype.set_y=Ue.prototype.S=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),Bt(Rt,$e)},Object.defineProperty(Ue.prototype,"y",{get:Ue.prototype.I,set:Ue.prototype.S}),Ue.prototype.get_z=Ue.prototype.J=function(){return Ln(this.C)},Ue.prototype.set_z=Ue.prototype.T=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),rn(Rt,$e)},Object.defineProperty(Ue.prototype,"z",{get:Ue.prototype.J,set:Ue.prototype.T}),Ue.prototype.__destroy__=function(){Xn(this.C)},lt.prototype=Object.create(nn.prototype),lt.prototype.constructor=lt,lt.prototype.D=lt,lt.F={},a.McGePoint3dArray=lt,lt.prototype.append=lt.prototype.append=function($e){var Rt=this.C;$e&&typeof $e=="object"&&($e=$e.C),ze(Rt,$e)},lt.prototype.__destroy__=function(){Zt(this.C)},Wt.prototype=Object.create(nn.prototype),Wt.prototype.constructor=Wt,Wt.prototype.D=Wt,Wt.F={},a.McGeTool=Wt,Wt.prototype.calcArea=function($e){var Rt=this.C;return $e&&typeof $e=="object"&&($e=$e.C),Yn(Rt,$e)},Wt.prototype.pointInPolyline=function($e,Rt){var $t=this.C;return $e&&typeof $e=="object"&&($e=$e.C),Rt&&typeof Rt=="object"&&(Rt=Rt.C),!!pt($t,$e,Rt)},Wt.prototype.__destroy__=function(){st(this.C)},o.ready});return typeof exports=="object"&&typeof module=="object"?module.exports=r:typeof define=="function"&&define.amd?define([],function(){return r}):typeof exports=="object"&&(exports.mxcadassembly=r),r()}function loadMxcadAssembly(){mxcadassemblyinit().then(function(b){store.commit("setMxassembly",b)})}function _load(b){window.MxDocumentReady=void 0,window.MxUiMain=r=>{const o=r("./MxFun").MxFun;window.THREE=o.getTHREE(),store.commit("setMxFun",o),store.events.emit("MxUiMain",r),window.MxUiMain=void 0},window.MxMain=r=>(store.events.emit("MxMain",r),window.MxMain=void 0,registerMxDbEntity(),b(),0),mxfun(),loadMxcadAssembly()}async function loadCoreCode(){return new Promise(async(b,r)=>{try{if(store.state.MxFun)return console.warn("程序已自动调用loadCoreCode 无需主动调用 | The program has automatically called loadCoreCode without actively calling it"),void b();_load(b)}catch(o){r({code:"error",msg:o})}})}function createCanvas(b="mx-canvas"){let r=document.getElementById(b);return r||(console.warn("没有找到id为:"+b+"的canvas元素"),(r=document.createElement("canvas")).id=b),r}function createCanvasParent(b=createCanvas()){let r;return b||(b=createCanvas()),b.parentNode?r=b.parentNode:((r=document.createElement("div")).style.height="80vh",r.appendChild(b)),r}async function dynamicImport(b){let r;switch(b){case"jquery":r=await dynamicImportJquery();break;case"element-resize-event-polyfill":r=await dynamicImportResize()}return r}async function dynamicImportResize(){try{const b=await Promise.resolve().then(function(){return elementResizeEventPolyfill_umd_min$2});return b.default?b.default:b}catch(b){console.log("import动态导入：element-resize-event-polyfill失败！",b)}}async function dynamicImportJquery(){try{const b=await Promise.resolve().then(function(){return jquery$1});return b.default?b.default:b}catch(b){console.log("import动态导入：jquery失败！",b)}}window.$=window.jQuery=jquery,_load(()=>{});var lodash=createCommonjsModule(function(b,r){(function(){var o,a="Expected a function",v="__lodash_hash_undefined__",h="__lodash_placeholder__",w=16,L=32,G=64,k=128,D=256,f=1/0,O=9007199254740991,C=NaN,j=4294967295,V=[["ary",k],["bind",1],["bindKey",2],["curry",8],["curryRight",w],["flip",512],["partial",L],["partialRight",G],["rearg",D]],R="[object Arguments]",M="[object Array]",ee="[object Boolean]",F="[object Date]",_="[object Error]",J="[object Function]",T="[object GeneratorFunction]",B="[object Map]",N="[object Number]",u="[object Object]",c="[object Promise]",m="[object RegExp]",E="[object Set]",U="[object String]",X="[object Symbol]",W="[object WeakMap]",te="[object ArrayBuffer]",ne="[object DataView]",ce="[object Float32Array]",we="[object Float64Array]",Ie="[object Int8Array]",xe="[object Int16Array]",Be="[object Int32Array]",q="[object Uint8Array]",ge="[object Uint8ClampedArray]",oe="[object Uint16Array]",se="[object Uint32Array]",Ae=/\b__p \+= '';/g,Ye=/\b(__p \+=) '' \+/g,Ge=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ne=/&(?:amp|lt|gt|quot|#39);/g,le=/[&<>"']/g,ve=RegExp(Ne.source),He=RegExp(le.source),nt=/<%-([\s\S]+?)%>/g,ht=/<%([\s\S]+?)%>/g,Tt=/<%=([\s\S]+?)%>/g,Ct=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,We=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bt=/[\\^$.*+?()[\]{}|]/g,Ln=RegExp(Bt.source),rn=/^\s+/,Xn=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ze=/\{\n\/\* \[wrapped with (.+)\] \*/,Zt=/,? & /,An=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Yn=/[()=,{}\[\]\/\s]/,pt=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qt=/\w*$/,xn=/^[-+]0x[0-9a-f]+$/i,nn=/^0b[01]+$/i,er=/^\[object .+?Constructor\]$/,kr=/^0o[0-7]+$/i,ct=/^(?:0|[1-9]\d*)$/,Ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,Wt=/['\n\r\u2028\u2029\\]/g,$e="\\ud800-\\udfff",Rt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",$t="\\u2700-\\u27bf",an="a-z\\xdf-\\xf6\\xf8-\\xff",hr="A-Z\\xc0-\\xd6\\xd8-\\xde",_r="\\ufe0e\\ufe0f",qr="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ur="["+$e+"]",Gr="["+qr+"]",Or="["+Rt+"]",Qi="\\d+",Pi="["+$t+"]",si="["+an+"]",gr="[^"+$e+qr+Qi+$t+an+hr+"]",Wi="\\ud83c[\\udffb-\\udfff]",H="[^"+$e+"]",Hr="(?:\\ud83c[\\udde6-\\uddff]){2}",Da="[\\ud800-\\udbff][\\udc00-\\udfff]",$n="["+hr+"]",oa="\\u200d",No="(?:"+si+"|"+gr+")",Fs="(?:"+$n+"|"+gr+")",es="(?:['’](?:d|ll|m|re|s|t|ve))?",fs="(?:['’](?:D|LL|M|RE|S|T|VE))?",to="(?:"+Or+"|"+Wi+")?",ts="["+_r+"]?",sa=ts+to+"(?:"+oa+"(?:"+[H,Hr,Da].join("|")+")"+ts+to+")*",Bo="(?:"+[Pi,Hr,Da].join("|")+")"+sa,Ea="(?:"+[H+Or+"?",Or,Hr,Da,Ur].join("|")+")",ms=RegExp("['’]","g"),Vs=RegExp(Or,"g"),no=RegExp(Wi+"(?="+Wi+")|"+Ea+sa,"g"),gs=RegExp([$n+"?"+si+"+"+es+"(?="+[Gr,$n,"$"].join("|")+")",Fs+"+"+fs+"(?="+[Gr,$n+No,"$"].join("|")+")",$n+"?"+No+"+"+es,$n+"+"+fs,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Qi,Bo].join("|"),"g"),Pa=RegExp("["+oa+$e+Rt+_r+"]"),ys=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ro=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],io=-1,Xr={};Xr[ce]=Xr[we]=Xr[Ie]=Xr[xe]=Xr[Be]=Xr[q]=Xr[ge]=Xr[oe]=Xr[se]=!0,Xr[R]=Xr[M]=Xr[te]=Xr[ee]=Xr[ne]=Xr[F]=Xr[_]=Xr[J]=Xr[B]=Xr[N]=Xr[u]=Xr[m]=Xr[E]=Xr[U]=Xr[W]=!1;var Sr={};Sr[R]=Sr[M]=Sr[te]=Sr[ne]=Sr[ee]=Sr[F]=Sr[ce]=Sr[we]=Sr[Ie]=Sr[xe]=Sr[Be]=Sr[B]=Sr[N]=Sr[u]=Sr[m]=Sr[E]=Sr[U]=Sr[X]=Sr[q]=Sr[ge]=Sr[oe]=Sr[se]=!0,Sr[_]=Sr[J]=Sr[W]=!1;var ns={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vs=parseFloat,rs=parseInt,Fo=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,Ji=typeof self=="object"&&self&&self.Object===Object&&self,jr=Fo||Ji||Function("return this")(),K=r&&!r.nodeType&&r,Ce=K&&b&&!b.nodeType&&b,ue=Ce&&Ce.exports===K,Te=ue&&Fo.process,Ke=function(){try{return Ce&&Ce.require&&Ce.require("util").types||Te&&Te.binding&&Te.binding("util")}catch{}}(),vt=Ke&&Ke.isArrayBuffer,Ft=Ke&&Ke.isDate,Xt=Ke&&Ke.isMap,In=Ke&&Ke.isRegExp,Gn=Ke&&Ke.isSet,or=Ke&&Ke.isTypedArray;function hi(Me,Se,je){switch(je.length){case 0:return Me.call(Se);case 1:return Me.call(Se,je[0]);case 2:return Me.call(Se,je[0],je[1]);case 3:return Me.call(Se,je[0],je[1],je[2])}return Me.apply(Se,je)}function ao(Me,Se,je,rt){for(var mt=-1,ut=Me==null?0:Me.length;++mt<ut;){var Lt=Me[mt];Se(rt,Lt,je(Lt),Me)}return rt}function Ci(Me,Se){for(var je=-1,rt=Me==null?0:Me.length;++je<rt&&Se(Me[je],je,Me)!==!1;);return Me}function vo(Me,Se){for(var je=-1,rt=Me==null?0:Me.length;++je<rt;)if(!Se(Me[je],je,Me))return!1;return!0}function Co(Me,Se){for(var je=-1,rt=Me==null?0:Me.length,mt=0,ut=[];++je<rt;){var Lt=Me[je];Se(Lt,je,Me)&&(ut[mt++]=Lt)}return ut}function oo(Me,Se){return!(Me==null||!Me.length)&&Si(Me,Se,0)>-1}function Gs(Me,Se,je){for(var rt=-1,mt=Me==null?0:Me.length;++rt<mt;)if(je(Se,Me[rt]))return!0;return!1}function Wr(Me,Se){for(var je=-1,rt=Me==null?0:Me.length,mt=Array(rt);++je<rt;)mt[je]=Se(Me[je],je,Me);return mt}function wa(Me,Se){for(var je=-1,rt=Se.length,mt=Me.length;++je<rt;)Me[mt+je]=Se[je];return Me}function Ia(Me,Se,je,rt){var mt=-1,ut=Me==null?0:Me.length;for(rt&&ut&&(je=Me[++mt]);++mt<ut;)je=Se(je,Me[mt],mt,Me);return je}function ea(Me,Se,je,rt){var mt=Me==null?0:Me.length;for(rt&&mt&&(je=Me[--mt]);mt--;)je=Se(je,Me[mt],mt,Me);return je}function Vo(Me,Se){for(var je=-1,rt=Me==null?0:Me.length;++je<rt;)if(Se(Me[je],je,Me))return!0;return!1}var xs=Jr("length");function vr(Me,Se,je){var rt;return je(Me,function(mt,ut,Lt){if(Se(mt,ut,Lt))return rt=ut,!1}),rt}function zt(Me,Se,je,rt){for(var mt=Me.length,ut=je+(rt?1:-1);rt?ut--:++ut<mt;)if(Se(Me[ut],ut,Me))return ut;return-1}function Si(Me,Se,je){return Se==Se?function(rt,mt,ut){for(var Lt=ut-1,kn=rt.length;++Lt<kn;)if(rt[Lt]===mt)return Lt;return-1}(Me,Se,je):zt(Me,lu,je)}function Go(Me,Se,je,rt){for(var mt=je-1,ut=Me.length;++mt<ut;)if(rt(Me[mt],Se))return mt;return-1}function lu(Me){return Me!=Me}function Yr(Me,Se){var je=Me==null?0:Me.length;return je?Bi(Me,Se)/je:C}function Jr(Me){return function(Se){return Se==null?o:Se[Me]}}function qi(Me){return function(Se){return Me==null?o:Me[Se]}}function zs(Me,Se,je,rt,mt){return mt(Me,function(ut,Lt,kn){je=rt?(rt=!1,ut):Se(je,ut,Lt,kn)}),je}function Bi(Me,Se){for(var je,rt=-1,mt=Me.length;++rt<mt;){var ut=Se(Me[rt]);ut!==o&&(je=je===o?ut:je+ut)}return je}function ws(Me,Se){for(var je=-1,rt=Array(Me);++je<Me;)rt[je]=Se(je);return rt}function Us(Me){return Me&&Me.slice(0,de(Me)+1).replace(rn,"")}function Oe(Me){return function(Se){return Me(Se)}}function So(Me,Se){return Wr(Se,function(je){return Me[je]})}function ta(Me,Se){return Me.has(Se)}function cu(Me,Se){for(var je=-1,rt=Me.length;++je<rt&&Si(Se,Me[je],0)>-1;);return je}function bs(Me,Se){for(var je=Me.length;je--&&Si(Se,Me[je],0)>-1;);return je}var Do=qi({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),Hs=qi({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ba(Me){return"\\"+ns[Me]}function fr(Me){return Pa.test(Me)}function _l(Me){var Se=-1,je=Array(Me.size);return Me.forEach(function(rt,mt){je[++Se]=[mt,rt]}),je}function ac(Me,Se){return function(je){return Me(Se(je))}}function y(Me,Se){for(var je=-1,rt=Me.length,mt=0,ut=[];++je<rt;){var Lt=Me[je];Lt!==Se&&Lt!==h||(Me[je]=h,ut[mt++]=je)}return ut}function S(Me){var Se=-1,je=Array(Me.size);return Me.forEach(function(rt){je[++Se]=rt}),je}function Z(Me){return fr(Me)?function(Se){for(var je=no.lastIndex=0;no.test(Se);)++je;return je}(Me):xs(Me)}function re(Me){return fr(Me)?function(Se){return Se.match(no)||[]}(Me):function(Se){return Se.split("")}(Me)}function de(Me){for(var Se=Me.length;Se--&&Xn.test(Me.charAt(Se)););return Se}var fe=qi({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),_e=function Me(Se){var je,rt=(Se=Se==null?jr:_e.defaults(jr.Object(),Se,_e.pick(jr,ro))).Array,mt=Se.Date,ut=Se.Error,Lt=Se.Function,kn=Se.Math,At=Se.Object,Hn=Se.RegExp,Zr=Se.String,Fr=Se.TypeError,la=rt.prototype,Ma=Lt.prototype,dr=At.prototype,_a=Se["__core-js_shared__"],xr=Ma.toString,Wn=dr.hasOwnProperty,so=0,zo=(je=/[^.]+$/.exec(_a&&_a.keys&&_a.keys.IE_PROTO||""))?"Symbol(src)_1."+je:"",ca=dr.toString,Uo=xr.call(At),Ta=jr._,Xi=Hn("^"+xr.call(Wn).replace(Bt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lo=ue?Se.Buffer:o,Fi=Se.Symbol,Kr=Se.Uint8Array,$r=lo?lo.allocUnsafe:o,Oi=ac(At.getPrototypeOf,At),Ua=At.create,wi=dr.propertyIsEnumerable,Jn=la.splice,li=Fi?Fi.isConcatSpreadable:o,ni=Fi?Fi.iterator:o,Ar=Fi?Fi.toStringTag:o,Ca=function(){try{var s=Ps(At,"defineProperty");return s({},"",{}),s}catch{}}(),Ms=Se.clearTimeout!==jr.clearTimeout&&Se.clearTimeout,Tl=mt&&mt.now!==jr.Date.now&&mt.now,na=Se.setTimeout!==jr.setTimeout&&Se.setTimeout,ua=kn.ceil,Vi=kn.floor,_s=At.getOwnPropertySymbols,Ha=lo?lo.isBuffer:o,xo=Se.isFinite,Eo=la.join,Cl=ac(At.keys,At),di=kn.max,Ai=kn.min,Ws=mt.now,Ri=Se.parseInt,Sl=kn.random,Le=la.reverse,ot=Ps(Se,"DataView"),Qe=Ps(Se,"Map"),St=Ps(Se,"Promise"),jt=Ps(Se,"Set"),gn=Ps(Se,"WeakMap"),yn=Ps(At,"create"),Rn=gn&&new gn,kt={},Mr=Xo(ot),Cn=Xo(Qe),en=Xo(St),Rr=Xo(jt),tr=Xo(gn),ci=Fi?Fi.prototype:o,bi=ci?ci.valueOf:o,pi=ci?ci.toString:o;function be(s){if(yi(s)&&!yr(s)&&!(s instanceof wr)){if(s instanceof Tr)return s;if(Wn.call(s,"__wrapped__"))return Yo(s)}return new Tr(s)}var Mi=function(){function s(){}return function(p){if(!gi(p))return{};if(Ua)return Ua(p);s.prototype=p;var P=new s;return s.prototype=o,P}}();function on(){}function Tr(s,p){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=o}function wr(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=j,this.__views__=[]}function Yi(s){var p=-1,P=s==null?0:s.length;for(this.clear();++p<P;){var ae=s[p];this.set(ae[0],ae[1])}}function Wa(s){var p=-1,P=s==null?0:s.length;for(this.clear();++p<P;){var ae=s[p];this.set(ae[0],ae[1])}}function Gi(s){var p=-1,P=s==null?0:s.length;for(this.clear();++p<P;){var ae=s[p];this.set(ae[0],ae[1])}}function wo(s){var p=-1,P=s==null?0:s.length;for(this.__data__=new Gi;++p<P;)this.add(s[p])}function ha(s){var p=this.__data__=new Wa(s);this.size=p.size}function Ja(s,p){var P=yr(s),ae=!P&&ra(s),pe=!P&&!ae&&Ro(s),Pe=!P&&!ae&&!pe&&Yl(s),Xe=P||ae||pe||Pe,it=Xe?ws(s.length,Zr):[],wt=it.length;for(var gt in s)!p&&!Wn.call(s,gt)||Xe&&(gt=="length"||pe&&(gt=="offset"||gt=="parent")||Pe&&(gt=="buffer"||gt=="byteLength"||gt=="byteOffset")||Jo(gt,wt))||it.push(gt);return it}function Dl(s){var p=s.length;return p?s[Dr(0,p-1)]:o}function Li(s,p,P){(P!==o&&!Ka(s[p],P)||P===o&&!(p in s))&&ka(s,p,P)}function Sn(s,p,P){var ae=s[p];Wn.call(s,p)&&Ka(ae,P)&&(P!==o||p in s)||ka(s,p,P)}function oc(s,p){for(var P=s.length;P--;)if(Ka(s[P][0],p))return P;return-1}function Js(s,p,P,ae){return Po(s,function(pe,Pe,Xe){p(ae,pe,P(pe),Xe)}),ae}function uu(s,p){return s&&Ho(p,Ui(p),s)}function ka(s,p,P){p=="__proto__"&&Ca?Ca(s,p,{configurable:!0,enumerable:!0,value:P,writable:!0}):s[p]=P}function is(s,p){for(var P=-1,ae=p.length,pe=rt(ae),Pe=s==null;++P<ae;)pe[P]=Pe?o:Gu(s,p[P]);return pe}function co(s,p,P){return s==s&&(P!==o&&(s=s<=P?s:P),p!==o&&(s=s>=p?s:p)),s}function qa(s,p,P,ae,pe,Pe){var Xe,it=1&p,wt=2&p,gt=4&p;if(P&&(Xe=pe?P(s,ae,pe,Pe):P(s)),Xe!==o)return Xe;if(!gi(s))return s;var Nt=yr(s);if(Nt){if(Xe=function(Ut){var sn=Ut.length,Nn=new Ut.constructor(sn);return sn&&typeof Ut[0]=="string"&&Wn.call(Ut,"index")&&(Nn.index=Ut.index,Nn.input=Ut.input),Nn}(s),!it)return Za(s,Xe)}else{var Qt=Aa(s),On=Qt==J||Qt==T;if(Ro(s))return Uh(s,it);if(Qt==u||Qt==R||On&&!pe){if(Xe=wt||On?{}:nd(s),!it)return wt?function(Ut,sn){return Ho(Ut,Sh(Ut),sn)}(s,function(Ut,sn){return Ut&&Ho(sn,pa(sn),Ut)}(Xe,s)):function(Ut,sn){return Ho(Ut,Ch(Ut),sn)}(s,uu(Xe,s))}else{if(!Sr[Qt])return pe?s:{};Xe=function(Ut,sn,Nn){var wn,pr=Ut.constructor;switch(sn){case te:return yh(Ut);case ee:case F:return new pr(+Ut);case ne:return function(lr,Er){var Bn=Er?yh(lr.buffer):lr.buffer;return new lr.constructor(Bn,lr.byteOffset,lr.byteLength)}(Ut,Nn);case ce:case we:case Ie:case xe:case Be:case q:case ge:case oe:case se:return Hh(Ut,Nn);case B:return new pr;case N:case U:return new pr(Ut);case m:return function(lr){var Er=new lr.constructor(lr.source,qt.exec(lr));return Er.lastIndex=lr.lastIndex,Er}(Ut);case E:return new pr;case X:return wn=Ut,bi?At(bi.call(wn)):{}}}(s,Qt,it)}}Pe||(Pe=new ha);var jn=Pe.get(s);if(jn)return jn;Pe.set(s,Xe),Xl(s)?s.forEach(function(Ut){Xe.add(qa(Ut,p,P,Ut,s,Pe))}):Ic(s)&&s.forEach(function(Ut,sn){Xe.set(sn,qa(Ut,p,P,sn,s,Pe))});var Qn=Nt?o:(gt?wt?tl:el:wt?pa:Ui)(s);return Ci(Qn||s,function(Ut,sn){Qn&&(Ut=s[sn=Ut]),Sn(Xe,sn,qa(Ut,p,P,sn,s,Pe))}),Xe}function hu(s,p,P){var ae=P.length;if(s==null)return!ae;for(s=At(s);ae--;){var pe=P[ae],Pe=p[pe],Xe=s[pe];if(Xe===o&&!(pe in s)||!Pe(Xe))return!1}return!0}function du(s,p,P){if(typeof s!="function")throw new Fr(a);return jl(function(){s.apply(o,P)},p)}function Ts(s,p,P,ae){var pe=-1,Pe=oo,Xe=!0,it=s.length,wt=[],gt=p.length;if(!it)return wt;P&&(p=Wr(p,Oe(P))),ae?(Pe=Gs,Xe=!1):p.length>=200&&(Pe=ta,Xe=!1,p=new wo(p));e:for(;++pe<it;){var Nt=s[pe],Qt=P==null?Nt:P(Nt);if(Nt=ae||Nt!==0?Nt:0,Xe&&Qt==Qt){for(var On=gt;On--;)if(p[On]===Qt)continue e;wt.push(Nt)}else Pe(p,Qt,ae)||wt.push(Nt)}return wt}be.templateSettings={escape:nt,evaluate:ht,interpolate:Tt,variable:"",imports:{_:be}},be.prototype=on.prototype,be.prototype.constructor=be,Tr.prototype=Mi(on.prototype),Tr.prototype.constructor=Tr,wr.prototype=Mi(on.prototype),wr.prototype.constructor=wr,Yi.prototype.clear=function(){this.__data__=yn?yn(null):{},this.size=0},Yi.prototype.delete=function(s){var p=this.has(s)&&delete this.__data__[s];return this.size-=p?1:0,p},Yi.prototype.get=function(s){var p=this.__data__;if(yn){var P=p[s];return P===v?o:P}return Wn.call(p,s)?p[s]:o},Yi.prototype.has=function(s){var p=this.__data__;return yn?p[s]!==o:Wn.call(p,s)},Yi.prototype.set=function(s,p){var P=this.__data__;return this.size+=this.has(s)?0:1,P[s]=yn&&p===o?v:p,this},Wa.prototype.clear=function(){this.__data__=[],this.size=0},Wa.prototype.delete=function(s){var p=this.__data__,P=oc(p,s);return!(P<0||(P==p.length-1?p.pop():Jn.call(p,P,1),--this.size,0))},Wa.prototype.get=function(s){var p=this.__data__,P=oc(p,s);return P<0?o:p[P][1]},Wa.prototype.has=function(s){return oc(this.__data__,s)>-1},Wa.prototype.set=function(s,p){var P=this.__data__,ae=oc(P,s);return ae<0?(++this.size,P.push([s,p])):P[ae][1]=p,this},Gi.prototype.clear=function(){this.size=0,this.__data__={hash:new Yi,map:new(Qe||Wa),string:new Yi}},Gi.prototype.delete=function(s){var p=Cu(this,s).delete(s);return this.size-=p?1:0,p},Gi.prototype.get=function(s){return Cu(this,s).get(s)},Gi.prototype.has=function(s){return Cu(this,s).has(s)},Gi.prototype.set=function(s,p){var P=Cu(this,s),ae=P.size;return P.set(s,p),this.size+=P.size==ae?0:1,this},wo.prototype.add=wo.prototype.push=function(s){return this.__data__.set(s,v),this},wo.prototype.has=function(s){return this.__data__.has(s)},ha.prototype.clear=function(){this.__data__=new Wa,this.size=0},ha.prototype.delete=function(s){var p=this.__data__,P=p.delete(s);return this.size=p.size,P},ha.prototype.get=function(s){return this.__data__.get(s)},ha.prototype.has=function(s){return this.__data__.has(s)},ha.prototype.set=function(s,p){var P=this.__data__;if(P instanceof Wa){var ae=P.__data__;if(!Qe||ae.length<199)return ae.push([s,p]),this.size=++P.size,this;P=this.__data__=new Gi(ae)}return P.set(s,p),this.size=P.size,this};var Po=Xh(Oo),sc=Xh(Ol,!0);function El(s,p){var P=!0;return Po(s,function(ae,pe,Pe){return P=!!p(ae,pe,Pe)}),P}function as(s,p,P){for(var ae=-1,pe=s.length;++ae<pe;){var Pe=s[ae],Xe=p(Pe);if(Xe!=null&&(it===o?Xe==Xe&&!fo(Xe):P(Xe,it)))var it=Xe,wt=Pe}return wt}function qs(s,p){var P=[];return Po(s,function(ae,pe,Pe){p(ae,pe,Pe)&&P.push(ae)}),P}function zi(s,p,P,ae,pe){var Pe=-1,Xe=s.length;for(P||(P=qd),pe||(pe=[]);++Pe<Xe;){var it=s[Pe];p>0&&P(it)?p>1?zi(it,p-1,P,ae,pe):wa(pe,it):ae||(pe[pe.length]=it)}return pe}var Pl=Yh(),_i=Yh(!0);function Oo(s,p){return s&&Pl(s,p,Ui)}function Ol(s,p){return s&&_i(s,p,Ui)}function pu(s,p){return Co(p,function(P){return po(s[P])})}function Oa(s,p){for(var P=0,ae=(p=Ds(p,s)).length;s!=null&&P<ae;)s=s[ho(p[P++])];return P&&P==ae?s:o}function fu(s,p,P){var ae=p(s);return yr(s)?ae:wa(ae,P(s))}function da(s){return s==null?s===o?"[object Undefined]":"[object Null]":Ar&&Ar in At(s)?function(p){var P=Wn.call(p,Ar),ae=p[Ar];try{p[Ar]=o;var pe=!0}catch{}var Pe=ca.call(p);return pe&&(P?p[Ar]=ae:delete p[Ar]),Pe}(s):function(p){return ca.call(p)}(s)}function sr(s,p){return s>p}function oh(s,p){return s!=null&&Wn.call(s,p)}function lc(s,p){return s!=null&&p in At(s)}function Cs(s,p,P){for(var ae=P?Gs:oo,pe=s[0].length,Pe=s.length,Xe=Pe,it=rt(Pe),wt=1/0,gt=[];Xe--;){var Nt=s[Xe];Xe&&p&&(Nt=Wr(Nt,Oe(p))),wt=Ai(Nt.length,wt),it[Xe]=!P&&(p||pe>=120&&Nt.length>=120)?new wo(Xe&&Nt):o}Nt=s[0];var Qt=-1,On=it[0];e:for(;++Qt<pe&&gt.length<wt;){var jn=Nt[Qt],Qn=p?p(jn):jn;if(jn=P||jn!==0?jn:0,!(On?ta(On,Qn):ae(gt,Qn,P))){for(Xe=Pe;--Xe;){var Ut=it[Xe];if(!(Ut?ta(Ut,Qn):ae(s[Xe],Qn,P)))continue e}On&&On.push(Qn),gt.push(jn)}}return gt}function Zi(s,p,P){var ae=(s=Ph(s,p=Ds(p,s)))==null?s:s[ho(Fa(p))];return ae==null?o:hi(ae,s,P)}function sh(s){return yi(s)&&da(s)==R}function cc(s,p,P,ae,pe){return s===p||(s==null||p==null||!yi(s)&&!yi(p)?s!=s&&p!=p:function(Pe,Xe,it,wt,gt,Nt){var Qt=yr(Pe),On=yr(Xe),jn=Qt?M:Aa(Pe),Qn=On?M:Aa(Xe),Ut=(jn=jn==R?u:jn)==u,sn=(Qn=Qn==R?u:Qn)==u,Nn=jn==Qn;if(Nn&&Ro(Pe)){if(!Ro(Xe))return!1;Qt=!0,Ut=!1}if(Nn&&!Ut)return Nt||(Nt=new ha),Qt||Yl(Pe)?_h(Pe,Xe,it,wt,gt,Nt):function(Bn,zn,ui,ri,ji,zr,ga){switch(ui){case ne:if(Bn.byteLength!=zn.byteLength||Bn.byteOffset!=zn.byteOffset)return!1;Bn=Bn.buffer,zn=zn.buffer;case te:return!(Bn.byteLength!=zn.byteLength||!zr(new Kr(Bn),new Kr(zn)));case ee:case F:case N:return Ka(+Bn,+zn);case _:return Bn.name==zn.name&&Bn.message==zn.message;case m:case U:return Bn==zn+"";case B:var ya=_l;case E:var va=1&ri;if(ya||(ya=S),Bn.size!=zn.size&&!va)return!1;var $a=ga.get(Bn);if($a)return $a==zn;ri|=2,ga.set(Bn,zn);var Vr=_h(ya(Bn),ya(zn),ri,ji,zr,ga);return ga.delete(Bn),Vr;case X:if(bi)return bi.call(Bn)==bi.call(zn)}return!1}(Pe,Xe,jn,it,wt,gt,Nt);if(!(1&it)){var wn=Ut&&Wn.call(Pe,"__wrapped__"),pr=sn&&Wn.call(Xe,"__wrapped__");if(wn||pr){var lr=wn?Pe.value():Pe,Er=pr?Xe.value():Xe;return Nt||(Nt=new ha),gt(lr,Er,it,wt,Nt)}}return!!Nn&&(Nt||(Nt=new ha),function(Bn,zn,ui,ri,ji,zr){var ga=1&ui,ya=el(Bn),va=ya.length;if(va!=el(zn).length&&!ga)return!1;for(var $a=va;$a--;){var Vr=ya[$a];if(!(ga?Vr in zn:Wn.call(zn,Vr)))return!1}var Jc=zr.get(Bn),Io=zr.get(zn);if(Jc&&Io)return Jc==zn&&Io==Bn;var yl=!0;zr.set(Bn,zn),zr.set(zn,Bn);for(var tc=ga;++$a<va;){var nc=Bn[Vr=ya[$a]],vl=zn[Vr];if(ri)var xl=ga?ri(vl,nc,Vr,zn,Bn,zr):ri(nc,vl,Vr,Bn,zn,zr);if(!(xl===o?nc===vl||ji(nc,vl,ui,ri,zr):xl)){yl=!1;break}tc||(tc=Vr=="constructor")}if(yl&&!tc){var wl=Bn.constructor,bl=zn.constructor;wl==bl||!("constructor"in Bn)||!("constructor"in zn)||typeof wl=="function"&&wl instanceof wl&&typeof bl=="function"&&bl instanceof bl||(yl=!1)}return zr.delete(Bn),zr.delete(zn),yl}(Pe,Xe,it,wt,gt,Nt))}(s,p,P,ae,cc,pe))}function lh(s,p,P,ae){var pe=P.length,Pe=pe,Xe=!ae;if(s==null)return!Pe;for(s=At(s);pe--;){var it=P[pe];if(Xe&&it[2]?it[1]!==s[it[0]]:!(it[0]in s))return!1}for(;++pe<Pe;){var wt=(it=P[pe])[0],gt=s[wt],Nt=it[1];if(Xe&&it[2]){if(gt===o&&!(wt in s))return!1}else{var Qt=new ha;if(ae)var On=ae(gt,Nt,wt,s,p,Qt);if(!(On===o?cc(Nt,gt,3,ae,Qt):On))return!1}}return!0}function Xa(s){return!(!gi(s)||(p=s,zo&&zo in p))&&(po(s)?Xi:er).test(Xo(s));var p}function Ao(s){return typeof s=="function"?s:s==null?fa:typeof s=="object"?yr(s)?Zs(s[0],s[1]):Al(s):ma(s)}function Ii(s){if(!qo(s))return Cl(s);var p=[];for(var P in At(s))Wn.call(s,P)&&P!="constructor"&&p.push(P);return p}function Xs(s,p){return s<p}function Ys(s,p){var P=-1,ae=Sa(s)?rt(s.length):[];return Po(s,function(pe,Pe,Xe){ae[++P]=p(pe,Pe,Xe)}),ae}function Al(s){var p=Th(s);return p.length==1&&p[0][2]?id(p[0][0],p[0][1]):function(P){return P===s||lh(P,s,p)}}function Zs(s,p){return Dh(s)&&nl(p)?id(ho(s),p):function(P){var ae=Gu(P,s);return ae===o&&ae===p?ul(P,s):cc(p,ae,3)}}function Ks(s,p,P,ae,pe){s!==p&&Pl(p,function(Pe,Xe){if(pe||(pe=new ha),gi(Pe))(function(wt,gt,Nt,Qt,On,jn,Qn){var Ut=Oh(wt,Nt),sn=Oh(gt,Nt),Nn=Qn.get(sn);if(Nn)Li(wt,Nt,Nn);else{var wn=jn?jn(Ut,sn,Nt+"",wt,gt,Qn):o,pr=wn===o;if(pr){var lr=yr(sn),Er=!lr&&Ro(sn),Bn=!lr&&!Er&&Yl(sn);wn=sn,lr||Er||Bn?yr(Ut)?wn=Ut:mi(Ut)?wn=Za(Ut):Er?(pr=!1,wn=Uh(sn,!0)):Bn?(pr=!1,wn=Hh(sn,!0)):wn=[]:ql(sn)||ra(sn)?(wn=Ut,ra(Ut)?wn=As(Ut):gi(Ut)&&!po(Ut)||(wn=nd(sn))):pr=!1}pr&&(Qn.set(sn,wn),On(wn,sn,Qt,jn,Qn),Qn.delete(sn)),Li(wt,Nt,wn)}})(s,p,Xe,P,Ks,ae,pe);else{var it=ae?ae(Oh(s,Xe),Pe,Xe+"",s,p,pe):o;it===o&&(it=Pe),Li(s,Xe,it)}},pa)}function $s(s,p){var P=s.length;if(P)return Jo(p+=p<0?P:0,P)?s[p]:o}function bn(s,p,P){var ae=-1;return p=Wr(p=p.length?Wr(p,function(pe){return yr(pe)?function(Pe){return Oa(Pe,pe.length===1?pe[0]:pe)}:pe}):[fa],Oe(nr())),function(pe,Pe){var Xe=pe.length;for(pe.sort(Pe);Xe--;)pe[Xe]=pe[Xe].value;return pe}(Ys(s,function(pe,Pe,Xe){return{criteria:Wr(p,function(it){return it(pe)}),index:++ae,value:pe}}),function(pe,Pe){return function(Xe,it,wt){for(var gt=-1,Nt=Xe.criteria,Qt=it.criteria,On=Nt.length,jn=wt.length;++gt<On;){var Qn=Wh(Nt[gt],Qt[gt]);if(Qn)return gt>=jn?Qn:Qn*(wt[gt]=="desc"?-1:1)}return Xe.index-it.index}(pe,Pe,P)})}function ch(s,p,P){for(var ae=-1,pe=p.length,Pe={};++ae<pe;){var Xe=p[ae],it=Oa(s,Xe);P(it,Xe)&&uc(Pe,Ds(Xe,s),it)}return Pe}function Rl(s,p,P,ae){var pe=ae?Go:Si,Pe=-1,Xe=p.length,it=s;for(s===p&&(p=Za(p)),P&&(it=Wr(s,Oe(P)));++Pe<Xe;)for(var wt=0,gt=p[Pe],Nt=P?P(gt):gt;(wt=pe(it,Nt,wt,ae))>-1;)it!==s&&Jn.call(it,wt,1),Jn.call(s,wt,1);return s}function Qs(s,p){for(var P=s?p.length:0,ae=P-1;P--;){var pe=p[P];if(P==ae||pe!==Pe){var Pe=pe;Jo(pe)?Jn.call(s,pe,1):yu(s,pe)}}return s}function Dr(s,p){return s+Vi(Sl()*(p-s+1))}function bo(s,p){var P="";if(!s||p<1||p>O)return P;do p%2&&(P+=s),(p=Vi(p/2))&&(s+=s);while(p);return P}function Lr(s,p){return pc(ad(s,p,fa),s+"")}function uc(s,p,P,ae){if(!gi(s))return s;for(var pe=-1,Pe=(p=Ds(p,s)).length,Xe=Pe-1,it=s;it!=null&&++pe<Pe;){var wt=ho(p[pe]),gt=P;if(wt==="__proto__"||wt==="constructor"||wt==="prototype")return s;if(pe!=Xe){var Nt=it[wt];(gt=ae?ae(Nt,wt,it):o)===o&&(gt=gi(Nt)?Nt:Jo(p[pe+1])?[]:{})}Sn(it,wt,gt),it=it[wt]}return s}var Ss=Rn?function(s,p){return Rn.set(s,p),s}:fa,mu=Ca?function(s,p){return Ca(s,"toString",{configurable:!0,enumerable:!1,value:ks(p),writable:!0})}:fa;function ja(s,p,P){var ae=-1,pe=s.length;p<0&&(p=-p>pe?0:pe+p),(P=P>pe?pe:P)<0&&(P+=pe),pe=p>P?0:P-p>>>0,p>>>=0;for(var Pe=rt(pe);++ae<pe;)Pe[ae]=s[ae+p];return Pe}function Gh(s,p){var P;return Po(s,function(ae,pe,Pe){return!(P=p(ae,pe,Pe))}),!!P}function gu(s,p,P){var ae=0,pe=s==null?ae:s.length;if(typeof p=="number"&&p==p&&pe<=2147483647){for(;ae<pe;){var Pe=ae+pe>>>1,Xe=s[Pe];Xe!==null&&!fo(Xe)&&(P?Xe<=p:Xe<p)?ae=Pe+1:pe=Pe}return pe}return uh(s,p,fa,P)}function uh(s,p,P,ae){var pe=0,Pe=s==null?0:s.length;if(Pe===0)return 0;for(var Xe=(p=P(p))!=p,it=p===null,wt=fo(p),gt=p===o;pe<Pe;){var Nt=Vi((pe+Pe)/2),Qt=P(s[Nt]),On=Qt!==o,jn=Qt===null,Qn=Qt==Qt,Ut=fo(Qt);if(Xe)var sn=ae||Qn;else sn=gt?Qn&&(ae||On):it?Qn&&On&&(ae||!jn):wt?Qn&&On&&!jn&&(ae||!Ut):!jn&&!Ut&&(ae?Qt<=p:Qt<p);sn?pe=Nt+1:Pe=Nt}return Ai(Pe,4294967294)}function hh(s,p){for(var P=-1,ae=s.length,pe=0,Pe=[];++P<ae;){var Xe=s[P],it=p?p(Xe):Xe;if(!P||!Ka(it,wt)){var wt=it;Pe[pe++]=Xe===0?0:Xe}}return Pe}function dh(s){return typeof s=="number"?s:fo(s)?C:+s}function Ya(s){if(typeof s=="string")return s;if(yr(s))return Wr(s,Ya)+"";if(fo(s))return pi?pi.call(s):"";var p=s+"";return p=="0"&&1/s==-1/0?"-0":p}function os(s,p,P){var ae=-1,pe=oo,Pe=s.length,Xe=!0,it=[],wt=it;if(P)Xe=!1,pe=Gs;else if(Pe>=200){var gt=p?null:wh(s);if(gt)return S(gt);Xe=!1,pe=ta,wt=new wo}else wt=p?[]:it;e:for(;++ae<Pe;){var Nt=s[ae],Qt=p?p(Nt):Nt;if(Nt=P||Nt!==0?Nt:0,Xe&&Qt==Qt){for(var On=wt.length;On--;)if(wt[On]===Qt)continue e;p&&wt.push(Qt),it.push(Nt)}else pe(wt,Qt,P)||(wt!==it&&wt.push(Qt),it.push(Nt))}return it}function yu(s,p){return(s=Ph(s,p=Ds(p,s)))==null||delete s[ho(Fa(p))]}function ph(s,p,P,ae){return uc(s,p,P(Oa(s,p)),ae)}function ss(s,p,P,ae){for(var pe=s.length,Pe=ae?pe:-1;(ae?Pe--:++Pe<pe)&&p(s[Pe],Pe,s););return P?ja(s,ae?0:Pe,ae?Pe+1:pe):ja(s,ae?Pe+1:0,ae?pe:Pe)}function uo(s,p){var P=s;return P instanceof wr&&(P=P.value()),Ia(p,function(ae,pe){return pe.func.apply(pe.thisArg,wa([ae],pe.args))},P)}function Na(s,p,P){var ae=s.length;if(ae<2)return ae?os(s[0]):[];for(var pe=-1,Pe=rt(ae);++pe<ae;)for(var Xe=s[pe],it=-1;++it<ae;)it!=pe&&(Pe[pe]=Ts(Pe[pe]||Xe,s[it],p,P));return os(zi(Pe,1),p,P)}function fh(s,p,P){for(var ae=-1,pe=s.length,Pe=p.length,Xe={};++ae<pe;){var it=ae<Pe?p[ae]:o;P(Xe,s[ae],it)}return Xe}function mh(s){return mi(s)?s:[]}function gh(s){return typeof s=="function"?s:fa}function Ds(s,p){return yr(s)?s:Dh(s,p)?[s]:Su(Qr(s))}var Wd=Lr;function Es(s,p,P){var ae=s.length;return P=P===o?ae:P,!p&&P>=ae?s:ja(s,p,P)}var zh=Ms||function(s){return jr.clearTimeout(s)};function Uh(s,p){if(p)return s.slice();var P=s.length,ae=$r?$r(P):new s.constructor(P);return s.copy(ae),ae}function yh(s){var p=new s.constructor(s.byteLength);return new Kr(p).set(new Kr(s)),p}function Hh(s,p){var P=p?yh(s.buffer):s.buffer;return new s.constructor(P,s.byteOffset,s.length)}function Wh(s,p){if(s!==p){var P=s!==o,ae=s===null,pe=s==s,Pe=fo(s),Xe=p!==o,it=p===null,wt=p==p,gt=fo(p);if(!it&&!gt&&!Pe&&s>p||Pe&&Xe&&wt&&!it&&!gt||ae&&Xe&&wt||!P&&wt||!pe)return 1;if(!ae&&!Pe&&!gt&&s<p||gt&&P&&pe&&!ae&&!Pe||it&&P&&pe||!Xe&&pe||!wt)return-1}return 0}function Jh(s,p,P,ae){for(var pe=-1,Pe=s.length,Xe=P.length,it=-1,wt=p.length,gt=di(Pe-Xe,0),Nt=rt(wt+gt),Qt=!ae;++it<wt;)Nt[it]=p[it];for(;++pe<Xe;)(Qt||pe<Pe)&&(Nt[P[pe]]=s[pe]);for(;gt--;)Nt[it++]=s[pe++];return Nt}function qh(s,p,P,ae){for(var pe=-1,Pe=s.length,Xe=-1,it=P.length,wt=-1,gt=p.length,Nt=di(Pe-it,0),Qt=rt(Nt+gt),On=!ae;++pe<Nt;)Qt[pe]=s[pe];for(var jn=pe;++wt<gt;)Qt[jn+wt]=p[wt];for(;++Xe<it;)(On||pe<Pe)&&(Qt[jn+P[Xe]]=s[pe++]);return Qt}function Za(s,p){var P=-1,ae=s.length;for(p||(p=rt(ae));++P<ae;)p[P]=s[P];return p}function Ho(s,p,P,ae){var pe=!P;P||(P={});for(var Pe=-1,Xe=p.length;++Pe<Xe;){var it=p[Pe],wt=ae?ae(P[it],s[it],it,P,s):o;wt===o&&(wt=s[it]),pe?ka(P,it,wt):Sn(P,it,wt)}return P}function vu(s,p){return function(P,ae){var pe=yr(P)?ao:Js,Pe=p?p():{};return pe(P,s,nr(ae,2),Pe)}}function Ll(s){return Lr(function(p,P){var ae=-1,pe=P.length,Pe=pe>1?P[pe-1]:o,Xe=pe>2?P[2]:o;for(Pe=s.length>3&&typeof Pe=="function"?(pe--,Pe):o,Xe&&Ba(P[0],P[1],Xe)&&(Pe=pe<3?o:Pe,pe=1),p=At(p);++ae<pe;){var it=P[ae];it&&s(p,it,ae,Pe)}return p})}function Xh(s,p){return function(P,ae){if(P==null)return P;if(!Sa(P))return s(P,ae);for(var pe=P.length,Pe=p?pe:-1,Xe=At(P);(p?Pe--:++Pe<pe)&&ae(Xe[Pe],Pe,Xe)!==!1;);return P}}function Yh(s){return function(p,P,ae){for(var pe=-1,Pe=At(p),Xe=ae(p),it=Xe.length;it--;){var wt=Xe[s?it:++pe];if(P(Pe[wt],wt,Pe)===!1)break}return p}}function Zh(s){return function(p){var P=fr(p=Qr(p))?re(p):o,ae=P?P[0]:p.charAt(0),pe=P?Es(P,1).join(""):p.slice(1);return ae[s]()+pe}}function Il(s){return function(p){return Ia(Is(dl(p).replace(ms,"")),s,"")}}function hc(s){return function(){var p=arguments;switch(p.length){case 0:return new s;case 1:return new s(p[0]);case 2:return new s(p[0],p[1]);case 3:return new s(p[0],p[1],p[2]);case 4:return new s(p[0],p[1],p[2],p[3]);case 5:return new s(p[0],p[1],p[2],p[3],p[4]);case 6:return new s(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new s(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var P=Mi(s.prototype),ae=s.apply(P,p);return gi(ae)?ae:P}}function Kh(s){return function(p,P,ae){var pe=At(p);if(!Sa(p)){var Pe=nr(P,3);p=Ui(p),P=function(it){return Pe(pe[it],it,pe)}}var Xe=s(p,P,ae);return Xe>-1?pe[Pe?p[Xe]:Xe]:o}}function $h(s){return Wo(function(p){var P=p.length,ae=P,pe=Tr.prototype.thru;for(s&&p.reverse();ae--;){var Pe=p[ae];if(typeof Pe!="function")throw new Fr(a);if(pe&&!Xe&&dc(Pe)=="wrapper")var Xe=new Tr([],!0)}for(ae=Xe?ae:P;++ae<P;){var it=dc(Pe=p[ae]),wt=it=="wrapper"?Tu(Pe):o;Xe=wt&&Eh(wt[0])&&wt[1]==424&&!wt[4].length&&wt[9]==1?Xe[dc(wt[0])].apply(Xe,wt[3]):Pe.length==1&&Eh(Pe)?Xe[it]():Xe.thru(Pe)}return function(){var gt=arguments,Nt=gt[0];if(Xe&&gt.length==1&&yr(Nt))return Xe.plant(Nt).value();for(var Qt=0,On=P?p[Qt].apply(this,gt):Nt;++Qt<P;)On=p[Qt].call(this,On);return On}})}function xu(s,p,P,ae,pe,Pe,Xe,it,wt,gt){var Nt=p&k,Qt=1&p,On=2&p,jn=24&p,Qn=512&p,Ut=On?o:hc(s);return function sn(){for(var Nn=arguments.length,wn=rt(Nn),pr=Nn;pr--;)wn[pr]=arguments[pr];if(jn)var lr=kl(sn),Er=function(ri,ji){for(var zr=ri.length,ga=0;zr--;)ri[zr]===ji&&++ga;return ga}(wn,lr);if(ae&&(wn=Jh(wn,ae,pe,jn)),Pe&&(wn=qh(wn,Pe,Xe,jn)),Nn-=Er,jn&&Nn<gt){var Bn=y(wn,lr);return xh(s,p,xu,sn.placeholder,P,wn,Bn,it,wt,gt-Nn)}var zn=Qt?P:this,ui=On?zn[s]:s;return Nn=wn.length,it?wn=function(ri,ji){for(var zr=ri.length,ga=Ai(ji.length,zr),ya=Za(ri);ga--;){var va=ji[ga];ri[ga]=Jo(va,zr)?ya[va]:o}return ri}(wn,it):Qn&&Nn>1&&wn.reverse(),Nt&&wt<Nn&&(wn.length=wt),this&&this!==jr&&this instanceof sn&&(ui=Ut||hc(ui)),ui.apply(zn,wn)}}function Qh(s,p){return function(P,ae){return function(pe,Pe,Xe,it){return Oo(pe,function(wt,gt,Nt){Pe(it,Xe(wt),gt,Nt)}),it}(P,s,p(ae),{})}}function wu(s,p){return function(P,ae){var pe;if(P===o&&ae===o)return p;if(P!==o&&(pe=P),ae!==o){if(pe===o)return ae;typeof P=="string"||typeof ae=="string"?(P=Ya(P),ae=Ya(ae)):(P=dh(P),ae=dh(ae)),pe=s(P,ae)}return pe}}function vh(s){return Wo(function(p){return p=Wr(p,Oe(nr())),Lr(function(P){var ae=this;return s(p,function(pe){return hi(pe,ae,P)})})})}function bu(s,p){var P=(p=p===o?" ":Ya(p)).length;if(P<2)return P?bo(p,s):p;var ae=bo(p,ua(s/Z(p)));return fr(p)?Es(re(ae),0,s).join(""):ae.slice(0,s)}function ed(s){return function(p,P,ae){return ae&&typeof ae!="number"&&Ba(p,P,ae)&&(P=ae=o),p=Lo(p),P===o?(P=p,p=0):P=Lo(P),function(pe,Pe,Xe,it){for(var wt=-1,gt=di(ua((Pe-pe)/(Xe||1)),0),Nt=rt(gt);gt--;)Nt[it?gt:++wt]=pe,pe+=Xe;return Nt}(p,P,ae=ae===o?p<P?1:-1:Lo(ae),s)}}function Mu(s){return function(p,P){return typeof p=="string"&&typeof P=="string"||(p=ai(p),P=ai(P)),s(p,P)}}function xh(s,p,P,ae,pe,Pe,Xe,it,wt,gt){var Nt=8&p;p|=Nt?L:G,4&(p&=~(Nt?G:L))||(p&=-4);var Qt=[s,p,pe,Nt?Pe:o,Nt?Xe:o,Nt?o:Pe,Nt?o:Xe,it,wt,gt],On=P.apply(o,Qt);return Eh(s)&&od(On,Qt),On.placeholder=ae,fc(On,s,p)}function _u(s){var p=kn[s];return function(P,ae){if(P=ai(P),(ae=ae==null?0:Ai(Cr(ae),292))&&xo(P)){var pe=(Qr(P)+"e").split("e");return+((pe=(Qr(p(pe[0]+"e"+(+pe[1]+ae)))+"e").split("e"))[0]+"e"+(+pe[1]-ae))}return p(P)}}var wh=jt&&1/S(new jt([,-0]))[1]==f?function(s){return new jt(s)}:Ga;function bh(s){return function(p){var P=Aa(p);return P==B?_l(p):P==E?function(ae){var pe=-1,Pe=Array(ae.size);return ae.forEach(function(Xe){Pe[++pe]=[Xe,Xe]}),Pe}(p):function(ae,pe){return Wr(pe,function(Pe){return[Pe,ae[Pe]]})}(p,s(p))}}function ls(s,p,P,ae,pe,Pe,Xe,it){var wt=2&p;if(!wt&&typeof s!="function")throw new Fr(a);var gt=ae?ae.length:0;if(gt||(p&=-97,ae=pe=o),Xe=Xe===o?Xe:di(Cr(Xe),0),it=it===o?it:Cr(it),gt-=pe?pe.length:0,p&G){var Nt=ae,Qt=pe;ae=pe=o}var On=wt?o:Tu(s),jn=[s,p,P,ae,pe,Nt,Qt,Pe,Xe,it];if(On&&function(Ut,sn){var Nn=Ut[1],wn=sn[1],pr=Nn|wn,lr=pr<131,Er=wn==k&&Nn==8||wn==k&&Nn==D&&Ut[7].length<=sn[8]||wn==384&&sn[7].length<=sn[8]&&Nn==8;if(!lr&&!Er)return Ut;1&wn&&(Ut[2]=sn[2],pr|=1&Nn?0:4);var Bn=sn[3];if(Bn){var zn=Ut[3];Ut[3]=zn?Jh(zn,Bn,sn[4]):Bn,Ut[4]=zn?y(Ut[3],h):sn[4]}(Bn=sn[5])&&(zn=Ut[5],Ut[5]=zn?qh(zn,Bn,sn[6]):Bn,Ut[6]=zn?y(Ut[5],h):sn[6]),(Bn=sn[7])&&(Ut[7]=Bn),wn&k&&(Ut[8]=Ut[8]==null?sn[8]:Ai(Ut[8],sn[8])),Ut[9]==null&&(Ut[9]=sn[9]),Ut[0]=sn[0],Ut[1]=pr}(jn,On),s=jn[0],p=jn[1],P=jn[2],ae=jn[3],pe=jn[4],!(it=jn[9]=jn[9]===o?wt?0:s.length:di(jn[9]-gt,0))&&24&p&&(p&=-25),p&&p!=1)Qn=p==8||p==w?function(Ut,sn,Nn){var wn=hc(Ut);return function pr(){for(var lr=arguments.length,Er=rt(lr),Bn=lr,zn=kl(pr);Bn--;)Er[Bn]=arguments[Bn];var ui=lr<3&&Er[0]!==zn&&Er[lr-1]!==zn?[]:y(Er,zn);return(lr-=ui.length)<Nn?xh(Ut,sn,xu,pr.placeholder,o,Er,ui,o,o,Nn-lr):hi(this&&this!==jr&&this instanceof pr?wn:Ut,this,Er)}}(s,p,it):p!=L&&p!=33||pe.length?xu.apply(o,jn):function(Ut,sn,Nn,wn){var pr=1&sn,lr=hc(Ut);return function Er(){for(var Bn=-1,zn=arguments.length,ui=-1,ri=wn.length,ji=rt(ri+zn),zr=this&&this!==jr&&this instanceof Er?lr:Ut;++ui<ri;)ji[ui]=wn[ui];for(;zn--;)ji[ui++]=arguments[++Bn];return hi(zr,pr?Nn:this,ji)}}(s,p,P,ae);else var Qn=function(Ut,sn,Nn){var wn=1&sn,pr=hc(Ut);return function lr(){return(this&&this!==jr&&this instanceof lr?pr:Ut).apply(wn?Nn:this,arguments)}}(s,p,P);return fc((On?Ss:od)(Qn,jn),s,p)}function cs(s,p,P,ae){return s===o||Ka(s,dr[P])&&!Wn.call(ae,P)?p:s}function Mh(s,p,P,ae,pe,Pe){return gi(s)&&gi(p)&&(Pe.set(p,s),Ks(s,p,o,Mh,Pe),Pe.delete(p)),s}function Jd(s){return ql(s)?o:s}function _h(s,p,P,ae,pe,Pe){var Xe=1&P,it=s.length,wt=p.length;if(it!=wt&&!(Xe&&wt>it))return!1;var gt=Pe.get(s),Nt=Pe.get(p);if(gt&&Nt)return gt==p&&Nt==s;var Qt=-1,On=!0,jn=2&P?new wo:o;for(Pe.set(s,p),Pe.set(p,s);++Qt<it;){var Qn=s[Qt],Ut=p[Qt];if(ae)var sn=Xe?ae(Ut,Qn,Qt,p,s,Pe):ae(Qn,Ut,Qt,s,p,Pe);if(sn!==o){if(sn)continue;On=!1;break}if(jn){if(!Vo(p,function(Nn,wn){if(!ta(jn,wn)&&(Qn===Nn||pe(Qn,Nn,P,ae,Pe)))return jn.push(wn)})){On=!1;break}}else if(Qn!==Ut&&!pe(Qn,Ut,P,ae,Pe)){On=!1;break}}return Pe.delete(s),Pe.delete(p),On}function Wo(s){return pc(ad(s,o,ol),s+"")}function el(s){return fu(s,Ui,Ch)}function tl(s){return fu(s,pa,Sh)}var Tu=Rn?function(s){return Rn.get(s)}:Ga;function dc(s){for(var p=s.name+"",P=kt[p],ae=Wn.call(kt,p)?P.length:0;ae--;){var pe=P[ae],Pe=pe.func;if(Pe==null||Pe==s)return pe.name}return p}function kl(s){return(Wn.call(be,"placeholder")?be:s).placeholder}function nr(){var s=be.iteratee||fl;return s=s===fl?Ao:s,arguments.length?s(arguments[0],arguments[1]):s}function Cu(s,p){var P,ae,pe=s.__data__;return((ae=typeof(P=p))=="string"||ae=="number"||ae=="symbol"||ae=="boolean"?P!=="__proto__":P===null)?pe[typeof p=="string"?"string":"hash"]:pe.map}function Th(s){for(var p=Ui(s),P=p.length;P--;){var ae=p[P],pe=s[ae];p[P]=[ae,pe,nl(pe)]}return p}function Ps(s,p){var P=function(ae,pe){return ae==null?o:ae[pe]}(s,p);return Xa(P)?P:o}var Ch=_s?function(s){return s==null?[]:(s=At(s),Co(_s(s),function(p){return wi.call(s,p)}))}:js,Sh=_s?function(s){for(var p=[];s;)wa(p,Ch(s)),s=Oi(s);return p}:js,Aa=da;function td(s,p,P){for(var ae=-1,pe=(p=Ds(p,s)).length,Pe=!1;++ae<pe;){var Xe=ho(p[ae]);if(!(Pe=s!=null&&P(s,Xe)))break;s=s[Xe]}return Pe||++ae!=pe?Pe:!!(pe=s==null?0:s.length)&&Os(pe)&&Jo(Xe,pe)&&(yr(s)||ra(s))}function nd(s){return typeof s.constructor!="function"||qo(s)?{}:Mi(Oi(s))}function qd(s){return yr(s)||ra(s)||!!(li&&s&&s[li])}function Jo(s,p){var P=typeof s;return!!(p=p??O)&&(P=="number"||P!="symbol"&&ct.test(s))&&s>-1&&s%1==0&&s<p}function Ba(s,p,P){if(!gi(P))return!1;var ae=typeof p;return!!(ae=="number"?Sa(P)&&Jo(p,P.length):ae=="string"&&p in P)&&Ka(P[p],s)}function Dh(s,p){if(yr(s))return!1;var P=typeof s;return!(P!="number"&&P!="symbol"&&P!="boolean"&&s!=null&&!fo(s))||We.test(s)||!Ct.test(s)||p!=null&&s in At(p)}function Eh(s){var p=dc(s),P=be[p];if(typeof P!="function"||!(p in wr.prototype))return!1;if(s===P)return!0;var ae=Tu(P);return!!ae&&s===ae[0]}(ot&&Aa(new ot(new ArrayBuffer(1)))!=ne||Qe&&Aa(new Qe)!=B||St&&Aa(St.resolve())!=c||jt&&Aa(new jt)!=E||gn&&Aa(new gn)!=W)&&(Aa=function(s){var p=da(s),P=p==u?s.constructor:o,ae=P?Xo(P):"";if(ae)switch(ae){case Mr:return ne;case Cn:return B;case en:return c;case Rr:return E;case tr:return W}return p});var rd=_a?po:Ql;function qo(s){var p=s&&s.constructor;return s===(typeof p=="function"&&p.prototype||dr)}function nl(s){return s==s&&!gi(s)}function id(s,p){return function(P){return P!=null&&P[s]===p&&(p!==o||s in At(P))}}function ad(s,p,P){return p=di(p===o?s.length-1:p,0),function(){for(var ae=arguments,pe=-1,Pe=di(ae.length-p,0),Xe=rt(Pe);++pe<Pe;)Xe[pe]=ae[p+pe];pe=-1;for(var it=rt(p+1);++pe<p;)it[pe]=ae[pe];return it[p]=P(Xe),hi(s,this,it)}}function Ph(s,p){return p.length<2?s:Oa(s,ja(p,0,-1))}function Oh(s,p){if((p!=="constructor"||typeof s[p]!="function")&&p!="__proto__")return s[p]}var od=rl(Ss),jl=na||function(s,p){return jr.setTimeout(s,p)},pc=rl(mu);function fc(s,p,P){var ae=p+"";return pc(s,function(pe,Pe){var Xe=Pe.length;if(!Xe)return pe;var it=Xe-1;return Pe[it]=(Xe>1?"& ":"")+Pe[it],Pe=Pe.join(Xe>2?", ":" "),pe.replace(yt,`{
/* [wrapped with `+Pe+`] */
`)}(ae,function(pe,Pe){return Ci(V,function(Xe){var it="_."+Xe[0];Pe&Xe[1]&&!oo(pe,it)&&pe.push(it)}),pe.sort()}(function(pe){var Pe=ae.match(ze);return Pe?Pe[1].split(Zt):[]}(),P)))}function rl(s){var p=0,P=0;return function(){var ae=Ws(),pe=16-(ae-P);if(P=ae,pe>0){if(++p>=800)return arguments[0]}else p=0;return s.apply(o,arguments)}}function mc(s,p){var P=-1,ae=s.length,pe=ae-1;for(p=p===o?ae:p;++P<p;){var Pe=Dr(P,pe),Xe=s[Pe];s[Pe]=s[P],s[P]=Xe}return s.length=p,s}var Su=function(s){var p=Ul(function(ae){var pe=[];return ae.charCodeAt(0)===46&&pe.push(""),ae.replace(It,function(Pe,Xe,it,wt){pe.push(it?wt.replace(pt,"$1"):Xe||Pe)}),pe},function(ae){return P.size===500&&P.clear(),ae}),P=p.cache;return p}();function ho(s){if(typeof s=="string"||fo(s))return s;var p=s+"";return p=="0"&&1/s==-1/0?"-0":p}function Xo(s){if(s!=null){try{return xr.call(s)}catch{}try{return s+""}catch{}}return""}function Yo(s){if(s instanceof wr)return s.clone();var p=new Tr(s.__wrapped__,s.__chain__);return p.__actions__=Za(s.__actions__),p.__index__=s.__index__,p.__values__=s.__values__,p}var Nl=Lr(function(s,p){return mi(s)?Ts(s,zi(p,1,mi,!0)):[]}),il=Lr(function(s,p){var P=Fa(p);return mi(P)&&(P=o),mi(s)?Ts(s,zi(p,1,mi,!0),nr(P,2)):[]}),gc=Lr(function(s,p){var P=Fa(p);return mi(P)&&(P=o),mi(s)?Ts(s,zi(p,1,mi,!0),o,P):[]});function al(s,p,P){var ae=s==null?0:s.length;if(!ae)return-1;var pe=P==null?0:Cr(P);return pe<0&&(pe=di(ae+pe,0)),zt(s,nr(p,3),pe)}function Bl(s,p,P){var ae=s==null?0:s.length;if(!ae)return-1;var pe=ae-1;return P!==o&&(pe=Cr(P),pe=P<0?di(ae+pe,0):Ai(pe,ae-1)),zt(s,nr(p,3),pe,!0)}function ol(s){return s!=null&&s.length?zi(s,1):[]}function sl(s){return s&&s.length?s[0]:o}var Fl=Lr(function(s){var p=Wr(s,mh);return p.length&&p[0]===s[0]?Cs(p):[]}),yc=Lr(function(s){var p=Fa(s),P=Wr(s,mh);return p===Fa(P)?p=o:P.pop(),P.length&&P[0]===s[0]?Cs(P,nr(p,2)):[]}),sd=Lr(function(s){var p=Fa(s),P=Wr(s,mh);return(p=typeof p=="function"?p:o)&&P.pop(),P.length&&P[0]===s[0]?Cs(P,o,p):[]});function Fa(s){var p=s==null?0:s.length;return p?s[p-1]:o}var vc=Lr(xc);function xc(s,p){return s&&s.length&&p&&p.length?Rl(s,p):s}var ld=Wo(function(s,p){var P=s==null?0:s.length,ae=is(s,p);return Qs(s,Wr(p,function(pe){return Jo(pe,P)?+pe:pe}).sort(Wh)),ae});function wc(s){return s==null?s:Le.call(s)}var cd=Lr(function(s){return os(zi(s,1,mi,!0))}),bc=Lr(function(s){var p=Fa(s);return mi(p)&&(p=o),os(zi(s,1,mi,!0),nr(p,2))}),Du=Lr(function(s){var p=Fa(s);return p=typeof p=="function"?p:o,os(zi(s,1,mi,!0),o,p)});function Vl(s){if(!s||!s.length)return[];var p=0;return s=Co(s,function(P){if(mi(P))return p=di(P.length,p),!0}),ws(p,function(P){return Wr(s,Jr(P))})}function Ah(s,p){if(!s||!s.length)return[];var P=Vl(s);return p==null?P:Wr(P,function(ae){return hi(p,o,ae)})}var Mc=Lr(function(s,p){return mi(s)?Ts(s,p):[]}),_c=Lr(function(s){return Na(Co(s,mi))}),ud=Lr(function(s){var p=Fa(s);return mi(p)&&(p=o),Na(Co(s,mi),nr(p,2))}),Xd=Lr(function(s){var p=Fa(s);return p=typeof p=="function"?p:o,Na(Co(s,mi),o,p)}),Eu=Lr(Vl),Rh=Lr(function(s){var p=s.length,P=p>1?s[p-1]:o;return Ah(s,P=typeof P=="function"?(s.pop(),P):o)});function Lh(s){var p=be(s);return p.__chain__=!0,p}function Tc(s,p){return p(s)}var Gl=Wo(function(s){var p=s.length,P=p?s[0]:0,ae=this.__wrapped__,pe=function(Pe){return is(Pe,s)};return!(p>1||this.__actions__.length)&&ae instanceof wr&&Jo(P)?((ae=ae.slice(P,+P+(p?1:0))).__actions__.push({func:Tc,args:[pe],thisArg:o}),new Tr(ae,this.__chain__).thru(function(Pe){return p&&!Pe.length&&Pe.push(o),Pe})):this.thru(pe)}),Cc=vu(function(s,p,P){Wn.call(s,P)?++s[P]:ka(s,P,1)}),Pu=Kh(al),ki=Kh(Bl);function Ih(s,p){return(yr(s)?Ci:Po)(s,nr(p,3))}function kh(s,p){return(yr(s)?function(P,ae){for(var pe=P==null?0:P.length;pe--&&ae(P[pe],pe,P)!==!1;);return P}:sc)(s,nr(p,3))}var hd=vu(function(s,p,P){Wn.call(s,P)?s[P].push(p):ka(s,P,[p])}),Ou=Lr(function(s,p,P){var ae=-1,pe=typeof p=="function",Pe=Sa(s)?rt(s.length):[];return Po(s,function(Xe){Pe[++ae]=pe?hi(p,Xe,P):Zi(Xe,p,P)}),Pe}),Au=vu(function(s,p,P){ka(s,P,p)});function Ra(s,p){return(yr(s)?Wr:Ys)(s,nr(p,3))}var Ru=vu(function(s,p,P){s[P?0:1].push(p)},function(){return[[],[]]}),Lu=Lr(function(s,p){if(s==null)return[];var P=p.length;return P>1&&Ba(s,p[0],p[1])?p=[]:P>2&&Ba(p[0],p[1],p[2])&&(p=[p[0]]),bn(s,zi(p,1),[])}),fi=Tl||function(){return jr.Date.now()};function Sc(s,p,P){return p=P?o:p,p=s&&p==null?s.length:p,ls(s,k,o,o,o,o,p)}function Zo(s,p){var P;if(typeof p!="function")throw new Fr(a);return s=Cr(s),function(){return--s>0&&(P=p.apply(this,arguments)),s<=1&&(p=o),P}}var Iu=Lr(function(s,p,P){var ae=1;if(P.length){var pe=y(P,kl(Iu));ae|=L}return ls(s,ae,p,P,pe)}),ku=Lr(function(s,p,P){var ae=3;if(P.length){var pe=y(P,kl(ku));ae|=L}return ls(p,ae,s,P,pe)});function Dc(s,p,P){var ae,pe,Pe,Xe,it,wt,gt=0,Nt=!1,Qt=!1,On=!0;if(typeof s!="function")throw new Fr(a);function jn(wn){var pr=ae,lr=pe;return ae=pe=o,gt=wn,Xe=s.apply(lr,pr)}function Qn(wn){var pr=wn-wt;return wt===o||pr>=p||pr<0||Qt&&wn-gt>=Pe}function Ut(){var wn=fi();if(Qn(wn))return sn(wn);it=jl(Ut,function(pr){var lr=p-(pr-wt);return Qt?Ai(lr,Pe-(pr-gt)):lr}(wn))}function sn(wn){return it=o,On&&ae?jn(wn):(ae=pe=o,Xe)}function Nn(){var wn=fi(),pr=Qn(wn);if(ae=arguments,pe=this,wt=wn,pr){if(it===o)return function(lr){return gt=lr,it=jl(Ut,p),Nt?jn(lr):Xe}(wt);if(Qt)return zh(it),it=jl(Ut,p),jn(wt)}return it===o&&(it=jl(Ut,p)),Xe}return p=ai(p)||0,gi(P)&&(Nt=!!P.leading,Pe=(Qt="maxWait"in P)?di(ai(P.maxWait)||0,p):Pe,On="trailing"in P?!!P.trailing:On),Nn.cancel=function(){it!==o&&zh(it),gt=0,ae=wt=pe=it=o},Nn.flush=function(){return it===o?Xe:sn(fi())},Nn}var ju=Lr(function(s,p){return du(s,1,p)}),zl=Lr(function(s,p,P){return du(s,ai(p)||0,P)});function Ul(s,p){if(typeof s!="function"||p!=null&&typeof p!="function")throw new Fr(a);var P=function(){var ae=arguments,pe=p?p.apply(this,ae):ae[0],Pe=P.cache;if(Pe.has(pe))return Pe.get(pe);var Xe=s.apply(this,ae);return P.cache=Pe.set(pe,Xe)||Pe,Xe};return P.cache=new(Ul.Cache||Gi),P}function Hl(s){if(typeof s!="function")throw new Fr(a);return function(){var p=arguments;switch(p.length){case 0:return!s.call(this);case 1:return!s.call(this,p[0]);case 2:return!s.call(this,p[0],p[1]);case 3:return!s.call(this,p[0],p[1],p[2])}return!s.apply(this,p)}}Ul.Cache=Gi;var Nu=Wd(function(s,p){var P=(p=p.length==1&&yr(p[0])?Wr(p[0],Oe(nr())):Wr(zi(p,1),Oe(nr()))).length;return Lr(function(ae){for(var pe=-1,Pe=Ai(ae.length,P);++pe<Pe;)ae[pe]=p[pe].call(this,ae[pe]);return hi(s,this,ae)})}),Ec=Lr(function(s,p){var P=y(p,kl(Ec));return ls(s,L,o,p,P)}),Bu=Lr(function(s,p){var P=y(p,kl(Bu));return ls(s,G,o,p,P)}),Pc=Wo(function(s,p){return ls(s,D,o,o,o,p)});function Ka(s,p){return s===p||s!=s&&p!=p}var Oc=Mu(sr),Fu=Mu(function(s,p){return s>=p}),ra=sh(function(){return arguments}())?sh:function(s){return yi(s)&&Wn.call(s,"callee")&&!wi.call(s,"callee")},yr=rt.isArray,Ac=vt?Oe(vt):function(s){return yi(s)&&da(s)==te};function Sa(s){return s!=null&&Os(s.length)&&!po(s)}function mi(s){return yi(s)&&Sa(s)}var Ro=Ha||Ql,Rc=Ft?Oe(Ft):function(s){return yi(s)&&da(s)==F};function Wl(s){if(!yi(s))return!1;var p=da(s);return p==_||p=="[object DOMException]"||typeof s.message=="string"&&typeof s.name=="string"&&!ql(s)}function po(s){if(!gi(s))return!1;var p=da(s);return p==J||p==T||p=="[object AsyncFunction]"||p=="[object Proxy]"}function Lc(s){return typeof s=="number"&&s==Cr(s)}function Os(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=O}function gi(s){var p=typeof s;return s!=null&&(p=="object"||p=="function")}function yi(s){return s!=null&&typeof s=="object"}var Ic=Xt?Oe(Xt):function(s){return yi(s)&&Aa(s)==B};function Jl(s){return typeof s=="number"||yi(s)&&da(s)==N}function ql(s){if(!yi(s)||da(s)!=u)return!1;var p=Oi(s);if(p===null)return!0;var P=Wn.call(p,"constructor")&&p.constructor;return typeof P=="function"&&P instanceof P&&xr.call(P)==Uo}var ll=In?Oe(In):function(s){return yi(s)&&da(s)==m},Xl=Gn?Oe(Gn):function(s){return yi(s)&&Aa(s)==E};function Vu(s){return typeof s=="string"||!yr(s)&&yi(s)&&da(s)==U}function fo(s){return typeof s=="symbol"||yi(s)&&da(s)==X}var Yl=or?Oe(or):function(s){return yi(s)&&Os(s.length)&&!!Xr[da(s)]},Yd=Mu(Xs),Zd=Mu(function(s,p){return s<=p});function dd(s){if(!s)return[];if(Sa(s))return Vu(s)?re(s):Za(s);if(ni&&s[ni])return function(P){for(var ae,pe=[];!(ae=P.next()).done;)pe.push(ae.value);return pe}(s[ni]());var p=Aa(s);return(p==B?_l:p==E?S:Ko)(s)}function Lo(s){return s?(s=ai(s))===f||s===-1/0?17976931348623157e292*(s<0?-1:1):s==s?s:0:s===0?s:0}function Cr(s){var p=Lo(s),P=p%1;return p==p?P?p-P:p:0}function cl(s){return s?co(Cr(s),0,j):0}function ai(s){if(typeof s=="number")return s;if(fo(s))return C;if(gi(s)){var p=typeof s.valueOf=="function"?s.valueOf():s;s=gi(p)?p+"":p}if(typeof s!="string")return s===0?s:+s;s=Us(s);var P=nn.test(s);return P||kr.test(s)?rs(s.slice(2),P?2:8):xn.test(s)?C:+s}function As(s){return Ho(s,pa(s))}function Qr(s){return s==null?"":Ya(s)}var kc=Ll(function(s,p){if(qo(p)||Sa(p))Ho(p,Ui(p),s);else for(var P in p)Wn.call(p,P)&&Sn(s,P,p[P])}),jh=Ll(function(s,p){Ho(p,pa(p),s)}),jc=Ll(function(s,p,P,ae){Ho(p,pa(p),s,ae)}),Nc=Ll(function(s,p,P,ae){Ho(p,Ui(p),s,ae)}),Nh=Wo(is),us=Lr(function(s,p){s=At(s);var P=-1,ae=p.length,pe=ae>2?p[2]:o;for(pe&&Ba(p[0],p[1],pe)&&(ae=1);++P<ae;)for(var Pe=p[P],Xe=pa(Pe),it=-1,wt=Xe.length;++it<wt;){var gt=Xe[it],Nt=s[gt];(Nt===o||Ka(Nt,dr[gt])&&!Wn.call(s,gt))&&(s[gt]=Pe[gt])}return s}),pd=Lr(function(s){return s.push(o,Mh),hi(hl,o,s)});function Gu(s,p,P){var ae=s==null?o:Oa(s,p);return ae===o?P:ae}function ul(s,p){return s!=null&&td(s,p,lc)}var Rs=Qh(function(s,p,P){p!=null&&typeof p.toString!="function"&&(p=ca.call(p)),s[p]=P},ks(fa)),Kd=Qh(function(s,p,P){p!=null&&typeof p.toString!="function"&&(p=ca.call(p)),Wn.call(s,p)?s[p].push(P):s[p]=[P]},nr),fd=Lr(Zi);function Ui(s){return Sa(s)?Ja(s):Ii(s)}function pa(s){return Sa(s)?Ja(s,!0):function(p){if(!gi(p))return function(Pe){var Xe=[];if(Pe!=null)for(var it in At(Pe))Xe.push(it);return Xe}(p);var P=qo(p),ae=[];for(var pe in p)(pe!="constructor"||!P&&Wn.call(p,pe))&&ae.push(pe);return ae}(s)}var zu=Ll(function(s,p,P){Ks(s,p,P)}),hl=Ll(function(s,p,P,ae){Ks(s,p,P,ae)}),Uu=Wo(function(s,p){var P={};if(s==null)return P;var ae=!1;p=Wr(p,function(Pe){return Pe=Ds(Pe,s),ae||(ae=Pe.length>1),Pe}),Ho(s,tl(s),P),ae&&(P=qa(P,7,Jd));for(var pe=p.length;pe--;)yu(P,p[pe]);return P}),Bc=Wo(function(s,p){return s==null?{}:function(P,ae){return ch(P,ae,function(pe,Pe){return ul(P,Pe)})}(s,p)});function Fc(s,p){if(s==null)return{};var P=Wr(tl(s),function(ae){return[ae]});return p=nr(p),ch(s,P,function(ae,pe){return p(ae,pe[0])})}var Zl=bh(Ui),Kl=bh(pa);function Ko(s){return s==null?[]:So(s,Ui(s))}var md=Il(function(s,p,P){return p=p.toLowerCase(),s+(P?$l(p):p)});function $l(s){return pl(Qr(s).toLowerCase())}function dl(s){return(s=Qr(s))&&s.replace(Ue,Do).replace(Vs,"")}var Ls=Il(function(s,p,P){return s+(P?"-":"")+p.toLowerCase()}),Hu=Il(function(s,p,P){return s+(P?" ":"")+p.toLowerCase()}),Wu=Zh("toLowerCase"),Ju=Il(function(s,p,P){return s+(P?"_":"")+p.toLowerCase()}),Vc=Il(function(s,p,P){return s+(P?" ":"")+pl(p)}),Va=Il(function(s,p,P){return s+(P?" ":"")+p.toUpperCase()}),pl=Zh("toUpperCase");function Is(s,p,P){return s=Qr(s),(p=P?o:p)===o?function(ae){return ys.test(ae)}(s)?function(ae){return ae.match(gs)||[]}(s):function(ae){return ae.match(An)||[]}(s):s.match(p)||[]}var hs=Lr(function(s,p){try{return hi(s,o,p)}catch(P){return Wl(P)?P:new ut(P)}}),Gc=Wo(function(s,p){return Ci(p,function(P){P=ho(P),ka(s,P,Iu(s[P],s))}),s});function ks(s){return function(){return s}}var zc=$h(),Uc=$h(!0);function fa(s){return s}function fl(s){return Ao(typeof s=="function"?s:qa(s,1))}var Hc=Lr(function(s,p){return function(P){return Zi(P,s,p)}}),$d=Lr(function(s,p){return function(P){return Zi(s,P,p)}});function Di(s,p,P){var ae=Ui(p),pe=pu(p,ae);P!=null||gi(p)&&(pe.length||!ae.length)||(P=p,p=s,s=this,pe=pu(p,Ui(p)));var Pe=!(gi(P)&&"chain"in P&&!P.chain),Xe=po(s);return Ci(pe,function(it){var wt=p[it];s[it]=wt,Xe&&(s.prototype[it]=function(){var gt=this.__chain__;if(Pe||gt){var Nt=s(this.__wrapped__);return(Nt.__actions__=Za(this.__actions__)).push({func:wt,args:arguments,thisArg:s}),Nt.__chain__=gt,Nt}return wt.apply(s,wa([this.value()],arguments))})}),s}function Ga(){}var qu=vh(Wr),Wc=vh(vo),Xu=vh(Vo);function ma(s){return Dh(s)?Jr(ho(s)):function(p){return function(P){return Oa(P,p)}}(s)}var Yu=ed(),Zu=ed(!0);function js(){return[]}function Ql(){return!1}var ml,Ku=wu(function(s,p){return s+p},0),ec=_u("ceil"),Mo=wu(function(s,p){return s/p},1),Qd=_u("floor"),gl=wu(function(s,p){return s*p},1),Bh=_u("round"),gd=wu(function(s,p){return s-p},0);return be.after=function(s,p){if(typeof p!="function")throw new Fr(a);return s=Cr(s),function(){if(--s<1)return p.apply(this,arguments)}},be.ary=Sc,be.assign=kc,be.assignIn=jh,be.assignInWith=jc,be.assignWith=Nc,be.at=Nh,be.before=Zo,be.bind=Iu,be.bindAll=Gc,be.bindKey=ku,be.castArray=function(){if(!arguments.length)return[];var s=arguments[0];return yr(s)?s:[s]},be.chain=Lh,be.chunk=function(s,p,P){p=(P?Ba(s,p,P):p===o)?1:di(Cr(p),0);var ae=s==null?0:s.length;if(!ae||p<1)return[];for(var pe=0,Pe=0,Xe=rt(ua(ae/p));pe<ae;)Xe[Pe++]=ja(s,pe,pe+=p);return Xe},be.compact=function(s){for(var p=-1,P=s==null?0:s.length,ae=0,pe=[];++p<P;){var Pe=s[p];Pe&&(pe[ae++]=Pe)}return pe},be.concat=function(){var s=arguments.length;if(!s)return[];for(var p=rt(s-1),P=arguments[0],ae=s;ae--;)p[ae-1]=arguments[ae];return wa(yr(P)?Za(P):[P],zi(p,1))},be.cond=function(s){var p=s==null?0:s.length,P=nr();return s=p?Wr(s,function(ae){if(typeof ae[1]!="function")throw new Fr(a);return[P(ae[0]),ae[1]]}):[],Lr(function(ae){for(var pe=-1;++pe<p;){var Pe=s[pe];if(hi(Pe[0],this,ae))return hi(Pe[1],this,ae)}})},be.conforms=function(s){return function(p){var P=Ui(p);return function(ae){return hu(ae,p,P)}}(qa(s,1))},be.constant=ks,be.countBy=Cc,be.create=function(s,p){var P=Mi(s);return p==null?P:uu(P,p)},be.curry=function s(p,P,ae){var pe=ls(p,8,o,o,o,o,o,P=ae?o:P);return pe.placeholder=s.placeholder,pe},be.curryRight=function s(p,P,ae){var pe=ls(p,w,o,o,o,o,o,P=ae?o:P);return pe.placeholder=s.placeholder,pe},be.debounce=Dc,be.defaults=us,be.defaultsDeep=pd,be.defer=ju,be.delay=zl,be.difference=Nl,be.differenceBy=il,be.differenceWith=gc,be.drop=function(s,p,P){var ae=s==null?0:s.length;return ae?ja(s,(p=P||p===o?1:Cr(p))<0?0:p,ae):[]},be.dropRight=function(s,p,P){var ae=s==null?0:s.length;return ae?ja(s,0,(p=ae-(p=P||p===o?1:Cr(p)))<0?0:p):[]},be.dropRightWhile=function(s,p){return s&&s.length?ss(s,nr(p,3),!0,!0):[]},be.dropWhile=function(s,p){return s&&s.length?ss(s,nr(p,3),!0):[]},be.fill=function(s,p,P,ae){var pe=s==null?0:s.length;return pe?(P&&typeof P!="number"&&Ba(s,p,P)&&(P=0,ae=pe),function(Pe,Xe,it,wt){var gt=Pe.length;for((it=Cr(it))<0&&(it=-it>gt?0:gt+it),(wt=wt===o||wt>gt?gt:Cr(wt))<0&&(wt+=gt),wt=it>wt?0:cl(wt);it<wt;)Pe[it++]=Xe;return Pe}(s,p,P,ae)):[]},be.filter=function(s,p){return(yr(s)?Co:qs)(s,nr(p,3))},be.flatMap=function(s,p){return zi(Ra(s,p),1)},be.flatMapDeep=function(s,p){return zi(Ra(s,p),f)},be.flatMapDepth=function(s,p,P){return P=P===o?1:Cr(P),zi(Ra(s,p),P)},be.flatten=ol,be.flattenDeep=function(s){return s!=null&&s.length?zi(s,f):[]},be.flattenDepth=function(s,p){return s!=null&&s.length?zi(s,p=p===o?1:Cr(p)):[]},be.flip=function(s){return ls(s,512)},be.flow=zc,be.flowRight=Uc,be.fromPairs=function(s){for(var p=-1,P=s==null?0:s.length,ae={};++p<P;){var pe=s[p];ae[pe[0]]=pe[1]}return ae},be.functions=function(s){return s==null?[]:pu(s,Ui(s))},be.functionsIn=function(s){return s==null?[]:pu(s,pa(s))},be.groupBy=hd,be.initial=function(s){return s!=null&&s.length?ja(s,0,-1):[]},be.intersection=Fl,be.intersectionBy=yc,be.intersectionWith=sd,be.invert=Rs,be.invertBy=Kd,be.invokeMap=Ou,be.iteratee=fl,be.keyBy=Au,be.keys=Ui,be.keysIn=pa,be.map=Ra,be.mapKeys=function(s,p){var P={};return p=nr(p,3),Oo(s,function(ae,pe,Pe){ka(P,p(ae,pe,Pe),ae)}),P},be.mapValues=function(s,p){var P={};return p=nr(p,3),Oo(s,function(ae,pe,Pe){ka(P,pe,p(ae,pe,Pe))}),P},be.matches=function(s){return Al(qa(s,1))},be.matchesProperty=function(s,p){return Zs(s,qa(p,1))},be.memoize=Ul,be.merge=zu,be.mergeWith=hl,be.method=Hc,be.methodOf=$d,be.mixin=Di,be.negate=Hl,be.nthArg=function(s){return s=Cr(s),Lr(function(p){return $s(p,s)})},be.omit=Uu,be.omitBy=function(s,p){return Fc(s,Hl(nr(p)))},be.once=function(s){return Zo(2,s)},be.orderBy=function(s,p,P,ae){return s==null?[]:(yr(p)||(p=p==null?[]:[p]),yr(P=ae?o:P)||(P=P==null?[]:[P]),bn(s,p,P))},be.over=qu,be.overArgs=Nu,be.overEvery=Wc,be.overSome=Xu,be.partial=Ec,be.partialRight=Bu,be.partition=Ru,be.pick=Bc,be.pickBy=Fc,be.property=ma,be.propertyOf=function(s){return function(p){return s==null?o:Oa(s,p)}},be.pull=vc,be.pullAll=xc,be.pullAllBy=function(s,p,P){return s&&s.length&&p&&p.length?Rl(s,p,nr(P,2)):s},be.pullAllWith=function(s,p,P){return s&&s.length&&p&&p.length?Rl(s,p,o,P):s},be.pullAt=ld,be.range=Yu,be.rangeRight=Zu,be.rearg=Pc,be.reject=function(s,p){return(yr(s)?Co:qs)(s,Hl(nr(p,3)))},be.remove=function(s,p){var P=[];if(!s||!s.length)return P;var ae=-1,pe=[],Pe=s.length;for(p=nr(p,3);++ae<Pe;){var Xe=s[ae];p(Xe,ae,s)&&(P.push(Xe),pe.push(ae))}return Qs(s,pe),P},be.rest=function(s,p){if(typeof s!="function")throw new Fr(a);return Lr(s,p=p===o?p:Cr(p))},be.reverse=wc,be.sampleSize=function(s,p,P){return p=(P?Ba(s,p,P):p===o)?1:Cr(p),(yr(s)?function(ae,pe){return mc(Za(ae),co(pe,0,ae.length))}:function(ae,pe){var Pe=Ko(ae);return mc(Pe,co(pe,0,Pe.length))})(s,p)},be.set=function(s,p,P){return s==null?s:uc(s,p,P)},be.setWith=function(s,p,P,ae){return ae=typeof ae=="function"?ae:o,s==null?s:uc(s,p,P,ae)},be.shuffle=function(s){return(yr(s)?function(p){return mc(Za(p))}:function(p){return mc(Ko(p))})(s)},be.slice=function(s,p,P){var ae=s==null?0:s.length;return ae?(P&&typeof P!="number"&&Ba(s,p,P)?(p=0,P=ae):(p=p==null?0:Cr(p),P=P===o?ae:Cr(P)),ja(s,p,P)):[]},be.sortBy=Lu,be.sortedUniq=function(s){return s&&s.length?hh(s):[]},be.sortedUniqBy=function(s,p){return s&&s.length?hh(s,nr(p,2)):[]},be.split=function(s,p,P){return P&&typeof P!="number"&&Ba(s,p,P)&&(p=P=o),(P=P===o?j:P>>>0)?(s=Qr(s))&&(typeof p=="string"||p!=null&&!ll(p))&&!(p=Ya(p))&&fr(s)?Es(re(s),0,P):s.split(p,P):[]},be.spread=function(s,p){if(typeof s!="function")throw new Fr(a);return p=p==null?0:di(Cr(p),0),Lr(function(P){var ae=P[p],pe=Es(P,0,p);return ae&&wa(pe,ae),hi(s,this,pe)})},be.tail=function(s){var p=s==null?0:s.length;return p?ja(s,1,p):[]},be.take=function(s,p,P){return s&&s.length?ja(s,0,(p=P||p===o?1:Cr(p))<0?0:p):[]},be.takeRight=function(s,p,P){var ae=s==null?0:s.length;return ae?ja(s,(p=ae-(p=P||p===o?1:Cr(p)))<0?0:p,ae):[]},be.takeRightWhile=function(s,p){return s&&s.length?ss(s,nr(p,3),!1,!0):[]},be.takeWhile=function(s,p){return s&&s.length?ss(s,nr(p,3)):[]},be.tap=function(s,p){return p(s),s},be.throttle=function(s,p,P){var ae=!0,pe=!0;if(typeof s!="function")throw new Fr(a);return gi(P)&&(ae="leading"in P?!!P.leading:ae,pe="trailing"in P?!!P.trailing:pe),Dc(s,p,{leading:ae,maxWait:p,trailing:pe})},be.thru=Tc,be.toArray=dd,be.toPairs=Zl,be.toPairsIn=Kl,be.toPath=function(s){return yr(s)?Wr(s,ho):fo(s)?[s]:Za(Su(Qr(s)))},be.toPlainObject=As,be.transform=function(s,p,P){var ae=yr(s),pe=ae||Ro(s)||Yl(s);if(p=nr(p,4),P==null){var Pe=s&&s.constructor;P=pe?ae?new Pe:[]:gi(s)&&po(Pe)?Mi(Oi(s)):{}}return(pe?Ci:Oo)(s,function(Xe,it,wt){return p(P,Xe,it,wt)}),P},be.unary=function(s){return Sc(s,1)},be.union=cd,be.unionBy=bc,be.unionWith=Du,be.uniq=function(s){return s&&s.length?os(s):[]},be.uniqBy=function(s,p){return s&&s.length?os(s,nr(p,2)):[]},be.uniqWith=function(s,p){return p=typeof p=="function"?p:o,s&&s.length?os(s,o,p):[]},be.unset=function(s,p){return s==null||yu(s,p)},be.unzip=Vl,be.unzipWith=Ah,be.update=function(s,p,P){return s==null?s:ph(s,p,gh(P))},be.updateWith=function(s,p,P,ae){return ae=typeof ae=="function"?ae:o,s==null?s:ph(s,p,gh(P),ae)},be.values=Ko,be.valuesIn=function(s){return s==null?[]:So(s,pa(s))},be.without=Mc,be.words=Is,be.wrap=function(s,p){return Ec(gh(p),s)},be.xor=_c,be.xorBy=ud,be.xorWith=Xd,be.zip=Eu,be.zipObject=function(s,p){return fh(s||[],p||[],Sn)},be.zipObjectDeep=function(s,p){return fh(s||[],p||[],uc)},be.zipWith=Rh,be.entries=Zl,be.entriesIn=Kl,be.extend=jh,be.extendWith=jc,Di(be,be),be.add=Ku,be.attempt=hs,be.camelCase=md,be.capitalize=$l,be.ceil=ec,be.clamp=function(s,p,P){return P===o&&(P=p,p=o),P!==o&&(P=(P=ai(P))==P?P:0),p!==o&&(p=(p=ai(p))==p?p:0),co(ai(s),p,P)},be.clone=function(s){return qa(s,4)},be.cloneDeep=function(s){return qa(s,5)},be.cloneDeepWith=function(s,p){return qa(s,5,p=typeof p=="function"?p:o)},be.cloneWith=function(s,p){return qa(s,4,p=typeof p=="function"?p:o)},be.conformsTo=function(s,p){return p==null||hu(s,p,Ui(p))},be.deburr=dl,be.defaultTo=function(s,p){return s==null||s!=s?p:s},be.divide=Mo,be.endsWith=function(s,p,P){s=Qr(s),p=Ya(p);var ae=s.length,pe=P=P===o?ae:co(Cr(P),0,ae);return(P-=p.length)>=0&&s.slice(P,pe)==p},be.eq=Ka,be.escape=function(s){return(s=Qr(s))&&He.test(s)?s.replace(le,Hs):s},be.escapeRegExp=function(s){return(s=Qr(s))&&Ln.test(s)?s.replace(Bt,"\\$&"):s},be.every=function(s,p,P){var ae=yr(s)?vo:El;return P&&Ba(s,p,P)&&(p=o),ae(s,nr(p,3))},be.find=Pu,be.findIndex=al,be.findKey=function(s,p){return vr(s,nr(p,3),Oo)},be.findLast=ki,be.findLastIndex=Bl,be.findLastKey=function(s,p){return vr(s,nr(p,3),Ol)},be.floor=Qd,be.forEach=Ih,be.forEachRight=kh,be.forIn=function(s,p){return s==null?s:Pl(s,nr(p,3),pa)},be.forInRight=function(s,p){return s==null?s:_i(s,nr(p,3),pa)},be.forOwn=function(s,p){return s&&Oo(s,nr(p,3))},be.forOwnRight=function(s,p){return s&&Ol(s,nr(p,3))},be.get=Gu,be.gt=Oc,be.gte=Fu,be.has=function(s,p){return s!=null&&td(s,p,oh)},be.hasIn=ul,be.head=sl,be.identity=fa,be.includes=function(s,p,P,ae){s=Sa(s)?s:Ko(s),P=P&&!ae?Cr(P):0;var pe=s.length;return P<0&&(P=di(pe+P,0)),Vu(s)?P<=pe&&s.indexOf(p,P)>-1:!!pe&&Si(s,p,P)>-1},be.indexOf=function(s,p,P){var ae=s==null?0:s.length;if(!ae)return-1;var pe=P==null?0:Cr(P);return pe<0&&(pe=di(ae+pe,0)),Si(s,p,pe)},be.inRange=function(s,p,P){return p=Lo(p),P===o?(P=p,p=0):P=Lo(P),function(ae,pe,Pe){return ae>=Ai(pe,Pe)&&ae<di(pe,Pe)}(s=ai(s),p,P)},be.invoke=fd,be.isArguments=ra,be.isArray=yr,be.isArrayBuffer=Ac,be.isArrayLike=Sa,be.isArrayLikeObject=mi,be.isBoolean=function(s){return s===!0||s===!1||yi(s)&&da(s)==ee},be.isBuffer=Ro,be.isDate=Rc,be.isElement=function(s){return yi(s)&&s.nodeType===1&&!ql(s)},be.isEmpty=function(s){if(s==null)return!0;if(Sa(s)&&(yr(s)||typeof s=="string"||typeof s.splice=="function"||Ro(s)||Yl(s)||ra(s)))return!s.length;var p=Aa(s);if(p==B||p==E)return!s.size;if(qo(s))return!Ii(s).length;for(var P in s)if(Wn.call(s,P))return!1;return!0},be.isEqual=function(s,p){return cc(s,p)},be.isEqualWith=function(s,p,P){var ae=(P=typeof P=="function"?P:o)?P(s,p):o;return ae===o?cc(s,p,o,P):!!ae},be.isError=Wl,be.isFinite=function(s){return typeof s=="number"&&xo(s)},be.isFunction=po,be.isInteger=Lc,be.isLength=Os,be.isMap=Ic,be.isMatch=function(s,p){return s===p||lh(s,p,Th(p))},be.isMatchWith=function(s,p,P){return P=typeof P=="function"?P:o,lh(s,p,Th(p),P)},be.isNaN=function(s){return Jl(s)&&s!=+s},be.isNative=function(s){if(rd(s))throw new ut("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Xa(s)},be.isNil=function(s){return s==null},be.isNull=function(s){return s===null},be.isNumber=Jl,be.isObject=gi,be.isObjectLike=yi,be.isPlainObject=ql,be.isRegExp=ll,be.isSafeInteger=function(s){return Lc(s)&&s>=-9007199254740991&&s<=O},be.isSet=Xl,be.isString=Vu,be.isSymbol=fo,be.isTypedArray=Yl,be.isUndefined=function(s){return s===o},be.isWeakMap=function(s){return yi(s)&&Aa(s)==W},be.isWeakSet=function(s){return yi(s)&&da(s)=="[object WeakSet]"},be.join=function(s,p){return s==null?"":Eo.call(s,p)},be.kebabCase=Ls,be.last=Fa,be.lastIndexOf=function(s,p,P){var ae=s==null?0:s.length;if(!ae)return-1;var pe=ae;return P!==o&&(pe=(pe=Cr(P))<0?di(ae+pe,0):Ai(pe,ae-1)),p==p?function(Pe,Xe,it){for(var wt=pe+1;wt--;)if(Pe[wt]===Xe)return wt;return wt}(s,p):zt(s,lu,pe,!0)},be.lowerCase=Hu,be.lowerFirst=Wu,be.lt=Yd,be.lte=Zd,be.max=function(s){return s&&s.length?as(s,fa,sr):o},be.maxBy=function(s,p){return s&&s.length?as(s,nr(p,2),sr):o},be.mean=function(s){return Yr(s,fa)},be.meanBy=function(s,p){return Yr(s,nr(p,2))},be.min=function(s){return s&&s.length?as(s,fa,Xs):o},be.minBy=function(s,p){return s&&s.length?as(s,nr(p,2),Xs):o},be.stubArray=js,be.stubFalse=Ql,be.stubObject=function(){return{}},be.stubString=function(){return""},be.stubTrue=function(){return!0},be.multiply=gl,be.nth=function(s,p){return s&&s.length?$s(s,Cr(p)):o},be.noConflict=function(){return jr._===this&&(jr._=Ta),this},be.noop=Ga,be.now=fi,be.pad=function(s,p,P){s=Qr(s);var ae=(p=Cr(p))?Z(s):0;if(!p||ae>=p)return s;var pe=(p-ae)/2;return bu(Vi(pe),P)+s+bu(ua(pe),P)},be.padEnd=function(s,p,P){s=Qr(s);var ae=(p=Cr(p))?Z(s):0;return p&&ae<p?s+bu(p-ae,P):s},be.padStart=function(s,p,P){s=Qr(s);var ae=(p=Cr(p))?Z(s):0;return p&&ae<p?bu(p-ae,P)+s:s},be.parseInt=function(s,p,P){return P||p==null?p=0:p&&(p=+p),Ri(Qr(s).replace(rn,""),p||0)},be.random=function(s,p,P){if(P&&typeof P!="boolean"&&Ba(s,p,P)&&(p=P=o),P===o&&(typeof p=="boolean"?(P=p,p=o):typeof s=="boolean"&&(P=s,s=o)),s===o&&p===o?(s=0,p=1):(s=Lo(s),p===o?(p=s,s=0):p=Lo(p)),s>p){var ae=s;s=p,p=ae}if(P||s%1||p%1){var pe=Sl();return Ai(s+pe*(p-s+vs("1e-"+((pe+"").length-1))),p)}return Dr(s,p)},be.reduce=function(s,p,P){var ae=yr(s)?Ia:zs,pe=arguments.length<3;return ae(s,nr(p,4),P,pe,Po)},be.reduceRight=function(s,p,P){var ae=yr(s)?ea:zs,pe=arguments.length<3;return ae(s,nr(p,4),P,pe,sc)},be.repeat=function(s,p,P){return p=(P?Ba(s,p,P):p===o)?1:Cr(p),bo(Qr(s),p)},be.replace=function(){var s=arguments,p=Qr(s[0]);return s.length<3?p:p.replace(s[1],s[2])},be.result=function(s,p,P){var ae=-1,pe=(p=Ds(p,s)).length;for(pe||(pe=1,s=o);++ae<pe;){var Pe=s==null?o:s[ho(p[ae])];Pe===o&&(ae=pe,Pe=P),s=po(Pe)?Pe.call(s):Pe}return s},be.round=Bh,be.runInContext=Me,be.sample=function(s){return(yr(s)?Dl:function(p){return Dl(Ko(p))})(s)},be.size=function(s){if(s==null)return 0;if(Sa(s))return Vu(s)?Z(s):s.length;var p=Aa(s);return p==B||p==E?s.size:Ii(s).length},be.snakeCase=Ju,be.some=function(s,p,P){var ae=yr(s)?Vo:Gh;return P&&Ba(s,p,P)&&(p=o),ae(s,nr(p,3))},be.sortedIndex=function(s,p){return gu(s,p)},be.sortedIndexBy=function(s,p,P){return uh(s,p,nr(P,2))},be.sortedIndexOf=function(s,p){var P=s==null?0:s.length;if(P){var ae=gu(s,p);if(ae<P&&Ka(s[ae],p))return ae}return-1},be.sortedLastIndex=function(s,p){return gu(s,p,!0)},be.sortedLastIndexBy=function(s,p,P){return uh(s,p,nr(P,2),!0)},be.sortedLastIndexOf=function(s,p){if(s!=null&&s.length){var P=gu(s,p,!0)-1;if(Ka(s[P],p))return P}return-1},be.startCase=Vc,be.startsWith=function(s,p,P){return s=Qr(s),P=P==null?0:co(Cr(P),0,s.length),p=Ya(p),s.slice(P,P+p.length)==p},be.subtract=gd,be.sum=function(s){return s&&s.length?Bi(s,fa):0},be.sumBy=function(s,p){return s&&s.length?Bi(s,nr(p,2)):0},be.template=function(s,p,P){var ae=be.templateSettings;P&&Ba(s,p,P)&&(p=o),s=Qr(s),p=jc({},p,ae,cs);var pe,Pe,Xe=jc({},p.imports,ae.imports,cs),it=Ui(Xe),wt=So(Xe,it),gt=0,Nt=p.interpolate||lt,Qt="__p += '",On=Hn((p.escape||lt).source+"|"+Nt.source+"|"+(Nt===Tt?st:lt).source+"|"+(p.evaluate||lt).source+"|$","g"),jn="//# sourceURL="+(Wn.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++io+"]")+`
`;s.replace(On,function(sn,Nn,wn,pr,lr,Er){return wn||(wn=pr),Qt+=s.slice(gt,Er).replace(Wt,ba),Nn&&(pe=!0,Qt+=`' +
__e(`+Nn+`) +
'`),lr&&(Pe=!0,Qt+=`';
`+lr+`;
__p += '`),wn&&(Qt+=`' +
((__t = (`+wn+`)) == null ? '' : __t) +
'`),gt=Er+sn.length,sn}),Qt+=`';
`;var Qn=Wn.call(p,"variable")&&p.variable;if(Qn){if(Yn.test(Qn))throw new ut("Invalid `variable` option passed into `_.template`")}else Qt=`with (obj) {
`+Qt+`
}
`;Qt=(Pe?Qt.replace(Ae,""):Qt).replace(Ye,"$1").replace(Ge,"$1;"),Qt="function("+(Qn||"obj")+`) {
`+(Qn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(pe?", __e = _.escape":"")+(Pe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Qt+`return __p
}`;var Ut=hs(function(){return Lt(it,jn+"return "+Qt).apply(o,wt)});if(Ut.source=Qt,Wl(Ut))throw Ut;return Ut},be.times=function(s,p){if((s=Cr(s))<1||s>O)return[];var P=j,ae=Ai(s,j);p=nr(p),s-=j;for(var pe=ws(ae,p);++P<s;)p(P);return pe},be.toFinite=Lo,be.toInteger=Cr,be.toLength=cl,be.toLower=function(s){return Qr(s).toLowerCase()},be.toNumber=ai,be.toSafeInteger=function(s){return s?co(Cr(s),-9007199254740991,O):s===0?s:0},be.toString=Qr,be.toUpper=function(s){return Qr(s).toUpperCase()},be.trim=function(s,p,P){if((s=Qr(s))&&(P||p===o))return Us(s);if(!s||!(p=Ya(p)))return s;var ae=re(s),pe=re(p);return Es(ae,cu(ae,pe),bs(ae,pe)+1).join("")},be.trimEnd=function(s,p,P){if((s=Qr(s))&&(P||p===o))return s.slice(0,de(s)+1);if(!s||!(p=Ya(p)))return s;var ae=re(s);return Es(ae,0,bs(ae,re(p))+1).join("")},be.trimStart=function(s,p,P){if((s=Qr(s))&&(P||p===o))return s.replace(rn,"");if(!s||!(p=Ya(p)))return s;var ae=re(s);return Es(ae,cu(ae,re(p))).join("")},be.truncate=function(s,p){var P=30,ae="...";if(gi(p)){var pe="separator"in p?p.separator:pe;P="length"in p?Cr(p.length):P,ae="omission"in p?Ya(p.omission):ae}var Pe=(s=Qr(s)).length;if(fr(s)){var Xe=re(s);Pe=Xe.length}if(P>=Pe)return s;var it=P-Z(ae);if(it<1)return ae;var wt=Xe?Es(Xe,0,it).join(""):s.slice(0,it);if(pe===o)return wt+ae;if(Xe&&(it+=wt.length-it),ll(pe)){if(s.slice(it).search(pe)){var gt,Nt=wt;for(pe.global||(pe=Hn(pe.source,Qr(qt.exec(pe))+"g")),pe.lastIndex=0;gt=pe.exec(Nt);)var Qt=gt.index;wt=wt.slice(0,Qt===o?it:Qt)}}else if(s.indexOf(Ya(pe),it)!=it){var On=wt.lastIndexOf(pe);On>-1&&(wt=wt.slice(0,On))}return wt+ae},be.unescape=function(s){return(s=Qr(s))&&ve.test(s)?s.replace(Ne,fe):s},be.uniqueId=function(s){var p=++so;return Qr(s)+p},be.upperCase=Va,be.upperFirst=pl,be.each=Ih,be.eachRight=kh,be.first=sl,Di(be,(ml={},Oo(be,function(s,p){Wn.call(be.prototype,p)||(ml[p]=s)}),ml),{chain:!1}),be.VERSION="4.17.21",Ci(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){be[s].placeholder=be}),Ci(["drop","take"],function(s,p){wr.prototype[s]=function(P){P=P===o?1:di(Cr(P),0);var ae=this.__filtered__&&!p?new wr(this):this.clone();return ae.__filtered__?ae.__takeCount__=Ai(P,ae.__takeCount__):ae.__views__.push({size:Ai(P,j),type:s+(ae.__dir__<0?"Right":"")}),ae},wr.prototype[s+"Right"]=function(P){return this.reverse()[s](P).reverse()}}),Ci(["filter","map","takeWhile"],function(s,p){var P=p+1,ae=P==1||P==3;wr.prototype[s]=function(pe){var Pe=this.clone();return Pe.__iteratees__.push({iteratee:nr(pe,3),type:P}),Pe.__filtered__=Pe.__filtered__||ae,Pe}}),Ci(["head","last"],function(s,p){var P="take"+(p?"Right":"");wr.prototype[s]=function(){return this[P](1).value()[0]}}),Ci(["initial","tail"],function(s,p){var P="drop"+(p?"":"Right");wr.prototype[s]=function(){return this.__filtered__?new wr(this):this[P](1)}}),wr.prototype.compact=function(){return this.filter(fa)},wr.prototype.find=function(s){return this.filter(s).head()},wr.prototype.findLast=function(s){return this.reverse().find(s)},wr.prototype.invokeMap=Lr(function(s,p){return typeof s=="function"?new wr(this):this.map(function(P){return Zi(P,s,p)})}),wr.prototype.reject=function(s){return this.filter(Hl(nr(s)))},wr.prototype.slice=function(s,p){s=Cr(s);var P=this;return P.__filtered__&&(s>0||p<0)?new wr(P):(s<0?P=P.takeRight(-s):s&&(P=P.drop(s)),p!==o&&(P=(p=Cr(p))<0?P.dropRight(-p):P.take(p-s)),P)},wr.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},wr.prototype.toArray=function(){return this.take(j)},Oo(wr.prototype,function(s,p){var P=/^(?:filter|find|map|reject)|While$/.test(p),ae=/^(?:head|last)$/.test(p),pe=be[ae?"take"+(p=="last"?"Right":""):p],Pe=ae||/^find/.test(p);pe&&(be.prototype[p]=function(){var Xe=this.__wrapped__,it=ae?[1]:arguments,wt=Xe instanceof wr,gt=it[0],Nt=wt||yr(Xe),Qt=function(Nn){var wn=pe.apply(be,wa([Nn],it));return ae&&On?wn[0]:wn};Nt&&P&&typeof gt=="function"&&gt.length!=1&&(wt=Nt=!1);var On=this.__chain__,jn=!!this.__actions__.length,Qn=Pe&&!On,Ut=wt&&!jn;if(!Pe&&Nt){Xe=Ut?Xe:new wr(this);var sn=s.apply(Xe,it);return sn.__actions__.push({func:Tc,args:[Qt],thisArg:o}),new Tr(sn,On)}return Qn&&Ut?s.apply(this,it):(sn=this.thru(Qt),Qn?ae?sn.value()[0]:sn.value():sn)})}),Ci(["pop","push","shift","sort","splice","unshift"],function(s){var p=la[s],P=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",ae=/^(?:pop|shift)$/.test(s);be.prototype[s]=function(){var pe=arguments;if(ae&&!this.__chain__){var Pe=this.value();return p.apply(yr(Pe)?Pe:[],pe)}return this[P](function(Xe){return p.apply(yr(Xe)?Xe:[],pe)})}}),Oo(wr.prototype,function(s,p){var P=be[p];if(P){var ae=P.name+"";Wn.call(kt,ae)||(kt[ae]=[]),kt[ae].push({name:p,func:P})}}),kt[xu(o,2).name]=[{name:"wrapper",func:o}],wr.prototype.clone=function(){var s=new wr(this.__wrapped__);return s.__actions__=Za(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Za(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Za(this.__views__),s},wr.prototype.reverse=function(){if(this.__filtered__){var s=new wr(this);s.__dir__=-1,s.__filtered__=!0}else(s=this.clone()).__dir__*=-1;return s},wr.prototype.value=function(){var s=this.__wrapped__.value(),p=this.__dir__,P=yr(s),ae=p<0,pe=P?s.length:0,Pe=function(Er,Bn,zn){for(var ui=-1,ri=zn.length;++ui<ri;){var ji=zn[ui],zr=ji.size;switch(ji.type){case"drop":Er+=zr;break;case"dropRight":Bn-=zr;break;case"take":Bn=Ai(Bn,Er+zr);break;case"takeRight":Er=di(Er,Bn-zr)}}return{start:Er,end:Bn}}(0,pe,this.__views__),Xe=Pe.start,it=Pe.end,wt=it-Xe,gt=ae?it:Xe-1,Nt=this.__iteratees__,Qt=Nt.length,On=0,jn=Ai(wt,this.__takeCount__);if(!P||!ae&&pe==wt&&jn==wt)return uo(s,this.__actions__);var Qn=[];e:for(;wt--&&On<jn;){for(var Ut=-1,sn=s[gt+=p];++Ut<Qt;){var Nn=Nt[Ut],wn=Nn.iteratee,pr=Nn.type,lr=wn(sn);if(pr==2)sn=lr;else if(!lr){if(pr==1)continue e;break e}}Qn[On++]=sn}return Qn},be.prototype.at=Gl,be.prototype.chain=function(){return Lh(this)},be.prototype.commit=function(){return new Tr(this.value(),this.__chain__)},be.prototype.next=function(){this.__values__===o&&(this.__values__=dd(this.value()));var s=this.__index__>=this.__values__.length;return{done:s,value:s?o:this.__values__[this.__index__++]}},be.prototype.plant=function(s){for(var p,P=this;P instanceof on;){var ae=Yo(P);ae.__index__=0,ae.__values__=o,p?pe.__wrapped__=ae:p=ae;var pe=ae;P=P.__wrapped__}return pe.__wrapped__=s,p},be.prototype.reverse=function(){var s=this.__wrapped__;if(s instanceof wr){var p=s;return this.__actions__.length&&(p=new wr(this)),(p=p.reverse()).__actions__.push({func:Tc,args:[wc],thisArg:o}),new Tr(p,this.__chain__)}return this.thru(wc)},be.prototype.toJSON=be.prototype.valueOf=be.prototype.value=function(){return uo(this.__wrapped__,this.__actions__)},be.prototype.first=be.prototype.head,ni&&(be.prototype[ni]=function(){return this}),be}();Ce?((Ce.exports=_e)._=_e,K._=_e):jr._=_e}).call(commonjsGlobal)}),MrxDbgUiPrBaseReturn;async function useCanvasResizeListener(b,r,o=100){if(!store.state.MxFun)return void console.error("请先调用loadCoreCode方法! ");if(!b)return void console.error("请确保mxdrawObj参数 是通过调用MxFun.createMxObject的callback回调函数拿到的mxDraw对象");let a=b;if(!a.isLoadCanvasResizeListene){let v;a.isLoadCanvasResizeListene=!0,b.addEvent("addResizeEvent",w=>{v=w}),await dynamicImport("element-resize-event-polyfill");let h=createCanvasParent(r);h.addEventListener?h.addEventListener("resize",lodash.throttle(function(w){v&&v()},o),!1):console.log("mx: parentdiv[addEventListener] invalid")}}class McEdGetPointWorldDrawObject{constructor(){var r;this._McEdGetPointWorldDraw=new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().McEdGetPointWorldDrawObjectClass()),this._get=()=>this._McEdGetPointWorldDraw}drawCircle(r,o){return this._McEdGetPointWorldDraw.drawCircle(r,o)}drawLine(r,o){return this._McEdGetPointWorldDraw.drawLine(r,o)}drawSolid(r,o){this.drawSolid(r,o)}drawRect(r,o){return this._McEdGetPointWorldDraw.drawRect(r,o)}drawEntity(r,o){return this._McEdGetPointWorldDraw.drawEntity(r,o)}drawMcDbEntity(r,o){return this._McEdGetPointWorldDraw.drawMcDbEntity(r,o)}drawMcDbLine(r,o,a,v,h,w){return this._McEdGetPointWorldDraw.drawMcDbLine(r,o,a,v,h,w)}drawText(r,o,a,v){return this._McEdGetPointWorldDraw.drawText(r,o,a,v)}setDraw(r){return this._McEdGetPointWorldDraw.setDraw(r)}setColor(r){return this._McEdGetPointWorldDraw.setColor(r)}getColor(){return this._McEdGetPointWorldDraw.getColor()}drawCustomEntity(r,o){return this._McEdGetPointWorldDraw.drawCustomEntity(r,o)}}(function(b){b[b.kCancel=-2]="kCancel",b[b.kNone=-1]="kNone",b[b.kOk=0]="kOk",b[b.kKeyWord=1]="kKeyWord"})(MrxDbgUiPrBaseReturn||(MrxDbgUiPrBaseReturn={}));var MrxDbgUiPrBaseReturn$1=MrxDbgUiPrBaseReturn,MxCursorType,DynamicInputType,DetailedResult,UserInputControls;(function(b){b[b.kNormal=0]="kNormal",b[b.kRect=1]="kRect",b[b.kCross=2]="kCross"})(MxCursorType||(MxCursorType={})),function(b){b[b.kNoInput=0]="kNoInput",b[b.kXYCoordInput=1]="kXYCoordInput",b[b.kDistanceInput=2]="kDistanceInput",b[b.kDynTip=3]="kDynTip",b[b.kAutoInput=4]="kAutoInput",b[b.kAngleInput=5]="kAngleInput"}(DynamicInputType||(DynamicInputType={})),function(b){b[b.kUnknown=1]="kUnknown",b[b.kTouchDownIn=2]="kTouchDownIn",b[b.kTouchUpIn=3]="kTouchUpIn",b[b.kMouseLeftIn=4]="kMouseLeftIn",b[b.kMouseLeftUpIn=5]="kMouseLeftUpIn",b[b.kMouseRightIn=6]="kMouseRightIn",b[b.kKeyIn=7]="kKeyIn",b[b.kCoordIn=8]="kCoordIn",b[b.kNullEnterIn=9]="kNullEnterIn",b[b.kNullSpaceIn=10]="kNullSpaceIn",b[b.kEcsIn=11]="kEcsIn",b[b.kNewCommadIn=12]="kNewCommadIn",b[b.kCodeAbort=13]="kCodeAbort"}(DetailedResult||(DetailedResult={})),function(b){b[b.kGovernedByOrthoMode=1]="kGovernedByOrthoMode",b[b.kNullResponseAccepted=2]="kNullResponseAccepted",b[b.kDontEchoCancelForCtrlC=4]="kDontEchoCancelForCtrlC",b[b.kDontUpdateLastPoint=8]="kDontUpdateLastPoint",b[b.kNoDwgLimitsChecking=16]="kNoDwgLimitsChecking",b[b.kNoZeroResponseAccepted=32]="kNoZeroResponseAccepted",b[b.kNoNegativeResponseAccepted=64]="kNoNegativeResponseAccepted",b[b.kAccept3dCoordinates=128]="kAccept3dCoordinates",b[b.kAcceptMouseUpAsPoint=256]="kAcceptMouseUpAsPoint",b[b.kAnyBlankTerminatesInput=512]="kAnyBlankTerminatesInput",b[b.kInitialBlankTerminatesInput=1024]="kInitialBlankTerminatesInput",b[b.kAcceptOtherInputString=2048]="kAcceptOtherInputString",b[b.kGovernedByUCSDetect=4096]="kGovernedByUCSDetect",b[b.kNoZDirectionOrtho=8192]="kNoZDirectionOrtho",b[b.kSpacesInAccepted=16384]="kSpacesInAccepted"}(UserInputControls||(UserInputControls={}));class MrxDbgUiPrBase{constructor(r){this.imp=r,this.status=MrxDbgUiPrBaseReturn$1.kCancel}keyWords(){return this.imp.keyWords()}setKeyWords(r){return this.imp.setKeyWords(r)}message(){return this.imp.message()}setMessage(r){return this.imp.setMessage(r)}clearLastInputPoint(){this.imp.clearLastInputPoint()}setLastInputPoint(r){this.imp.SetLASTPOINT(r)}keyWordPicked(){return this.imp.keyWordPicked()}isKeyWordPicked(r){return this.status==MrxDbgUiPrBaseReturn$1.kKeyWord&&this.imp.isKeyWordPicked(r)}setUserDraw(r){if(typeof r!="function")return this.imp.setUserDraw(r._get?r._get():r);{const o=new McEdGetPointWorldDrawObject;o.setDraw(r),this.imp.setUserDraw(o._get())}}getDetailedResult(){return this.imp.getDetailedResult()}getStatus(){return this.status}drawReserve(r){return this.imp.drawReserve(r)}setInputToucheType(r){return this.imp.setInputToucheType(r)}getInputToucheType(){return this.imp.getInputToucheType()}setCursorType(r){this.imp.setCursorType(r)}getCursorType(){return this.imp.getCursorType()}setDynamicInputType(r){this.imp.setDynamicInputType(r)}getDynamicInputType(){return this.imp.getDynamicInputType()}isDisableDynInput(){return this.imp.isDisableDynInput()}setDisableDynInput(r){return this.imp.setDisableDynInput(r)}setDisableOsnap(r){return this.imp.setDisableOsnap(r)}isOffsetInputPostion(){return this.imp.isOffsetInputPostion()}setOffsetInputPostion(r){return this.imp.setOffsetInputPostion(r)}isDisableOsnap(){return this.imp.isDisableOsnap()}setDisableDynamicTrace(r){this.imp.setDisableDynamicTrace(r)}isDisableDynamicTrace(){return this.imp.isDisableDynamicTrace()}setDisablePolarAxisTrace(r){this.imp.setDisablePolarAxisTrace(r)}isDisablePolarAxisTrace(){return this.imp.isDisablePolarAxisTrace()}setDisableGridTrace(r){this.imp.setDisableGridTrace(r)}isDisableGridTrace(){return this.imp.isDisableGridTrace()}setDisableOrthoTrace(r){this.imp.setDisableOrthoTrace(r)}isDisableOrthoTrace(){return this.imp.isDisableOrtho()}disableAllTrace(r=!0){this.imp.disableAllTrace(r)}userInputControls(){return this.imp.userInputControls()}setUserInputControls(r){this.imp.setUserInputControls(r)}}class MrxDbgUiPrPoint extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrPointClass()))}value(){return this.imp.value()}getCADValue(){return this.imp.getCADValue()}valueDocCoord(){return this.imp.valueDocCoord()}basePt(){return this.imp.basePt()}setBasePt(r){return this.imp.setBasePt(r)}setUseBasePt(r){return this.imp.setUseBasePt(r)}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.imp.value())})})}goWhile(r,o){return this.imp.goWhile(r,o)}abort(r){this.imp.abort(r)}}class MxVueComandLine{constructor(){this.msCmdText="",this.msCmdDisplay="",this.msCmdTip="",this.mxFunObject=void 0,this.mountUpDisplayFun=r=>{this.mUpDisplayFun=r},this.setCmdText=r=>{this.msCmdText=r},this.getCmdText=()=>this.msCmdText,this.getCmdDisplay=()=>this.msCmdDisplay,this.setCmdDisplay=r=>{this.msCmdDisplay=r},this.addCmdDisplay=r=>{this.msCmdDisplay.length>1024?(this.msCmdDisplay=this.msCmdDisplay.substring(this.msCmdDisplay.length-1024,this.msCmdDisplay.length),this.msCmdDisplay=this.msCmdDisplay+r):this.msCmdDisplay=this.msCmdDisplay+r},this.setCmdTip=r=>{this.msCmdTip=r},this.getCmdTip=()=>this.msCmdTip}upDisplay(){const{msCmdTip:r,msCmdDisplay:o,msCmdText:a}=this;this.mUpDisplayFun!=null&&this.mUpDisplayFun({msCmdTip:r,msCmdDisplay:o,msCmdText:a})}}const MxInputType={kNoInput:0,kXYCoordInput:1,kDistanceInput:2,kDynTip:3},MxInputPostionType={kRelative:0,kAbsolutely:1};class MxDynamicInput{constructor(){this.mType=MxInputType.kNoInput,this.mPos=[0,0],this.mTip="",this.mValue1="",this.mValue1Pos=[0,0],this.mValue2="",this.mValue2Pos=[0,0],this.misShow=!1,this.focusIndex=0,this.mOnKeydownEvent=void 0,this.mFocusValue="",this.setFocusValue=r=>{this.mFocusValue=r},this.getFocusValue=()=>this.mFocusValue,this.getFocusIndex=()=>this.focusIndex,this.setFocusIndex=r=>{this.focusIndex=r},this.mountKeydownEvent=r=>{this.mOnKeydownEvent=r},this.onKeydown=r=>{this.mOnKeydownEvent!=null&&this.mOnKeydownEvent(r)},this.setType=r=>{this.mType=r},this.getType=()=>this.mType,this.isShow=()=>this.misShow,this.setPos=r=>{this.mPos=r},this.setTip=r=>{this.mTip=r},this.setValue1=r=>{this.mValue1=r},this.getValue1=()=>this.mValue1,this.setValue1Pos=r=>{this.mValue1Pos=r},this.setValue2=r=>{this.mValue2=r},this.getValue2=()=>this.mValue2,this.setValue2Pos=r=>{this.mValue2Pos=r},this.setShow=r=>{this.misShow=r},this.getData=()=>{if(!this.misShow)return;let r={list:[{value:"",readonly:!0},{value:"",readonly:!1},{value:"",readonly:!1}],pos:this.mPos,postype:MxInputPostionType.kRelative};return this.mType!=MxInputType.kNoInput?(this.mType==MxInputType.kXYCoordInput?(r.list[0].show=!0,r.list[0].value=this.mTip,r.list[0].readonly=!0,r.list[1].show=!0,r.list[1].value=this.mValue1,r.list[1].readonly=!1,r.list[2].show=!0,r.list[2].value=this.mValue2,r.list[2].readonly=!1):this.mType==MxInputType.kDistanceInput?(r.list[0].show=!0,r.list[0].value=this.mTip,r.list[0].readonly=!0,r.list[1].show=!0,r.list[1].value=this.mValue1,r.list[1].readonly=!1,r.list[1].pos=this.mValue1Pos,r.list[2].show=!0,r.list[2].value=this.mValue2,r.list[2].readonly=!1,r.list[2].pos=this.mValue2Pos,r.postype=MxInputPostionType.kAbsolutely):this.mType==MxInputType.kDynTip?(r.list[0].show=!0,r.list[0].value=this.mTip,r.list[0].readonly=!0,r.list[1].show=!1,r.list[2].show=!1):r=void 0,r):void 0}}}const CursorType={kNormal:"Normal",kRect:"Rect",kCross:"Cross",kPan:"Pan"};class MxVueInterface{constructor(){this.mSetCoordFun=void 0,this.mUpdateCursorFun=void 0,this.mOnKeydownEvent=void 0,this.mCursorType=CursorType.kNormal,this.mComandLine=new MxVueComandLine,this.mdynamicInput=new MxDynamicInput,this.mMxEvents={},this.mountSetCoordFun=r=>{this.mSetCoordFun=r},this.mountUpdateCursorFun=r=>{this.mUpdateCursorFun=r},this.mountKeydownEvent=r=>{this.mOnKeydownEvent=r},this.onKeydown=r=>{this.mOnKeydownEvent!=null&&this.mOnKeydownEvent(r)},this.setTipCoord=r=>{this.mSetCoordFun!=null&&this.mSetCoordFun(r)},this.getCursorType=()=>this.mCursorType,this.setCursorType=r=>{if(typeof r=="number")switch(r){case 0:this.mCursorType=CursorType.kNormal;break;case 1:this.mCursorType=CursorType.kRect;break;case 2:this.mCursorType=CursorType.kCross;break;case 3:this.mCursorType=CursorType.kPan}else this.mCursorType=r;this.mUpdateCursorFun!=null&&this.mUpdateCursorFun(this.mCursorType)},this.getTitle=()=>this.mTitle,this.getTopButtonBarData=()=>this.mTopButtonBarData,this.getMenuBarData=()=>this.mMenuBarData,this.getRighButtonBarData=()=>this.mRighButtonBarData,this.getLeftButtonBarData=()=>this.mLeftButtonBarData,this.getTitleButtonBarData=()=>this.mTitleButtonBarData,this.getLayerComboxData=()=>this.mLayerComboxData,this.getColorComboxData=()=>this.mColorComboxData,this.getLinetypeComboxData=()=>this.mLinetypeComboxData,this.getFooterData=()=>this.mFooterData,this.sendStringToExecute=r=>{this.mxFunObject.sendStringToExecute(r)},this.getCmdLine=()=>this.mComandLine,this.getDynamicInput=()=>this.mdynamicInput,this.init=r=>{this.mxFunObject=r},this.OnMxEvent=r=>{const o=r.name;if(o==null)return;const a=this.mMxEvents[o];a!=null&&a(r.param)},this.mountMxEvent=(r,o)=>{this.mMxEvents[r]=o}}}const mxUiData$1=new MxVueInterface;function createReandomId(b=10){return new Number(Math.random().toString().substr(3,b)+Date.now()).toString(36)}class Node extends PubSub{constructor(){super(...arguments),this.parent=null,this.children=[]}add(...r){if(r.length>1){for(let a=0;a<r.length;a++){const v=r[a];this.add(v)}return this}const o=r[0];return o===this?(console.error("Node.add 不可以添加它自己"),this):(o&&(o.parent!==null&&o.parent.remove(o),o.parent=this,this.children.push(o)),this)}remove(...r){r.length>1&&r.forEach(v=>{this.remove(v)});const o=r[0],a=this.children.indexOf(o);return a!==-1&&(o.parent=null,this.children.splice(a,1)),this}removeFromParent(){const r=this.parent;return r!==null&&r.remove(this),this}clear(){for(let r=0;r<this.children.length;r++)this.children[r].parent=null;return this.children.length=0,this}getNodeByProperty(r,o){if(this[r]===o)return this;for(let a=0,v=this.children.length;a<v;a++){const h=this.children[a].getNodeByProperty(r,o);if(h!==void 0)return h}}getNodesByProperty(r,o){let a=[];this[r]===o&&a.push(this);for(let v=0,h=this.children.length;v<h;v++){const w=this.children[v].getNodesByProperty(r,o);w.length>0&&(a=a.concat(w))}return a}traverse(r){r(this);const o=this.children;for(let a=0,v=o.length;a<v;a++)o[a].traverse(r)}traverseParent(r){this.parent!==null&&r(this.parent)!==!1&&this.parent.traverseParent(r)}emit(r,...o){super.emit(r,...o),this.traverseParent(a=>(a.emit(r,...o),(o==null?void 0:o.isEventBubbling)!==!1&&void 0))}}class RenderOrderNode extends Node{constructor(){super(),this.renderOrder=30}setRenderOrder(r){this.renderOrder=r}getRenderOrder(){return this.renderOrder}top(){var r;if(!this.parent)return;let o=Math.max(...(r=this.parent)===null||r===void 0?void 0:r.children.map(({renderOrder:a})=>a));o!==this.renderOrder&&o++,this.setRenderOrder(o)}bottom(){var r;if(!this.parent)return;let o=Math.min(...(r=this.parent)===null||r===void 0?void 0:r.children.map(({renderOrder:a})=>a));o--,this.setRenderOrder(o)}restoreDefaultRenderOrder(){this.renderOrder=30}}class Layer extends RenderOrderNode{constructor(r){super(),this.isLayer=!0,this.getLayerMap=()=>this.getDatabase()._mxDatabase.mapNameToLayer,this.getEntityMap=()=>this.getDatabase()._mxDatabase.mapIdToEntity,this.getRootLayerName=()=>this.getNames()[0]||"0";const o=typeof r=="string"?r:Date.now()+Math.random().toString(36).substr(2,9);Object.defineProperty(this,"name",{get:()=>o,set(){throw new Error("不能修改Layer.name值, 因为它是Layer 实例的唯一标识")},configurable:!1});let a=this.renderOrder;Object.defineProperty(this,"renderOrder",{get:()=>a,set(v){this.getLayer().group.renderOrder=v,a=v,MxFun.updateDisplay()}})}get visible(){const r=this.getDatabase().getLayer(this.name);return!r||r.getVisible()}set visible(r){this.getDatabase().showLayer(this.name,r),MxFun.updateDisplay()}setVisible(r){this.visible=r}getDatabase(){return this._database||(this._database=MxFun.getCurrentDatabase()),this._database}getLayer(){return this.getDatabase().getLayer(this.name)||this.getDatabase().addLayer(this.name),this.getDatabase().getLayer(this.name)}getCurrentName(){return this.getDatabase()._mxDatabase.curLayer.toString()}async callLayerContextFun(r){const o=this.getCurrentName();this.getDatabase().setCurrentLayer(this.name);const a=await r();return this.getDatabase().setCurrentLayer(o),a}getNames(){return Array.from(this.getLayerMap().keys())}getAllEntity(){return Array.from(this.getEntityMap().values()).filter(({userObject:r})=>r.layer===this.name).map(({userObject:r})=>r)}add(...r){var o;const a=this.getLayer();return a.group.renderOrder!==this.renderOrder&&(a.group.renderOrder=this.renderOrder,this.children=this.getAllEntity()),this.parent||(this.parent=MxFun.getCurrentDraw(),(o=this.parent)===null||o===void 0||o.add(this)),super.add(...r),this.callLayerContextFun(()=>{r.forEach(v=>{v&&this.getDatabase().addEntity(v)})}),this}remove(...r){super.remove(...r);let o=this.getRootLayerName();return this.callLayerContextFun(()=>{r.forEach(a=>{a&&(a.setLayer(o),a.setNeedUpdateDisplay())})}),this}}class MxDbDatabase{constructor(r){this._mxDatabase=r}addLayer(r){return this._mxDatabase.addLayer(r)}showLayer(r,o){this._mxDatabase.showLayer(r,o)}setCurrentLayer(r){return this._mxDatabase.setCurrentLayer(r)}getLayer(r){return this._mxDatabase.getLayer(r)}addEntity(r){return this._mxDatabase.addMxEntity(r)}getGroup(r){return this._mxDatabase.getGroupDictionary().getAt(r)}addGroup(r){return this._mxDatabase.getGroupDictionary().add(r)}getEntityInGroup(r){return this._mxDatabase.getGroupDictionary().getEntityInGroup(r)}deleteGroup(r){return this._mxDatabase.getGroupDictionary().delete(r)}}class MxTempMarkDraw{constructor(r){this.imp=r}clear(){this.imp.clear()}drawLine(r,o,a=16777215,v=1){this.imp.drawLine(r,o,a,v)}drawCircle(r,o,a){this.imp.drawCircle(r,o,a)}drawEntity(r){this.imp.drawEntity(r)}drawCircleMark(r,o,a){this.imp.drawCircleMark(r,o,a)}}function setGeometrPostion(b,r){for(let o=0;o<b.vertices.length;o++)b.vertices[o].x+=r.x,b.vertices[o].y+=r.y,b.vertices[o].z+=r.z}function repairGeometryFaceVertexUvs(b){b.computeBoundingBox();const r=b.boundingBox.min,o=b.boundingBox.max,a=new THREE.Vector2(0-r.x,0-r.y),v=new THREE.Vector2(o.x-r.x,o.y-r.y);b.faceVertexUvs[0]=[];const h=b.faces;for(let w=0;w<h.length;w++){const L=h[w],G=b.vertices[L.a],k=b.vertices[L.b],D=b.vertices[L.c];b.faceVertexUvs[0].push([new THREE.Vector2((G.x+a.x)/v.x,(G.y+a.y)/v.y),new THREE.Vector2((k.x+a.x)/v.x,(k.y+a.y)/v.y),new THREE.Vector2((D.x+a.x)/v.x,(D.y+a.y)/v.y)])}return b.uvsNeedUpdate=!0,b}function insertPointsWithEqualSpacing(b){const r=[];if(b.length<2)return b;let o=Number.MAX_VALUE;for(let a=0;a<b.length-1;a++){const v=b[a].distanceTo(b[a+1]);v<o&&(o=v)}for(let a=0;a<b.length-1;a++){const v=b[a],h=b[a+1];r.push(v);const w=v.distanceTo(h);if(w>o){const L=Math.floor(w/o),G=h.clone().sub(v).normalize();for(let k=1;k<L;k++){const D=v.clone().add(G.clone().multiplyScalar(k*o));r.push(D)}}}return r.push(b[b.length-1]),r}function getToGenerateRoundedCorners(b,r,o=!0){const a=new THREE.CurvePath;if(b.length<2)throw new Error("Points should have at least 2 items");if(!r||r.length===0)return b;!o&&b[0].equals(b[b.length-1])&&b.pop(),o||b.push(b[0]);for(let h=0;h<b.length-1;h++){const w=r[h]||0;if(h===0&&!o){const C=b[0].clone().sub(b[1]);C.normalize();const j=b[1].clone();j.add(C.clone().multiplyScalar(w));const V=new THREE.LineCurve3(b[0],j);a.curves.push(V);continue}const L=!o||b[h-1]?b[h-1].clone().sub(b[h]):b[b.length-1].clone().sub(b[0]);L.normalize();const G=!o||b[h+1]?b[h+1].clone().sub(b[h]):b[1].clone().sub(b[0]);G.normalize();const k=b[h].clone().add(L.clone().multiplyScalar(w)),D=b[h].clone(),f=b[h].clone().add(G.clone().multiplyScalar(w)),O=new THREE.QuadraticBezierCurve3(k,D,f);if(h===b.length-2){const C=b[h].clone().add(G.clone().multiplyScalar(w)),j=b[h+1].clone();o?j.add(G.clone().multiplyScalar(-w)):j.add(G.clone());const V=new THREE.LineCurve3(C,j);a.curves.push(O,V)}else a.curves.push(O);h===0&&b.push(b[0])}let v=a.getPoints();return v=insertPointsWithEqualSpacing(v)}function computeRectPoints(b,r){return[b,b.clone().set(r.x,b.y,r.z),r,r.clone().set(b.x,r.y,b.z)]}function calculateArcOrigin(b,r,o){const a=b.x,v=r.x,h=o.x,w=b.y,L=r.y,G=o.y,k=a-v,D=w-L,f=a-h,O=w-G,C=(a*a-v*v+(w*w-L*L))/2,j=(a*a-h*h+(w*w-G*G))/2,V=D*f-k*O,R=-(O*C-D*j)/V,M=-(k*j-f*C)/V;return new THREE.Vector3(R,M,0)}function calculateRadiusArc(b,r){const o=b.x,a=b.y,v=r.x,h=r.y;return Math.sqrt((o-v)*(o-v)+(a-h)*(a-h))}function calculateArcAngle(b,r,o){const a=b.x,v=r.x;let h,w,L;return h=(b.y-r.y)/o,(w=(a-v)/o)>=.99999&&(w=.99999),w<=-.99999&&(w=-.99999),L=(L=Math.acos(w))/Math.PI*180,h<-.05&&(L=360-L),{sin:h,cos:w,angle:L}}function judgementArcRenderDirection(b,r,o){return(b<r?r-b:r-b+360)>(b<o?o-b:o-b+360)}function createThreePointArc(b,r,o,a=!1,v=!1,h=new THREE.Color("#ff0000")){const w=calculateArcOrigin(b,r,o),L=w.x,G=w.y,k=calculateRadiusArc(b,w),D=calculateArcAngle(b,w,k),f=calculateArcAngle(r,w,k),O=calculateArcAngle(o,w,k);let C,j,V=D.angle,R=f.angle,M=O.angle,ee=judgementArcRenderDirection(V,R,M);v&&(ee=!0),a?(j=new THREE.ArcCurve(L,G,k,THREE.MathUtils.degToRad(V),THREE.MathUtils.degToRad(R),!ee),C=ee?R>V?THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle):360-Math.abs(THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle)):V>R?Math.abs(THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle)):360-THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle)):(j=new THREE.ArcCurve(L,G,k,THREE.MathUtils.degToRad(V),THREE.MathUtils.degToRad(M),ee),C=ee?M>V?360-THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle):Math.abs(THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle)):V>M?360+THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle):THREE.MathUtils.radToDeg(j.aEndAngle-j.aStartAngle));const F=C*Math.PI*k/180,_=new THREE.BufferGeometry().setFromPoints(j.getPoints(50)),J=new THREE.LineBasicMaterial({color:h});return{arc:new THREE.Line(_,J),radius:k,angle:C,arcLength:F}}function computeRegularPolygonVertices(b=new THREE.Vector3,r=new THREE.Vector3,o=3){const a=[];o=Math.max(3,o),a.push(r);const v=2*Math.PI/o;for(let h=1;h<o;h++){const w=Math.cos(v*h),L=Math.sin(v*h),G=b.clone(),k=r.clone(),D=k.x-G.x,f=k.y-G.y,O=new THREE.Vector3(D*w-f*L+G.x,D*L+f*w+G.y);a.push(O)}return a}function computeBounding(b){if(b.length==0){let r=new THREE.Vector3;return{centerPoint:r,minPoint:r,maxPoint:r}}{let r=new THREE.Vector3(b[0].x,b[0].y,b[0].z||0),o=new THREE.Vector3(b[0].x,b[0].y,b[0].z||0),a=b.length;for(let v=1;v<a;v++){let h=b[v];r.x>h.x&&(r.x=h.x),r.y>h.y&&(r.y=h.y),o.x<h.x&&(o.x=h.x),o.y<h.y&&(o.y=h.y)}return{centerPoint:new THREE.Vector3(r.x+.5*(o.x-r.x),r.y+.5*(o.y-r.y),0),minPoint:r,maxPoint:o}}}function MxThreeJSMixin(b){return b.createImage=function(r,o,a,v,h){if(!h)return new Promise((w,L)=>{b.createImage.call(this,r,o,a,v,G=>w(G))});new THREE.TextureLoader().load(v,function(w){let L=new THREE.PlaneGeometry(o,a),G=new THREE.MeshLambertMaterial({map:w,transparent:!0,side:THREE.DoubleSide});G.map&&(G.map.needsUpdate=!0),setGeometrPostion(L,r);let k=new THREE.Mesh(L,G);k.material.depthTest=!1,h&&h(k)},void 0,function(w){console.log(w),h&&h(null)})},b.loadSVG=function(r,o,a,v){return a?(store.state.MxFun.loadSVG(r,o,a,v),new Promise(h=>{h(null)})):new Promise(h=>{store.state.MxFun.loadSVG(r,o,w=>{h(w)},v)})},b.clacTextSize=(r,o)=>store.state.MxFun.getMxThreeJS().clacTextSize(r,o),b.clacTextSpriteSize=(r,o,a)=>store.state.MxFun.getMxThreeJS().clacTextSpriteSize(r,o,a),b.creatTextSprite=(r,o,a,v,h)=>r.length===0?null:(h instanceof Object?h.getHex&&(h=h.getHex()):typeof h=="string"&&(h=parseInt(h)),store.state.MxFun.getMxThreeJS().creatTextSprite(r,o,a,v,h)),b}class MxThreeJS$1{createLine(r,o,a){const v=new THREE.Geometry,h=new THREE.LineBasicMaterial({color:a});return v.vertices.push(r,o),new THREE.Line(v,h)}createCircle(r,o,a){const v=new THREE.CircleGeometry(o,64,3,2*Math.PI),h=new THREE.LineBasicMaterial({color:a});v.vertices.shift();const w=new THREE.LineLoop(v,h),{x:L,y:G,z:k}=r;return w.position.set(L,G,k),w}createPoint(r,o,a=3){const v=new THREE.Geometry;v.vertices.push(r);const h=new THREE.PointsMaterial({color:o,size:a});return new THREE.Points(v,h)}createTriangle(r,o,a=1){if(r.length<3)return null;const v=r.length,h=new THREE.Geometry;for(let L=0;L+2<v;L+=3){h.vertices.push(r[L]),h.vertices.push(r[L+1]),h.vertices.push(r[L+2]);const G=new THREE.Face3(L,L+1,L+2);h.faces.push(G)}h.computeFaceNormals(),h.computeVertexNormals();const w=new THREE.MeshBasicMaterial({color:o,transparent:!0,depthTest:!1,side:THREE.DoubleSide,opacity:a});return new THREE.Mesh(h,w)}createLines(r,o){const a=new THREE.Geometry;a.vertices=r;const v=new THREE.LineBasicMaterial({color:o});return new THREE.Line(a,v)}createDashedLines(r,o,a,v){const h=new THREE.Geometry;h.vertices=r;const w=new THREE.Line(h,new THREE.LineDashedMaterial({color:o,dashSize:a,gapSize:v}));return w.computeLineDistances(),w}}const MxThreeJS=MxThreeJSMixin(new MxThreeJS$1);class MxDrawObject extends Node{constructor(r){super(),this.rootLayer=new Layer(r.m_mxDatabase.curLayer),this.add(this.rootLayer),this._mxdrawObj=r}getMxObjectImplement(){return this._mxdrawObj}getScene(){return this._mxdrawObj.getScene()}setMultipleSelect(r){this._mxdrawObj.isMultipleSelect=r}getCamera(){return this._mxdrawObj.getCamera()}getRenderer(){return this._mxdrawObj.renderer}setMouseRightRotate(r=!0){return this._mxdrawObj.setMouseRightRotate(r)}getFullDisplayRange(){return this._mxdrawObj.getFullDisplayRange()}getCanvas(){return this._mxdrawObj.getCanvas()}updateDisplay(r=!1){return this._mxdrawObj.updateDisplay(r)}createCanvasImageData(r,o){return this._mxdrawObj.createCanvasImageData(r,o)}setViewColor(r){return this._mxdrawObj.setViewColor(r)}getViewColor(){return this._mxdrawObj.getViewColor()}setSize(r,o){return this._mxdrawObj.setSize(r,o)}getIntersectObjects(r){return this._mxdrawObj.getIntersectObjects(r)}addObject(r,o=!0){return this._mxdrawObj.addObject(r,o)}addViewObject(r){return this._mxdrawObj.addViewObject(r)}getViewWidth(){return this._mxdrawObj.getViewWidth()}getViewHeight(){return this._mxdrawObj.getViewHeight()}removeObject(r,o=!0){return this._mxdrawObj.removeObject(r,o)}zoomInitialStates(){return this._mxdrawObj.zoomInitialStates()}zoomScale(r){return this._mxdrawObj.zoomScale(r)}zoomW(r,o,a,v,h){return this._mxdrawObj.zoomW(r,o,a,v,h)}saveZoom(){return this._mxdrawObj.saveZoom()}recoverZoom(){return this._mxdrawObj.recoverZoom()}zoomCenter(r,o){return this._mxdrawObj.zoomCenter(r,o)}initZoomW(r,o){return this._mxdrawObj.initZoomW(r,o)}addEvent(r,o){return this._mxdrawObj.addEvent(r,o)}on(r,o){return super.on(r,o),this._mxdrawObj.addEvent(r,o)}off(r,o){return super.off(r,o),this.removeEventFuction(r,o)}removeEventFuction(r,o){return this._mxdrawObj.removeEventFuction(r,o)}setIniset(r){return this._mxdrawObj.setIniset(r)}getViewDocCoord(){return this._mxdrawObj.getViewDocCoord()}screenCoord2World(r,o,a){return this._mxdrawObj.screenCoord2World(r,o,a)}worldCoord2Screen(r,o,a){return this._mxdrawObj.worldCoord2Screen(r,o,a)}screenCoord2Doc(r,o){return this._mxdrawObj.screenCoord2Doc(r,o,0)}worldCoordLong2Doc(r){return this._mxdrawObj.worldCoordLong2Doc(r)}docCoordLong2World(r){return this._mxdrawObj.docCoordLong2World(r)}docCoord2World(r,o,a){return this._mxdrawObj.docCoord2World(r,o,a)}docCoord2World2(r){return this._mxdrawObj.docCoord2World(r.x,r.y,r.z)}worldCoord2Doc(r,o,a){return this._mxdrawObj.worldCoord2Doc(r,o,a)}worldCoord2Doc2(r){return this._mxdrawObj.worldCoord2Doc(r.x,r.y,r.z)}docCoord2Screen(r,o){return this._mxdrawObj.docCoord2Screen(r,o,0)}screenCoordLong2Doc(r){return this._mxdrawObj.screenCoordLong2Doc(r)}docCoordLong2Screen(r){return this._mxdrawObj.docCoordLong2Screen(r)}screenCoordLong2World(r){return this._mxdrawObj.screenCoordLong2World(r)}worldCoordLong2Screen(r){return this._mxdrawObj.worldCoordLong2Screen(r)}initRendererParam(r){return this._mxdrawObj.initRendererParam(r)}addMxEntity(r){return this.rootLayer.add(r),r.objectId()}getMxCurrentSelect(){let r=this._mxdrawObj.getMxAllSelect();return r.length==0&&(r=this._mxdrawObj.getPrvCommandSelect()),r}getMxCADCurrentSelect(){let r=this._mxdrawObj.getMxCADAllSelect();return r.length==0&&(r=this._mxdrawObj.getPrvCommandMxCADSelect()),r}getSelectPoints(){return this._mxdrawObj.getSelectPoints()}addMxCurrentSelect(r,o=!0,a=!0){return this._mxdrawObj.addMxCurrentSelect(r,o,a)}addMxCADCurrentSelect(r,o=!0,a=!0){return this._mxdrawObj.addMxCADCurrentSelect(r,o,a)}fireSelectChange(r){this._mxdrawObj.fireSelectChange(r)}clearMxCurrentSelect(){return this._mxdrawObj.clearMxCurrentSelect()}getMxEntity(r){return this._mxdrawObj.getMxEntityUserObject(r)}findMxEntityAtPoint(r,o,a){return this._mxdrawObj.findMxEntityAtPoint(r,o,a)}getAllMxEntity(){return this._mxdrawObj.getAllMxEntity()}setViewMovementMethod(r){return this._mxdrawObj.setMouseMiddlePan(r)}setMouseMiddlePan(r){return this._mxdrawObj.setMouseMiddlePan(r)}resetThreeJSControls(){return this._mxdrawObj.resetThreeJSControls()}enableZoom(r){return this._mxdrawObj.enableZoom(r)}enablePan(r){return this._mxdrawObj.enablePan(r)}eraseMxEntity(r){return this._mxdrawObj.eraseMxEntity(r)}removeViewObject(r){this._mxdrawObj.removeViewObject(r)}saveMxEntityToJson(r){return JSON.stringify(this._mxdrawObj.saveMxEntityToJson(r))}saveMxEntityToObject(r){return this._mxdrawObj.saveMxEntityToJson(r)}async loadMxEntityFromJson(r,o=null){if(o){let a=o.length;for(let v=0;v<a;v++)await MxThreeJS.loadSVG(o[v])}return this.getAllMxEntity().forEach(a=>{for(let v in a)Reflect.deleteProperty(a,v)}),typeof r=="string"?this._mxdrawObj.loadMxEntityFromJson(JSON.parse(r)):this._mxdrawObj.loadMxEntityFromJson(r)}eraseAllMxEntity(){return this._mxdrawObj.eraseAllMxEntity()}makeCurrent(){this._mxdrawObj.makeCurrent()}getViewCenterDocCoord(){return this._mxdrawObj.getViewCenterDocCoord()}updateCanvasSize(){this._mxdrawObj.updateCanvasSize()}newFile(r,o,a,v){return this._mxdrawObj.newFile(r,o,a,v)}stopAllLoading(){this._mxdrawObj.stopAllLoading()}getOrbitControls(){return this._mxdrawObj.getOrbitControls()}enableViewControls(r){return this._mxdrawObj.enableViewControls(r)}getMxDatabase(){return new MxDbDatabase(this._mxdrawObj.getMxDatabase())}getTempMarkDraw(){return new MxTempMarkDraw(this._mxdrawObj.getTempMarkDraw())}setZoomSpeed(r){return this._mxdrawObj.setZoomSpeed(r)}resetRenderer(){return this._mxdrawObj.resetRenderer()}setRequestHeader(r){return this._mxdrawObj.setRequestHeader(r)}closeWebSocket(){return this._mxdrawObj.closeWebSocket()}cadCoord2Doc(r,o,a){return this._mxdrawObj.cadCoord2Doc(r,o,a)}cadCoord2Doc2(r){return this._mxdrawObj.cadCoord2Doc2(r)}toSmallcoord(r){return this._mxdrawObj.toSmallcoord(r)}toSmallcoord2(r,o,a=0){return this._mxdrawObj.toSmallcoord2(r,o,a)}docCoord2Cad(r,o,a){return this._mxdrawObj.docCoord2Cad(r,o,a)}docCoord2Cad2(r){return this._mxdrawObj.docCoord2Cad2(r)}viewCoord2Cad(r,o,a){return this._mxdrawObj.viewCoord2Cad(r,o,a)}cadCoord2View(r,o,a){return this._mxdrawObj.cadCoord2View(r,o,a)}cadCoordLong2View(r){return this._mxdrawObj.cadCoordLong2View(r)}viewCoordLong2Cad(r){return this._mxdrawObj.viewCoordLong2Cad(r)}docCoordLong2Cad(r){return this._mxdrawObj.docCoordLong2Cad(r)}cadCoordLong2Doc(r){return this._mxdrawObj.cadCoordLong2Doc(r)}setViewAngle(r){return this._mxdrawObj.setViewAngle(r)}getViewAngle(){return this._mxdrawObj.getViewAngle()}getSysVar(r){return this._mxdrawObj.sysVariable().getSysVar()}setSysVar(r,o){return this._mxdrawObj.sysVariable().setSysVar(r,o)}isMxCAD(){return this._mxdrawObj.isCppMxCAD()}getAllLayoutName(){return this._mxdrawObj.getAllLayoutName()}getDtabaseJsonString(){return this._mxdrawObj.getDtabaseJsonString()}gotoLayout(r){return this._mxdrawObj.gotoLayout(r)}initMxCpp(r){return this._mxdrawObj.initMxCpp(r)}isWebgl2(){return this._mxdrawObj.isWebgl2()}getId(){return this._mxdrawObj.getId()}addControlsEvent(r,o,a=!1){return this._mxdrawObj.addControlsEvent(r,o,a)}clearAllObject(){return this.rootLayer.clear(),this._mxdrawObj.clearAllObject()}setPointMultipleSelect(r=!0){return this._mxdrawObj.setPointMultipleSelect(r)}isWhiteViewColor(){return this._mxdrawObj.isWhiteViewColor()}automaticInversionColor(r){return this._mxdrawObj.automaticInversionColor(r)}renderLoop(r=!0){return this._mxdrawObj.renderLoop(r)}}const initEvents=b=>{let r=[];["click","mousedown","mouseup"].forEach(o=>{b.addEventListener(o,()=>{r.forEach(a=>{a.emit(o)})})}),b.addEventListener("mousemove",()=>{const o=MxFun.getCurrentDraw().findMxEntityAtPoint(MxFun.getCurrentMousePostion(),!1);o.forEach(a=>{a.emit("mousemove")}),o.length===0&&(r.length>0&&r.forEach(a=>{a.emit("mouseout")}),r=[]),r.length===0&&(r=o).forEach(a=>{a.emit("mouseover"),a.emit("hover")})})};function createMxObject({canvasId:b=createReandomId(),cadFile:r="",callback:o,isNewFile:a=!1,useWebsocket:v=!1,isAutoResize:h=!0,mapBox:w,isMxCAD:L=!1,userIdentitySign:G="emptyUserIdentity",isCPPMxCAD:k=!1}){if(this.initUiDataObject(mxUiData$1),!v&&a&&(a=!1),w)if(k){const D=w.canvas;let f=!0;store.state.MxFun.createMxObject(D,"",O=>{let C=new MxDrawObject(O);O.setMouseRightRotate(!1),O.setIniset({EnableOsnapFunction:!0}),o&&o(C,{canvas:D,canvasParent:void 0})},f,!1,!1,w,k)}else{const D=w.canvas;store.state.MxFun.createMxObject(D,r,f=>{let O=new MxDrawObject(f);f.setIniset({EnableOsnapFunction:!0}),o&&o(O,{canvas:D,canvasParent:void 0})},void 0,a,v,w)}else if(k){const D=createCanvas(b),f=createCanvasParent(D);f.parentNode&&f.parentNode.nodeType!=11||document.body.appendChild(f);let O=!0;store.state.MxFun.createMxObject(b,"",C=>{let j=new MxDrawObject(C);C.setMouseRightRotate(!1),C.setIniset({EnableOsnapFunction:!0}),C.addEvent("onResize",()=>(f.tabindex=3,{width:f.clientWidth,height:f.clientHeight})),h&&useCanvasResizeListener(j,D),o&&o(j,{canvas:D,canvasParent:f})},O,!1,!1,void 0,k)}else{const D=createCanvas(b),f=createCanvasParent(D);let O;f.parentNode&&f.parentNode.nodeType!=11||document.body.appendChild(f),L&&(O=!0,v=!0),store.state.MxFun.createMxObject(b,r,C=>{let j=new MxDrawObject(C);L&&(G.length==0&&(G="invalidUserIdentity"),C.initRunMode(2),C.initUserLoginData(G,"")),C.setMouseRightRotate(!1),C.setIniset({EnableOsnapFunction:!0}),C.addEvent("onResize",()=>(f.tabindex=3,{width:f.clientWidth,height:f.clientHeight})),h&&useCanvasResizeListener(j,D),initEvents(D),o&&o(j,{canvas:D,canvasParent:f})},O,a,v,void 0)}}let mxUiData=mxUiData$1;class MxFunClass{constructor(){this.createMxObject=createMxObject,this.getMxFunTHREE=()=>store.state.MxFun.getTHREE()}setMxServer(r="ws://localhost:5090"){store.state.MxFun.setMxServer(r)}screenCoord2Doc(r,o){return store.state.MxFun.screenCoord2Doc(r,o,0)}docCoord2Screen(r,o){return store.state.MxFun.docCoord2Screen(r,o,0)}getCurrentDraw(){const r=store.state.MxFun.getCurrentDraw();return r.tmp||(r.tmp=new MxDrawObject(r)),r.tmp}addToCurrentSpace(r){return MxFun.getCurrentDraw().addMxEntity(r)}initUiDataObject(r){return mxUiData=r,store.state.MxFun.initUiDataObject(r)}getUIData(){return mxUiData}getCurrentDatabase(){return MxFun.getCurrentDraw().getMxDatabase()}testMX(r){return 11}loadImageMaterial(r,o){return o?(store.state.MxFun.loadImageMaterial(r,o),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{store.state.MxFun.loadImageMaterial(r,h=>{a(h||null)})})}selectEnt(r,o=null){return new Promise((a,v)=>{const h=new MrxDbgUiPrPoint;h.setMessage(r),h.go(w=>{if(w!=0)return void a(0);const L=h.value();let G=MxFun.getCurrentDraw().findMxEntityAtPoint(L),k=0;for(;G.length!=0;){let D=G.length;for(let f=0;f<D;f++){let O=G[f];if(!o||!o.type||o.type==O.getTypeName()){k=O.objectId();break}}break}a(k)})})}listenForCommandLineInput(r){mxUiData.getCmdLine().mountUpDisplayFun(r)}setCommandLineInputData(r,o){mxUiData.getCmdLine().setCmdText(r),mxUiData.onKeydown(o)}listenForCoordTip(r){mxUiData.mountSetCoordFun(r)}listenForUpdateCursor(r){mxUiData.mountUpdateCursorFun(r)}getMxFunThreeTool(){return store.state.MxFun.getMxThreeJS()}ceneratecursor(r=128,o=10,a=!0,v){return store.state.MxFun.ceneratecursor(r,o,a,v)}getCurrentMousePostion(){let r=store.state.MxFun.getCurrentMousePostion();return new THREE.Vector3(r.x,r.y,0)}onUseCreateMxDbEntity(r){store.events.on("use:create:MxDbEntity",r)}}const _MxFun=new MxFunClass,MxFun=new Proxy({},{get:(b,r)=>typeof _MxFun[r]=="function"?_MxFun[r].bind(_MxFun):store.state.MxFun[r]});var MxCloneType,MxCommandFlag,MxDefaultRenderOrder,InputToucheType;(function(b){b[b.kClone=1]="kClone",b[b.kDragClone=2]="kDragClone",b[b.kMxFileClone=3]="kMxFileClone",b[b.kSaveDwgClone=4]="kSaveDwgClone"})(MxCloneType||(MxCloneType={})),function(b){b[b.MCRX_CMD_MODAL=0]="MCRX_CMD_MODAL",b[b.MCRX_CMD_TRANSPARENT=1]="MCRX_CMD_TRANSPARENT",b[b.MCRX_CMD_NO_UNDO_MARKER=2]="MCRX_CMD_NO_UNDO_MARKER",b[b.MCRX_CMD_NOPRV=4]="MCRX_CMD_NOPRV"}(MxCommandFlag||(MxCommandFlag={})),function(b){b[b.kCADMeshRenderOrder=10]="kCADMeshRenderOrder",b[b.kCADCurveRenderOrder=20]="kCADCurveRenderOrder",b[b.kMxEntityRenderOrder=30]="kMxEntityRenderOrder",b[b.kGripRenderOrder=110]="kGripRenderOrder",b[b.kDynJigRenderOrder=120]="kDynJigRenderOrder"}(MxDefaultRenderOrder||(MxDefaultRenderOrder={})),function(b){b[b.kGetBegan=1]="kGetBegan",b[b.kGetEnd=2]="kGetEnd"}(InputToucheType||(InputToucheType={}));var MxType=Object.freeze({__proto__:null,get MxCloneType(){return MxCloneType},get MxCommandFlag(){return MxCommandFlag},get MxDefaultRenderOrder(){return MxDefaultRenderOrder},get InputToucheType(){return InputToucheType}});class MxassemblyClass{constructor(){this.mxassembly=null}initImp(){this.mxassembly||store.state.Mxassembly&&(this.mxassembly=store.state.Mxassembly)}NewMcGePoint3d(r,o,a){this.initImp();let v=new this.mxassembly.McGePoint3d;return r&&(v.x=r),o&&(v.y=o),a&&(v.z=a),v}NewMcGePoint3dArray(r){this.initImp();let o=new this.mxassembly.McGePoint3dArray;return r&&r.forEach(a=>{let v=this.NewMcGePoint3d();v.x=a.x,v.y=a.y,v.z=a.z,o.append(v)}),o}}const Mxassembly=new MxassemblyClass;class McGeToolClass{constructor(){this.mxgeTool=null}initImp(){this.mxgeTool||store.state.Mxassembly&&(this.mxgeTool=new store.state.Mxassembly.McGeTool)}calcArea(r){if(this.initImp(),!store.state.Mxassembly)return 0;if(r instanceof Array){let o=Mxassembly.NewMcGePoint3dArray(r);return this.mxgeTool.calcArea(o)}return this.mxgeTool.calcArea(r)}pointInPolyline(r,o){this.initImp();let a=o;o instanceof Array&&(a=Mxassembly.NewMcGePoint3dArray(o));let v=Mxassembly.NewMcGePoint3d(r.x,r.y,r.z);return this.mxgeTool.pointInPolyline(v,a)}}const McGeTool=new McGeToolClass;class MrxDbgUtilsClass{constructor(){this.imp=null}initImp(){if(!this.imp&&store.state.MxFun){let r=store.state.MxFun;this.imp=new r.getMrxDbgUtilsClass}}findEntAtPoint(r,o=null,a,v=!0,h){return this.initImp(),a||(a=MxFun.getCurrentDraw()),this.imp.findEntAtPoint(a.getMxObjectImplement(),r,o,v,h)}selectEnt(r,o){return this.initImp(),this.imp.selectEnt(r)}getCorner(r,o,a=!1,v,h=!1){return this.initImp(),this.imp.getCorner(r,o,a,v,h)}}const MrxDbgUtils=new MrxDbgUtilsClass,MxPaintBrushProps={},MxPaintBrush={getProps:()=>MxPaintBrushProps,setProps:b=>Object.assign(MxPaintBrushProps,b),use:b=>Object.assign(b,MxPaintBrushProps)};var DataType;(function(b){b[b.Default=0]="Default",b[b.Color=1]="Color",b[b.Vector2=2]="Vector2",b[b.Vector3=3]="Vector3",b[b.Vector4=4]="Vector4",b[b.Matrix3=5]="Matrix3",b[b.Matrix4=6]="Matrix4"})(DataType||(DataType={}));const MXDBDATATYPE="datatype";function getDwgKeyVal(b,r){let o,a="";return lodash.isObject(r)?(o=r.default,a=r.key):typeof r=="string"&&(a=r),[a,b[a]===void 0?o:b[a]]}class MxDbEntity extends RenderOrderNode{constructor(){super(),this.color=16777215,this.opacity=1,this.visible=!0,this.userData={},this.sGuid="",this.dLineWidth=0,this.lineWidthByPixels=!0,this.dDashArray=0,this.dDashRatio=0,this.layer="",this.use_smallcoord_display=!1,this.addEvent=this.on,this.removeEvent=this.off,this.callEvent=this.emit;const r=this.constructor;r.isPaintBrushDraw&&(MxPaintBrush.use(this),store.events.emit("use:create:MxDbEntity",this),r.isPaintBrushDraw=!1)}static register(){const r=this;r.isRegister||(r.cmd&&r.draw&&MxFun.addCommand(r.cmd,o=>r.use.call(r,void 0,o)),new r().rxInit(),r.isRegister=!0)}static async use(r,o){return new Promise((a,v)=>{const h=this;if(!h.isRegister&&h.register(),h.isPaintBrushDraw=!0,!h.cmd&&h.draw)return v();const w=L=>{a(L),r&&r(L),store.events.off("use:create:MxDbEntity",w)};store.events.on("use:create:MxDbEntity",w),h.draw(o)})}initGuid(r){this.sGuid.length>0?console.log("mx: init guid error"):this.sGuid=r}toSmallcoord2(r,o,a,v=0){return this.use_smallcoord_display?r.toSmallcoord2(o,a,v):new THREE.Vector3(o,a,v)}toSmallcoord(r,o){return this.use_smallcoord_display?r.toSmallcoord(o):o}isUseSmallcoordDisplay(){return this.use_smallcoord_display}setUseSmallcoordDisplay(r){this.use_smallcoord_display=r}dwgInHelp(r,o,a){let v=this;const h=r.type===MxType.MxCloneType.kMxFileClone||r.type===MxType.MxCloneType.kSaveDwgClone,w=G=>{if(!G)return;const{value:k,[MXDBDATATYPE]:D}=G;switch(D){case DataType.Color:return new THREE.Color(...k);case DataType.Vector2:return new THREE.Vector2(...k);case DataType.Vector3:return new THREE.Vector3(...k);case DataType.Vector4:return new THREE.Vector4(...k);case DataType.Matrix3:return new THREE.Matrix3().fromArray(k);case DataType.Matrix4:return new THREE.Matrix4().fromArray(k)}return a&&a.getCacheVal?a.getCacheVal(G):void 0};function L(G){return G instanceof THREE.Color||G instanceof THREE.Vector2||G instanceof THREE.Vector3||G instanceof THREE.Vector4||G instanceof THREE.Matrix3||G instanceof THREE.Matrix4?G.clone():a&&a.getVal?a.getVal(G):void 0}return o.forEach(G=>{const[k,D]=getDwgKeyVal(r,G);v[k]=lodash.cloneDeepWith(D,h?w:L)}),!0}dwgOutHelp(r,o){const a=w=>w instanceof THREE.Color?{[MXDBDATATYPE]:DataType.Color,value:w.toArray()}:w instanceof THREE.Vector2?{[MXDBDATATYPE]:DataType.Vector2,value:w.toArray()}:w instanceof THREE.Vector3?{[MXDBDATATYPE]:DataType.Vector3,value:w.toArray()}:w instanceof THREE.Vector4?{[MXDBDATATYPE]:DataType.Vector4,value:w.toArray()}:w instanceof THREE.Matrix3?{[MXDBDATATYPE]:DataType.Matrix3,value:w.toArray()}:w instanceof THREE.Matrix4?{[MXDBDATATYPE]:DataType.Matrix4,value:w.toArray()}:void 0;let v=this;const h=r.type===MxType.MxCloneType.kMxFileClone||r.type===MxType.MxCloneType.kSaveDwgClone;return o.forEach(w=>{const[L,G]=getDwgKeyVal(v,w);r[L]=h?lodash.cloneDeepWith(G,a):G}),r}create(r){return new this.constructor(r)}transformBy(r){}getGeomExtents(){return null}getClosestPointTo(r,o=0){return null}getImp(){return this.MxDbEntityImp}setNeedUpdateDisplay(r){let o=this.getImp();return!!o&&(r?o.upDisplay():o.setDirtyDisplay(!0),!0)}getMxObject(){let r=this.getImp();return r?r.getMxObject():null}onViewChange(){return!1}objectId(){let r=this.getImp();return r?r.objectId():0}erase(){let r=this.getImp();return!!r&&r.erase()}setLayer(r){let o=this.getImp();o&&o.nodifySetLayer(),this.layer=r}getLayer(){return this.layer}setColor(r){return this.color=r,this}getColor(){return this.color||16777215}clone(r){let o=this.create(),a={type:r||MxType.MxCloneType.kClone};return this.dwgOut(a),o.dwgIn(a),o.sGuid="",o}onDwgIn(r){this.color=r.color,this.renderOrder=r.renderOrder,this.opacity=r.opacity,this.visible=r.visible,r.userData?this.userData=JSON.parse(JSON.stringify(r.userData)):this.userData={},this.dLineWidth=r.lineWidth,this.lineWidthByPixels=r.lineWidthByPixels,this.dDashArray=r.dashArray,this.dDashRatio=r.dashRatio,this.layer=r.layer,r.guid&&(this.sGuid=r.guid)}onDwgOut(r){r.color=this.color,r.renderOrder=this.renderOrder,r.opacity=this.opacity,r.visible=this.visible,r.lineWidth=this.dLineWidth,r.lineWidthByPixels=this.lineWidthByPixels,r.dashArray=this.dDashArray,r.dashRatio=this.dDashRatio,r.layer=this.layer,r.guid=this.sGuid,Object.keys(this.userData).length>0&&(r.userData=this.userData)}rxInit(){MxFun.initMxDbEntityType(this)}setRenderOrder(r){this.renderOrder=r}getRenderOrder(){return this.renderOrder}setLineWidthByPixels(r){return this.lineWidthByPixels=r,this}getLineWidthByPixels(){return this.lineWidthByPixels}setLineWidth(r){return this.dLineWidth=r,this}getLineWidth(){return this.dLineWidth}getGetLength(){return 0}setDashLen(r){let o=this.getGetLength();if(o<1e-6||r<1e-6)return this;let a=Math.floor(o/r);return a<1e-6&&(this.dDashRatio=0),this.dDashArray=1/a,this}setDashRatio(r){return this.dDashRatio=r,this}setDashArray(r){return this.dDashArray=r,this}setDash(r,o){return this.dDashArray=r,this.dDashRatio=o,this.dLineWidth==0&&(this.dLineWidth=6,this.lineWidthByPixels=!0),this}getDash(){return{dDashArray:this.dDashArray,dDashRatio:this.dDashRatio}}setDashLineDisplay(r){return r?(this.dDashArray<1e-5&&(this.dDashArray=.03),this.dDashRatio<1e-5&&(this.dDashRatio=.1),this.dLineWidth==0&&(this.dLineWidth=6,this.lineWidthByPixels=!0)):(this.dDashArray=0,this.dDashRatio=0),this}isDashLineDisplay(){return this.dDashArray>0&&this.dDashRatio>0}guid(){return this.sGuid}setGuid(r){return this.sGuid=r}onEndGripEidt(){this.callEvent("onEndGripEidt")}onStartGripEidt(){return this.callEvent("onStartGripEidt")}toJsonString(r=MxType.MxCloneType.kMxFileClone){let o={type:r};return this.dwgOut(o),o.TypeName=this.getTypeName(),JSON.stringify(o)}fromJsonString(r){let o=JSON.parse(r);return(o.type==MxType.MxCloneType.kMxFileClone||o.type==MxType.MxCloneType.kClone)&&this.dwgIn(o)}}function drawMxDbImage(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定插入点:`);let r=MxFun.getCurrentDraw();b.go(o=>{if(o!=0)return;let a=MxFun.screenCoordLong2Doc(300),v=MxFun.screenCoordLong2Doc(200);const h=b.value();let w=MxFun.screenCoord2Doc(10,10);h.z=w.z;let L=new MxDbImage;L.setRenderOrder(MxType.MxDefaultRenderOrder.kCADMeshRenderOrder-1),L.setPoint1(h);let G=new THREE.Vector3(h.x+a,h.y+v,h.z);L.setPoint2(G);let k=prompt("请填写图片网络地址","https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg");k&&(L.setImagePath(k),r.addMxEntity(L),L.addEvent("onStartGripEidt",()=>(L.visible=!1,L.setNeedUpdateDisplay(),{renderOrder:MxType.MxDefaultRenderOrder.kCADMeshRenderOrder-1})),L.addEvent("onEndGripEidt",()=>{L.visible=!0,L.setNeedUpdateDisplay()}))})}MxDbEntity.isRegister=!1;class MxDbImage extends MxDbEntity{constructor(){super(...arguments),this.pt1=new THREE.Vector3,this.pt2=new THREE.Vector3,this.imagePath="",this.isLoadMaterialFromPath=!0,this.material=null,this.angle=0}getTypeName(){return"MxDbImage"}getAngle(){return this.angle}setAngle(r){this.angle=r}worldDraw(r){let o=new THREE.Vector3(this.pt1.x,this.pt2.y),a=new THREE.Vector3(this.pt2.x,this.pt1.y);if(Math.abs(this.angle)>1e-5){let v=new THREE.Vector3(.5*(this.pt1.x-this.pt2.x)+this.pt2.x,.5*(this.pt1.y-this.pt2.y)+this.pt2.y),h=new THREE.Matrix4;h.makeRotationZ(this.angle);let w=new THREE.Matrix4().makeTranslation(v.x,v.y,v.z).multiply(h).multiply(new THREE.Matrix4().makeTranslation(-v.x,-v.y,-v.z));r.setMatrix(w)}if(r.getType()==1){if(r.drawSelectLine(this.pt1,o),r.drawSelectLine(o,this.pt2),r.drawSelectLine(this.pt2,a),r.drawSelectLine(a,this.pt1),this.material){let v=Math.abs(this.pt1.x-this.pt2.x),h=Math.abs(this.pt1.y-this.pt2.y),w=new THREE.PlaneGeometry(v,h),L=Math.min(this.pt1.x,this.pt2.x),G=Math.min(this.pt1.y,this.pt2.y);for(let D=0;D<w.vertices.length;D++)w.vertices[D].x+=L+.5*v,w.vertices[D].y+=G+.5*h,w.vertices[D].z=0;let k=new THREE.Mesh(w,this.material);k.material.depthTest=!1,r.drawEntity(k)}else if(this.imagePath.length>0&&this.isLoadMaterialFromPath){let v=this,h=r.getMxObject();const w=L=>{this.isLoadMaterialFromPath=!1,L&&(v.setMaterial(L),v.setNeedUpdateDisplay(),h.updateDisplay())};MxFun.loadImageMaterial(this.imagePath,L=>{w(L)})}}else if(this.material){let v=Math.abs(this.pt1.x-this.pt2.x),h=Math.abs(this.pt1.y-this.pt2.y),w=new THREE.PlaneGeometry(v,h),L=Math.min(this.pt1.x,this.pt2.x),G=Math.min(this.pt1.y,this.pt2.y);for(let D=0;D<w.vertices.length;D++)w.vertices[D].x+=L+.5*v,w.vertices[D].y+=G+.5*h,w.vertices[D].z=0;let k=new THREE.Mesh(w,this.material);k.material.depthTest=!1,r.drawEntity(k)}else r.drawLine(this.pt1,o),r.drawLine(o,this.pt2),r.drawLine(this.pt2,a),r.drawLine(a,this.pt1);r.setMatrix(null)}setImagePath(r){this.imagePath=r,this.isLoadMaterialFromPath=!0,this.material=null}getImagePath(){return this.imagePath}setMaterial(r){this.material=r}loadMaterial(r){r&&(this.imagePath=r),this.isLoadMaterialFromPath=!1,this.material=null;let o=this;MxFun.loadImageMaterial(this.imagePath,a=>{this.isLoadMaterialFromPath=!1,o.setMaterial(a)})}setPoint1(r){this.pt1=r}getPoint1(){return this.pt1}setPoint2(r){this.pt2=r}getPoint2(){return this.pt2}getGripPoints(){let r=[];r.push(this.pt1),r.push(this.pt2);let o=new THREE.Vector3(this.pt1.x+.5*(this.pt2.x-this.pt1.x),this.pt1.y+.5*(this.pt2.y-this.pt1.y));return r.push(o),r}moveGripPointsAt(r,o){return r==0?this.pt1.add(o):r==1?this.pt2.add(o):r==2&&(this.pt1.add(o),this.pt2.add(o)),!0}dwgIn(r){return this.onDwgIn(r),this.pt1.copy(r.pt1),this.pt2.copy(r.pt2),this.imagePath=r.imagePath.substr(0),this.isLoadMaterialFromPath=!0,r.angle&&(this.angle=r.angle),r.material&&(this.material=r.material),!0}dwgOut(r){return this.onDwgOut(r),r.pt1=this.pt1,r.pt2=this.pt2,r.imagePath=this.imagePath,r.angle=this.angle,r.type==MxType.MxCloneType.kDragClone&&(r.material=this.material),r}create(){return new MxDbImage}}var McGiWorldDrawType;MxDbImage.cmd="Mx_DrawImage",MxDbImage.draw=drawMxDbImage,addRegisterMxDbEntity(MxDbImage),function(b){b[b.kWorldDraw=1]="kWorldDraw",b[b.kDynDragDraw=2]="kDynDragDraw",b[b.kSelectDraw=3]="kSelectDraw"}(McGiWorldDrawType||(McGiWorldDrawType={}));var McGiWorldDrawType$1=McGiWorldDrawType;class MxDbSVGText{constructor(){this.txtPos=new THREE.Vector3,this.txt="",this.txtHeight=1,this.color=void 0,this._txtObject=null,this._txtAspectRatio=-1,this.move=!1,this.drawConnectingLine=!1,this._connectingLine=null,this.fontStyle="",this.underline=!1,this._underLine=null}}async function drawMxDbSVG(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定一点:`);let r=await b.go();if(!r)return;let o=new MxDbSVG,a=prompt("请输入svg图片网络或本地地址","https://img.alicdn.com/imgextra/i2/O1CN01FF1t1g1Q3PDWpSm4b_!!6000000001920-55-tps-508-135.svg");if(!a)return;o.setSvgPath(a),o.setSvgPostion(r),o.svgReverse=!0,o.svgMargin.x=.2,o.setSvgAlignmentRatio(new THREE.Vector2(.5,-1)),o.setRenderOrder(100),o.setSvgSize(new THREE.Vector2(50,0));let v=new MxDbSVGText;v.txt="A1",v.txtPos=new THREE.Vector3(0,-30,0),v.txtHeight=30,o.addText(v),o.fixedSize=!0,o.color=65297,MxFun.addToCurrentSpace(o)}class MxDbSVG extends MxDbEntity{constructor(){super(...arguments),this.svgPos=new THREE.Vector3,this.svg=null,this.svgPath="",this.svgSize=new THREE.Vector2(50,50),this.svgAlignmentRatio=new THREE.Vector2(0,0),this.imagePath="",this.isLoadMaterialFromPath=!0,this.material=null,this.svgRotate=0,this.svgReverse=!1,this.svgMirror=!1,this.svgChildColor=[],this.svgMargin=new THREE.Vector2(0,0),this.isSvgDirtyLocation=!1,this.isLoadFromPath=!0,this.aryText=[],this.svgBoxSize=null,this.fixedSize=!1,this.useSvgColor=!1}setSvgChildColor(r){if(this.svgChildColor=r,!this.useSvgColor&&this.svg){let o=new THREE.Color(this.getColor()),a=0,v=this;this.svg.traverse(function(h){h.material&&(a<v.svgChildColor.length?h.material.color=new THREE.Color(v.svgChildColor[a]):h.material.color=o,a++)}),this.setNeedUpdateDisplay(!0)}}getSvgChildColor(){return this.svgChildColor}calcVewSize(r){let o=this.svgSize.x,a=this.svgSize.y;return a<=0&&(a=this.svgBoxSize?this.svgBoxSize.y/this.svgBoxSize.x*o:o),this.fixedSize&&(o=r.screenCoordLong2Doc(o),a=r.screenCoordLong2Doc(a)),[o,a]}calcSvgDrawRect(r){if(!r)return;this.calcSvgPosition(r);let[o,a]=this.calcVewSize(r),v=new THREE.Matrix4;v.makeScale(this.svgMirror?-1:1,this.svgReverse?-1:1,1);let h=new THREE.Matrix4;h.makeRotationZ(this.svgRotate);let w=new THREE.Matrix4,L=new THREE.Vector3(this.svgPos.x-o*this.svgAlignmentRatio.x,this.svgPos.y-a*this.svgAlignmentRatio.y,0);w.makeTranslation(L.x,L.y,L.z),h.multiply(v),h.premultiply(w);let G=new THREE.Vector3(0,0,0),k=new THREE.Vector3(o,0,0),D=new THREE.Vector3(o,a,0),f=new THREE.Vector3(0,a,0);return G.applyMatrix4(h),k.applyMatrix4(h),D.applyMatrix4(h),f.applyMatrix4(h),{pt1:G,pt2:D,pt3:k,pt4:f,cenpt:D.clone().add(G.clone().sub(D).multiplyScalar(.5)),sizew:o,sizeh:a}}calcImageDrawRect(r){if(!r)return;this.calcSvgPosition(r);let[o,a]=this.calcVewSize(r),v=new THREE.Matrix4;v.makeScale(this.svgMirror?-1:1,this.svgReverse?-1:1,1);let h=new THREE.Matrix4,w=new THREE.Matrix4,L=new THREE.Vector3(this.svgPos.x-o*this.svgAlignmentRatio.x,this.svgPos.y-a*this.svgAlignmentRatio.y,0);w.makeTranslation(L.x,L.y,L.z),h.multiply(v),h.premultiply(w);let G=new THREE.Vector3(0,0,0),k=new THREE.Vector3(o,0,0),D=new THREE.Vector3(o,a,0),f=new THREE.Vector3(0,a,0);return G.applyMatrix4(h),k.applyMatrix4(h),D.applyMatrix4(h),f.applyMatrix4(h),{pt1:G,pt2:D,pt3:k,pt4:f,cenpt:D.clone().add(G.clone().sub(D).multiplyScalar(.5)),sizew:o,sizeh:a}}worldDraw(r){let o,a=r.getMxObject();if(this.imagePath.length>0){if(o=this.calcImageDrawRect(a),Math.abs(this.svgRotate)>1e-5){let f=new THREE.Vector3(.5*(o.pt1.x-o.pt2.x)+o.pt2.x,.5*(o.pt1.y-o.pt2.y)+o.pt2.y),O=new THREE.Matrix4;O.makeRotationZ(this.svgRotate);let C=new THREE.Matrix4().makeTranslation(f.x,f.y,f.z).multiply(O).multiply(new THREE.Matrix4().makeTranslation(-f.x,-f.y,-f.z));r.setMatrix(C)}}else o=this.calcSvgDrawRect(a);let v=o.pt1,h=o.pt2,w=o.pt3,L=o.pt4,G=o.cenpt,k=o.sizew,D=this;if(r.getType()!=McGiWorldDrawType$1.kSelectDraw&&this.aryText.forEach((f,O)=>{if(f.txt.length>0){let V,R=new THREE.Vector3(f.txtPos.x,f.txtPos.y,0);this.fixedSize&&(f.txtPos.x>0?R.x=this.svgPos.x+a.screenCoordLong2Doc(f.txtPos.x):R.x=this.svgPos.x-a.screenCoordLong2Doc(f.txtPos.x),f.txtPos.y>0?R.y=this.svgPos.y+a.screenCoordLong2Doc(f.txtPos.y):R.y=this.svgPos.y-a.screenCoordLong2Doc(f.txtPos.y)),f.color&&(V=r.getColor(),r.setColor(f.color));let M=f.txtHeight;D.fixedSize&&(M=a.screenCoordLong2Doc(f.txtHeight)),r.setXData({type:"text",txt:f.txt,index:O});let ee=r.drawText(f.txt,M,0,R,void 0,F=>f.fontStyle.length>0?`${f.fontStyle} ${F}px Arial`:`normal ${F}px Arial`);if(r.getType()==McGiWorldDrawType$1.kWorldDraw&&(f._txtObject=ee),f.underline&&f._txtObject){const F=new THREE.Box3;F.expandByObject(f._txtObject);let _=new THREE.Vector3(F.min.x,F.min.y+.1*M,0),J=new THREE.Vector3(F.max.x,F.min.y+.1*M,0);var C=new THREE.Geometry;let T=new THREE.LineBasicMaterial({color:r.getColor(),transparent:!0,depthTest:!1});C.vertices.push(_,J);var j=new THREE.Line(C,T);r.drawEntity(j),r.getType()==McGiWorldDrawType$1.kWorldDraw&&(f._underLine=j)}if(f._txtAspectRatio=-1,V&&r.setColor(V),f.drawConnectingLine){let F=G.clone().sub(R);if(F.length()>M+k){F.normalize();let _=G.clone().sub(F.clone().multiplyScalar(k)),J=R.clone().add(F.clone().multiplyScalar(M));C=new THREE.Geometry;let T=new THREE.LineBasicMaterial({color:r.getColor(),transparent:!0,depthTest:!1});C.vertices.push(_,J),j=new THREE.Line(C,T),r.setXData({type:"line"}),r.drawEntity(j),r.getType()==McGiWorldDrawType$1.kWorldDraw&&(f._connectingLine=j)}}}}),r.getType()==1){if(this.svg)r.setXData({type:"svg"}),r.drawEntity(this.svg);else if(this.svgPath.length>0&&this.isLoadFromPath){let f=this,O=r.getMxObject();MxThreeJS.loadSVG(this.svgPath,void 0,C=>{if(C){let j=C;if(j.boxSize)f.svgBoxSize=j.boxSize.clone();else{let F=new THREE.Box3().setFromObject(C);f.svgBoxSize||(f.svgBoxSize=new THREE.Vector3),f.svgBoxSize.x=F.max.x-F.min.x,f.svgBoxSize.y=F.max.y-F.min.y}let[V,R]=f.calcVewSize(a);f.svgBoxSize&&(C.scale.x=V/f.svgBoxSize.x,C.scale.y=R/f.svgBoxSize.y),C.scale.z=C.scale.x,f.svgReverse&&(C.scale.y*=-1),f.svgMirror&&(C.scale.x*=-1),C.rotateZ(f.svgRotate),f.isSvgDirtyLocation=!0;let M=new THREE.Color(r.getColor()),ee=0;C.traverse(function(F){F.material&&(F.material=F.material.clone(),F.material.transparent=!0,F.material.depthTest=!1,f.useSvgColor||(ee<f.svgChildColor.length?F.material.color=new THREE.Color(f.svgChildColor[ee]):F.material.color=M),ee++)}),f.svg=C,f.setNeedUpdateDisplay(),O.updateDisplay()}else console.log("mx LoadSVG:"+f.svgPath+" failed");f.isLoadFromPath=!1})}else if(this.material){let f=Math.abs(v.x-h.x),O=Math.abs(v.y-h.y),C=new THREE.PlaneGeometry(f,O),j=Math.min(v.x,h.x),V=Math.min(v.y,h.y);for(let M=0;M<C.vertices.length;M++)C.vertices[M].x+=j+.5*f,C.vertices[M].y+=V+.5*O,C.vertices[M].z=0;let R=new THREE.Mesh(C,this.material);R.material.depthTest=!1,r.drawEntity(R)}else if(this.isLoadMaterialFromPath&&this.imagePath.length>0){let f=this,O=r.getMxObject();MxFun.loadImageMaterial(this.imagePath,C=>{this.isLoadMaterialFromPath=!1,C&&(f.material=C,f.setNeedUpdateDisplay(),O.updateDisplay())})}this.fixedSize||(r.drawSelectLine(v,h),r.drawSelectLine(w,L),r.drawSelectLine(v,w),r.drawSelectLine(w,h),r.drawSelectLine(h,L),r.drawSelectLine(L,v))}else r.drawLine(v,w),r.drawLine(w,h),r.drawLine(h,L),r.drawLine(L,v);this.imagePath.length>0&&r.setMatrix(null)}async setSvgPath(r,o=!1){this.svgPath=r,this.svg=null,this.isLoadFromPath=!0,this.svgBoxSize=null,o&&await MxThreeJS.loadSVG(r)}getSvgPath(){return this.svgPath}setSvgPostion(r){this.svgPos=r.clone(),this.isSvgDirtyLocation=!0}setImagePath(r,o){this.imagePath=r,o?(this.material=o,this.isLoadMaterialFromPath=!1):(this.material=null,this.isLoadMaterialFromPath=!0)}getImagePath(){return this.imagePath}getSvgPostion(){return this.svgPos}setSvgSize(r){this.svgSize=r,this.isSvgDirtyLocation=!0}getSvgSize(){return this.svgSize}setSvgAlignmentRatio(r){this.svgAlignmentRatio=r,this.isSvgDirtyLocation=!0}getSvgAlignmentRatio(){return this.svgAlignmentRatio}getText(r){return r<this.aryText.length?this.aryText[r]:null}addText(r){this.aryText.push(r)}getGripPoints(){let r=[];r.push(this.svgPos);let o=0;for(;o<this.aryText.length;o++){let a=this.aryText[o];if(a.move){let v=new THREE.Vector3(a.txtPos.x,a.txtPos.y,0);if(this.fixedSize){let h=MxFun.getCurrentDraw();a.txtPos.x>0?v.x=this.svgPos.x+h.screenCoordLong2Doc(a.txtPos.x):v.x=this.svgPos.x-h.screenCoordLong2Doc(a.txtPos.x),a.txtPos.y>0?v.y=this.svgPos.y+h.screenCoordLong2Doc(a.txtPos.y):v.y=this.svgPos.y-h.screenCoordLong2Doc(a.txtPos.y)}r.push(v)}}return r}moveGripPointsAt(r,o){if(r==0)this.svgPos.add(o),this.fixedSize||this.aryText.forEach(a=>{a.txtPos.add(o)});else if(r-1>=0&&r-1<this.aryText.length){let a=this.aryText[r-1];if(a.move)if(this.fixedSize){let v=MxFun.getCurrentDraw();a.txtPos.x+=v.docCoordLong2Screen(o.x),a.txtPos.y+=v.docCoordLong2Screen(o.y)}else a.txtPos.add(o)}return this.isSvgDirtyLocation=!0,!0}calcSvgPosition(r){if(!this.svg||!this.isSvgDirtyLocation)return;this.isSvgDirtyLocation=!1;let[o,a]=this.calcVewSize(r);this.svg.position.x=this.svgPos.x-o*this.svgAlignmentRatio.x-this.svgMargin.x*o,this.svg.position.y=this.svgPos.y-a*this.svgAlignmentRatio.y-this.svgMargin.y*a}dwgIn(r){this.onDwgIn(r),this.fixedSize=r.fixedSize,this.fixedSize?this.svg=null:r.type==MxType.MxCloneType.kClone&&r.svg&&(this.svg=r.svg.clone()),this.svgPos.copy(r.svgPos),this.svgPath=r.svgPath.substr(0),this.svgSize.copy(r.svgSize),this.svgAlignmentRatio.copy(r.svgAlignmentRatio),this.isSvgDirtyLocation=!0,this.svg||(this.isLoadFromPath=!0),this.svgBoxSize=null;let o=r.txts;return this.aryText=[],o.forEach(a=>{let v=new MxDbSVGText;v.txt=a.txt,v.txtHeight=a.txtHeight,v.txtPos.copy(a.txtPos),v.move=a.move,v.drawConnectingLine=a.drawConnectingLine,this.aryText.push(v)}),this.svgRotate=r.svgRotate,this.useSvgColor=r.useSvgColor,this.svgReverse=r.svgReverse,this.svgMirror=r.svgMirror,this.svgMargin=r.svgMargin,r.svgChildColor?this.svgChildColor=r.svgChildColor:this.svgChildColor=[],this.imagePath=r.imagePath.substr(0),this.isLoadMaterialFromPath=!0,r.material&&(this.material=r.material),!0}dwgOut(r){this.onDwgOut(r);let o,a=this.getMxObject();return r.type==MxType.MxCloneType.kClone&&(r.svg=this.svg),r.svgPath=this.svgPath,r.svgPos=this.svgPos,r.svgSize=this.svgSize,r.svgAlignmentRatio=this.svgAlignmentRatio,r.txts=[],r.type==MxType.MxCloneType.kSaveDwgClone&&a&&(o=this.calcSvgDrawRect(a)),this.aryText.forEach(v=>{let h={txtPos:v.txtPos,txt:v.txt,txtHeight:v.txtHeight,color:v.color,_txtAspectRatio:v._txtAspectRatio,move:v.move,drawConnectingLine:v.drawConnectingLine};r.type==MxType.MxCloneType.kSaveDwgClone&&(v._connectingLine&&(h.connectingLine=v._connectingLine.geometry.vertice),v._underLine&&(h._underLine=v._underLine.geometry.vertice)),r.txts.push(h)}),r.fixedSize=this.fixedSize,r.svgRotate=this.svgRotate,r.useSvgColor=this.useSvgColor,r.svgReverse=this.svgReverse,r.svgMirror=this.svgMirror,r.svgMargin=this.svgMargin,r.svgChildColor=this.svgChildColor,r.type==MxType.MxCloneType.kSaveDwgClone&&(r.svgRect=o),r.imagePath=this.imagePath,r.type==MxType.MxCloneType.kDragClone&&(r.material=this.material),r}create(){return new MxDbSVG}transformBy(r){this.svgPos.applyMatrix4(r),this.isSvgDirtyLocation=!0,this.fixedSize||this.aryText.forEach(o=>{o.txtPos.applyMatrix4(r)})}getTypeName(){return"MxDbSVG"}setColor(r){if(super.setColor(r),this.svg){let o=new THREE.Color(this.color);this.svg.traverse(function(a){a.material&&(a.material.color=o)})}return this}setSvg(r){this.svg=r,this.isLoadFromPath=!1,this.svgBoxSize=null}calcSvgBoxSize(r){if(!this.svgBoxSize)if(r.boxSize)this.svgBoxSize=r.boxSize.clone();else{let o=new THREE.Box3().setFromObject(r);this.svgBoxSize||(this.svgBoxSize=new THREE.Vector3),this.svgBoxSize.x=o.max.x-o.min.x,this.svgBoxSize.y=o.max.y-o.min.y}}reComputeSVG(){if(!this.svg)return;let r=this.getMxObject();if(!r)return;this.calcSvgBoxSize(this.svg);let[o,a]=this.calcVewSize(r);this.svgBoxSize&&(this.svg.scale.x=o/this.svgBoxSize.x,this.svg.scale.y=a/this.svgBoxSize.y),this.svg.scale.z=this.svg.scale.x,this.svgReverse&&(this.svg.scale.y*=-1),this.svgMirror&&(this.svg.scale.x*=-1),this.isSvgDirtyLocation=!0,this.calcSvgPosition(r)}onViewChange(){if(!this.fixedSize)return!1;if(this.imagePath.length>0)return this.setNeedUpdateDisplay(!1),!0;let r=this.getMxObject();if(r==null)return!1;if(this.svg){this.calcSvgBoxSize(this.svg);let[w,L]=this.calcVewSize(r);this.svgBoxSize&&(this.svg.scale.x=w/this.svgBoxSize.x,this.svg.scale.y=L/this.svgBoxSize.y),this.svg.scale.z=this.svg.scale.x,this.svgReverse&&(this.svg.scale.y*=-1),this.svgMirror&&(this.svg.scale.x*=-1),this.isSvgDirtyLocation=!0,this.calcSvgPosition(r)}let o=this.calcSvgDrawRect(r),a=o.cenpt,v=o.sizew,h=this;return this.aryText.forEach(w=>{if(w._txtObject&&r){let G=r.screenCoordLong2Doc(w.txtHeight);if(G>1e-5){w._txtAspectRatio<=0&&(w._txtAspectRatio=w._txtObject.scale.x/w._txtObject.scale.y),w._txtObject.scale.set(w._txtAspectRatio*G*1.5,1.5*G,1),w.txtPos.x>0?w._txtObject.position.x=h.svgPos.x+r.screenCoordLong2Doc(w.txtPos.x):w._txtObject.position.x=h.svgPos.x-r.screenCoordLong2Doc(w.txtPos.x),w.txtPos.y>0?w._txtObject.position.y=h.svgPos.y+r.screenCoordLong2Doc(w.txtPos.y):w._txtObject.position.y=h.svgPos.y-r.screenCoordLong2Doc(w.txtPos.y);let k=w._txtObject.position;if(w._txtObject.updateMatrix(),w._underLine){const D=new THREE.Box3;let f=w._txtObject.parent;w._txtObject.parent=null,D.expandByObject(w._txtObject),w._txtObject.parent=f;let O=new THREE.Vector3(D.min.x,D.min.y+.1*G,0),C=new THREE.Vector3(D.max.x,D.min.y+.1*G,0);(L=new THREE.Geometry).vertices.push(O,C),w._underLine.geometry=L}if(w._connectingLine){let D=a.clone().sub(k);D.normalize();let f=a.clone().sub(D.clone().multiplyScalar(v)),O=k.clone().add(D.clone().multiplyScalar(G));var L;(L=new THREE.Geometry).vertices.push(f,O),w._connectingLine.geometry=L}}}}),!0}}function drawMxDbPolyline(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定第一点:`);let r,o=new MxDbPolyline;b.go(a=>{if(a!=0)return;let v=b.value();r||(r=v.clone());let h=v;const w=new McEdGetPointWorldDrawObject;w.setDraw((G,k)=>{k.setColor(16711680),k.drawLine(h,G),k.drawCustomEntity(o)}),b.setUserDraw(w),b.setMessage(`
指定下一点:`);let L=0;o.addVertexAt(v),b.goWhile(G=>{if(G==0)h=b.value(),o.addVertexAt(h),++L>=2?(b.setMessage(`
指定下一点:`),b.setKeyWords("[闭合(C)/放弃(U)]")):L>0?(b.setMessage(`
指定下一点:`),b.setKeyWords("[放弃(U)]")):(b.setMessage(`
指定第一点:`),b.setKeyWords(""));else if(G==1){if(b.isKeyWordPicked("C"))return{exit:!0};b.isKeyWordPicked("U")&&console.log("Mx_Line undo....")}},()=>{MxFun.getCurrentDraw().addMxEntity(o)})})}MxDbSVG.cmd="Mx_ModelFixedSvg",MxDbSVG.draw=drawMxDbSVG,addRegisterMxDbEntity(MxDbSVG);class MxDbPolyline extends MxDbEntity{constructor(){super(...arguments),this.points=[]}getTypeName(){return"MxDbPolyline"}worldDraw(r){this.points.length<2||r.drawLines(this.points)}getGripPoints(){return this.points}moveGripPointsAt(r,o){return!(r>=this.points.length||(this.points[r].add(o),0))}create(){return new MxDbPolyline}dwgIn(r){this.onDwgIn(r);let o=r.points;return this.points=[],o.forEach(a=>{this.points.push(new THREE.Vector3(a.x,a.y,a.z))}),!0}dwgOut(r){return this.onDwgOut(r),r.points=this.points,r}addVertexAt(r){this.points.push(r)}numVerts(){return this.points.length}getPointAt(r){return r<this.points.length?this.points[r]:null}setPointAt(r,o){return r<this.points.length&&(this.points[r]=o,!0)}}function drawMxDb2LineAngularDimension(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new MxDb2LineAngularDimension,a=new McEdGetPointWorldDrawObject;return b.setMessage(`
指定第一点:`),b.go(v=>{v===0&&(b.setMessage(`
指定第二个角度点:`),o.point1=b.value(),a.setDraw((h,w)=>{o.point2=h,a.drawLine(o.point1,h)}),b.setUserDraw(a),b.go(h=>{b.setMessage(`
指定最后一个点:`),h===0&&(o.point2=b.value(),a.setDraw((w,L)=>{o.point3=w,a.drawCustomEntity(o)}),b.go(w=>{w===0&&r.addMxEntity(o)}))}))}),o}MxDbPolyline.cmd="Mx_Lines",MxDbPolyline.draw=drawMxDbPolyline,addRegisterMxDbEntity(MxDbPolyline);const propertyDbKeys$6=["colors","point1","point2","point3"];class MxDb2LineAngularDimension extends MxDbEntity{constructor(r){if(super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.point3=new THREE.Vector3,this.colors=[],r){const{points:o,colors:a}=r;o&&this.setPoints(o),a&&this.setColor(a)}}calculateLineAngle(r,o,a){const v=2*Math.PI/360;return{startAngle:180*Math.atan2(o.y-r.y,o.x-r.x)/Math.PI*v,endAngle:180*Math.atan2(a.y-r.y,a.x-r.x)/Math.PI*v}}setPoints(r){const[o,a,v]=r;return o&&(this.point1=o),a&&(this.point2=a),v&&(this.point3=v),this}setColor(r){return lodash.isArray(r)?this.colors=r:this.color=r,this}worldDraw(r){if(r.getType()==McGiWorldDrawType$1.kWorldDraw||r.getType()==McGiWorldDrawType$1.kDynDragDraw){const[o,a,v,h]=this.colors||[],w=this.getColor(),L=r.getMxObject();r.setOpacity(this.opacity),r.setColor(o||w),r.drawLine(this.point1,this.point2),r.setColor(a||w),r.drawLine(this.point2,this.point3);const{startAngle:G,endAngle:k}=this.calculateLineAngle(this.point2,this.point1,this.point3),D=this.point2.distanceTo(this.point1),f=this.point2.distanceTo(this.point3),O=Math.min(D,f)/4;let C=THREE.MathUtils.radToDeg(G-k);C<0&&(C+=360);let j=L.screenCoordLong2Doc(50);const V=new THREE.ArcCurve(this.point2.x,this.point2.y,O,G,k,!0),R=new THREE.Geometry().setFromPoints(V.getPoints(50));r.setColor(v||w),r.drawGeometryLines(R);const M=V.getPoint(.5);let ee=new THREE.Vector3(M.x,M.y,0);const F=ee.sub(this.point2),_=F.length()+.5*j;F.normalize().multiplyScalar(_),ee=this.point2.clone().add(F),r.setColor(h||w),r.drawText(C.toFixed(3)+"°",.5*j,0,ee)}else r.drawLine(this.point1,this.point2),r.drawLine(this.point3,this.point2)}getGripPoints(){return[this.point1,this.point2,this.point3]}moveGripPointsAt(r,o){return r===0?this.point1.add(o):r===1?this.point2.add(o):r===2&&this.point3.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys$6),!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys$6),r}create(){return new MxDb2LineAngularDimension}transformBy(r){this.point1.applyMatrix4(r),this.point2.applyMatrix4(r)}getTypeName(){return"MxDb2LineAngularDimension"}}MxDb2LineAngularDimension.cmd="Mx_AngleSurveying",MxDb2LineAngularDimension.draw=drawMxDb2LineAngularDimension,addRegisterMxDbEntity(MxDb2LineAngularDimension);class MxFilters{constructor(){this.uniformObj={},this.filtersStr="",this.filtersTypes="",this.VSHADER_SOURCE=`
  varying vec2 v_Uv;
  void main () {
      v_Uv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }
  `,this.FSHADER_SOURCE=`
  varying vec2 v_Uv;
  uniform sampler2D e_Texture;
  uniform mat4 colorMatrix;
  ${this.filtersStr}
  void main () {
    vec4 color = texture2D( e_Texture, v_Uv );
    color = color * colorMatrix;
    ${this.filtersTypes}
    gl_FragColor = color;
  }`,this._matrix=new THREE.Matrix4}channel({r=1,g:o=1,b:a=1}){return this._matrix=new THREE.Matrix4().set(r,0,0,0,0,o,0,0,0,0,a,0,0,0,0,1).multiply(this._matrix),this}brightness(r){return this._matrix=new THREE.Matrix4().set(r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,1).multiply(this._matrix),this}saturate(r){const o=.2126*(1-r),a=.7152*(1-r),v=.0722*(1-r);return this._matrix=new THREE.Matrix4().set(o+r,a,v,0,o,a+r,v,0,o,a,v+r,0,0,0,0,1).multiply(this._matrix),this}contrast(r){const o=.5*(1-r);return this._matrix=new THREE.Matrix4().set(r,0,0,0,0,r,0,0,0,0,r,0,o,o,o,1).multiply(this._matrix),this}opacity(r){return this._matrix=new THREE.Matrix4().set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,r).multiply(this._matrix),this}invert(r){const o=1-2*r;return this._matrix=new THREE.Matrix4().set(o,0,0,0,0,o,0,0,0,0,o,0,r,r,r,1).multiply(this._matrix),this}grayscale(r=1){const o=.2126*r,a=.7152*r,v=.0722*r;return this._matrix=new THREE.Matrix4().set(o+1-r,a,v,0,o,a+1-r,v,0,o,a,v+1-r,0,0,0,0,1).multiply(this._matrix),this}sepia(r=1){return this._matrix=new THREE.Matrix4().set(1-.607*r,.769*r,.189*r,0,.349*r,1-.314*r,.168*r,0,.272*r,.534*r,1-.869*r,0,0,0,0,1).multiply(this._matrix),this}hueRotate(r){const o=r/180*Math.PI,a=Math.cos(o),v=Math.sin(o),h=.2126,w=.7152,L=.0722;return this._matrix=new THREE.Matrix4().set(h+.7874*a+v*-h,w+a*-w+v*-w,L+a*-L+.9278*v,0,h+a*-h+.143*v,w+a*(1-w)+.14*v,L+a*-L+-.283*v,0,h+a*-h+-.7874*v,w+a*-w+v*w,L+.9278*a+v*L,0,0,0,0,1).multiply(this._matrix),this}convolution(r,o=1/9,a=521){return this.uniformObj=Object.assign(Object.assign({},this.uniformObj),{cKernel:{value:r.toArray()},stStep:{value:o},scaleFactor:{value:a}}),this.filtersTypes.indexOf("convolutionTextureColor")<0&&(this.filtersStr+=`
        uniform float cKernel[9];
        uniform float stStep;
        uniform float scaleFactor;
        vec4 convolutionTextureColor(vec4 color) {
            vec2 offsets[9];
            offsets[0] = vec2(-1.0,-1.0);
            offsets[1] =  vec2(0.0,-1.0);
            offsets[2] = vec2(1.0,-1.0);
            offsets[3] =  vec2(-1.0,0.0);
            offsets[4] = vec2(0.0,0.0);
            offsets[5] = vec2(1.0,0.0);
            offsets[6] =  vec2(-1.0,1.0);
            offsets[7] = vec2(0.0,1.0);
            offsets[8] = vec2(1.0,1.0);

            vec4 sum = color;
            for(int i = 0; i < 9; i++) {
                sum = sum + cKernel[i] * scaleFactor * texture2D(e_Texture, v_Uv + offsets[i] / stStep);
            };
            return sum;
        }`,this.filtersTypes+=`color = convolutionTextureColor(color);
`),this}reset(){return this.uniformObj={},this.filtersStr="",this.filtersTypes="",this._matrix=new THREE.Matrix4,this}_getFilterShaderData(r){return{uniforms:Object.assign({e_Texture:{value:r},colorMatrix:{value:this._matrix}},this.uniformObj),vertexShader:this.VSHADER_SOURCE,fragmentShader:this.FSHADER_SOURCE}}_getFilterColor(r="#000000",o=1){r=new THREE.Color(r);let{r:a,g:v,b:h}=r;const w=this._matrix.toArray();w[12],w[13],w[14],w[15];const L=w[0]*a+w[1]*a+w[2]*a+w[3]*o,G=w[4]*v+w[5]*v+w[6]*v+w[7]*o,k=w[8]*h+w[9]*h+w[10]*h+w[11]*o;return r.setRGB(L,G,k),r}toJSON(){return JSON.stringify({matrix:this._matrix.toArray(),uniformObj:this.uniformObj,filtersStr:this.filtersStr,filtersTypes:this.filtersTypes})}static fromJSON(r){const{matrix:o,uniformObj:a,filtersStr:v,filtersTypes:h}=JSON.parse(r),w=new MxFilters;return w._matrix=new THREE.Matrix4().fromArray(o),w.uniformObj=a,w.filtersStr=v,w.filtersTypes=h,w}}class MxDbShape extends MxDbEntity{constructor(){super(...arguments),this.isLoadMaterialFromPath=!0,this.stroke="#fff",this.strokeLineWidth=2,this.isStrokeDashLine=!1,this.isFill=!1,this._fillImageSrc=null,this.curveSegments=50,this.closed=!0,this.filter=null,this._cornerRadius=[],this._propertyDbKeys=["isFill","stroke","strokeLineWidth","isStrokeDashLine","closed","cornerRadius","fillImageSrc","fillImageParam","curveSegments"]}setStroke(r){return this.stroke=r,this}setStrokeLineWidth(r){return this.strokeLineWidth=r,this}setIsStrokeDashLine(r){return this.isStrokeDashLine=r,this}setIsFill(r){return this.isFill=r,this}get fillImageSrc(){return this._fillImageSrc}set fillImageSrc(r){this._fillImageSrc=r,this.isLoadMaterialFromPath=!0,this.material=null,this.fillImageSrc&&(this.isFill=!0),r!==!1&&r!==null||(this.setNeedUpdateDisplay(),MxFun.updateDisplay())}setFillImageSrc(r){return this.fillImageSrc=r,this}setFillImageParam(r){this.fillImageParam=r===void 0?r:Object.assign(this.fillImageParam,r)}setCurveSegments(r){return this.curveSegments=r,this}setClosed(r){return this.closed=r,this}getFilter(){return this.filter}setFilter(r){this.filter=r,this.isLoadMaterialFromPath=!0,this.material=null}get cornerRadius(){return this._cornerRadius}set cornerRadius(r){this.setCornerRadius(r)}setCornerRadius(r,o=!0){this._cornerRadius=r instanceof Array?r.map(a=>o?MxFun.screenCoordLong2Doc(a):a):o?MxFun.screenCoordLong2Doc(r):r}getTypeName(){return"MxDbShape"}getShapePoints(r){const{curveSegments:o}=this;return this.points=r.getPoints(o).map(a=>a instanceof THREE.Vector2?new THREE.Vector3(a.x,a.y,0):a),this.points}createPaths(r){return this._paths=new THREE.CurvePath,Array.isArray(r)?r.forEach(o=>this._paths.add(o)):this._paths.add(r),this._paths}_draw(r,o){let{isFill:a,closed:v,opacity:h,dLineWidth:w,lineWidthByPixels:L}=this;r.setOpacity(h),r.setLineWidthByPixels(L),r.setLineWidth(w);const G=r.getColor();r.setColor(this.filter?this.filter._getFilterColor(this.color,this.opacity):this.color);const k=this.getCornerRadiusPoints(v||a?this.getClosedPoints(o):o);a?!this.fillImageSrc&&r.drawSolid(k):r.drawLines(k),this._fillImg(r,k),r.setColor(G)}getCornerRadiusPoints(r){const{cornerRadius:o}=this;if(!o)return r;const a=typeof o=="number"?r.map(()=>o):o;return a.length>0?getToGenerateRoundedCorners(r,a):r}_drawStoreLine(r,o,a){const{isFill:v,stroke:h,strokeLineWidth:w}=this,L=r.getLineWidth(),G=r.getColor(),k=r.isDashLineDisplay();h&&v&&(r.setDashLineDisplay(this.isStrokeDashLine),r.setColor(h),r.setLineWidth(w),a?a(r):r.drawLines(this.getCornerRadiusPoints(this.getClosedPoints(o))),r.setColor(G),r.setLineWidth(L),r.setDashLineDisplay(k))}getClosedPoints(r){return[...r,r[0]]}getTotalLength(){if(this.points){let r=0;return this.points.reduce((o,a)=>(r+=o.distanceTo(a),a)),r}if(this._paths)return this._paths.getLength()+(this.closedLine?this.closedLine.getLength():0)}getGetLength(){return this._paths.getLength()}getArea(){return this.points?McGeTool.calcArea(this.closed?this.getClosedPoints(this.points):this.points):0}worldDraw(r){const o=this.createPaths(new THREE.Curve),a=this.getShapePoints(o);this._draw(r,a),this._drawStoreLine(r,a)}_fillImg(r,o){const a={transparent:!0,depthTest:!1,opacity:this.opacity,visible:this.visible};if(!this.isFill||!this.fillImageSrc)return;if(!this.material){let G=this;return void MxFun.loadImageMaterial(this.fillImageSrc,k=>{G.isLoadMaterialFromPath=!1,k&&(G.material=k,G.setNeedUpdateDisplay(),MxFun.updateDisplay())})}const v=o.map(({x:G,y:k})=>new THREE.Vector2(G,k));let h=this.material,w=new THREE.ShapeGeometry(new THREE.Shape(v));if(w=repairGeometryFaceVertexUvs(w),this.filter){const G=h.map,k=this.filter._getFilterShaderData(G);h=new THREE.ShaderMaterial(Object.assign(Object.assign({},k),a))}if(h.depthTest=!1,h.transparent=!0,h.opacity=this.opacity,h.visible=this.visible,this.fillImageParam){const G=this.fillImageParam;for(let k in this.fillImageParam)this.material.map[k]=G[k]}let L=new THREE.Mesh(w,h);r.drawEntity(L)}getGripPoints(){return[]}moveGripPointsAt(r,o){return!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,this._propertyDbKeys),this.isLoadMaterialFromPath=!0,this.material=null,r.type===MxType.MxCloneType.kMxFileClone?r.filter&&(this.filter=MxFilters.fromJSON(r.filter)):r.filter&&(this.filter=r.filter),!0}dwgOut(r){var o;return this.onDwgOut(r),this.dwgOutHelp(r,this._propertyDbKeys),r.type===MxType.MxCloneType.kMxFileClone?this.filter&&(r.filter=(o=this.filter)===null||o===void 0?void 0:o.toJSON()):r.filter=this.filter,r}transformBy(r){this.points&&this.points.forEach(o=>{o.applyMatrix4(r)})}}class MxDbEllipseShape extends MxDbShape{constructor(){super(),this.center=new THREE.Vector3,this.xRadius=10,this.yRadius=10,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!1,this.rotation=0,this.isClosedToCenter=!0,this._propertyDbKeys=[...this._propertyDbKeys,"center","xRadius","yRadius","startAngle","endAngle","clockwise","rotation","isClosedToCenter"]}getTypeName(){return"MxDbEllipseShape"}setCenter(r){return this.center=r,this}setXRadius(r){return this.xRadius=r,this}setYRadius(r){return this.yRadius=r,this}setStartAngle(r){return this.startAngle=r,this}setEndAngle(r){return this.endAngle=r,this}setClockwise(r){return this.clockwise=r,this}setRotation(r){return this.rotation=r,this}setIsClosedToCenter(r){return this.isClosedToCenter=r,this}worldDraw(r){this.drawEllipseShape(r)}drawEllipseShape(r){let{startAngle:o,endAngle:a,clockwise:v}=this;const h=this.createEllipseCurve(),w=this.createPaths(h);let L=this.getShapePoints(w);return this._draw(r,L),this._drawStoreLine(r,L),{centralAngle:v?a>o?THREE.MathUtils.radToDeg(h.aEndAngle-h.aStartAngle):360-Math.abs(THREE.MathUtils.radToDeg(h.aEndAngle-h.aStartAngle)):o>a?Math.abs(THREE.MathUtils.radToDeg(h.aEndAngle-h.aStartAngle)):360-THREE.MathUtils.radToDeg(h.aEndAngle-h.aStartAngle),curve:h,points:L}}createEllipseCurve(r=this.center.x,o=this.center.y,a=this.xRadius,v=this.yRadius,h=this.startAngle,w=this.endAngle,L=this.clockwise,G=this.rotation){return new THREE.EllipseCurve(r,o,a,v,h,w,L,G)}getCornerRadiusPoints(r){return r}getClosedPoints(r){try{let o=(this._paths||new THREE.CatmullRomCurve3(r,!1,"catmullrom",0)).getLength();this.closedLine=this.getClosedLine(r);const a=this.closedLine.getLength();let v=this.curveSegments/o,h=2.5*(o>this.curveSegments?a*v:1);if(h>20*this.curveSegments&&(h=20*this.curveSegments),h<=0)return r;const w=this.closedLine.getPoints(h);return[...r,...w]}catch{return[...r,r[0]]}}getClosedLine(r){const{isClosedToCenter:o,center:a}=this;let v=o?[r[r.length-1],a,r[0]]:[r[r.length-1],r[0]];return new THREE.CatmullRomCurve3(v,!1,"catmullrom",.01)}getGripPoints(){return[this.center]}moveGripPointsAt(r,o){return r===0&&this.center.add(o),!0}}class MxDbCircleShape extends MxDbEllipseShape{getTypeName(){return"MxDbCircleShape"}get radius(){return this.xRadius}set radius(r){this.xRadius=r,this.yRadius=r}setRadius(r){return this.radius=r,this}setXRadius(r){return this.setRadius(r),this}setYRadius(r){return this.setRadius(r),this}}function drawMx3PointArc(){const b=new MrxDbgUiPrPoint,r=new McEdGetPointWorldDrawObject,o=new Mx3PointArc;b.setUserDraw(r),b.setMessage(`
确定圆弧开始点:`),b.go(a=>{a===MrxDbgUiPrBaseReturn$1.kOk&&(o.point1=b.value(),r.setDraw(v=>{r.drawLine(o.point1,v)})),b.setMessage(`
确定圆弧结束点:`),b.go(v=>{v===MrxDbgUiPrBaseReturn$1.kOk&&(o.point2=b.value(),r.setDraw(h=>{o.point3=h,r.drawCustomEntity(o)})),b.setMessage(`
确定圆弧上任意一点:`),b.go(h=>{if(h===MrxDbgUiPrBaseReturn$1.kOk){MxFun.getCurrentDraw().addMxEntity(o);const{radius:w,angle:L,arcLength:G}=createThreePointArc(o.point1,o.point2,o.point3,!0);console.log("半径:",w),console.log("圆弧弧长:",G,o.getTotalLength())}})})})}class Mx3PointArc extends MxDbCircleShape{constructor(){super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.point3=new THREE.Vector3,this.autoClockwise=!0,this.closed=!1,this.centralAngle=0,this._propertyDbKeys=[...this._propertyDbKeys,"point1","point2","point3","autoClockwise"]}getTypeName(){return"Mx3PointArc"}create(){return new Mx3PointArc}worldDraw(r){this.updateDataInfo();const{centralAngle:o}=this.drawEllipseShape(r);this.centralAngle=o}getGripPoints(){return[this.point1,this.point2,this.point3,this.center]}compute3PointAngle(r=this.point1,o=this.point2,a=this.point3){const v=calculateArcAngle(r,this.center,this.radius),h=calculateArcAngle(o,this.center,this.radius),w=calculateArcAngle(a,this.center,this.radius);return[v.angle,h.angle,w.angle]}upDateCenter(r=this.point1,o=this.point2,a=this.point3){return this.center=calculateArcOrigin(r,o,a),this.center}upDateRadius(r=this.point1){return this.radius=calculateRadiusArc(r,this.center),this.radius}upDataClockwise(r,o,a){const{autoClockwise:v}=this;v&&(this.clockwise=judgementArcRenderDirection(o,r,a))}updateDataInfo(){this.upDateCenter(this.point1,this.point2,this.point3),this.upDateRadius(this.point1);const[r,o,a]=this.compute3PointAngle();this.startAngle=THREE.MathUtils.degToRad(r),this.endAngle=THREE.MathUtils.degToRad(o),this.upDataClockwise(r,o,a)}getArcMidPoint(){const r=MxFun.getMxFunTHREE();this.updateDataInfo();let{startAngle:o,endAngle:a,center:v,radius:h,clockwise:w}=this;w?o<a&&(o+=2*Math.PI):o>a&&(a+=2*Math.PI);const L=(o+a)/2,G=v.x+h*Math.cos(L),k=v.y+h*Math.sin(L);return new r.Vector3(G,k,0)}moveGripPointsAt(r,o){return r===0?this.point1.add(o):r===1?this.point2.add(o):r===2?this.point3.add(o):r===3&&(this.point1.add(o),this.point2.add(o),this.point3.add(o)),this.upDateCenter(),!0}}Mx3PointArc.cmd="Mx_3PointArc",Mx3PointArc.draw=drawMx3PointArc,Mx3PointArc.isRegister=!1,addRegisterMxDbEntity(Mx3PointArc);const drawMx2PointArc=async()=>{const b=new MrxDbgUiPrPoint,r=new Mx2PointArc,o=await b.go();if(!o)return;r.startPoint=o,b.setUserDraw((v,h)=>{r.endPoint=v,h.drawCustomEntity(r)});const a=await b.go();a&&(r.endPoint=a,MxFun.getCurrentDraw().addMxEntity(r))};class Mx2PointArc extends Mx3PointArc{getTypeName(){return"Mx2PointArc"}create(){return new Mx2PointArc}get startPoint(){return this.point1}set startPoint(r){this.point1=r,this.point3.x,this.point1.x,this.point3.y,this.point2.y}get endPoint(){return this.point2}set endPoint(r){this.point2=r,this.point3=this.getArcMidPoint()}}function drawMxDbCoord(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定坐标点:`),b.go(r=>{if(r!=0)return;const o=b.value();let a=new MxDbCoord;a.point1=o,a.point2=o.clone(),b.setBasePt(o),b.setUseBasePt(!0),b.setUserDraw((v,h)=>{a.point2=v,h.drawCustomEntity(a)}),b.setMessage(`
指定标注点:`),b.go(v=>{v==0?(a.point2=b.value(),MxFun.addToCurrentSpace(a)):console.log(v)})})}Mx2PointArc.cmd="Mx_2PointArc",Mx2PointArc.draw=drawMx2PointArc,Mx2PointArc.isRegister=!1,addRegisterMxDbEntity(Mx2PointArc);class MxDbCoord extends MxDbEntity{constructor(){super(...arguments),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3}worldDraw(r){let o=r.getMxObject();r.drawLine(this.point1,this.point2);let a=this.point2.clone();var v=o.screenCoordLong2Doc(20),h=6*v;a.x=a.x+h,r.drawLine(this.point2,a);var w=new THREE.Vector3,L=new THREE.Vector3;let G=o.docCoord2Cad(this.point1.x,this.point1.y,this.point1.z),k=G.x.toFixed(3),D=G.y.toFixed(3);w.x=this.point2.x+.3*v+.5*h,w.y=this.point2.y+.1*v+.5*v,r.drawText(k,v,0,w),L.x=this.point2.x+.3*v+.5*h,L.y=this.point2.y-.1*v-.5*v,r.drawText(D,v,0,L)}getGripPoints(){let r=[];return r.push(this.point1),r.push(this.point2),r}moveGripPointsAt(r,o){return r==0?this.point1.add(o):r==1&&this.point2.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.point1.copy(r.point1),this.point2.copy(r.point2),!0}dwgOut(r){return this.onDwgOut(r),r.point1=this.point1,r.point2=this.point2,r}create(){return new MxDbCoord}transformBy(r){this.point1.applyMatrix4(r),this.point2.applyMatrix4(r)}getTypeName(){return"MxDbCoord"}}async function drawMxDbLine(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定第一点:`);let r=await b.go();if(r==null)return;b.setBasePt(r.clone()),b.setUseBasePt(!0),b.setMessage(`
指定第二点:`);let o=await b.go();if(o==null)return;let a=new MxDbLine;a.pt1=r,a.pt2=o,MxFun.addToCurrentSpace(a)}MxDbCoord.cmd="Mx_Coord",MxDbCoord.draw=drawMxDbCoord,addRegisterMxDbEntity(MxDbCoord);class MxDbLine extends MxDbEntity{constructor(){super(...arguments),this.pt1=new THREE.Vector3,this.pt2=new THREE.Vector3}getTypeName(){return"MxDbLine"}worldDraw(r){r.drawLine(this.pt1,this.pt2)}setPoint1(r){this.pt1=r}getPoint1(){return this.pt1}setPoint2(r){this.pt2=r}getPoint2(){return this.pt2}getGripPoints(){let r=[];r.push(this.pt1),r.push(this.pt2);let o=new THREE.Vector3(this.pt1.x+.5*(this.pt2.x-this.pt1.x),this.pt1.y+.5*(this.pt2.y-this.pt1.y),0);return r.push(o),r}moveGripPointsAt(r,o){return r==0?this.pt1.add(o):r==1?this.pt2.add(o):r==2&&(this.pt1.add(o),this.pt2.add(o)),!0}dwgIn(r){return this.onDwgIn(r),this.pt1.copy(r.pt1),this.pt2.copy(r.pt2),!0}dwgOut(r){return this.onDwgOut(r),r.pt1=this.pt1,r.pt2=this.pt2,r}create(){return new MxDbLine}getGeomExtents(){return new THREE.Box3(this.pt1,this.pt2)}getGetLength(){return this.pt1.distanceTo(this.pt2)}}async function drawMxDbRect(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定第一点:`);let r=await b.go();if(!r)return;let o=new MxDbRect;o.pt1=r;const a=new McEdGetPointWorldDrawObject;a.setDraw(v=>{o.pt2=v,a.drawCustomEntity(o)}),b.setBasePt(r),b.setUseBasePt(!0),b.setUserDraw(a),b.setMessage(`
指定第二点:`),await b.go()&&(o.pt2=b.value(),MxFun.getCurrentDraw().addMxEntity(o))}MxDbLine.cmd="Mx_Line",MxDbLine.draw=drawMxDbLine,addRegisterMxDbEntity(MxDbLine);class MxDbRect extends MxDbEntity{constructor(){super(...arguments),this.cornerRadius=[],this.pt1=new THREE.Vector3,this.pt2=new THREE.Vector3,this.isSolidColorFill=!1,this.isLoadMaterialFromPath=!0,this.material=null}worldDraw(r){let o=computeRectPoints(this.pt1,this.pt2);if(this.cornerRadius.length>0&&(o=getToGenerateRoundedCorners(o,this.cornerRadius)),r.getType()!=McGiWorldDrawType$1.kWorldDraw)return o.push(o[0]),void r.drawLines(o);const a={transparent:!0,depthTest:!1,opacity:this.opacity,visible:this.visible};if(this.isSolidColorFill){let v;o=o.map(({x:L,y:G})=>new THREE.Vector2(L,G)),v=new THREE.ShapeGeometry(new THREE.Shape(o));let h=new THREE.MeshBasicMaterial(Object.assign({color:this.filter?this.filter._getFilterColor(this.color,this.opacity):new THREE.Color(this.color)},a)),w=new THREE.Mesh(v,h);r.drawEntity(w)}else if(this.fillImageSrc){if(this.material){o=o.map(({x:L,y:G})=>new THREE.Vector2(L,G));let v=this.material,h=new THREE.ShapeGeometry(new THREE.Shape(o));if(h=repairGeometryFaceVertexUvs(h),this.filter){const L=v.map;this.fillImageParam&&(this.fillImageParam.center&&(L.center=this.fillImageParam.center),this.fillImageParam.offset&&(L.offset=this.fillImageParam.offset),this.fillImageParam.repeat&&(L.repeat=this.fillImageParam.repeat),this.fillImageParam.rotation&&(L.rotation=this.fillImageParam.rotation));const G=this.filter._getFilterShaderData(L);v=new THREE.ShaderMaterial(Object.assign(Object.assign({},G),a))}v.depthTest=!1,v.transparent=!0,v.opacity=this.opacity,v.visible=this.visible;let w=new THREE.Mesh(h,v);r.drawEntity(w)}else if(this.fillImageSrc.length>0&&this.isLoadMaterialFromPath){let v=this;MxFun.loadImageMaterial(this.fillImageSrc,h=>{this.isLoadMaterialFromPath=!1,h&&(v.material=h,v.setNeedUpdateDisplay(),MxFun.updateDisplay())})}}else{let v=new THREE.BufferGeometry().setFromPoints(o),h=new THREE.LineBasicMaterial(Object.assign({color:this.getColor()},a)),w=new THREE.LineLoop(v,h);r.drawEntity(w)}}getGripPoints(){let r=[];r.push(this.pt1);const o=new THREE.Line3(this.pt1,this.pt2);let a=new THREE.Vector3;return o.getCenter(a),r.push(a),r.push(this.pt2),r}moveGripPointsAt(r,o){return r==0?this.pt1.add(o):r==1?(this.pt1.add(o),this.pt2.add(o)):r==2&&this.pt2.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.pt1.copy(r.pt1),this.pt2.copy(r.pt2),this.isSolidColorFill=r.isSolidColorFill,this.fillImageSrc=r.fillImageSrc,this.fillImageParam=r.fillImageParam,this.cornerRadius=r.cornerRadius,this.filter=r.filter,this.isLoadMaterialFromPath=!0,this.material=null,!0}dwgOut(r){return this.onDwgOut(r),r.pt1=this.pt1,r.pt2=this.pt2,r.isSolidColorFill=this.isSolidColorFill,r.fillImageSrc=this.fillImageSrc,r.fillImageParam=this.fillImageParam,r.cornerRadius=this.cornerRadius,r.filter=this.filter,r}create(){return new MxDbRect}transformBy(r){this.pt1.applyMatrix4(r),this.pt2.applyMatrix4(r)}setRadius(r,o=!0){this.cornerRadius=r instanceof Array?r.map(a=>o?MxFun.screenCoordLong2Doc(a):a):r>0?o?[MxFun.screenCoordLong2Doc(r),MxFun.screenCoordLong2Doc(r),MxFun.screenCoordLong2Doc(r),MxFun.screenCoordLong2Doc(r)]:[r,r,r,r]:[]}getTypeName(){return"MxDbRect"}getFilter(){return this.filter}setFilter(r){this.filter=r,this.isLoadMaterialFromPath=!0,this.material=null}setFillImagePath(r){this.fillImageSrc=r,this.isLoadMaterialFromPath=!0,this.material=null,this.fillImageSrc&&(this.isSolidColorFill=!1)}getFillImagePath(){return this.fillImageSrc}}function drawMxDbAlignedDimension(){let b=new MxDbAlignedDimension;const r=new MrxDbgUiPrPoint;return r.setMessage(`
指定第一点:`),r.go(o=>{if(o!=0)return;const a=r.value();b.setPoint1(a),b.setColor(65314);const v=new McEdGetPointWorldDrawObject;v.setDraw(h=>{b.setPoint2(h),v.drawCustomEntity(b)}),r.setBasePt(a),r.setUseBasePt(!0),r.setUserDraw(v),r.setMessage(`
指定第二点:`),r.setInputToucheType(MxType.InputToucheType.kGetEnd),r.go(h=>{if(h!=0)return void console.log(h);const w=r.value();b.setPoint2(w),MxFun.getCurrentDraw().addMxEntity(b)})}),b}MxDbRect.cmd="Mx_DrawRect",MxDbRect.draw=drawMxDbRect,addRegisterMxDbEntity(MxDbRect);const propertyDbKeys$5=["point1","point2","fontColor"];class MxDbAlignedDimension extends MxDbEntity{constructor(r){if(super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,r){const{points:o,fontColor:a}=r;o&&this.setPoints(o),a&&(this.fontColor=a)}}setPoints(r){const[o,a]=r;o&&(this.point1=o),a&&(this.point2=a)}getTypeName(){return"MxDbAlignedDimension"}getDirection(r,o,a){const v=new THREE.Vector3(r.x,r.y,0),h=new THREE.Vector3(1,0,0),w=r.angleTo(h);let L=-1;(w<7*Math.PI/18||w>10*Math.PI/18)&&o.x>a.x&&(L=1);const G=new THREE.Matrix4;return G.makeRotationZ(Math.PI/2*L),v.applyMatrix4(G),v}getDimText(){return new THREE.Vector3(this.point1.x-this.point2.x,this.point1.y-this.point2.y,0).length().toFixed(3)}worldDraw(r){if(r.setOpacity(this.opacity),r.getType()==McGiWorldDrawType$1.kWorldDraw||r.getType()==McGiWorldDrawType$1.kDynDragDraw){let _=function(J,T){Array.isArray(J)?J.forEach(B=>{_(B,T)}):J.opacity=T};const o=this.point1,a=this.point2;let v,h,w,L,G,k,D;const f=new THREE.Vector3(o.x-a.x,o.y-a.y,0),O=this.getDirection(f,o,a),C=new THREE.Matrix4;C.makeScale(.01,.01,.01);const j=new THREE.Vector3(O.x,O.y,0);j.applyMatrix4(C);const V=new THREE.Vector3(o.x+j.x,o.y+j.y,0),R=new THREE.Vector3(a.x+j.x,a.y+j.y,0),M=this.getColor();k=MxThreeJS.createPoint(o,M),D=MxThreeJS.createPoint(a,M);const ee=new THREE.Vector3(O.x,O.y,0),F=new THREE.Vector3(O.x,O.y,0);C.identity(),C.makeScale(.2,.2,0),ee.applyMatrix4(C),C.identity(),C.makeScale(.02,.02,0),F.applyMatrix4(C),r.drawLine(V.x+2*F.x,V.y+2*F.y,R.x+2*F.x,R.y+2*F.y),v=MxThreeJS.createLine(new THREE.Vector3(V.x+3*F.x,V.y+3*F.y,0),new THREE.Vector3(o.x+.5*F.x,o.y+.5*F.y,0),M),h=MxThreeJS.createLine(new THREE.Vector3(R.x+3*F.x,R.y+3*F.y,0),new THREE.Vector3(a.x+.5*F.x,a.y+.5*F.y,0),M);{const J=new THREE.Vector3(1,0,0);let T=f.angleTo(J);const B=new THREE.Vector3(O.x,O.y,0);B.normalize();const N=o.distanceTo(a);f.y<0?T=T<Math.PI/2?2*Math.PI-T:Math.PI-T:T>Math.PI/2&&(T=Math.PI+T);const u=r.getMxObject();u&&(T-=u.getViewAngle());const c=this.getDimText();(w=MxThreeJS.creatTextSprite(c,new THREE.Vector3(R.x+f.x/2+B.x*N/15,R.y+f.y/2+B.y*N/15,0),.07*N,T,this.fontColor||M))!=null&&(w.material.opacity=this.opacity,r.drawEntity(w))}{C.identity(),C.makeScale(.08,.08,.08);const J=new THREE.Matrix4;J.makeRotationZ(17*Math.PI/18);let T=new THREE.Vector3(f.x,f.y,0);T.applyMatrix4(C),T.applyMatrix4(J),J.identity(),J.makeRotationZ(17*-Math.PI/18);let B=new THREE.Vector3(f.x,f.y,0);B.applyMatrix4(C),B.applyMatrix4(J);const N=new Array;N.push(new THREE.Vector3(V.x+2*F.x,V.y+2*F.y,0),new THREE.Vector3(V.x+2*F.x+T.x,V.y+T.y+2*F.y,0),new THREE.Vector3(V.x+2*F.x+B.x,V.y+B.y+2*F.y,0)),L=MxThreeJS.createTriangle(N,M),J.identity(),J.makeRotationZ(Math.PI/18),(T=new THREE.Vector3(f.x,f.y,0)).applyMatrix4(C),T.applyMatrix4(J),J.identity(),J.makeRotationZ(-Math.PI/18),(B=new THREE.Vector3(f.x,f.y,0)).applyMatrix4(C),B.applyMatrix4(J);const u=new Array;u.push(new THREE.Vector3(R.x+2*F.x,R.y+2*F.y,0),new THREE.Vector3(R.x+T.x+2*F.x,R.y+T.y+2*F.y,0),new THREE.Vector3(R.x+B.x+2*F.x,R.y+B.y+2*F.y,0)),G=MxThreeJS.createTriangle(u,M)}r.drawEntity(v),r.drawEntity(h),L&&(_(L.material,this.opacity),r.drawEntity(L)),G&&(_(G.material,this.opacity),r.drawEntity(G)),r.drawEntity(k),r.drawEntity(D)}else r.drawLine(this.point1,this.point2)}setPoint1(r){this.point1=r}setPoint2(r){this.point2=r}setColor(r){return lodash.isArray(r)?([this.color=this.color,this.fontColor=this.fontColor||this.color]=r,console.log("this.fontColor : ",this.fontColor)):this.color=r,this}getGripPoints(){let r=[];return r.push(this.point1),r.push(this.point2),r}moveGripPointsAt(r,o){return r==0?this.point1.add(o):(r=1)&&this.point2.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys$5),!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys$5),r}create(){return new MxDbAlignedDimension}}MxDbAlignedDimension.cmd="Mx_DimensionMeasurement",MxDbAlignedDimension.draw=drawMxDbAlignedDimension,addRegisterMxDbEntity(MxDbAlignedDimension);class MxDbHatch extends MxDbEntity{constructor(){super(...arguments),this.points=[]}worldDraw(r){r.getType()===McGiWorldDrawType$1.kWorldDraw?r.drawSolid(this.points):r.drawLines([...this.points,this.points[0]])}getTypeName(){return"MxDbHatch"}moveGripPointsAt(r,o){return r===0?this.points.forEach(a=>{a.add(o)}):this.points[r-1]&&this.points[r-1].add(o),!0}setPoints(r){this.points=r.map(o=>o.clone())}getGripPoints(){if(this.points.length>0){const{centerPoint:r}=computeBounding(this.points);return[r,...this.points]}return[]}dwgIn(r){this.onDwgIn(r);const o=r.points;return this.points=o.map(({x:a,y:v,z:h})=>new THREE.Vector3(a,v,h)),!0}dwgOut(r){return this.onDwgOut(r),r.points=this.points,r}}function drawMxDbArea(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定第一点:`),b.go(r=>{if(r!=0)return;const o=b.value();let a=new MxDbArea;a.addPoint(o);const v=new McEdGetPointWorldDrawObject;v.setDraw((h,w)=>{let L=a.clone();L.addPoint(h),v.drawCustomEntity(L)}),b.setUserDraw(v),b.setMessage(`
指定下一点:`),b.goWhile(h=>{if(h==0){const w=b.value();a.addPoint(w)}},h=>{a.isFill=!0,a.fillOpacity=.7,a.fillColor=6697540,MxFun.getCurrentDraw().addMxEntity(a)})})}addRegisterMxDbEntity(MxDbHatch);class MxDbArea extends MxDbEntity{constructor(){super(...arguments),this.points=[],this.isFill=!1,this.fillColor=6697540,this.fillOpacity=.7}getTypeName(){return"MxDbArea"}create(){return new MxDbArea}getDimText(){return McGeTool.calcArea(this.points).toFixed(2)}worldDraw(r){if(this.points.length<3)return void(this.points.length==2&&r.drawLine(this.points[0],this.points[1]));let o=this.points[0],a=o.clone(),v=o.clone(),h=this.points.length;for(let D=1;D<h;D++){let f=this.points[D];a.x>f.x&&(a.x=f.x),a.y>f.y&&(a.y=f.y),v.x<f.x&&(v.x=f.x),v.y<f.y&&(v.y=f.y),r.drawLine(o,f),o=f}r.drawLine(o,this.points[0]);let w=new THREE.Vector3(a.x+.5*(v.x-a.x),a.y+.5*(v.y-a.y));const L=r.getColor();let G=MxFun.screenCoordLong2Doc(20),k=MxThreeJS.creatTextSprite(this.getDimText(),w,G,0,L);if(k!=null&&r.drawEntity(k),r.getType()==McGiWorldDrawType$1.kWorldDraw&&this.isFill){r.setColor(this.fillColor),r.setOpacity(this.fillOpacity),r.setRenderOrder(r.getRenderOrder()-1);const D=new MxDbHatch;D.points=this.points,D.worldDraw(r)}}getGripPoints(){return this.points}moveGripPointsAt(r,o){return!(r>=this.points.length||(this.points[r].add(o),0))}dwgIn(r){this.onDwgIn(r);let o=r.points;return this.points=[],o.forEach(a=>{this.points.push(new THREE.Vector3(a.x,a.y,a.z))}),this.dwgInHelp(r,["isFill","fillColor","fillOpacity"]),!0}dwgOut(r){return this.onDwgOut(r),r.points=this.points,this.dwgOutHelp(r,["isFill","fillColor","fillOpacity"]),r}addPoint(r){this.points.push(r.clone())}getPoints(){return this.points}clearPoint(){this.points=[]}}async function drawMxDbLeadTag(){let r=await new MrxDbgUiPrPoint().go();if(!r)return;let o=prompt("请输入文字批注","批注");if(!o)return;const a=new MxDbLeadTag;a.point=r,a.text=o,MxFun.addToCurrentSpace(a)}MxDbArea.cmd="Mx_Area",MxDbArea.draw=drawMxDbArea,addRegisterMxDbEntity(MxDbArea);class MxDbLeadTag extends MxDbEntity{constructor(){super(...arguments),this.point=new THREE.Vector3,this.leadLen=88,this.text="",this.textHeight=24}getTypeName(){return"MxDbLeadTag"}createDots(r,o){const{x:a,y:v,z:h}=r,w=new THREE.Shape;w.arc(a,v,o.screenCoordLong2Doc(6),0,2*Math.PI,!0);const L=new THREE.Path;L.arc(a,v,o.screenCoordLong2Doc(3),0,2*Math.PI,!0),w.holes.push(L);const G=new THREE.ShapeGeometry(w),k=new THREE.MeshPhongMaterial({color:"#ff0000",transparent:!0}),D=new THREE.Shape;D.arc(a,v,o.screenCoordLong2Doc(3),0,2*Math.PI,!0);const f=new THREE.ShapeGeometry(D),O=new THREE.MeshPhongMaterial({color:"#e2da8f",transparent:!0}),C=new THREE.Mesh(G,k),j=new THREE.Mesh(f,O);return C.add(j),C}worldDraw(r){let o=r.getMxObject();const a=this.createDots(this.point,o);if(r.drawEntity(a),a.geometry.computeBoundingBox(),r.drawSelectLine(a.geometry.boundingBox.max,a.geometry.boundingBox.min),r.getType()===2)return;let v=r.getMxObject().screenCoordLong2Doc(this.leadLen),h=new THREE.Vector3(this.point.x+2*v,this.point.y+v,0);const w=h.x-v,L=new THREE.Vector3(w,h.y,h.z);r.setLineWidth(4),r.setColor(16770565),r.drawLines([this.point,L,h]);const G=r.getMxObject().screenCoordLong2Doc(this.textHeight),k=h.clone().setX(h.x);r.setColor(16744448);const D=MxThreeJS.creatTextSprite(this.text,k,G,0,r.getColor());if(D){const f=new THREE.Box3,O=new THREE.Vector3;f.expandByObject(D),f.getSize(O),D.position.setX(D.position.x+O.x/2);const C=r.getMxObject().screenCoordLong2Doc(5),j=f.min.clone().setX(f.min.x+O.x/2).setY(f.min.y-C),V=f.max.clone().setX(f.max.x+O.x/2).setY(f.min.y+C);V.setY(f.max.y+C);const R=new THREE.Vector3(j.x,V.y),M=new THREE.Vector3(V.x,j.y);r.setColor(16777215),r.setLineWidth(0),r.drawLine(j,R),r.drawLine(V,M),r.drawLine(j,M),r.drawLine(R,V);const ee=C/2,F=[],_=[];F.push(new THREE.Vector3(R.x+ee,R.y-C,R.z),new THREE.Vector3(R.x+ee,R.y-ee,R.z),new THREE.Vector3(R.x+C,R.y-ee,R.z)),_.push(new THREE.Vector3(M.x-ee,M.y+C,M.z),new THREE.Vector3(M.x-ee,M.y+ee,M.z),new THREE.Vector3(M.x-C,M.y+ee,M.z)),r.drawLines(F),r.drawLines(_),r.setOpacity(.5),r.setColor(6697540),r.setRenderOrder(-100),r.drawSolid([j,R,V,M]),r.setRenderOrder(100),r.drawEntity(D)}}getGripPoints(){return[this.point]}onViewChange(){return this.setNeedUpdateDisplay(),!0}moveGripPointsAt(r,o){return r===0&&this.point.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,["point","text","textHeight","leadLen"]),!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,["point","text","textHeight","leadLen"]),r}}function drawMxDbAnyLine(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject,a=new MxDbAnyLine;b.setUserDraw(o),b.setMessage(`
点击开始画线:`),b.go(v=>{v===MrxDbgUiPrBaseReturn$1.kOk&&(a.points.push(b.value()),o.setDraw(h=>{a.points.push(h.clone()),o.drawCustomEntity(a)})),b.setMessage(`
再次点击结束画线:`),b.go(h=>{h===MrxDbgUiPrBaseReturn$1.kOk&&r.addMxEntity(a)})})}MxDbLeadTag.cmd="Mx_LeadTag",MxDbLeadTag.draw=drawMxDbLeadTag,addRegisterMxDbEntity(MxDbLeadTag);const propertyDbKeys$4=["points"];class MxDbAnyLine extends MxDbEntity{constructor(){super(...arguments),this.points=[]}getTypeName(){return"MxDbAnyLine"}create(){return new MxDbAnyLine}worldDraw(r){let o=r.getMxObject();const a=new THREE.Box3().setFromPoints(this.points);let v=new THREE.Vector3;if(a.getCenter(v),r.drawLines(this.points),r.getType()===McGiWorldDrawType$1.kSelectDraw){const h=new THREE.Vector3;a.getSize(h),h.addScalar(o.screenCoordLong2Doc(20));const w=h.x/2,L=h.y/2,G={x:v.x-w,y:v.y-L},k={x:v.x+w,y:v.y-L},D={x:v.x+w,y:v.y+L},f={x:v.x-w,y:v.y+L};r.drawLine(k.x,k.y,D.x,D.y),r.drawLine(G.x,G.y,k.x,k.y),r.drawLine(D.x,D.y,f.x,f.y),r.drawLine(f.x,f.y,G.x,G.y)}}setPoints(r){return this.points=r,this}getCenter(){const r=new THREE.Geometry;r.vertices=this.points;const o=new THREE.Vector3;return r.computeBoundingBox(),r.boundingBox.getCenter(o),o}getGripPoints(){return[this.getCenter()]}moveGripPointsAt(r,o){return r===0&&this.points.forEach(a=>{a.add(o)}),!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys$4),!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys$4),r}}function drawMxDbCloudLine(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;b.setMessage(`
点击开启绘制云线:`),b.go(()=>{const a=MxFun.screenCoordLong2Doc(16);let v=b.value();const h=new MxDbCloudLine;h.setRadius(a),h.addPoint(v),o.setDraw(w=>{v.distanceTo(w)>a&&(v=w.clone(),h.addPoint(w,!0)),o.drawCustomEntity(h)}),b.setUserDraw(o),b.setMessage(`
再次点击结束绘制云线:`),b.go(()=>{r.addMxEntity(h)})})}MxDbAnyLine.cmd="Mx_AnyLine",MxDbAnyLine.draw=drawMxDbAnyLine,addRegisterMxDbEntity(MxDbAnyLine);const propertyDbKeys$3=["points","radius"];class MxDbCloudLine extends MxDbEntity{constructor(){super(),this.points=[],this.radius=16,this.cachePoint=null,this.use_smallcoord_display=!0}getTypeName(){return"MxDbCloudLine"}create(){return new MxDbCloudLine}setRadius(r){this.radius=r}getRadius(){return this.radius}getCachePoint(){return this.cachePoint}clacNewArcDiameterPoint(r){if(this.points.length==0)return r;let o=this.points[this.points.length-1];const a=2*this.radius,v=o.distanceTo(r);if(v<a)return null;const h=a*(r.x-o.x)/v+o.x,w=a*(r.y-o.y)/v+o.y;return new THREE.Vector3(h,w,o.z)}createCloudArcCurvePoints(r,o,a){const v=new THREE.Vector3((r.x+o.x)/2,(r.y+o.y)/2,0);a||(a=v.distanceTo(r));const{startAngle:h,endAngle:w}=function(L,G,k){const D=2*Math.PI/360;return{startAngle:180*Math.atan2(G.y-L.y,G.x-L.x)/Math.PI*D,endAngle:180*Math.atan2(k.y-L.y,k.x-L.x)/Math.PI*D}}(v,r,o);return new THREE.ArcCurve(v.x,v.y,a,h,w,!0).getPoints(10)}addPoint(r,o){let a=this.clacNewArcDiameterPoint(r);a&&(this.points.push(a),this.cachePoint=null,o&&(this.cachePoint=this.reCalculateDrawGeometryPoint()))}addLine(r,o){this.addPoint(r);const a=2*this.radius;let v=this.points[this.points.length-1],h=v.distanceTo(o);const w=Math.round(h/a);for(let L=0;L<w;L++){h=v.distanceTo(o);const G=a*(o.x-v.x)/h+v.x,k=a*(o.y-v.y)/h+v.y;let D=new THREE.Vector3(G,k,o.z);this.addPoint(D),v=D}return this.points[this.points.length-1]}reCalculateDrawGeometryPoint(){if(this.points.length<2)return null;let r=this.points[0],o=this.points.length,a=[];for(let v=1;v<o;v++){let h=this.points[v];this.createCloudArcCurvePoints(r,h).forEach(w=>{a.push(new THREE.Vector3(w.x,w.y,0))}),r=h}return a}worldDraw(r){if(this.cachePoint||(this.cachePoint=this.reCalculateDrawGeometryPoint()),!this.cachePoint)return;let o=r.getMxObject();if(r.getType()===McGiWorldDrawType$1.kSelectDraw){let a=new THREE.Geometry;this.cachePoint.forEach(O=>{a.vertices.push(new THREE.Vector3(O.x,O.y,0))}),a.computeBoundingBox();const v=new THREE.Vector3;a.boundingBox.getSize(v);let h=new THREE.Vector3;a.boundingBox.getCenter(h);const w=v.x/2,L=v.y/2,G={x:h.x-w,y:h.y-L},k={x:h.x+w,y:h.y-L},D={x:h.x+w,y:h.y+L},f={x:h.x-w,y:h.y+L};r.drawLine(this.toSmallcoord2(o,G.x,G.y),this.toSmallcoord2(o,k.x,k.y)),r.drawLine(this.toSmallcoord2(o,k.x,k.y),this.toSmallcoord2(o,D.x,D.y)),r.drawLine(this.toSmallcoord2(o,D.x,D.y),this.toSmallcoord2(o,f.x,f.y)),r.drawLine(this.toSmallcoord2(o,f.x,f.y),this.toSmallcoord2(o,G.x,G.y))}else{let a=[];this.cachePoint.forEach(v=>{a.push(this.toSmallcoord(o,v))}),r.drawLines(a)}}getCenter(){const r=new THREE.Geometry;r.vertices=this.points;let o=new THREE.Vector3;return r.computeBoundingBox(),r.boundingBox.getCenter(o),o}getGripPoints(){return[this.getCenter()]}moveGripPointsAt(r,o){return this.points.forEach(a=>{a.add(o)}),this.cachePoint=null,!0}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys$3),this.cachePoint=null,!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys$3),r.type===MxType.MxCloneType.kSaveDwgClone&&this.dwgOutHelp(r,["cachePoint"]),r}}function drawMxDbRegularPolygon(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject,a=new MxDbRegularPolygon;b.setMessage(`
点击开始绘制多边形:`),b.go(()=>{let v=prompt("请输入多边形的边数","8");v&&(a.sidesNumber=Number(v),a.centerPoint=b.value(),b.setUserDraw(o),o.setDraw(h=>{a.otherPoint=h,o.drawCustomEntity(a)}),b.setMessage(`
再次点击结束绘制多边形:`),b.go(()=>{r.addMxEntity(a)}))})}MxDbCloudLine.isRegister=!1,MxDbCloudLine.cmd="Mx_CloudLine",MxDbCloudLine.draw=drawMxDbCloudLine,addRegisterMxDbEntity(MxDbCloudLine);class MxDbRegularPolygon extends MxDbShape{getTypeName(){return"MxDbRegularPolygon"}constructor(){super(),this.centerPoint=new THREE.Vector3,this.otherPoint=new THREE.Vector3,this.sidesNumber=5,this._propertyDbKeys=[...this._propertyDbKeys,"centerPoint","otherPoint","sidesNumber"]}worldDraw(r){const o=computeRegularPolygonVertices(this.centerPoint,this.otherPoint,this.sidesNumber);this.closed=!1,o.push(o[0]),this._draw(r,o),this._drawStoreLine(r,o)}getGripPoints(){return[this.centerPoint,this.otherPoint]}moveGripPointsAt(r,o){return r===0?(this.centerPoint.add(o),this.otherPoint.add(o)):r===1&&this.otherPoint.add(o),!0}}function drawMxDbLeadComment(){const b=new MrxDbgUiPrPoint;b.setMessage(`
指定第一点:`),b.go(r=>{if(r!=0)return;const o=b.value();let a=new MxDbLeadComment;a.point1=o.clone(),a.textHeight=MxFun.screenCoordLong2Doc(50);let v=prompt("请输入文字批注","批注");if(!v)return;a.text=v,a.textWidth=MxFun.screenCoordLong2Doc(10*v.length),a.fixedSize=!0,a.fixedSize&&(a.textHeight=50,a.textWidth=50*v.length);const h=new McEdGetPointWorldDrawObject;h.setDraw((w,L)=>{a.point2=w,L.drawCustomEntity(a)}),b.setBasePt(o),b.setUseBasePt(!0),b.setUserDraw(h),b.setMessage(`
指定第二点:`),b.go(w=>{if(w!=0)return void console.log(w);const L=b.value();a.point2=L,MxFun.addToCurrentSpace(a)})})}MxDbRegularPolygon.cmd="Mx_RegularPolygon",MxDbRegularPolygon.draw=drawMxDbRegularPolygon,addRegisterMxDbEntity(MxDbRegularPolygon);class MxDbLeadComment extends MxDbEntity{constructor(){super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.text="",this.textHeight=20,this.textWidth=0,this.fixedSize=!1,this.use_smallcoord_display=!0}getTypeName(){return"MxDbLeadComment"}create(){return new MxDbLeadComment}worldDraw(r){let o=r.getMxObject(),a=this.toSmallcoord(o,this.point1),v=this.toSmallcoord(o,this.point2);if(r.drawLine(a,v),this.text.length>0){const h=new THREE.Vector3;let w=this.textHeight,L=this.textWidth;this.fixedSize&&(w=o.screenCoordLong2Doc(w),L=o.screenCoordLong2Doc(L));let G=MxThreeJS.clacTextSpriteSize(this.text,w,L);h.x=v.x+.5*G.textwidth,h.y=v.y+.5*G.allTextHeight,r.drawText(this.text,w,0,h,L);const k=new THREE.Vector3;k.x=v.x+G.textwidth,k.y=v.y,r.drawLine(k,v)}}getGripPoints(){let r=[];return r.push(this.point1),r.push(this.point2),r}moveGripPointsAt(r,o){return r==0?this.point1.add(o):r==1&&this.point2.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.point1.copy(r.point1),this.point2.copy(r.point2),this.text=r.text.substr(0),this.textHeight=r.textHeight,r.textWidth&&(this.textWidth=r.textWidth),this.fixedSize=r.fixedSize,!0}dwgOut(r){return this.onDwgOut(r),r.point1=this.point1,r.point2=this.point2,r.textHeight=this.textHeight,r.text=this.text,r.textWidth=this.textWidth,r.fixedSize=this.fixedSize,r}onViewChange(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}}function drawMxDbRectBoxLeadComment(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject,a=new MxDbRectBoxLeadComment;a.setLineWidth(3),a.setLineWidthByPixels(!0),b.setMessage(`
云线框起始点:`),b.go(v=>{a.radius=MxFun.screenCoordLong2Doc(8),v==MrxDbgUiPrBaseReturn$1.kOk&&(a.point1=b.value(),o.setDraw(h=>{a.point2=h,o.drawCustomEntity(a)}),b.setUserDraw(o),b.setMessage(`
云线框结束点:`),b.go(h=>{if(h!=MrxDbgUiPrBaseReturn$1.kOk)return;a.point2=b.value(),o.setDraw(L=>{a.point3=L,o.drawCustomEntity(a)});let w=prompt("请输入文字批注","批注");w||(w="默认批注文字"),a.text=w,a.textWidth=MxFun.screenCoordLong2Doc(10*w.length),a.textHeight=MxFun.screenCoordLong2Doc(5*w.length),a.fixedSize=!0,a.fixedSize&&(a.textHeight=20,a.textWidth=20*w.length),b.setMessage(`
审图标注点:`),b.go(L=>{L==MrxDbgUiPrBaseReturn$1.kOk&&(a.point3=b.value(),r.addMxEntity(a))})}))})}MxDbLeadComment.cmd="Mx_Comment",MxDbLeadComment.draw=drawMxDbLeadComment,addRegisterMxDbEntity(MxDbLeadComment);class MxDbRectBoxLeadComment extends MxDbEntity{constructor(){super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.point3=new THREE.Vector3,this.text="",this.textHeight=20,this.radius=16,this.textWidth=0,this.fixedSize=!1,this.use_smallcoord_display=!0}getTypeName(){return"MxDbRectBoxLeadComment"}create(){return new MxDbRectBoxLeadComment}getCloudLine(){let r=new MxDbCloudLine;r.setRadius(this.radius);let o=this.point1.clone(),a=this.point2.clone();if(o.x>a.x){let G=o.x;o.x=a.x,a.x=G}if(o.y>a.y){let G=o.y;o.y=a.y,a.y=G}let v=new THREE.Vector3(o.x,a.y,o.z);v=r.addLine(o,v),a=new THREE.Vector3(a.x,v.y,a.z),a=r.addLine(v,a);let h=new THREE.Vector3(a.x,o.y,o.z);h=r.addLine(a,h);let w=o=r.addLine(h,o),L=o.distanceTo(this.point3);return L>v.distanceTo(this.point3)&&(w=v,L=v.distanceTo(this.point3)),L>a.distanceTo(this.point3)&&(w=a,L=a.distanceTo(this.point3)),L>h.distanceTo(this.point3)&&(w=h,L=h.distanceTo(this.point3)),{cloudLine:r,pt1:o,pt2:v,pt3:a,pt4:h,leadPt:w}}worldDraw(r){let o=this.getCloudLine(),a=o.cloudLine;if(a.setUseSmallcoordDisplay(this.use_smallcoord_display),a.worldDraw(r),this.text.length>0){let v=o.leadPt,h=new MxDbLeadComment;h.setUseSmallcoordDisplay(this.use_smallcoord_display),h.point1=v,h.point2=this.point3,h.text=this.text,h.textHeight=this.textHeight,h.textWidth=this.textWidth,h.fixedSize=this.fixedSize,h.worldDraw(r)}}getGripPoints(){let r=[];return r.push(this.point1),r.push(this.point2),r.push(this.point3),r}moveGripPointsAt(r,o){return r==0?this.point1.add(o):r==1?this.point2.add(o):r==2&&this.point3.add(o),!0}dwgIn(r){return this.onDwgIn(r),this.point1.copy(r.point1),this.point2.copy(r.point2),this.point3.copy(r.point3),this.text=r.text.substr(0),this.textHeight=r.textHeight,this.radius=r.radius,r.textWidth&&(this.textWidth=r.textWidth),this.fixedSize=r.fixedSize,!0}dwgOut(r){if(this.onDwgOut(r),r.point1=this.point1,r.point2=this.point2,r.point3=this.point3,r.textHeight=this.textHeight,r.text=this.text,r.radius=this.radius,r.textWidth=this.textWidth,r.fixedSize=this.fixedSize,r.type===MxType.MxCloneType.kSaveDwgClone){let o=this.getCloudLine(),a=o.cloudLine.reCalculateDrawGeometryPoint();r.cachePoint=a||[],r.leadPt=o.leadPt}return r}onViewChange(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}}function drawMxDbEllipse(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject,a=new MxDbEllipse;b.setMessage(`
点击开始绘制椭圆:`),b.go(()=>{a.point1=b.value(),o.setDraw(v=>{a.point2=v,o.drawCustomEntity(a)}),b.setUserDraw(o),b.setMessage(`
再次点击结束绘制椭圆:`),b.go(()=>{r.addMxEntity(a)})})}MxDbRectBoxLeadComment.cmd="Mx_CheckDraw",MxDbRectBoxLeadComment.draw=drawMxDbRectBoxLeadComment,addRegisterMxDbEntity(MxDbRectBoxLeadComment);class MxDbEllipse extends MxDbEllipseShape{constructor(){super(),this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.isClosedToCenter=!1,this.closed=!1,this._propertyDbKeys=[...this._propertyDbKeys,"point1","point2"]}getTypeName(){return"MxDbEllipse"}create(){return new MxDbEllipse}setPoint1(r){return this.point1=r,this}setPoint2(r){return this.point2=r,this}worldDraw(r){const{point1:o,point2:a}=this,v=o.clone().set(a.x,o.y,a.z),h=a.clone().set(o.x,a.y,o.z);this.xRadius=o.distanceTo(v)/2,this.yRadius=o.distanceTo(h)/2;const w=o.x>a.x,L=o.y>a.y,G=w?o.x-this.xRadius:o.x+this.xRadius,k=L?o.y-this.yRadius:o.y+this.yRadius;this.center=new THREE.Vector3(G,k,0),this.drawEllipseShape(r),r.getType()===McGiWorldDrawType$1.kSelectDraw&&r.drawLines([o,new THREE.Vector3(o.x,a.y),a,new THREE.Vector3(a.x,o.y),o])}getGripPoints(){let r=new THREE.Vector3(.5*(this.point2.x+this.point1.x),.5*(this.point2.y+this.point1.y),0);return[this.point1,this.point2,r]}moveGripPointsAt(r,o){return r===0?this.point1.add(o):r===1?this.point2.add(o):r===2&&(this.point1.add(o),this.point2.add(o)),!0}}async function drawMxDbText(){const b=new MrxDbgUiPrPoint;b.setMessage(`
 点取文字插入点:`);let r=await b.go();if(r==null)return;let o=prompt("请输入文字");if(!o)return;let a=new MxDbText;a.position=r,a.height=MxFun.screenCoordLong2Doc(50),a.text=o,MxFun.addToCurrentSpace(a)}let _SpriteText;function getSpriteTextColor(b){return b?b instanceof THREE.Color?b.getStyle():typeof b=="number"?new THREE.Color(b).getStyle():b:"#fff"}function toCSSFont(b,r,o,a,v){let h=document.createElement("span");return h.style.font="1px serif",h.style.fontFamily=b,h.style.fontSize=`${r}px`,h.style.fontStyle=o,h.style.fontVariant=a,h.style.fontWeight=v,h.style.font}function getSpriteTextClass(){if(!_SpriteText){class b extends THREE.Sprite{constructor(o){super(new THREE.SpriteMaterial);const{text:a,textHeight:v,color:h,backgroundColor:w,padding:L,borderWidth:G,borderRadius:k,borderColor:D,strokeWidth:f,strokeColor:O,fontFace:C,fontSize:j,fontWeight:V,textAlign:R,textShadowBlur:M,textShadowColor:ee,textShadowOffsetX:F,textShadowOffsetY:_,angle:J,scale:T,underline:B,fontStyle:N,fontVariant:u}=o||{};this._text=`${a}`,this._textHeight=v||10,this._color=h,this._backgroundColor=w,this._padding=L||0,this._borderWidth=G||0,this._borderRadius=k||0,this._borderColor=D||"white",this._strokeWidth=f||0,this._strokeColor=O||"white",this._fontFace=C||"Arial",this._fontSize=j||90,this._fontWeight=(V==null?void 0:V.toString())||"normal",this._textAlign=R||"start",this._fontStyle=N||"normal",this._fontVariant=u||"normal",this._textShadowBlur=M||0,this._textShadowColor=ee,this._textShadowOffsetX=F||0,this._textShadowOffsetY=_||0,this._angle=J||0,this._textScale=T||1,this._underline=B||!1,this._canvas=document.createElement("canvas"),this._genCanvas()}get text(){return this._text}set text(o){this._text=o,this._genCanvas()}get textHeight(){return this._textHeight}set textHeight(o){this._textHeight=o,this._genCanvas()}get color(){return this._color}set color(o){this._color=o,this._genCanvas()}get backgroundColor(){return this._backgroundColor}set backgroundColor(o){this._backgroundColor=o,this._genCanvas()}get padding(){return this._padding}set padding(o){this._padding=o,this._genCanvas()}get borderWidth(){return this._borderWidth}set borderWidth(o){this._borderWidth=o,this._genCanvas()}get borderRadius(){return this._borderRadius}set borderRadius(o){this._borderRadius=o,this._genCanvas()}get borderColor(){return this._borderColor}set borderColor(o){this._borderColor=o,this._genCanvas()}get fontFace(){return this._fontFace}set fontFace(o){this._fontFace=o,this._genCanvas()}get fontSize(){return this._fontSize}set fontSize(o){this._fontSize=o,this._genCanvas()}get fontWeight(){return this._fontWeight}set fontWeight(o){this._fontWeight=o,this._genCanvas()}get strokeWidth(){return this._strokeWidth}set strokeWidth(o){this._strokeWidth=o,this._genCanvas()}get strokeColor(){return this._strokeColor}set strokeColor(o){this._strokeColor=o,this._genCanvas()}get textAlign(){return this._textAlign}set textAlign(o){this._textAlign=o,this._genCanvas()}get textShadowBlur(){return this._textShadowBlur}set textShadowBlur(o){this._textShadowBlur=o,this._genCanvas()}get textShadowColor(){return this._textShadowColor}set textShadowColor(o){this._textShadowColor=o,this._genCanvas()}get textShadowOffsetX(){return this._textShadowOffsetX}set textShadowOffsetX(o){this._textShadowOffsetX=o,this._genCanvas()}get textShadowOffsetY(){return this._textShadowOffsetY}set textShadowOffsetY(o){this._textShadowOffsetY=o,this._genCanvas()}get angle(){return this._angle}set angle(o){this._angle=o,this._genCanvas()}get textScale(){return this._textScale}set textScale(o){this._textScale=o,this._genCanvas()}get underline(){return this._underline}set underline(o){this._underline=o,this._genCanvas()}get fontStyle(){return this._fontStyle}set fontStyle(o){this._fontStyle=o,this._genCanvas()}get fontVariant(){return this._fontVariant}set fontVariant(o){this._fontVariant=o,this._genCanvas()}_genCanvas(){const o=this._canvas,a=o.getContext("2d"),v=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],h=v.map(_=>_*this.fontSize*.1),w=(Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius]).map(_=>_*this.fontSize*.1),L=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],G=L.map(_=>_*this.fontSize*.1),k=this.text.split(`
`),D=this.font;a.font=D;const f=Math.max(...k.map(_=>a.measureText(_).width)),O=4*this.strokeWidth+(this.underline?this.fontSize/15*4:this.fontSize/15),C=(this.fontSize+O)*k.length;if(o.width=f+2*h[0]+2*G[0],o.height=C+2*h[1]+2*G[1],this.borderWidth){if(a.strokeStyle=getSpriteTextColor(this.borderColor),h[0]){const _=h[0]/2;a.lineWidth=h[0],a.beginPath(),a.moveTo(_,w[0]),a.lineTo(_,o.height-w[3]),a.moveTo(o.width-_,w[1]),a.lineTo(o.width-_,o.height-w[2]),a.stroke()}if(h[1]){const _=h[1]/2;a.lineWidth=h[1],a.beginPath(),a.moveTo(Math.max(h[0],w[0]),_),a.lineTo(o.width-Math.max(h[0],w[1]),_),a.moveTo(Math.max(h[0],w[3]),o.height-_),a.lineTo(o.width-Math.max(h[0],w[2]),o.height-_),a.stroke()}if(this.borderRadius){const _=Math.max(...h),J=_/2;a.lineWidth=_,a.beginPath(),[!!w[0]&&[w[0],J,J,w[0]],!!w[1]&&[o.width-w[1],o.width-J,J,w[1]],!!w[2]&&[o.width-w[2],o.width-J,o.height-J,o.height-w[2]],!!w[3]&&[w[3],J,o.height-J,o.height-w[3]]].filter(T=>T).forEach(T=>{const[B,N,u,c]=T;a.moveTo(B,u),a.quadraticCurveTo(N,u,N,c)}),a.stroke()}}this.backgroundColor&&(a.fillStyle=getSpriteTextColor(this.backgroundColor),this.borderRadius?(a.beginPath(),a.moveTo(h[0],w[0]),[[h[0],w[0],o.width-w[1],h[1],h[1],h[1]],[o.width-h[0],o.width-h[0],o.width-h[0],h[1],w[1],o.height-w[2]],[o.width-h[0],o.width-w[2],w[3],o.height-h[1],o.height-h[1],o.height-h[1]],[h[0],h[0],h[0],o.height-h[1],o.height-w[3],w[0]]].forEach(([_,J,T,B,N,u])=>{a.quadraticCurveTo(_,B,J,N),a.lineTo(T,u)}),a.closePath(),a.fill()):a.fillRect(h[0],h[1],o.width-2*h[0],o.height-2*h[1])),a.translate(h[0],h[1]),a.translate(G[0],G[1]),a.font=D,a.fillStyle=getSpriteTextColor(this.color),a.textBaseline="bottom",a.shadowBlur=this.textShadowBlur,a.shadowColor=new THREE.Color(this.textShadowColor).getStyle(),a.shadowOffsetX=this.textShadowOffsetX,a.shadowOffsetY=this.textShadowOffsetY;const j=this.strokeWidth>0;j&&(a.lineWidth=this.strokeWidth*this.fontSize/10,a.strokeStyle=getSpriteTextColor(this.strokeColor));const V=this.textAlign==="center",R=this.textAlign==="start"||this.textAlign==="left";k.forEach(async(_,J)=>{let T=V?2:1;const B=a.measureText(_).width,N=R?0:(f-B)/T,u=(J+1)*(this.fontSize+O);j&&a.strokeText(_,N,u),a.fillText(_,N,u),this.underline&&a.fillRect(N,o.height-this.fontSize/25,B,this.fontSize/25)}),this.material.map&&this.material.map.dispose();const M=this.material.map=new THREE.Texture(o);M.minFilter=THREE.LinearFilter,M.needsUpdate=!0;const ee=this.textHeight*k.length+2*v[1]+2*L[1],F=ee*o.width/o.height;this.scale.set(F,ee,this.scale.z),this.material.rotation=this.angle,this.scale.applyMatrix4(new THREE.Matrix4().makeScale(this.textScale,this.textScale,1))}clone(){return new this.constructor(this.text,this.textHeight,this.color).copy(THREE.Sprite.prototype.clone.call(this))}copy(o){return THREE.Sprite.prototype.copy.call(this,o),this.color=o.color,this.backgroundColor=o.backgroundColor,this.padding=o.padding,this.borderWidth=o.borderWidth,this.borderColor=o.borderColor,this.fontFace=o.fontFace,this.fontSize=o.fontSize,this.fontWeight=o.fontWeight,this.strokeWidth=o.strokeWidth,this.strokeColor=o.strokeColor,this.textAlign=o.textAlign,this.textShadowBlur=o.textShadowBlur,this.textShadowColor=o.textShadowColor,this.textShadowOffsetX=o.textShadowOffsetX,this.textShadowOffsetY=o.textShadowOffsetY,this.angle=o.angle,this.textScale=o.textScale,this}get font(){return toCSSFont(this.fontFace,this.fontSize,this.fontStyle,this.fontVariant,this.fontWeight)}checkFontFace(){try{const{fontFace:o}=this;return document.fonts.check(o)}catch{}return!0}async loadFontFace(){try{const{fontFace:o}=this;await document.fonts.load(o)}catch{}}dispose(){var o;(o=this.material.map)===null||o===void 0||o.dispose(),this.material.dispose(),this.geometry.dispose(),this.dispatchEvent({type:"dispose"})}}_SpriteText=b}return _SpriteText}MxDbEllipse.cmd="Mx_Ellipse",MxDbEllipse.draw=drawMxDbEllipse,addRegisterMxDbEntity(MxDbEllipse);const propertyDbKeys$2=["text","position","height","backgroundColor","padding","borderWidth","borderRadius","borderColor","fontFace","fontSize","fontWeight","strokeWidth","strokeColor","angle","textAlign","textShadowBlur","textShadowColor","textShadowOffsetX","textShadowOffsetY","scale","underline"];class MxDbText extends MxDbEntity{constructor(){super(...arguments),this.position=new THREE.Vector3,this._text="",this._height=16,this._angle=0,this._scale=1,this._underline=!1}setPosition(r){return this.position=r,this}get text(){return this.spriteText?this.spriteText.text:this._text}set text(r){this.spriteText?this.spriteText.text=r:this._text=r}setText(r){return this.text=r,this}get height(){return this.spriteText?this.spriteText.textHeight:this._height}set height(r){this.spriteText?this.spriteText.textHeight=r:this._height=r}setHeight(r){return this.height=r,this}get backgroundColor(){return this.spriteText?this.spriteText.backgroundColor:this._backgroundColor}set backgroundColor(r){this.spriteText?this.spriteText.backgroundColor=r:this._backgroundColor=r}setBackgroundColor(r){return this.backgroundColor=r,this}get padding(){return this.spriteText?this.spriteText.padding:this._padding}set padding(r){this.spriteText?this.spriteText.padding=r:this._padding=r}setPadding(r){return this.padding=r,this}get borderWidth(){return this.spriteText?this.spriteText.borderWidth:this._borderWidth}set borderWidth(r){this.spriteText?this.spriteText.borderWidth=r:this._borderWidth=r}setBorderWidth(r){return this.borderWidth=r,this}get borderRadius(){return this.spriteText?this.spriteText.borderRadius:this._borderRadius}set borderRadius(r){this.spriteText?this.spriteText.borderRadius=r:this._borderRadius=r}setBorderRadius(r){return this.borderRadius=r,this}get borderColor(){return this.spriteText?this.spriteText.borderColor:this._borderColor}set borderColor(r){this.spriteText?this.spriteText.borderColor=r:this._borderColor=r}setBorderColor(r){return this.borderColor=r,this}get fontFace(){return this.spriteText?this.spriteText.fontFace:this._fontFace}set fontFace(r){this.spriteText?this.spriteText.fontFace=r:this._fontFace=r}setFontFace(r){return this.fontFace=r,this}get fontSize(){return this.spriteText?this.spriteText.fontSize:this._fontSize}set fontSize(r){this.spriteText?this.spriteText.fontSize=r:this._fontSize=r}setFontSize(r){return this.fontSize=r,this}get fontWeight(){return this.spriteText?this.spriteText.fontWeight:this._fontWeight}set fontWeight(r){this.spriteText?this.spriteText.fontWeight=r:this._fontWeight=r}setFontWeight(r){return this.fontWeight=r,this}get strokeWidth(){return this.spriteText?this.spriteText.strokeWidth:this._strokeWidth}set strokeWidth(r){this.spriteText?this.spriteText.strokeWidth=r:this._strokeWidth=r}setStrokeWidth(r){return this.strokeWidth=r,this}get strokeColor(){return this.spriteText?this.spriteText.strokeColor:this._strokeColor}set strokeColor(r){this.spriteText?this.spriteText.strokeColor=r:this._strokeColor=r}setStrokeColor(r){return this.strokeColor=r,this}get textAlign(){return this.spriteText?this.spriteText.textAlign:this._textAlign}set textAlign(r){this.spriteText?this.spriteText.textAlign=r:this._textAlign=r}setTextAlign(r){return this.textAlign=r,this}get textShadowBlur(){return this.spriteText?this.spriteText.textShadowBlur:this._textShadowBlur}set textShadowBlur(r){this.spriteText?this.spriteText.textShadowBlur=r:this._textShadowBlur=r}setTextShadowBlur(r){return this.textShadowBlur=r,this}get textShadowColor(){return this.spriteText?this.spriteText.textShadowColor:this._textShadowColor}set textShadowColor(r){this.spriteText?this.spriteText.textShadowColor=r:this._textShadowColor=r}setTextShadowColor(r){return this.textShadowColor=r,this}get textShadowOffsetX(){return this.spriteText?this.spriteText.textShadowOffsetX:this._textShadowOffsetX}set textShadowOffsetX(r){this.spriteText?this.spriteText.textShadowOffsetX=r:this._textShadowOffsetX=r}setTextShadowOffsetX(r){return this.textShadowOffsetX=r,this}get textShadowOffsetY(){return this.spriteText?this.spriteText.textShadowOffsetY:this._textShadowOffsetY}set textShadowOffsetY(r){this.spriteText?this.spriteText.textShadowOffsetY=r:this._textShadowOffsetY=r}setTextShadowOffsetY(r){return this.textShadowOffsetY=r,this}get angle(){return this.spriteText?this.spriteText.angle:this._angle}set angle(r){this.spriteText?this.spriteText.angle=r:this._angle=r}setAngle(r){return this.angle=r,this}get scale(){return this.spriteText?this.spriteText.textScale:this._scale}set scale(r){this.spriteText?this.spriteText.textScale=r:this._scale=r}setScale(r){return this.scale=r,this}get underline(){return this.spriteText?this.spriteText.underline:this._underline}set underline(r){this.spriteText?this.spriteText.underline=r:this._underline=r}setUnderline(r){this.underline=r}getTypeName(){return"MxDbText"}worldDraw(r){if(this.text.length>0){r.getType()!==McGiWorldDrawType$1.kWorldDraw||this.spriteText||this.createSpriteText(),this.color!==this.spriteText.color&&(this.spriteText.color=this.color),this.spriteText.material.setValues({opacity:this.opacity,visible:this.visible});const{x:o,y:a,z:v}=this.position;this.spriteText.position.set(o,a,v),r.drawEntity(this.spriteText)}}createSpriteText(){const r=getSpriteTextClass(),{text:o,height:a,color:v,backgroundColor:h,padding:w,borderWidth:L,borderRadius:G,borderColor:k,strokeWidth:D,strokeColor:f,fontFace:O,fontSize:C,fontWeight:j,textAlign:V,textShadowBlur:R,textShadowColor:M,textShadowOffsetX:ee,textShadowOffsetY:F,angle:_,scale:J,underline:T}=this;this.spriteText=new r({text:o,textHeight:a,color:v,backgroundColor:h,padding:w,borderWidth:L,borderRadius:G,borderColor:k,strokeWidth:D,strokeColor:f,fontFace:O,fontSize:C,fontWeight:j,textAlign:V,textShadowBlur:R,textShadowColor:M,textShadowOffsetX:ee,textShadowOffsetY:F,angle:_,scale:J,underline:T})}getGripPoints(){return[this.position]}moveGripPointsAt(r,o){return r===0&&this.position.add(o),!0}create(){return new MxDbText}dwgIn(r){var o,a;return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys$2),typeof r.path=="string"&&(r.path=JSON.parse(r.path)),((a=(o=r==null?void 0:r.path)===null||o===void 0?void 0:o.metadata)===null||a===void 0?void 0:a.generator)==="Curve.toJSON"&&(r.path=new THREE.Path().fromJSON(r.path)),r.type===MxType.MxCloneType.kMxFileClone||r.type===MxType.MxCloneType.kSaveDwgClone?this.createSpriteText():this.spriteText=r.spriteText,!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys$2),r.type===MxType.MxCloneType.kMxFileClone||r.type===MxType.MxCloneType.kSaveDwgClone?r.spriteText=void 0:r.spriteText=this.spriteText,r}getGeomExtents(){return new THREE.Box3().expandByObject(this.spriteText)}erase(){return super.erase(),this.spriteText&&this.spriteText.dispose(),!0}}function createCurvePath(b=!1){const r=new THREE.CurvePath;return r.autoClose=b,r}function createQuadraticBezierCurve3(b){let r=0,o=[];for(let a=0;a<b.length;a++){const v=b[r],h=b[++r]||v,w=b[++r]||h;if(!v||!h||!w)break;o.push(new THREE.QuadraticBezierCurve3(v,h,w))}return o}function createCubicBezierCurve3(b){let r=0,o=[];for(let a=0;a<b.length;a++){const v=b[r],h=b[++r]||v,w=b[++r]||h,L=b[++r]||w;if(!(v&&h&&w&&L))break;o.push(new THREE.CubicBezierCurve3(v,h,w,L))}return o}function getCurveColorGradientData(b,r){let o=0,a=[],v=[];const h=Number((1/r.length).toFixed(2));let w=new THREE.Color(r[o]),L=new THREE.Color(r[o+1]);for(let G=0,k=b.length;G<k;G++){const D=b[G],f=G/b.length;f/o>=h&&(o++,L.set(new THREE.Color(r[o]||r[--o]))),a.push(D.x,D.y,D.z||0),w.lerpHSL(L,f),v.push(w.r,w.g,w.b)}return[a,v]}function getColorGradientData(b,r){let o=[],a=[];for(let v=0,h=b.length;v<h;v++){const w=b[v];o.push(w.x,w.y,w.z||0);const L=new THREE.Color(r[v]);a.push(L.r,L.g,L.b)}return[o,a]}MxDbText.cmd="Mx_Text",MxDbText.draw=drawMxDbText,addRegisterMxDbEntity(MxDbText);const propertyDbKeys$1=["points","colors","linecap","linejoin","closed","curveType","tension","bezierType"];class MxDbGradientLine extends MxDbEntity{constructor(){super(...arguments),this.linecap="round",this.linejoin="round",this.closed=!1,this.curveType="centripetal",this.tension=0,this.bezierType="quadratic"}create(){return new MxDbGradientLine}getTypeName(){return"MxDbGradientLine"}setPoints(r){return this.points=r,this}setColors(r){return this.colors=r,this}addColor(r){return this.colors.push(r),this}setLinecap(r){this.linecap=r}setClosed(r){this.closed=r}setCurveType(r){this.curveType=r}setTension(r){this.tension=r}setBezierType(r){this.bezierType=r}worldDraw(r){const o=r.getType();let a=this.getPoints();const{closed:v,curveType:h,tension:w,bezierType:L}=this,G=new THREE.BufferGeometry;let k=[],D=[];const f=L==="cubic",O=L==="quadratic";w!==0?this.curve=new THREE.CatmullRomCurve3(a,v,h,w):L?(this.curve=createCurvePath(v),f?this.curve.curves=createCubicBezierCurve3(a):O?this.curve.curves=createQuadraticBezierCurve3(a):this.curve=void 0):this.curve=void 0,this.curve&&(a=this.curve.getPoints(50));const{linecap:C,linejoin:j}=this;let V;if(this.colors&&this.colors.length>1){const M=v?[...this.colors,this.colors[0]]:this.colors;[k,D]=this.curve?getCurveColorGradientData(a,M):getColorGradientData(a,M),G.setAttribute("position",new THREE.Float32BufferAttribute(k,3)),G.setAttribute("color",new THREE.Float32BufferAttribute(D,3)),V=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,linecap:C,linejoin:j})}else G.setFromPoints(a),V=new THREE.LineBasicMaterial({color:this.color,linecap:C,linejoin:j});const R=v?new THREE.LineLoop(G,V):new THREE.Line(G,V);if(r.drawEntity(R),(o===McGiWorldDrawType$1.kSelectDraw||o===McGiWorldDrawType$1.kDynDragDraw)&&this.curve){let M=this.getPoints();const ee=r.getLineWidth();r.setLineWidth(1),r.drawLines(M),r.setLineWidth(ee)}}getGripPoints(){return this.getPoints()}getPoints(){return this.closed?[...this.points,this.points[0]]:this.points}moveGripPointsAt(r,o){return this.move(r,o),!0}move(r,o){return this.points[r].add(o),this}dwgIn(r){return this.dwgInHelp(r,propertyDbKeys$1),this.curve=r.curve,!0}dwgOut(r){return this.dwgOutHelp(r,propertyDbKeys$1),r.curve=this.curve,r}}function drawMxDbEllipseArc(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;let a=new MxDbEllipseArc;b.setUserDraw(o),b.go(async()=>{a.center=b.value(),o.setDraw((v,h)=>{a.startPoint=v,a.yRadius=a.center.distanceTo(v),h.drawCustomEntity(a)}),a.startPoint=await b.go()||new THREE.Vector3,o.setDraw((v,h)=>{a.endPoint=v,h.drawCustomEntity(a)}),a.endPoint=await b.go()||new THREE.Vector3,r.addMxEntity(a)})}addRegisterMxDbEntity(MxDbGradientLine);class MxDbEllipseArc extends MxDbEllipseShape{getTypeName(){return"MxDbEllipseArc"}constructor(){super(),this._propertyDbKeys=[...this._propertyDbKeys,"startPoint","endPoint"]}setStartPoint(r){return this.startPoint=r,this}setEndPoint(r){return this.endPoint=r,this}worldDraw(r){let{center:o,startPoint:a,endPoint:v}=this;a&&(this.xRadius=o.distanceTo(a),this.startAngle=THREE.MathUtils.degToRad(calculateArcAngle(a,o,this.xRadius).angle)),v&&(this.yRadius=o.distanceTo(v),this.endAngle=THREE.MathUtils.degToRad(calculateArcAngle(v,o,this.yRadius).angle)),this.drawEllipseShape(r)}getGripPoints(){return[this.center,this.startPoint,this.endPoint]}moveGripPointsAt(r,o){return r===0&&(this.center.add(o),this.startPoint.add(o),this.endPoint.add(o)),r===1&&this.startPoint.add(o),r===2&&this.endPoint.add(o),!0}}function drawMxDbCircleArc(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;let a=new MxDbCircleArc;a.stroke="#ff0000",b.setUserDraw(o),b.setMessage(`
确定圆弧中点:`),b.go(async()=>{a.center=b.value(),o.setDraw(v=>{o.drawLine(a.center,v)}),b.setMessage(`
确定圆弧开始点:`),a.startPoint=await b.go()||new THREE.Vector3,o.setDraw(v=>{a.endPoint=v,o.drawCustomEntity(a)}),b.setMessage(`
确定圆弧结束点:`),a.endPoint=await b.go()||new THREE.Vector3,o.setDraw(()=>{}),r.addMxEntity(a)})}MxDbEllipseArc.cmd="Mx_MxDbEllipseArc",MxDbEllipseArc.draw=drawMxDbEllipseArc,addRegisterMxDbEntity(MxDbEllipseArc);class MxDbCircleArc extends MxDbCircleShape{constructor(){super(),this._propertyDbKeys=[...this._propertyDbKeys,"startPoint","endPoint"]}getTypeName(){return"MxDbCircleArc"}setStartPoint(r){return this.startPoint=r,this}setEndPoint(r){return this.endPoint=r,this}worldDraw(r){let{startPoint:o,endPoint:a}=this;if(o&&(this.startAngle=this.computePointAngle(o)),a&&(this.endAngle=this.computePointAngle(a)),o&&a){const{points:v}=this.drawEllipseShape(r);this.startPoint=v[0]}}computePointAngle(r){return this.radius=this.center.distanceTo(r),THREE.MathUtils.degToRad(calculateArcAngle(r,this.center,this.radius).angle)}getGripPoints(){return[this.center,this.startPoint,this.endPoint]}moveGripPointsAt(r,o){return r===0?(this.center.add(o),this.startPoint.add(o),this.endPoint.add(o)):r===1?this.startPoint.add(o):r===2&&this.endPoint.add(o),!0}}MxDbCircleArc.cmd="Mx_MxDbCircleArc",MxDbCircleArc.draw=drawMxDbCircleArc,addRegisterMxDbEntity(MxDbCircleArc);class MxDbArcShape extends MxDbCircleArc{constructor(){super(),this.center=new THREE.Vector3,this.innerRadius=10,this.outerRadius=20,this._propertyDbKeys=[...this._propertyDbKeys,"center","innerRadius","outerRadius"]}getTypeName(){return"MxDbArcShape"}worldDraw(r){r.getType()===McGiWorldDrawType$1.kDynDragDraw?(r.drawCircle(this.center,this.innerRadius),r.drawCircle(this.center,this.outerRadius)):this.drawArcShape(r)}drawArcShape(r){const{center:o,startAngle:a,endAngle:v,clockwise:h}=this,{x:w,y:L}=o;this.isClosedToCenter=!1;const G=this.createEllipseCurve(w,L,this.innerRadius,this.innerRadius,a,v,h),k=this.createEllipseCurve(w,L,this.outerRadius,this.outerRadius,v,a,!h),D=this.createPaths([G,k]);let f=this.getShapePoints(D);this._draw(r,f),this._drawStoreLine(r,f)}getGripPoints(){return[this.center]}moveGripPointsAt(r,o){return r===0&&this.center.add(o),!0}}function drawMxDbArcShape(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;let a=new MxDbArcShapeDraw;b.setMessage(`
确定圆弧中点:`),b.setUserDraw(o),b.go(async()=>{b.setMessage(`
确定圆弧开始点:`),a.center=b.value(),o.setDraw(v=>{a.interRadiusPoint=v,o.drawCircle(a.center,v.distanceTo(a.center))}),a.interRadiusPoint=await b.go()||new THREE.Vector3,o.setDraw(v=>{a.outerRadiusPoint=v,o.drawCustomEntity(a)}),a.outerRadiusPoint=await b.go()||new THREE.Vector3,r.addMxEntity(a)})}class MxDbArcShapeDraw extends MxDbArcShape{getTypeName(){return"MxDbArcShapeDraw"}constructor(){super(),this.outerRadiusPoint=new THREE.Vector3,this.interRadiusPoint=new THREE.Vector3,this._propertyDbKeys=[...this._propertyDbKeys,"interRadiusPoint","outerRadiusPoint"]}worldDraw(r){this.innerRadius=this.center.distanceTo(this.interRadiusPoint),this.outerRadius=this.center.distanceTo(this.outerRadiusPoint),this.startAngle=THREE.MathUtils.degToRad(calculateArcAngle(this.interRadiusPoint,this.center,this.innerRadius).angle),this.endAngle=THREE.MathUtils.degToRad(calculateArcAngle(this.outerRadiusPoint,this.center,this.outerRadius).angle),this.drawArcShape(r)}getGripPoints(){return[this.center,this.interRadiusPoint,this.outerRadiusPoint]}moveGripPointsAt(r,o){return r===0&&(this.center.add(o),this.interRadiusPoint.add(o),this.outerRadiusPoint.add(o)),r===1&&this.interRadiusPoint.add(o),r===2&&this.outerRadiusPoint.add(o),!0}}function drawMxDbRingShape(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;b.setUserDraw(o);const a=new McEdGetPointWorldDrawObject,v=new MxDbRingShapeDraw;b.setUserDraw(a),b.setMessage(`
确定圆弧开始点:`),b.go(async h=>{console.log(123),v.center=b.value(),a.setDraw(w=>{a.drawCircle(v.center,v.center.distanceTo(w))}),v.innerPoint=await b.go()||new THREE.Vector3,a.setDraw(w=>{v.outerPoint=w,a.drawCustomEntity(v)}),v.outerPoint=await b.go()||new THREE.Vector3,r.addMxEntity(v)})}MxDbArcShapeDraw.isRegister=!1,MxDbArcShapeDraw.cmd="Mx_MxDbArcShape",MxDbArcShapeDraw.draw=drawMxDbArcShape,addRegisterMxDbEntity(MxDbArcShapeDraw);class MxDbRingShape extends MxDbArcShape{getTypeName(){return"MxDbRingShape"}worldDraw(r){const{center:o,startAngle:a,endAngle:v,clockwise:h}=this,{x:w,y:L}=o;this.isClosedToCenter=!1;const G=this.createEllipseCurve(w,L,this.innerRadius,this.innerRadius,a,v,h),k=this.createEllipseCurve(w,L,this.outerRadius,this.outerRadius,a,v,!h),D=this.createPaths([G,k]);let f=this.getShapePoints(D);const O=this.createPaths(G);let C=this.getShapePoints(O);const j=this.createPaths(k);let V=this.getShapePoints(j);this.isFill?(this._draw(r,f),this._drawStoreLine(r,C),this._drawStoreLine(r,V)):(this._draw(r,C),this._drawStoreLine(r,C),this._draw(r,V),this._drawStoreLine(r,V))}}MxDbRingShape.isRegister=!1,MxDbRingShape.cmd="Mx_MxDbRingShape",MxDbRingShape.draw=drawMxDbRingShape;class MxDbRingShapeDraw extends MxDbRingShape{constructor(){super(),this.innerPoint=new THREE.Vector3,this.outerPoint=new THREE.Vector3,this._propertyDbKeys=[...this._propertyDbKeys,"innerPoint","outerPoint"]}getGripPoints(){return[this.center,this.innerPoint,this.outerPoint]}moveGripPointsAt(r,o){return r===0&&(this.center.add(o),this.innerPoint.add(o),this.outerPoint.add(o)),r===1&&this.innerPoint.add(o),r===2&&this.outerPoint.add(o),!0}worldDraw(r){this.innerPoint&&(this.innerRadius=this.center.distanceTo(this.innerPoint)),this.outerPoint&&(this.outerRadius=this.center.distanceTo(this.outerPoint)),super.worldDraw(r)}}function drawMxDbStarShape(){const b=new MrxDbgUiPrPoint,r=MxFun.getCurrentDraw(),o=new McEdGetPointWorldDrawObject;b.setUserDraw(o);const a=new McEdGetPointWorldDrawObject,v=new MxDbStarShapeDraw;b.setUserDraw(a),b.setMessage(`
确定圆弧开始点:`),b.go(async h=>{v.center=b.value(),a.setDraw(w=>{v.innerPoint=w,a.drawCircle(v.center,v.center.distanceTo(w))}),v.innerPoint=await b.go()||new THREE.Vector3,a.setDraw(w=>{v.outerPoint=w,a.drawCustomEntity(v)}),v.outerPoint=await b.go()||new THREE.Vector3,r.addMxEntity(v)})}addRegisterMxDbEntity(MxDbRingShape);class MxDbStarShape extends MxDbShape{getTypeName(){return"MxDbStarShape"}constructor(){super(),this.center=new THREE.Vector3,this.numPoints=10,this.innerRadius=10,this.outerRadius=10,this._propertyDbKeys=[...this._propertyDbKeys,"center","numPoints","innerRadius","outerRadius"]}worldDraw(r){const{x:o,y:a}=this.center,v=new THREE.Path;v.moveTo(o,a-this.outerRadius);for(let L=1;L<2*this.numPoints;L++){const G=L%2==0?this.outerRadius:this.innerRadius,k=G*Math.sin(L*Math.PI/this.numPoints)+o,D=-1*G*Math.cos(L*Math.PI/this.numPoints)+a;v.lineTo(k,D)}v.closePath();const h=this.createPaths(v),w=this.getShapePoints(h);this._draw(r,w),this._drawStoreLine(r,w)}getGripPoints(){return[this.center]}moveGripPointsAt(r,o){return r===0&&this.center.add(o),!0}}MxDbStarShape.cmd="Mx_MxDbStarShape",MxDbStarShape.draw=drawMxDbStarShape;class MxDbStarShapeDraw extends MxDbStarShape{constructor(){super(),this.innerPoint=new THREE.Vector3,this.outerPoint=new THREE.Vector3,this._propertyDbKeys=[...this._propertyDbKeys,"innerPoint","outerPoint"]}getGripPoints(){return[this.center,this.innerPoint,this.outerPoint]}moveGripPointsAt(r,o){return r===0&&(this.center.add(o),this.innerPoint.add(o),this.outerPoint.add(o)),r===1&&this.innerPoint.add(o),r===2&&this.outerPoint.add(o),!0}worldDraw(r){this.innerPoint&&(this.innerRadius=this.center.distanceTo(this.innerPoint)),this.outerPoint&&(this.outerRadius=this.center.distanceTo(this.outerPoint)),super.worldDraw(r)}}addRegisterMxDbEntity(MxDbStarShape);class MxDbRegularPolygonShape extends MxDbShape{getTypeName(){return"MxDbRegularPolygonShape"}constructor(){super(),this.center=new THREE.Vector3,this.sidesNumber=6,this.radius=70,this._propertyDbKeys=[...this._propertyDbKeys,"center","sidesNumber","radius"]}worldDraw(r){this._drawPolygonShape(r)}_drawPolygonShape(r){const o=this._getPoints(),a=new THREE.Path;a.moveTo(o[0].x,o[0].y);for(let w=0;w<o.length;w++)a.lineTo(o[w].x,o[w].y);a.closePath();const v=this.createPaths(a),h=this.getShapePoints(v);this._draw(r,h),this._drawStoreLine(r,h)}_getPoints(){const{sidesNumber:r,radius:o}=this,{x:a,y:v}=this.center,h=[];for(let w=0;w<r;w++)h.push({x:o*Math.sin(2*w*Math.PI/r)+a,y:-1*o*Math.cos(2*w*Math.PI/r)+v});return h}getGripPoints(){return[this.center]}moveGripPointsAt(r,o){return r===0&&this.center.add(o),!0}}function getScreenPixel(b,r){let o=MxFun.screenCoordLong2World(r?b:b-b/3);return o=MxFun.worldCoordLong2Doc(o)}function drawMxDbArrow(){const b=new McEdGetPointWorldDrawObject,r=new MxDbArrow,o=MxFun.getCurrentDraw(),a=new MrxDbgUiPrPoint;a.setUserDraw(b),r.setLineWidth(10),a.go(()=>{r.innerOffset=getScreenPixel(10),r.outerOffset=getScreenPixel(22),r.topOffset=getScreenPixel(36),r.startPoint=a.value(),b.setDraw(v=>{r.endPoint=v,b.drawCustomEntity(r)}),a.go(async v=>{r.endPoint=a.value(),o.addMxEntity(r)})})}addRegisterMxDbEntity(MxDbRegularPolygonShape);class MxDbArrow extends MxDbShape{constructor(){super(),this.isSharpCorner=!1,this.innerOffset=10,this.outerOffset=22,this.topOffset=36,this.startPoint=new THREE.Vector3,this.endPoint=new THREE.Vector3,this._propertyDbKeys=[...this._propertyDbKeys,"outerOffset","topOffset","innerOffset","isSharpCorner","startPoint","endPoint"]}worldDraw(r){const o=this.getArrowVertex(this.startPoint,this.endPoint);o&&(this._draw(r,o),this._drawStoreLine(r,o))}getArrowVertex(r,o,a=this.isSharpCorner){let{innerOffset:v,topOffset:h,outerOffset:w}=this;const L=[];L[3]=o;const G=Math.sqrt((r.x-o.x)*(r.x-o.x)+(r.y-o.y)*(r.y-o.y));if(G===0)return;const k=-(o.x-r.x)/G,D=(o.y-r.y)/G,f=r.x+v,O=r.y+G-h,C=r.x+w,j=r.y+G-h,V=r.x-v,R=r.y+G-h,M=r.x-w,ee=r.y+G-h;return a?(L[0]=r,L[6]=L[0]):(L[0]=new THREE.Vector3(r.x-(V-r.x)*D,r.y-(V-r.x)*k),L[6]=new THREE.Vector3(r.x+(V-r.x)*D,r.y+(V-r.x)*k),L[7]=L[0]),L[1]=new THREE.Vector3(r.x+(f-r.x)*D-(O-r.y)*k,r.y+(f-r.x)*k+(O-r.y)*D),L[2]=new THREE.Vector3(r.x+(C-r.x)*D-(j-r.y)*k,r.y+(C-r.x)*k+(j-r.y)*D),L[4]=new THREE.Vector3(r.x+(M-r.x)*D-(ee-r.y)*k,r.y+(M-r.x)*k+(ee-r.y)*D),L[5]=new THREE.Vector3(r.x+(V-r.x)*D-(R-r.y)*k,r.y+(V-r.x)*k+(R-r.y)*D),L}getGripPoints(){const r=new THREE.Vector3;return new THREE.Line3(this.startPoint,this.endPoint).getCenter(r),[this.startPoint,r,this.endPoint]}moveGripPointsAt(r,o){return r===0&&this.startPoint.add(o),r===1&&(this.startPoint.add(o),this.endPoint.add(o)),r===2&&this.endPoint.add(o),!0}getCornerRadiusPoints(r){return r}}MxDbArrow.cmd="Mx_MxDbArrow",MxDbArrow.draw=drawMxDbArrow,addRegisterMxDbEntity(MxDbArrow);class MxDbLineShape extends MxDbShape{setPoints(r){return this.points=r,this}addPoint(r){return this.points.push(r),this}removePoint(r){return this.points.splice(r,1),this}constructor(){super(),this.points=[],this._propertyDbKeys=[...this._propertyDbKeys,"points"]}getTypeName(){return"MxDbLineShape"}worldDraw(r){this._draw(r,this.points),this._drawStoreLine(r,this.points)}getGripPoints(){return this.points}moveGripPointsAt(r,o){return this.points[r].add(o),!0}getGeomExtents(){return new THREE.Box3().setFromPoints(this.points)}getGetLength(){let r=0;for(let o=0;o++;o<this.points.length)this.points[o+1]&&(r+=this.points[o].distanceTo(this.points[o+1]));return r}}async function drawMxDbSplineCurve(){const b=new MrxDbgUiPrPoint,r=new MxDbSplineCurve;b.setMessage(`
指定第一个点:`),b.goWhile(async o=>{if(o===MrxDbgUiPrBaseReturn$1.kOk)r.points.push(b.value()),b.setUserDraw((a,v)=>{const h=r.clone();h.points.push(a),v.drawCustomEntity(h),r.points.length===0?b.setMessage(`
指定第一个点:`):(b.setMessage(`
指定下一个点:`),b.setKeyWords("[闭合(C)/ 放弃(U)]"))});else if(o===MrxDbgUiPrBaseReturn$1.kKeyWord){if(b.isKeyWordPicked("C"))return r.closed=!0,{exit:!0};b.isKeyWordPicked("U")&&r.points.pop()}},()=>{MxFun.getCurrentDraw().addMxEntity(r)})}addRegisterMxDbEntity(MxDbLineShape);const propertyDbKeys=["points","closed","tension","curveType"];class MxDbSplineCurve extends MxDbEntity{constructor(){super(...arguments),this.points=[],this.closed=!1,this.tension=.5,this.curveType="centripetal"}worldDraw(r){const o=new THREE.CatmullRomCurve3(this.points,this.closed,"catmullrom",this.tension).getPoints(15*this.points.length),a=new THREE.Geometry().setFromPoints(o),v=new THREE.LineBasicMaterial({color:this.color}),h=new THREE.Line(a,v);r.drawEntity(h)}getGripPoints(){return this.points}moveGripPointsAt(r,o){return this.points[r].add(o),!0}create(){return new MxDbSplineCurve}dwgIn(r){return this.onDwgIn(r),this.dwgInHelp(r,propertyDbKeys),!0}dwgOut(r){return this.onDwgOut(r),this.dwgOutHelp(r,propertyDbKeys),r}getTypeName(){return"MxDbSplineCurve"}}MxDbSplineCurve.draw=drawMxDbSplineCurve,MxDbSplineCurve.cmd="Mx_Spline",addRegisterMxDbEntity(MxDbSplineCurve);class MrxDbgUiPrDist extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrDistClass()))}value(){return this.imp.value()}basePt(){return this.imp.basePt()}setBasePt(r){return this.imp.setBasePt(r)}setUseBasePt(r){return this.imp.setUseBasePt(r)}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.imp.value())})})}}class MrxDbgUiPrInt extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrIntClass()))}value(){return this.imp.value()}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.imp.value())})})}}class MrxDbgUiPrString extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrStringClass()))}value(){return this.imp.value()}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.imp.value())})})}}class MrxDbgUiPrKeyWord extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrKeyWordClass()))}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.keyWordPicked())})})}}class MrxDbgUiPrAngle extends MrxDbgUiPrBase{constructor(){var r;super(new((r=store.state.MxFun)===null||r===void 0?void 0:r.getMxJigCmdManager().getMrxDbgUiPrAngleClass()))}value(){return this.imp.value()}basePt(){return this.imp.basePt()}setBasePt(r){return this.imp.setBasePt(r)}setUseBasePt(r){return this.imp.setUseBasePt(r)}go(r){let o=this;return r?(o.imp.go(a=>{o.status=a,r(a)}),new Promise((a,v)=>{a(null)})):new Promise((a,v)=>{o.imp.go(h=>{o.status=h,a(h!=0?null:o.imp.value())})})}}var Mx=Object.freeze({__proto__:null,loadCoreCode,useCanvasResizeListener,store,MxFun,MxThreeJS,MxType,Mxassembly,McGeTool,MrxDbgUtils,MxPaintBrush,MrxDbgUiPrPoint,McEdGetPointWorldDrawObject,MrxDbgUiPrBaseReturn:MrxDbgUiPrBaseReturn$1,MxDbEntity,MxDbImage,MxDbSVG,MxDbSVGText,MxDbPolyline,MxDb2LineAngularDimension,Mx3PointArc,Mx2PointArc,MxDbCoord,MxDbLine,MxDbRect,MxDbAlignedDimension,MxFilters,McGiWorldDrawType:McGiWorldDrawType$1,MxDbArea,MxDbLeadTag,MxDbAnyLine,MxDbCloudLine,MxDbRegularPolygon,MxDbLeadComment,MxDbRectBoxLeadComment,MxDbEllipse,MxDbText,MxDrawObject,MxDbHatch,MxDbDatabase,MxDbGradientLine,MxDbShape,MxDbEllipseShape,MxDbEllipseArc,MxDbCircleShape,MxDbCircleArc,MxDbArcShapeDraw,MxDbRingShape,MxDbStarShape,MxDbRegularPolygonShape,MxDbArrow,MxDbLineShape,Layer,MxDbSplineCurve,MrxDbgUiPrBase,get MxCursorType(){return MxCursorType},get DetailedResult(){return DetailedResult},get DynamicInputType(){return DynamicInputType},get UserInputControls(){return UserInputControls},MrxDbgUiPrDist,MrxDbgUiPrInt,MrxDbgUiPrString,MrxDbgUiPrKeyWord,MrxDbgUiPrAngle,MxTempMarkDraw}),elementResizeEventPolyfill_umd_min=createCommonjsModule(function(b,r){b.exports=function(o){var a={};function v(h){if(a[h])return a[h].exports;var w=a[h]={i:h,l:!1,exports:{}};return o[h].call(w.exports,w,w.exports,v),w.l=!0,w.exports}return v.m=o,v.c=a,v.d=function(h,w,L){v.o(h,w)||Object.defineProperty(h,w,{enumerable:!0,get:L})},v.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},v.t=function(h,w){if(1&w&&(h=v(h)),8&w||4&w&&typeof h=="object"&&h&&h.__esModule)return h;var L=Object.create(null);if(v.r(L),Object.defineProperty(L,"default",{enumerable:!0,value:h}),2&w&&typeof h!="string")for(var G in h)v.d(L,G,function(k){return h[k]}.bind(null,G));return L},v.n=function(h){var w=h&&h.__esModule?function(){return h.default}:function(){return h};return v.d(w,"a",w),w},v.o=function(h,w){return Object.prototype.hasOwnProperty.call(h,w)},v.p="",v(v.s="fae3")}({"6dd8":function(o,a,v){(function(h){var w=function(){if(typeof Map<"u")return Map;function X(W,te){var ne=-1;return W.some(function(ce,we){return ce[0]===te&&(ne=we,!0)}),ne}return function(){function W(){this.__entries__=[]}return Object.defineProperty(W.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),W.prototype.get=function(te){var ne=X(this.__entries__,te),ce=this.__entries__[ne];return ce&&ce[1]},W.prototype.set=function(te,ne){var ce=X(this.__entries__,te);~ce?this.__entries__[ce][1]=ne:this.__entries__.push([te,ne])},W.prototype.delete=function(te){var ne=this.__entries__,ce=X(ne,te);~ce&&ne.splice(ce,1)},W.prototype.has=function(te){return!!~X(this.__entries__,te)},W.prototype.clear=function(){this.__entries__.splice(0)},W.prototype.forEach=function(te,ne){ne===void 0&&(ne=null);for(var ce=0,we=this.__entries__;ce<we.length;ce++){var Ie=we[ce];te.call(ne,Ie[1],Ie[0])}},W}()}(),L=typeof window<"u"&&typeof document<"u"&&window.document===document,G=h!==void 0&&h.Math===Math?h:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),k=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(G):function(X){return setTimeout(function(){return X(Date.now())},1e3/60)},D=2,f=20,O=["top","right","bottom","left","width","height","size","weight"],C=typeof MutationObserver<"u",j=function(){function X(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(W,te){var ne=!1,ce=!1,we=0;function Ie(){ne&&(ne=!1,W()),ce&&Be()}function xe(){k(Ie)}function Be(){var q=Date.now();if(ne){if(q-we<D)return;ce=!0}else ne=!0,ce=!1,setTimeout(xe,te);we=q}return Be}(this.refresh.bind(this),f)}return X.prototype.addObserver=function(W){~this.observers_.indexOf(W)||this.observers_.push(W),this.connected_||this.connect_()},X.prototype.removeObserver=function(W){var te=this.observers_,ne=te.indexOf(W);~ne&&te.splice(ne,1),!te.length&&this.connected_&&this.disconnect_()},X.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},X.prototype.updateObservers_=function(){var W=this.observers_.filter(function(te){return te.gatherActive(),te.hasActive()});return W.forEach(function(te){return te.broadcastActive()}),W.length>0},X.prototype.connect_=function(){L&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),C?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},X.prototype.disconnect_=function(){L&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},X.prototype.onTransitionEnd_=function(W){var te=W.propertyName,ne=te===void 0?"":te;O.some(function(ce){return!!~ne.indexOf(ce)})&&this.refresh()},X.getInstance=function(){return this.instance_||(this.instance_=new X),this.instance_},X.instance_=null,X}(),V=function(X,W){for(var te=0,ne=Object.keys(W);te<ne.length;te++){var ce=ne[te];Object.defineProperty(X,ce,{value:W[ce],enumerable:!1,writable:!1,configurable:!0})}return X},R=function(X){return X&&X.ownerDocument&&X.ownerDocument.defaultView||G},M=B(0,0,0,0);function ee(X){return parseFloat(X)||0}function F(X){for(var W=[],te=1;te<arguments.length;te++)W[te-1]=arguments[te];return W.reduce(function(ne,ce){return ne+ee(X["border-"+ce+"-width"])},0)}function _(X){var W=X.clientWidth,te=X.clientHeight;if(!W&&!te)return M;var ne=R(X).getComputedStyle(X),ce=function(oe){for(var se={},Ae=0,Ye=["top","right","bottom","left"];Ae<Ye.length;Ae++){var Ge=Ye[Ae],Ne=oe["padding-"+Ge];se[Ge]=ee(Ne)}return se}(ne),we=ce.left+ce.right,Ie=ce.top+ce.bottom,xe=ee(ne.width),Be=ee(ne.height);if(ne.boxSizing==="border-box"&&(Math.round(xe+we)!==W&&(xe-=F(ne,"left","right")+we),Math.round(Be+Ie)!==te&&(Be-=F(ne,"top","bottom")+Ie)),!function(oe){return oe===R(oe).document.documentElement}(X)){var q=Math.round(xe+we)-W,ge=Math.round(Be+Ie)-te;Math.abs(q)!==1&&(xe-=q),Math.abs(ge)!==1&&(Be-=ge)}return B(ce.left,ce.top,xe,Be)}var J=typeof SVGGraphicsElement<"u"?function(X){return X instanceof R(X).SVGGraphicsElement}:function(X){return X instanceof R(X).SVGElement&&typeof X.getBBox=="function"};function T(X){return L?J(X)?function(W){var te=W.getBBox();return B(0,0,te.width,te.height)}(X):_(X):M}function B(X,W,te,ne){return{x:X,y:W,width:te,height:ne}}var N=function(){function X(W){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=B(0,0,0,0),this.target=W}return X.prototype.isActive=function(){var W=T(this.target);return this.contentRect_=W,W.width!==this.broadcastWidth||W.height!==this.broadcastHeight},X.prototype.broadcastRect=function(){var W=this.contentRect_;return this.broadcastWidth=W.width,this.broadcastHeight=W.height,W},X}(),u=function(){return function(X,W){var te=function(ne){var ce=ne.x,we=ne.y,Ie=ne.width,xe=ne.height,Be=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,q=Object.create(Be.prototype);return V(q,{x:ce,y:we,width:Ie,height:xe,top:we,right:ce+Ie,bottom:xe+we,left:ce}),q}(W);V(this,{target:X,contentRect:te})}}(),c=function(){function X(W,te,ne){if(this.activeObservations_=[],this.observations_=new w,typeof W!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=W,this.controller_=te,this.callbackCtx_=ne}return X.prototype.observe=function(W){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(W instanceof R(W).Element))throw new TypeError('parameter 1 is not of type "Element".');var te=this.observations_;te.has(W)||(te.set(W,new N(W)),this.controller_.addObserver(this),this.controller_.refresh())}},X.prototype.unobserve=function(W){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(W instanceof R(W).Element))throw new TypeError('parameter 1 is not of type "Element".');var te=this.observations_;te.has(W)&&(te.delete(W),te.size||this.controller_.removeObserver(this))}},X.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},X.prototype.gatherActive=function(){var W=this;this.clearActive(),this.observations_.forEach(function(te){te.isActive()&&W.activeObservations_.push(te)})},X.prototype.broadcastActive=function(){if(this.hasActive()){var W=this.callbackCtx_,te=this.activeObservations_.map(function(ne){return new u(ne.target,ne.broadcastRect())});this.callback_.call(W,te,W),this.clearActive()}},X.prototype.clearActive=function(){this.activeObservations_.splice(0)},X.prototype.hasActive=function(){return this.activeObservations_.length>0},X}(),m=typeof WeakMap<"u"?new WeakMap:new w,E=function(){return function X(W){if(!(this instanceof X))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var te=j.getInstance(),ne=new c(W,te,this);m.set(this,ne)}}();["observe","unobserve","disconnect"].forEach(function(X){E.prototype[X]=function(){var W;return(W=m.get(this))[X].apply(W,arguments)}});var U=G.ResizeObserver!==void 0?G.ResizeObserver:E;a.a=U}).call(this,v("c8ba"))},c8ba:function(o,a){var v;v=function(){return this}();try{v=v||new Function("return this")()}catch{typeof window=="object"&&(v=window)}o.exports=v},f6fd:function(o,a){(function(v){var h="currentScript",w=v.getElementsByTagName("script");h in v||Object.defineProperty(v,h,{get:function(){try{throw new Error}catch(k){var L,G=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(k.stack)||[!1])[1];for(L in w)if(w[L].src==G||w[L].readyState=="interactive")return w[L];return null}}})})(document)},fae3:function(o,a,v){var h;v.r(a),v.d(a,"EventListenerWrapper",function(){return k}),typeof window<"u"&&(v("f6fd"),(h=window.document.currentScript)&&(h=h.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(v.p=h[1]));var w=v("6dd8");const L=EventTarget.prototype.addEventListener,G=function(O){const C=document.createEvent("HTMLEvents");return C.initEvent(O),C},k=function(O){O==="resize"&&f(this),L.apply(this,arguments)};function D(O){const C=D.observer=D.observer||new w.a(O);return C.initialized=!0,C}function f(O){const C=D(j=>{if(C.initialized)C.initialized=!1;else for(let V of j){const R=G("resize");V.target.dispatchEvent(R),V&&V.target&&typeof V.target.onresize=="function"&&V.target.onresize(R)}});C.observe(O)}HTMLElement.prototype.addEventListener=k,Reflect.defineProperty(HTMLElement.prototype,"onresize",{set(O){this._onresize=O,typeof O=="function"&&f(this)},get(){return this._onresize||null}})}})}),elementResizeEventPolyfill_umd_min$1=unwrapExports(elementResizeEventPolyfill_umd_min),elementResizeEventPolyfill_umd_min$2=Object.freeze({__proto__:null,default:elementResizeEventPolyfill_umd_min$1,__moduleExports:elementResizeEventPolyfill_umd_min});export{DetailedResult,DynamicInputType,Layer,McEdGetPointWorldDrawObject,McGeTool,McGiWorldDrawType$1 as McGiWorldDrawType,MrxDbgUiPrAngle,MrxDbgUiPrBase,MrxDbgUiPrBaseReturn$1 as MrxDbgUiPrBaseReturn,MrxDbgUiPrDist,MrxDbgUiPrInt,MrxDbgUiPrKeyWord,MrxDbgUiPrPoint,MrxDbgUiPrString,MrxDbgUtils,Mx2PointArc,Mx3PointArc,MxCursorType,MxDb2LineAngularDimension,MxDbAlignedDimension,MxDbAnyLine,MxDbArcShapeDraw,MxDbArea,MxDbArrow,MxDbCircleArc,MxDbCircleShape,MxDbCloudLine,MxDbCoord,MxDbDatabase,MxDbEllipse,MxDbEllipseArc,MxDbEllipseShape,MxDbEntity,MxDbGradientLine,MxDbHatch,MxDbImage,MxDbLeadComment,MxDbLeadTag,MxDbLine,MxDbLineShape,MxDbPolyline,MxDbRect,MxDbRectBoxLeadComment,MxDbRegularPolygon,MxDbRegularPolygonShape,MxDbRingShape,MxDbSVG,MxDbSVGText,MxDbShape,MxDbSplineCurve,MxDbStarShape,MxDbText,MxDrawObject,MxFilters,MxFun,MxPaintBrush,MxTempMarkDraw,MxThreeJS,MxType,Mxassembly,UserInputControls,Mx as default,loadCoreCode,store,useCanvasResizeListener};
