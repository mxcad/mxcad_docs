[mxcad_2d API documentation] (../README. md)/[2d] (../modules/2d. md)/McObject

# Class: McObject

[2d](../modules/2d.md).McObject

The McObject class encapsulates the functionality related to MxCAD objects and provides methods to manipulate and manage these functionalities

## Table of contents

### Constructors

- [constructor](2d.McObject.md#constructor)

### Accessors

- [database](2d.McObject.md#database)
- [drawColor](2d.McObject.md#drawcolor)
- [drawColorIndex](2d.McObject.md#drawcolorindex)
- [drawDimStyle](2d.McObject.md#drawdimstyle)
- [drawLayer](2d.McObject.md#drawlayer)
- [drawLineTypeScale](2d.McObject.md#drawlinetypescale)
- [drawLineWeight](2d.McObject.md#drawlineweight)
- [drawLineWidth](2d.McObject.md#drawlinewidth)
- [drawLinetype](2d.McObject.md#drawlinetype)
- [drawPatternDefinition](2d.McObject.md#drawpatterndefinition)
- [drawTextStyle](2d.McObject.md#drawtextstyle)
- [drawUseDefaultProperties](2d.McObject.md#drawusedefaultproperties)
- [mxdraw](2d.McObject.md#mxdraw)

### Methods

- [AddTureTypeTextStyle](2d.McObject.md#addturetypetextstyle)
- [addCurrentSelect](2d.McObject.md#addcurrentselect)
- [addDimStyle](2d.McObject.md#adddimstyle)
- [addImageDefine](2d.McObject.md#addimagedefine)
- [addLayer](2d.McObject.md#addlayer)
- [addLinetype](2d.McObject.md#addlinetype)
- [addLinetypeEx](2d.McObject.md#addlinetypeex)
- [addPatternDefinition](2d.McObject.md#addpatterndefinition)
- [addSystemVarNameForEvent](2d.McObject.md#addsystemvarnameforevent)
- [addTextStyle](2d.McObject.md#addtextstyle)
- [callEvent](2d.McObject.md#callevent)
- [clearDwgBackground](2d.McObject.md#cleardwgbackground)
- [clearMxCurrentSelect](2d.McObject.md#clearmxcurrentselect)
- [create](2d.McObject.md#create)
- [destroyObject](2d.McObject.md#destroyobject)
- [drawArc](2d.McObject.md#drawarc)
- [drawArc2](2d.McObject.md#drawarc2)
- [drawArc3](2d.McObject.md#drawarc3)
- [drawBlockReference](2d.McObject.md#drawblockreference)
- [drawCircle](2d.McObject.md#drawcircle)
- [drawDimAligned](2d.McObject.md#drawdimaligned)
- [drawDimAngular](2d.McObject.md#drawdimangular)
- [drawDimDiametric](2d.McObject.md#drawdimdiametric)
- [drawDimOrdinate](2d.McObject.md#drawdimordinate)
- [drawDimRadial](2d.McObject.md#drawdimradial)
- [drawDimRotated](2d.McObject.md#drawdimrotated)
- [drawEllipse](2d.McObject.md#drawellipse)
- [drawEllipseArc](2d.McObject.md#drawellipsearc)
- [drawEntity](2d.McObject.md#drawentity)
- [drawHatch](2d.McObject.md#drawhatch)
- [drawImage](2d.McObject.md#drawimage)
- [drawLine](2d.McObject.md#drawline)
- [drawLine3d](2d.McObject.md#drawline3d)
- [drawMText](2d.McObject.md#drawmtext)
- [drawPathToHatch](2d.McObject.md#drawpathtohatch)
- [drawPathToPolyline](2d.McObject.md#drawpathtopolyline)
- [drawPathToSpline](2d.McObject.md#drawpathtospline)
- [drawPoint](2d.McObject.md#drawpoint)
- [drawSolid](2d.McObject.md#drawsolid)
- [drawText](2d.McObject.md#drawtext)
- [getAllLayoutName](2d.McObject.md#getalllayoutname)
- [getBackgroundEntity](2d.McObject.md#getbackgroundentity)
- [getCurrentDatabaseDrawColor](2d.McObject.md#getcurrentdatabasedrawcolor)
- [getCurrentFileName](2d.McObject.md#getcurrentfilename)
- [getCurrentOriginaFileName](2d.McObject.md#getcurrentoriginafilename)
- [getDatabase](2d.McObject.md#getdatabase)
- [getImp](2d.McObject.md#getimp)
- [getMxCpp](2d.McObject.md#getmxcpp)
- [getMxDrawObject](2d.McObject.md#getmxdrawobject)
- [getSysVarDouble](2d.McObject.md#getsysvardouble)
- [getSysVarLong](2d.McObject.md#getsysvarlong)
- [getSysVarPoint](2d.McObject.md#getsysvarpoint)
- [getSysVarString](2d.McObject.md#getsysvarstring)
- [getViewCADCoord](2d.McObject.md#getviewcadcoord)
- [iniAuthorizedService](2d.McObject.md#iniauthorizedservice)
- [init](2d.McObject.md#init)
- [initMxObject](2d.McObject.md#initmxobject)
- [initRegist](2d.McObject.md#initregist)
- [insertBlock](2d.McObject.md#insertblock)
- [isTryVersion](2d.McObject.md#istryversion)
- [loadDwgBackground](2d.McObject.md#loaddwgbackground)
- [loadImage](2d.McObject.md#loadimage)
- [newFile](2d.McObject.md#newfile)
- [objectIdToObject](2d.McObject.md#objectidtoobject)
- [off](2d.McObject.md#off)
- [on](2d.McObject.md#on)
- [openWebFile](2d.McObject.md#openwebfile)
- [pathCircle](2d.McObject.md#pathcircle)
- [pathLineTo](2d.McObject.md#pathlineto)
- [pathLineToEx](2d.McObject.md#pathlinetoex)
- [pathMakeClosed](2d.McObject.md#pathmakeclosed)
- [pathMakeExclude](2d.McObject.md#pathmakeexclude)
- [pathMoveTo](2d.McObject.md#pathmoveto)
- [pathMoveToEx](2d.McObject.md#pathmovetoex)
- [redo](2d.McObject.md#redo)
- [regen](2d.McObject.md#regen)
- [saveFile](2d.McObject.md#savefile)
- [saveFileToUrl](2d.McObject.md#savefiletourl)
- [setAttribute](2d.McObject.md#setattribute)
- [setBrowse](2d.McObject.md#setbrowse)
- [setCurrentFileName](2d.McObject.md#setcurrentfilename)
- [setCurrentLayout](2d.McObject.md#setcurrentlayout)
- [setCurrentOriginaFileName](2d.McObject.md#setcurrentoriginafilename)
- [setSysVarDouble](2d.McObject.md#setsysvardouble)
- [setSysVarLong](2d.McObject.md#setsysvarlong)
- [setSysVarPoint](2d.McObject.md#setsysvarpoint)
- [setSysVarPoint2d](2d.McObject.md#setsysvarpoint2d)
- [setSysVarString](2d.McObject.md#setsysvarstring)
- [setViewBackgroundColor](2d.McObject.md#setviewbackgroundcolor)
- [showLineWeight](2d.McObject.md#showlineweight)
- [undo](2d.McObject.md#undo)
- [undoMark](2d.McObject.md#undomark)
- [updateDisplay](2d.McObject.md#updatedisplay)
- [updateLayerDisplayStatus](2d.McObject.md#updatelayerdisplaystatus)
- [zoomAll](2d.McObject.md#zoomall)
- [zoomAngle](2d.McObject.md#zoomangle)
- [zoomCenter](2d.McObject.md#zoomcenter)
- [zoomScale](2d.McObject.md#zoomscale)
- [zoomW](2d.McObject.md#zoomw)

## Constructors

### constructor

• **new McObject**(`imp?`)

Constructor function

**`Example`**

```ts
import { McObject } from 'mxcad'

const mxcad = new McObject;
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `imp?` | ` Any ` | Object Implementation|

## Accessors

### database

• `get` **database**(): [`McDbDatabase`](2d.McDbDatabase.md)

Return database object

#### Returns

[`McDbDatabase`](2d.McDbDatabase.md)

___

### drawColor

• `get` **drawColor**(): [`McCmColor`](2d.McCmColor.md)

Get drawing colors

#### Returns

[`McCmColor`](2d.McCmColor.md)

Return to drawing color

• `set` **drawColor**(`val`): `void`

Set drawing color

**`Example`**

```ts
import { MxCpp, McObject } from 'mxcad';
const mxcad:McObject = MxCpp.App.getCurrentMxCAD();
mxcad.drawColor = new McCmColor(0, 0, 255);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | [McCMColor] (2d. McCmColor. md) | Draw colors|

#### Returns

`void`

___

### drawColorIndex

• `get` **drawColorIndex**(): `number`

Set color index for drawing

#### Returns

`number`

Val color index type

• `set` **drawColorIndex**(`val`): `void`

Set color index for drawing

**`Example`**

```ts
import { MxCpp, ColorIndexType, McObject } from "mxcad" ;
const mxcad:McObject = MxCpp.App.getCurrentMxCAD();
mxcad.drawColorIndex = ColorIndexType.kMagenta;
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | number | color index type|

#### Returns

`void`

___

### drawDimStyle

• `get` **drawDimStyle**(): `string`

Get the currently drawn annotation style

#### Returns

`string`

• `set` **drawDimStyle**(`val`): `void`

Set the annotation style for the current drawing

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimStyle = "MyDimStyle2"
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | string | Style Name|

#### Returns

`void`

___

### drawLayer

• `get` **drawLayer**(): `string`

Get drawing layers

#### Returns

`string`

Return to drawing layer

• `set` **drawLayer**(`val`): `void`

Set drawing layer

**`Example`**

```ts
import { MxCpp, McObject } from 'mxcad'
  const mxcad:McObject = MxCpp.getCurrentMxCAD();
   mxcad.drawLayer = "MtextLayer";
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | string | Draw layers|

#### Returns

`void`

___

### drawLineTypeScale

• `get` **drawLineTypeScale**(): `number`

Obtain the scale of the drawn line type

#### Returns

`number`

Return to drawing line type scale

• `set` **drawLineTypeScale**(`val`): `void`

Set the drawing line scale

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | number | Draw line type scale|

#### Returns

`void`

___

### drawLineWeight

• `get` **drawLineWeight**(): [`LineWeight`](../enums/2d.McDb.LineWeight.md)

Get drawing line width

#### Returns

[`LineWeight`](../enums/2d.McDb.LineWeight.md)

Return to drawing line width

• `set` **drawLineWeight**(`val`): `void`

Set drawing line width

**`Example`**

```ts
import { MxCpp, McDb, McObject } from "mxcad" ;

const mxcad: McObject = MxCpp.App.getCurrentMxCAD();
mxcad.drawLineWeight(McDb.LineWeight.kLnWtByLayer)
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | [LineWeight] (../enums/2d. McDb. LineWeight. md) | Draw line width|

#### Returns

`void`

___

### drawLineWidth

• `get` **drawLineWidth**(): `number`

Get the current drawn line width

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad: McObject = MxCpp.getCurrentMxCAD()
mxcad.drawLineWidth = 4;
```

#### Returns

`number`

• `set` **drawLineWidth**(`val`): `void`

Set the current drawn line width

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | number | line width|

#### Returns

`void`

___

### drawLinetype

• `get` **drawLinetype**(): `string`

Obtain the drawing line type

#### Returns

`string`

Return to drawing line type

• `set` **drawLinetype**(`val`): `void`

Set drawing line type

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad" ;

const mxcad: McObject = MxCpp.App.getCurrentMxCAD();
mxcad.addLinetype("MyLineType3", "30,-10");
mxcad.drawLinetype = "MyLineType3";
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | string | Draw line types|

#### Returns

`void`

___

### drawPatternDefinition

• `get` **drawPatternDefinition**(): `string`

Get the current line type definition drawn

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad: McObject = MxCpp.getCurrentMxCAD()
mxcad.drawPatternDefinition = "MyHatchPattern1";
```

#### Returns

`string`

• `set` **drawPatternDefinition**(`val`): `void`

Set the line type definition for the current drawing

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | string | Line type definition|

#### Returns

`void`

___

### drawTextStyle

• `get` **drawTextStyle**(): `string`

Get the style of drawing text

#### Returns

`string`

Return to drawing text style

• `set` **drawTextStyle**(`val`): `void`

Set the style for drawing text

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad" ;

const mxcad: McObject = MxCpp.App.getCurrentMxCAD();
mxcad.addTextStyle("MyTextStyle", "italicc.shx", "gbcbig.shx", 0.7);
mxcad.drawTextStyle = "MyTextStyle";
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | string | Draw text styles|

#### Returns

`void`

___

### drawUseDefaultProperties

• `get` **drawUseDefaultProperties**(): `boolean`

Return the number of drawings starting with the call 'draw', using the current default properties of the database.

#### Returns

`boolean`

• `set` **drawUseDefaultProperties**(`val`): `void`

Set the number of drawings starting with 'draw' when calling, using the current default properties of the database

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | boolean | Line width|

#### Returns

`void`

___

### mxdraw

• `get` **mxdraw**(): `MxDrawObject`

Return the MxDraw object bound to the MxCAD object.

**`Example`**

```ts
import { McObject } from 'mxcad'

const mxcad = new McObject()
const mxdraw = mxcad.mxdraw
```

#### Returns

`MxDrawObject`

MxDraw object

## Methods

### AddTureTypeTextStyle

▸ **AddTureTypeTextStyle**(`sName`, `sTrueTypeFontName?`, `dXScale?`): [`McObjectId`](2d.McObjectId.md)

Add text styles using TrueType fonts

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.AddTureTypeTextStyle("MyTrueTypeTextStyle");
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `sName` | `string` | `undefined` | - |
|STrueTypeFontName | string | "" | TrueType font name, if left blank, use the default TrueType font|
|DXScale | number | 1.0 | X-direction scaling ratio|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addCurrentSelect

▸ **addCurrentSelect**(`id`, `isDisplayGrid?`): `void`

Add the object to the current selection

**`Example`**

```typescript
import { MxCpp, McObject } from "mxcad"
let mxcad:McObject = MxCpp.getCurrentMxCAD();
let id = mxcad.drawLine(0,0,1000,1000);
mxcad.addCurrentSelect(id);
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|Id | [McObjectid] (2d. McObjectid. md) \ | [McObjectid] (2d. McObjectid. md) [] | undefined | Object ID|
| `isDisplayGrid` | `boolean` | `true` | - |

#### Returns

`void`

void

___

### addDimStyle

▸ **addDimStyle**(`pszName`, `pszDoubleData`, `pszIntData`, `pszStringData`, `pszIdData`): [`McObjectId`](2d.McObjectId.md)

Add annotation style

**`Description`**

PszDoubleData Double Precision Data
|System Variables | Values | Function Description|
| ------- | ------- | ------- |
|Dimaltf | 143 | Control the multiplier for converting units|
|Dimasz | 41 | Control the size of dimension lines and lead arrows. And control the size of the baseline|
|Dimcen | 141 | Control the marking of circle or arc centers and the drawing of centerlines|
|Dimdle | 46 | When using a small diagonal line instead of an arrow for annotation, set the distance from the dimension line beyond the dimension boundary line|
|Dimdli | 43 | Control the spacing of dimension lines in baseline annotation|
|Dimexe | 44 | Export named annotation styles and their settings to an external file|
|Dimexo | 42 | Specify the distance from the origin of the dimension extension line|
|Dimgap | 147 | Set the distance around the annotation text when the dimension line is broken to conform to the annotation text|
|Dimlfac | 144 | Set the scaling factor for linear annotation measurement values|
|Dimrnd | 45 | Rounds all annotated distances to the specified value|
|Dimscale | 40 | Set the global scale factor applied to the annotation variable (used to specify size, distance, or offset)|
|Dimtfac | 146 | As set through the DIMTXT system variable, specify the scaling factor of the text height of the score and tolerance values relative to the annotation text height|
|Dimtm | 48 | Set the minimum (i.e. lowest) tolerance limit for the annotation text|
|Dimtp | 47 | Set the maximum (i.e. highest) tolerance limit for the annotation text|
|Dimtsz | 142 | Specify the size of the small diagonal lines drawn instead of arrows in linear, radius, and diameter annotations|
|Dimtvp | 145 | Control the vertical position of the annotation text above or below the dimension line|
|Dimtxt | 140 | Specify the height of the annotation text (unless the current text style has a fixed height)|
|Dimaltrnd | 148 | Rounding conversion annotation unit|

**`Description`**

PszIntData integer data
|System Variables | Values | Function Description|
| ------- | ------- | ------- |
|Dimadec | 179 | Control the precision decimal places displayed in the angle annotation|
|Dimalt | 170 | Controls the display of conversion units in annotations|
|Dimaltd | 171 | Control the number of decimal places in the conversion unit|
|Dimalttd | 274 | Set the decimal place for the tolerance value in the conversion annotation unit|
|Dimalttz | 286 | Control the zeroing process of tolerance values|
|Dimaltu | 273 | Set the unit format for the conversion units of all annotation sub styles (excluding angular annotations)|
|Dimaltz | 285 | Control the zeroing process for the annotation values of conversion units|
|Dimaunit | 275 | Set the unit format for angle annotation|
|Dimclrd | 176 | Specify colors for dimension lines, arrows, and dimension leaders|
|Dimctre | 177 | Specify colors for dimension lines, center marks, and centerlines|
|Dimclrt | 178 | Specify the color for the annotation text|
|Dimdec | 271 | Set the number of decimal places displayed in the primary unit of the annotation|
|When the space within the dimension line is insufficient to accommodate both the annotation text and the arrow, this system variable will determine the arrangement of both|
|Dimjust | 280 | Control the horizontal position of the annotation text|
|Dimlim | 72 | Generate annotation boundaries as default text|
|Dimsah | 173 | Control the display of dimension line arrow blocks|
|Dimsd1 | 281 | Control whether to hide the first dimension line and arrow|
|Dimsd2 | 282 | Control whether to hide the second dimension line and arrow|
|Dimse1 | 75 | Control whether to hide the first dimension line|
|Dimse2 | 76 | Control whether to hide the second dimension line|
|Dimsoxd | 175 | If there is not enough space within the dimension line, hide the arrow|
|Dimtad | 77 | Control the vertical position of the text relative to the dimension line|
|Dimtdec | 272 | Set the number of decimal places displayed in the tolerance value of the primary unit of the annotation|
|Dimtih | 73 | Controls the position of annotation text for all annotation types (excluding coordinate annotations) within the dimension lines|
|Dimtix | 174 | Draw text between dimension lines|
|Dimtofl | 172 | Controls whether dimension lines are drawn between dimension lines (even if the dimension text is placed outside the dimension lines)|
|Dimitoh | 74 | Control the position of the annotation text outside the dimension line|
|Ditol | 71 | Attach the tolerance in the annotation text|
|Dimtolj | 283 | Set the vertical alignment of tolerance values relative to surface annotation text|
|Dimzin | 78 | Control the zeroing process for the main unit value|
|Dimupt | 288 | Control the option for users to locate text|
|Dimtzin | 284 | Control the zeroing process of tolerance values|
|Dimfrac | 276 | Set score format|
|Dimlunit | 277 | Set units for all annotation types (excluding angular annotations)|
|When the space within the dimension line is insufficient to accommodate both the annotation text and the arrow, this system variable will determine the arrangement of both|
|Dimtmove | 279 | Set the movement rules for annotation text|
|Dimazin | 79 | Zero elimination processing for angle annotation|

**`Description`**

PszStringData string type data
|System Variables | Values | Function Description|
| ------- | ------- | ------- |
|Dimapost | 4 | Specify the text prefix or suffix (or both) used for converting dimension measurements for all dimension types (excluding angular dimensions)|
|Dimpost | 3 | Specify a text prefix or suffix (or both) for annotating measurement values|

**`Description`**

PszIdData ID type data
|System Variables | Values | Function Description|
| ------- | ------- | ------- |
|Dimblk | 342 | Set an arrow for the second endpoint of the dimension line|
|Dimblk1 | 343 | Set an arrow for the first endpoint of the dimension line|
|Dimblk2 | 344 | Set an arrow for the second endpoint of the dimension line|
|Dimldrblk | 341 | Specify the type of leader arrow|
|Dimtxsty | 340 | Specify the text style for the annotation|

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD();

//MyDimStyle2: Style Name
//41, 0.18141, 0.09, 40200 ": Double precision data
//77,1271,3 ": integer data
//Among them, the values are set in pairs, such as "41,0.18": the value of the dimasz system variable is set to 0.18; 77,1 ": The value of the dimtad system variable is set to 1
mxcad.addDimStyle("MyDimStyle2", "41,0.18,141,0.09,40,200", "77,1,271,3", "", "");
Add a%% c prefix '3, "%%c<>"'
mxcad.addDimStyle("MyDimStyle", "41,0.18,141,0.09,40,200", "77,1,271,3", '3,"%%c<>"', `340,${textId.id}`);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|PszName | string | Style Name|
|PszDoubleData | string | Double precision data|
|PszIntData | string | integer data|
|` pszStringData ` | ` string ` | String data|
|PszIdData | string | ID type data|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addImageDefine

▸ **addImageDefine**(`imageUrl`, `sName?`, `isConvertBase64?`): [`McObjectId`](2d.McObjectId.md)

Add an image definition to the CAD database.

**`Example`**

```ts
   import { MxCpp, McObject } from "mxcad"
   let mxcad:McObject = MxCpp.getCurrentMxCAD();
   let imagUrl = "https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";
   mxcad.loadImage(imagUrl, (imagedata) => {
       if (!imagedata) {
           console.log("loadImage failed");
           return;
       }
       let imagedefid = mxcad.addImageDefine(imagUrl,"winter-7593872_960_720.jpg",true);
       mxcad.updateDisplay();
   });
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|ImageURL | string | undefined | Image path|
|SName | string | "" | Image Definition Name|
| `isConvertBase64` | `boolean` | `false` | - |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addLayer

▸ **addLayer**(`string`): [`McObjectId`](2d.McObjectId.md)

Add Layer

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
Mxcad. addLayer ("Layer Name")
```

#### Parameters

| Name | Type |
| :------ | :------ |
| `string` | `string` |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addLinetype

▸ **addLinetype**(`sName`, `sLineDefine`): [`McObjectId`](2d.McObjectId.md)

Add line type

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
//Define dashed data, "MyLineType" is the line name, "6, -8" is a unit definition of the dashed line, 6 is the length of the solid line, and -8 is the length of the space.
mxcad.addLinetype("MyLineType", "6,-10");
```

#### Parameters

| Name | Type |
| :------ | :------ |
| `sName` | `string` |
| `sLineDefine` | `string` |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addLinetypeEx

▸ **addLinetypeEx**(`sName`, `sLineDefine`, `sTextStyle?`): [`McObjectId`](2d.McObjectId.md)

Add line type

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
let lintype = mxcad.addLinetypeEx("TestMyLine", '.5,-.2,["HW",STANDARD,S=.1,R=0.0,X=-0.1,Y=-.05],-.2', "");
```

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `sName` | `string` | `undefined` |
| `sLineDefine` | `string` | `undefined` |
| `sTextStyle` | `string` | `""` |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### addPatternDefinition

▸ **addPatternDefinition**(`sName`, `sDefinitionData`): `void`

Add a pattern definition

**`Example`**

```ts
   import { MxCpp, McObject } from "mxcad"
   const mxcad:McObject = MxCpp.getCurrentMxCAD()
   //angle, x-origin,y-origin, delta-x,delta-y,dash-1,dash-2, …
//45=angle is the angle of the pattern line
//0=x-origin is the X-coordinate of the point where the first fill line passes through
//0=y-origin is the Y coordinate of the point where the first fill line passes through
//0=delta-x is the X-direction offset of the next fill line relative to the previous line
//0.125=delta-y is the Y-direction offset of the next fill line relative to the previous line
   mxcad.addPatternDefinition("MyHatchPattern1", "((45, 0,0, 0,0.125))");
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|SName | string | Pattern Name|
|SDefinitionData | string | Pattern default definition data|

#### Returns

`void`

___

### addSystemVarNameForEvent

▸ **addSystemVarNameForEvent**(`aryVarName`): `void`

Add a system variable name for event notification after variable object modification
Variable object modification event name: sysVarChanged

#### Parameters

| Name | Type |
| :------ | :------ |
| `aryVarName` | `string`[] |

#### Returns

`void`

___

### addTextStyle

▸ **addTextStyle**(`sName`, `sFileName`, `sBigFontFileName`, `dXScale?`): [`McObjectId`](2d.McObjectId.md)

Add Text Style

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD() 
mxcad.addTextStyle("MyLineTypeTextStyle", "txt.shx", "hztxt.shx", 1);
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `sName` | `string` | `undefined` | - |
| `sFileName` | `string` | `undefined` | - |
| `sBigFontFileName` | `string` | `undefined` | - |
|DXScale | number | 1.0 | X-direction scaling ratio|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### callEvent

▸ **callEvent**(`sEventName`, `param?`): `boolean`

Call to trigger a system event

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"

const mxcad:McObject = MxCpp.getCurrentMxCAD();
mxcad.callEvent("init");
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `sEventName` | `string` | - |
| `param?` | ` Any | Event Parameters|

#### Returns

`boolean`

___

### clearDwgBackground

▸ **clearDwgBackground**(): `void`

Clear background drawing objects

#### Returns

`void`

___

### clearMxCurrentSelect

▸ **clearMxCurrentSelect**(): `void`

Clear all current selections

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"

const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.clearCurrentSelect();
```

#### Returns

`void`

___

### create

▸ **create**(`config`): `void`

Create an MXCAD object.

**`Example`**

```ts
import { McObject } from "mxcad"

//Create an MXCAD sample object
 const mxcad = new McObject()
mxcad.create({
//The ID of the canvas element
canvas: "#myCanvas",
//Retrieve the path location for loading wasm related files (wasm/js/worker. js)
locateFile: (fileName)=> new URL(`/node_modules/mxcad/dist/wasm/2d/${fileName}`, import.meta.url).href,
//Need to initialize the URL path of the opened file
fileUrl: new URL("../src/assets/test.mxweb", import.meta.url).href,
//Provide the directory path for loading fonts
fontspath:  new URL("node_modules/mxcad/dist/fonts", import.meta.url).href,
})
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|` config ` | [` MxCadConfig `] (../interfaces/2d. MxCadConfig. md) | Parameter configuration for creating MxCad|

#### Returns

`void`

___

### destroyObject

▸ **destroyObject**(`pObjectImp`): `void`

Destroy the specified McRxObject Imp object

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|PObject Imp | McRx Object Imp | McRx Object Imp object to be destroyed|

#### Returns

`void`

___

### drawArc

▸ **drawArc**(`dCenterX`, `dCenterY`, `dRadius`, `dStartAng`, `dEndAng`): [`McObjectId`](2d.McObjectId.md)

Draw an arc

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad: McObject = MxCpp.getCurrentMxCAD()
mxcad.drawArc(300, 1000, 100, 30, 200);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DCenterX | number | X coordinate of the center of the circle|
|DCenterY | number | Y coordinate of the center|
|DRadius | number | radius|
|DStartAng | number | Starting angle, in radians|
|DEndAng | number | End angle, in radians|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Success returns 1, failure returns 0

___

### drawArc2

▸ **drawArc2**(`dStartPointX`, `dStartPointY`, `dMidPointX`, `dMidPointY`, `dEndPointX`, `dEndPointY`): [`McObjectId`](2d.McObjectId.md)

Draw an arc

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
//Draw an arc from three points on the arc
mxcad.drawArc2(800, 1000, 900, 1200, 1000, 900);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DStartPointX | number | starting point X coordinate|
|DStartPointY | number | Starting point Y coordinate|
|DMidPointX | number | X coordinate of the midpoint|
|DMidPointY | number | Y coordinate of the midpoint|
|DEndPointX | number | End point X coordinate|
|DEndPointY | number | End point Y coordinate|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawArc3

▸ **drawArc3**(`dStartPointX`, `dStartPointY`, `dEndPointX`, `dEndPointY`, `dBulge`): [`McObjectId`](2d.McObjectId.md)

Draw an arc

**`Example`**

```ts
  import { MxCpp, McObject } from "mxcad"
  const mxcad:McObject = MxCpp.getCurrentMxCAD()
//The starting point, ending degree, and convexity on the arc will form an arc
  mxcad.drawLineWidth = 40;
  mxcad.drawArc3(1200, 1000, 1400, 1000, 0.6);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DStartPointX | number | starting point X coordinate|
|DStartPointY | number | Starting point Y coordinate|
|DEndPointX | number | End point X coordinate|
|DEndPointY | number | End point Y coordinate|
|DBulge | number | convexity|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawBlockReference

▸ **drawBlockReference**(`dPosX`, `dPosY`, `sBlkName`, `dScale`, `dAng`): [`McObjectId`](2d.McObjectId.md)

Draw block reference

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DPosX | number | Reference position X coordinate|
|DPosY | number | Reference position Y coordinate|
| `sBlkName` | `string` | - |
|DScale | number | scaling ratio|
|DAng | number | Rotation angle, in radians|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Block object ID

___

### drawCircle

▸ **drawCircle**(`dCenterX`, `dCenterY`, `dRadius`): [`McObjectId`](2d.McObjectId.md)

Draw a circle

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD(
mxcad.drawCircle(0, 0, 120);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DCenterX | number | X coordinate of the center of the circle|
|DCenterY | number | Y coordinate of the center|
|DRadius | number | radius|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawDimAligned

▸ **drawDimAligned**(`dExtLine1PointX`, `dExtLine1PointY`, `dExtLine2PointX`, `dExtLine2PointY`, `dTextPositionX`, `dTextPositionY`): [`McObjectId`](2d.McObjectId.md)

Draw alignment annotations

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimAligned(0, 4000, 300, 4500, 150, 4600);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DExtLine1PointX | number | X-coordinate of the starting point of the first ruler line|
|DExtLine1PointY | number | Y coordinate of the starting point of the first ruler line|
|DExtLine2PointX | number | X-coordinate of the starting point of the second ruler line|
|DExtLine2PointY | number | Y coordinate of the starting point of the second ruler line|
|DTextPositionX | number | Text Position X Coordinate|
|DTextPositionY | number | Y coordinate of text position|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Success returns 1, failure returns 0

___

### drawDimAngular

▸ **drawDimAngular**(`dAngleVertexX`, `dAngleVertexY`, `dFirstEndPointX`, `dFirstEndPointY`, `dSecondEndPointX`, `dSecondEndPointY`, `dTextPointX`, `dTextPointY`): [`McObjectId`](2d.McObjectId.md)

Draw angle annotation

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimAngular(500, 5000, 0, 5500, 1000, 5500, 500, 5500);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DAngle VertexX | number | angle vertex X coordinate|
|DAngle VertexY | number | Y-coordinate of angle vertex|
|DFirstEndPointX | number | X-coordinate of the starting point of the first ruler line|
|DFirstEndPointY | number | Y coordinate of the starting point of the first ruler line|
|DSecondEndPointX | number | X coordinate of the starting point of the second ruler line|
|DSecondEndPointY | number | Y coordinate of the starting point of the second ruler line|
|DTextPointX | number | Text Position X Coordinate|
|DTextPointY | number | Text Position Y Coordinate|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Success returns 1, failure returns 0

___

### drawDimDiametric

▸ **drawDimDiametric**(`dChordPointX`, `dChordPointY`, `dFarChordPointX`, `dFarChordPointY`, `dLeaderLength`): [`McObjectId`](2d.McObjectId.md)

Draw diameter annotation

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimDiametric(500, 0, -500, 0, 20);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DChordPointX | number | Chord endpoint X coordinate|
|DChordPointY | number | chord endpoint Y coordinate|
|DFarChordPointX | number | X coordinate of the far end point of the string|
|DFarChordPointY | number | Y-coordinate of the far end point of the string|
|DLeaderLength | number | lead length|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Diameter annotation object ID

___

### drawDimOrdinate

▸ **drawDimOrdinate**(`dDefinitionPointX`, `dDefinitionPointY`, `dDeaderEndPointX`, `dDeaderEndPointY`, `isUseXAxis`): [`McObjectId`](2d.McObjectId.md)

Draw linear dimensions for annotation

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimOrdinate(500, 0, -500, 0, true);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DDefinitionPointX | number | Define the coordinates of point X|
|DDefinitionPointY | number | Define the coordinates of point Y|
|DDeaderEndPointX | number | Annotate the X coordinate of the endpoint|
|DDeaderEndPointY | number | Annotate the Y coordinate of the endpoint|
|Is' isUseXAxis' | 'boolean' | labeled along the X-axis direction|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Linear size object ID

___

### drawDimRadial

▸ **drawDimRadial**(`dCenterX`, `dCenterY`, `dChordPointX`, `dChordPointY`, `dLeaderLength`): [`McObjectId`](2d.McObjectId.md)

Draw radial dimensions for annotation

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawDimOrdinate(0, 0, 0, 500, 20);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DCenterX | number | X coordinate of the center point|
|DCenterY | number | Y coordinate of the center point|
|DChordPointX | number | Chord endpoint X coordinate|
|DChordPointY | number | chord endpoint Y coordinate|
|DLeaderLength | number | Length of annotation line|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Radial dimension object ID

___

### drawDimRotated

▸ **drawDimRotated**(`dExtLine1PointX`, `dExtLine1PointY`, `dExtLine2PointX`, `dExtLine2PointY`, `dDimLineLocationX`, `dDimLineLocationY`, `dRotationAngle`): [`McObjectId`](2d.McObjectId.md)

Draw rotation annotation

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD() 
mxcad.drawDimRotated(0, 7000, 600, 7000, 250, 7050, 0);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DExtLine1PointX | number | X-coordinate of the starting point of the first ruler line|
|DExtLine1PointY | number | Y coordinate of the starting point of the first ruler line|
|DExtLine2PointX | number | X-coordinate of the starting point of the second ruler line|
|DExtLine2PointY | number | Y coordinate of the starting point of the second ruler line|
|DDimLinePositionX | number | annotation line position X coordinate|
|DDimLinePositionY | number | Y coordinate of annotation line position|
|DRotationAngle | number | Rotation angle, in radians|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Rotate annotation object ID

___

### drawEllipse

▸ **drawEllipse**(`dCenterX`, `dCenterY`, `dMajorAxisX`, `dMajorAxisY`, `dRadiusRatio`): [`McObjectId`](2d.McObjectId.md)

Draw an ellipse

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawEllipse(0, 1400, 100, 0, 0.7);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DCenterX | number | X-coordinate of ellipse center|
|DCenterY | number | Y coordinate of ellipse center|
|DMajorAxisX | number | long axis X coordinate|
|DMajorAxisY | number | Long axis Y coordinate|
|DRadiusRatio | number | ratio of minor axis to major axis|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Success returns 1, failure returns 0

___

### drawEllipseArc

▸ **drawEllipseArc**(`dCenterX`, `dCenterY`, `dMajorAxisX`, `dMajorAxisY`, `dRadiusRatio`, `dStartAng`, `dEndAng`): [`McObjectId`](2d.McObjectId.md)

Draw an elliptical arc

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawEllipseArc(0, 1600, 80, 30, 0.4, 30, 200);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DCenterX | number | X-coordinate of ellipse center|
|DCenterY | number | Y coordinate of ellipse center|
|DMajorAxisX | number | long axis X coordinate|
|DMajorAxisY | number | Long axis Y coordinate|
|DRadiusRatio | number | ratio of minor axis to major axis|
|DStartAng | number | Starting angle, in radians|
|DEndAng | number | End angle, in radians|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawEntity

▸ **drawEntity**(`entity`, `isUseDatabaseCurrentProperties?`): [`McObjectId`](2d.McObjectId.md)

Draw entities

**`Example`**

```ts
import { McDbPolyline, MxCpp } from
let pl = new McDbPolyline();
  pl.addVertexAt(new McGePoint3d(100, 100, 100));
  pl.addVertexAt(new McGePoint3d(200, 100, 500));
  pl.addVertexAt(new McGePoint3d(300, 400, 200));
  MxCpp.getCurrentCAD().drawEntity(pl);
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|Entity | [McDbEntity] (2d. McDbEntity. md) | undefined | Entity object|
| `isUseDatabaseCurrentProperties` | `boolean` | `false` | - |

#### Returns

[`McObjectId`](2d.McObjectId.md)

Draw Results

___

### drawHatch

▸ **drawHatch**(`hatch`, `dPatternScale?`): [`McObjectId`](2d.McObjectId.md)

Draw Fill Object

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `hatch` | [`McDbHatch`](2d.McDbHatch.md) | `undefined` |
| `dPatternScale` | `number` | `1.0` |

#### Returns

[`McObjectId`](2d.McObjectId.md)

Draw object ID

___

### drawImage

▸ **drawImage**(`dPosX`, `dPosY`, `dWidth`, `dHeight`, `dAng`, `imageUrl`, `isConvertBase64?`, `dwgImageSizeWidth?`, `dwgImageSizeHeight?`): [`McObjectId`](2d.McObjectId.md)

Draw an image

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|DPosX | number | undefined | X coordinate of image|
|DPosY | number | undefined | Y coordinate of image|
|DWidth | number | undefined | image width|
|DHeight | number | undefined | Image height|
|DAng | number | undefined | Image angle, in degrees|
|ImageURL | string | undefined | Image path|
| `isConvertBase64` | `boolean` | `false` | - |
| `dwgImageSizeWidth` | `number` | `1.0` | - |
| `dwgImageSizeHeight` | `number` | `1.0` | - |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawLine

▸ **drawLine**(`dX1`, `dY1`, `dX2`, `dY2`): [`McObjectId`](2d.McObjectId.md)

draw a straight line

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawLine(0, 60, 100, 60);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX1 | number | Starting point X coordinate|
|DY1 | number | Starting point Y coordinate|
|DX2 | number | endpoint X coordinate|
|DY2 | number | End point Y coordinate|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawLine3d

▸ **drawLine3d**(`dX1`, `dY1`, `dZ1`, `dX2`, `dY2`, `dZ2`): [`McObjectId`](2d.McObjectId.md)

#### Parameters

| Name | Type |
| :------ | :------ |
| `dX1` | `number` |
| `dY1` | `number` |
| `dZ1` | `number` |
| `dX2` | `number` |
| `dY2` | `number` |
| `dZ2` | `number` |

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawMText

▸ **drawMText**(`dPosX`, `dPosY`, `sContents`, `dHeight`, `dWidth`, `dRotation`, `iAttachment`): [`McObjectId`](2d.McObjectId.md)

Draw multiple lines of text

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
Mxcad.drawMText (0, -100, "Control:\ \P Multi line Text Test ", 50, 400, 0, 1);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DPosX | number | Text Position X Coordinate|
|DPosY | number | Y coordinate of text position|
| `sContents` | `string` | - |
|DHeight | number | Text height|
|DWidth | number | Text width|
|DRotation | number | Rotation angle, in radians|
|IAttachment | [AttachmentPoint] (../enums/2d. McDb. AttachmentPoint. md) | Alignment Method|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Multi line text object ID

___

### drawPathToHatch

▸ **drawPathToHatch**(`dPatternScale?`): [`McObjectId`](2d.McObjectId.md)

Convert the path to a fill pattern

**`Example`**

```ts
   import { MxCADUiPrPoint, MxCADUiPrDist, MxCpp } from "mxcad";
//Solid circle
   async function Mx_SolidCircle() {
       const getCenter = new MxCADUiPrPoint();
GetCenter.setMessage ('Please confirm the center position ');
       const center = await getCenter.go();
       if (!center) return;
       const getRadius = new MxCADUiPrDist();
getRadius.setBasePt(center);//  Set the distance base point as the center of the circle
GetRadius.setMessage ('Please enter circle radius');
       getRadius.setUserDraw((pt, pw) => {
           const r = pt.distanceTo(center);
           const circle = new McDbCircle();
           circle.center = center;
           circle.radius = r;
           pw.drawMcDbEntity(circle)
       })
       const radiusVal = await getRadius.go();
       if (!radiusVal) return;
       const radius = getRadius.value();
       const mxcad = MxCpp.getCurrentMxCAD();
mxcad.pathCircle(center.x, center.y, radius);// Set circular path
mxcad.drawPathToHatch();//  Draw a solid circle
   }
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|DPatternScale | number | 1.0 | Pattern scaling ratio|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Conversion results

___

### drawPathToPolyline

▸ **drawPathToPolyline**(): [`McObjectId`](2d.McObjectId.md)

Convert the path to a polyline

#### Returns

[`McObjectId`](2d.McObjectId.md)

Conversion results

___

### drawPathToSpline

▸ **drawPathToSpline**(): [`McObjectId`](2d.McObjectId.md)

Convert the path to a spline curve

#### Returns

[`McObjectId`](2d.McObjectId.md)

Conversion results

___

### drawPoint

▸ **drawPoint**(`dX`, `dY`): [`McObjectId`](2d.McObjectId.md)

Draw points

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.drawPoint(0,0);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX | number | X coordinate|
|DY | number | Y coordinate|

#### Returns

[`McObjectId`](2d.McObjectId.md)

___

### drawSolid

▸ **drawSolid**(`dX1`, `dY1`, `dX2`, `dY2`, `dX3`, `dY3`, `dX4`, `dY4`): [`McObjectId`](2d.McObjectId.md)

Draw entities

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX1 | number | X coordinate of the first point|
|DY1 | number | Y coordinate of the first point|
|DX2 | number | X coordinate of the second point|
|DY2 | number | Y coordinate of the second point|
|DX3 | number | X coordinate of the third point|
|DY3 | number | Y coordinate of the third point|
|DX4 | number | X coordinate of the fourth point|
|DY4 | number | Y coordinate of the fourth point|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Entity Object ID

___

### drawText

▸ **drawText**(`dPosX`, `dPosY`, `pszText`, `dHeight`, `dRotation`, `horizontalMode`, `verticalMode`): [`McObjectId`](2d.McObjectId.md)

Draw a single line of text

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
Mxcad.drawText (0, 1900, "Drawing Control Text Test", 100, 0, 0, 1);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DPosX | number | Text Position X Coordinate|
|DPosY | number | Y coordinate of text position|
|PszText | string | Text Content|
|DHeight | number | Text height|
|DRotation | number | Rotation angle, in radians|
|HorizontalMode | [TextHorzMode] (../enums/2d. McDb. TextHorzMode. md) | Horizontal alignment method|
|Vertical Mode | [TextVertMode] (../enums/2d. McDb. TextVertMode. md) | Vertical Alignment Method|

#### Returns

[`McObjectId`](2d.McObjectId.md)

Success returns 1, failure returns 0

___

### getAllLayoutName

▸ **getAllLayoutName**(): [`McGeStringArray`](2d.McGeStringArray.md)

Get all layout names

#### Returns

[`McGeStringArray`](2d.McGeStringArray.md)

___

### getBackgroundEntity

▸ **getBackgroundEntity**(): [`McDbBackgroundEntity`](2d.McDbBackgroundEntity.md)

Return the current background object

#### Returns

[`McDbBackgroundEntity`](2d.McDbBackgroundEntity.md)

___

### getCurrentDatabaseDrawColor

▸ **getCurrentDatabaseDrawColor**(): `Color`

Returns the drawing color set in the current database, which will automatically convert black and white based on the background color.

#### Returns

`Color`

___

### getCurrentFileName

▸ **getCurrentFileName**(): `string`

Get the current file name

#### Returns

`string`

Current file name

___

### getCurrentOriginaFileName

▸ **getCurrentOriginaFileName**(): `string`

Get the current file name

#### Returns

`string`

Current file name

___

### getDatabase

▸ **getDatabase**(): [`McDbDatabase`](2d.McDbDatabase.md)

Retrieve database objects

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.App.getCurrentMxCAD()
let layerTable = mxcad.getDatabase().getLayerTable();
```

#### Returns

[`McDbDatabase`](2d.McDbDatabase.md)

Database objects

___

### getImp

▸ **getImp**(): `any`

Retrieve internal implementation objects

#### Returns

`any`

Internal implementation object

___

### getMxCpp

▸ **getMxCpp**(): `any`

Add back the MxCpp object, which will be called in the MxDraw module.

#### Returns

`any`

___

### getMxDrawObject

▸ **getMxDrawObject**(): `MxDrawObject`

Return the MxDraw object bound to the MxCAD object.

**`Example`**

```ts
import { McObject } from 'mxcad'

const mxcad = new McObject()
const mxdraw = mxcad.getMxDrawObject()
```

#### Returns

`MxDrawObject`

MxDraw object

___

### getSysVarDouble

▸ **getSysVarDouble**(`varName`): `number`

Get floating-point values of system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|

#### Returns

`number`

Floating point values of variables

___

### getSysVarLong

▸ **getSysVarLong**(`varName`): `number`

Get the integer value of a system variable

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|

#### Returns

`number`

The integer value of a variable

___

### getSysVarPoint

▸ **getSysVarPoint**(`varName`): [`McGePoint3d`](2d.McGePoint3d.md)

Obtain the point values of system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|

#### Returns

[`McGePoint3d`](2d.McGePoint3d.md)

Point values of variables

___

### getSysVarString

▸ **getSysVarString**(`varName`): `string`

Retrieve the string value of a system variable

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|

#### Returns

`string`

The string value of a variable

___

### getViewCADCoord

▸ **getViewCADCoord**(): `Object`

Return the display range and CAD coordinates of the current viewport.

#### Returns

`Object`

Current viewport display range

| Name | Type |
| :------ | :------ |
| `pt1` | [`McGePoint3d`](2d.McGePoint3d.md) |
| `pt2` | [`McGePoint3d`](2d.McGePoint3d.md) |
| `pt3` | [`McGePoint3d`](2d.McGePoint3d.md) |
| `pt4` | [`McGePoint3d`](2d.McGePoint3d.md) |

___

### iniAuthorizedService

▸ **iniAuthorizedService**(`sUrl`): `void`

Initialize user authorization service url

#### Parameters

| Name | Type |
| :------ | :------ |
| `sUrl` | `string` |

#### Returns

`void`

___

### init

▸ **init**(`imp`): `void`

Initial object

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Implement the 'imp' | 'any' | object, and by default, this function will be automatically called by the system|

#### Returns

`void`

___

### initMxObject

▸ **initMxObject**(`mxObject`): `void`

Initialize object model

**`Description`**

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|MxObject | any | Initialize [mxdraw]（ https://mxcadx.gitee.io/mxdraw_docs ）Created drawing controls|

#### Returns

`void`

___

### initRegist

▸ **initRegist**(`sRegist`): `void`

Initialize user registration data

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|SRegist | string | Registration data|

#### Returns

`void`

___

### insertBlock

▸ **insertBlock**(`sFileUrl`, `sBlkName`, `isWorkThread?`, `fetchAttributes?`, `isUpdataInsertBlock?`, `isUpdataSameNameBlock?`): [`Promise`]( https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise )<[`McObjectId`](2d.McObjectId.md)\>

Plugin block file

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
const blkrecId = await mxcad.insertBlock("./blkrec.mxweb", "sBlkName");
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|SFileURL | string | undefined | Network file path This file is in mxweb format|
|SBlkName | string | undefined | The block name of the inserted block|
|IsWorkThread | boolean | true | Whether to use a worker thread to open the file, default to true|
| `fetchAttributes` | `number` | `0` | 1： EMSCRIPTEN_FETCH_LOAD_TO_MEMORY, Load the drawing data into memory, 0: EMSCRIPTEN_FETCH_LOAD_TO_MEMORY \| EMSCRIPTEN_FETCH_PERSIST_FILE \| EMSCRIPTEN_FETCH_APPEND， Add the drawing data to IndexedDB|
|IsUpdataInsertBlock | boolean | false | Update existing blocks, default not updated|
|IsUpdataSameNameBlock | boolean | false | During the process of inserting a block, if a block with the same name is found in the original database, will it also be updated? By default, it will not be updated|

#### Returns

[`Promise`]( https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise )<[`McObjectId`](2d.McObjectId.md)\>

___

### isTryVersion

▸ **isTryVersion**(): `boolean`

Is the current program a trial version

#### Returns

`boolean`

___

### loadDwgBackground

▸ **loadDwgBackground**(`sFileUrl`, `call`, `color?`, `isShow?`): `void`

Load another DWG file to draw the current background object

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `sFileUrl` | `string` | `undefined` |
| `call` | (`ret`: `boolean`) => `void` | `undefined` |
| `color` | `number` | `0` |
| `isShow` | `boolean` | `true` |

#### Returns

`void`

___

### loadImage

▸ **loadImage**(`imageUrl`, `call`, `imageFileName?`): `void`

Load an external image into the current context for future use.

**`Example`**

```ts
 import { MxCpp, McObject } from "mxcad"
 const mxcad: McObject = MxCpp.getCurrentMxCAD()
 mxcad.loadImage(imagUrl, (image) => {
   if (!image) {
       console.log("loadImage failed");
       return;
   }
   let width = mxcad.mxdraw.viewCoordLong2Cad(100);
   let height = (image.height / image.width) * width;
   idImage = mxcad.drawImage((pt as any).x, (pt as any).y, width, height, 0, imagUrl,true);
   mxcad.updateDisplay();
});
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|ImageURL | string | undefined | Image path|
|Call | (image: any)=>void | undefined | callback function|
| `imageFileName` | `string` | `""` | - |

#### Returns

`void`

___

### newFile

▸ **newFile**(): `boolean`

Clear the content of the current image and create a new file

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad" ;

let mxcad:McObject = MxCpp.getCurrentMxCAD();
mxcad.newFile();
```

#### Returns

`boolean`

___

### objectIdToObject

▸ **objectIdToObject**(`lIdIndex`): ``null`` \| [`McDbObject`](2d.McDbObject.md)

Convert lIdInDex to McDbObject object

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|LIdIDEX | number | Object ID|

#### Returns

``null`` \| [`McDbObject`](2d.McDbObject.md)

McDbObject object corresponding to ID, returns null if the object does not exist

___

### off

▸ **off**(`name`, `fun?`): `void`

Turn off event monitoring

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"

const mxcad:McObject = MxCpp.getCurrentMxCAD();
//E: Event function, referring to the function registered in mxcad. on ("selectChange", e)
mxcad.off("selectChange", e);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Name | String | Listening Event Name|
| `fun?` |  [`Function`](  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function ）Monitoring events|

#### Returns

`void`

___

### on

▸ **on**(`name`, `fun`): `void`

Monitor object selection event

**`Example`**

```ts
import { MxCpp, McObject, McObjectId } from "mxcad"

const mxcad:McObject = MxCpp.getCurrentMxCAD();
mxcad.on("selectChange", (ids: McObjectId[])=> {
     if (ids.length == 0) return;
     let id = ids[0]
     let ent = id.getMcDbEntity()
     if(!ent) return
     console.log(ent.objectName)
})
```

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"selectChange"`` |
| `fun` | (`ids`: [`McObjectId`](2d.McObjectId.md)[]) => `void` \| (`ids`: [`McObjectId`](2d.McObjectId.md)[]) => `void`[] |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Monitor file fully open

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"openFileComplete"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

The mxdraw mxcad program has been loaded and triggered when preparing to create an mxdraw object

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"init"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

MXdraw object created, triggered when preparing initial related parameters

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"init_before_mxdraw"`` |
| `fun` | (`mxdraw`: `MxDrawObject`) => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Triggered after mxdraw object creation

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"init_mxdraw"`` |
| `fun` | (`mxdraw`: `MxDrawObject`) => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Triggered when the MXCAD object is ready to be created

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"init_mxcad"`` |
| `fun` | (`mxcad`: [`McObject`](2d.McObject.md)) => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Monitor database modification events

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"databaseModify"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

System variables have been modified

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"sysVarChanged"`` |
| `fun` | (`name`: `string`) => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Graphic database initialization

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"databaseInitialization"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

The layer data has changed

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"layerChanged"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

The line type data has changed

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"lineTypeChanged"`` |
| `fun` | () => `void` |

#### Returns

`void`

▸ **on**(`name`, `fun`): `void`

Object modification event will not be notified by default. Configure the Enable Object Modification Event variable to enable it

#### Parameters

| Name | Type |
| :------ | :------ |
| `name` | ``"objectModified"`` |
| `fun` | (`param`: { `cmd`: `string` ; `entitys`: { `erase`: `boolean` ; `id`: [`McObjectId`](2d.McObjectId.md)  }[]  }) => `void` |

#### Returns

`void`

___

### openWebFile

▸ **openWebFile**(`sFileUrl`, `retCall?`, `isWorkThread?`, `initialParameter?`, `fetchAttributes?`, `isFetchTzFile?`): `boolean`

Open network files

**`Example`**

```ts
import { MxCpp } from "mxcad";
const mxcad = MxCpp.getCurrentMxCAD();
mxcad.openWebFile("http://localhost:1337/mxcad/file/a9cbed3d3a351b79f24484e87bd78338.DWG.mxweb");
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|SFileURL | string | undefined | Network file path|
| `retCall?` |  (iRet: number)=>void | undefined | callback function, optional parameter, callback function after opening the file, parameter is the result of opening the file, 0 indicates success, other values indicate failure|
|IsWorkThread | boolean | true | Whether to use a worker thread to open the file, default to true|
| `initialParameter?` | `object` | `undefined` | - |
| `fetchAttributes` | `number` | `0` | 1： EMSCRIPTEN_FETCH_LOAD_TO_MEMORY, Load the drawing data into memory, 0: EMSCRIPTEN_FETCH_LOAD_TO_MEMORY \| EMSCRIPTEN_FETCH_PERSIST_FILE \| EMSCRIPTEN_FETCH_APPEND， Add the drawing data to IndexedDB|
| `isFetchTzFile` | `boolean` | `true` | - |

#### Returns

`boolean`

Did you successfully open the file

___

### pathCircle

▸ **pathCircle**(`dCenX`, `dCenY`, `dR`, `dPrecision?`, `dWidth?`): `boolean`

Create a path based on a circular object

**`Example`**

```ts
  import { MxCpp, McObject } from "mxcad"
  const mxcad:McObject = MxCpp.getCurrentMxCAD()
  mxcad.pathCircle(0, 0, 20);
```

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `dCenX` | `number` | `undefined` |
| `dCenY` | `number` | `undefined` |
| `dR` | `number` | `undefined` |
| `dPrecision` | `number` | `0.0` |
| `dWidth` | `number` | `0` |

#### Returns

`boolean`

___

### pathLineTo

▸ **pathLineTo**(`dX`, `dY`): `void`

Draw a straight line from the current position to the specified location

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.pathLineTo(100, 300);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX | number | X coordinate|
|DY | number | Y coordinate|

#### Returns

`void`

___

### pathLineToEx

▸ **pathLineToEx**(`dX`, `dY`, `dStartWidth`, `dEndWidth`, `dBulge`): `void`

Draw a straight line from the current position to the specified position, while specifying the starting width, ending width, and convexity

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.pathLineToEx(1000, 500, 30, 0, 0);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX | number | X coordinate|
|DY | number | Y coordinate|
|DStartWidth | number | Starting width|
|DEndWidth | number | End width|
|DBulge | number | convexity|

#### Returns

`void`

___

### pathMakeClosed

▸ **pathMakeClosed**(): `void`

Closed path

#### Returns

`void`

___

### pathMakeExclude

▸ **pathMakeExclude**(`isExclude`): `void`

Mark the current path as an exclusion marker, mainly used for filling and drawing. Dig out the closed area composed of this path in the filling process

**`Example`**

```ts
   import { MxCpp, McObject } from "mxcad"
   const mxcad:McObject = MxCpp.getCurrentMxCAD()
//Draw a solid object with a curved boundary filling, and cut a piece in the middle
   mxcad.pathMoveToEx(440, 3310, 0, 0, 0);
   mxcad.pathLineTo(480, 3310);
   mxcad.pathLineTo(480, 3360);
   mxcad.pathLineTo(450, 3340);
//Fill in the exclusion area with the path definition defined above
   mxcad.pathMakeExclude(true);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|IsExclude | boolean | Exclude or not|

#### Returns

`void`

___

### pathMoveTo

▸ **pathMoveTo**(`dX`, `dY`): `void`

Move the path to the specified location

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.pathMoveTo(0, 300);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX | number | X coordinate|
|DY | number | Y coordinate|

#### Returns

`void`

___

### pathMoveToEx

▸ **pathMoveToEx**(`dX`, `dY`, `dStartWidth`, `dEndWidth`, `dBulge`): `void`

Move the path to the specified location, while specifying the starting width, ending width, and convexity

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.pathMoveToEx(1000, 300, 10, 10, 0);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|DX | number | X coordinate|
|DY | number | Y coordinate|
|DStartWidth | number | Starting width|
|DEndWidth | number | End width|
| `dBulge` | `number` | - |

#### Returns

`void`

___

### redo

▸ **redo**(): `void`

Reverse rollback, redo.

#### Returns

`void`

___

### regen

▸ **regen**(`delayTime?`): `void`

After redrawing all objects on the graph and calling ZoomAll and ZoomW, it may be necessary to delay the call to Regen before it takes effect due to asynchronous execution.

**`Example`**

```ts
import { MxCpp, McObject } from 'mxcad'
 const mxcad:McObject = MxCpp.getCurrentMxCAD()
//Draw a circle with width
   mxcad.addLinetype("CircleLineType", "30,-5,7,-7");

//Design the current line type as' CircleLineType '
   mxcad.drawLinetype = ("CircleLineType");

   mxcad.drawLineWidth = 40;

   mxcad.drawCircle(600, 800, 120);

   mxcad.zoomAll();
   mxcad.regen();
   mxcad.updateDisplay();
```

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `delayTime` | `number` | `0` |

#### Returns

`void`

___

### saveFile

▸ **saveFile**(`filename?`, `call?`, `isDownland?`, `isShowSaveFileDialog?`, `parameter?`): `boolean`

Save file

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.App.getCurrentMxCAD()
const fileName =  mxcad.getCurrentFileName()
mxcad.saveFile("test", (data)=> {
  const blob = new Blob([data.buffer], { type: "application/octet-stream" });
}, false, false)
```

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `filename?` | ` String | undefined | Save as new file name|
| `call?` |  (` data `: ` any `)=>` void ` | ` undefined ` | callback function, optional parameter, callback function after saving the file, parameter is file data|
|IsDownland | boolean | true | Whether to download files, default to true|
|IsShowSaveFileDialogue | boolean | true | Whether to display the save file dialog box, default is true|
| `parameter?` | `object` | `undefined` | - |

#### Returns

`boolean`

Has the file been successfully saved

___

### saveFileToUrl

▸ **saveFileToUrl**(`sSaveProgramUrl`, `call`, `filename?`, `param?`): `boolean`

Save and convert the file to a network path for download

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
 MxCpp.getCurrentMxCAD().saveFileToUrl("http://localhost:1337/mxcad/savefiledwg", (iResult, sserverResult) => {
   let ret = JSON.parse(sserverResult);
   if (ret.ret == "ok") {
       console.log(ret.file)
   }
})
//Save the PDF file.
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
 MxCpp.getCurrentMxCAD().saveFileToUrl("http://localhost:1337/mxcad/savepdf", (iResult, sserverResult) => {
   let ret = JSON.parse(sserverResult);
   if (ret.ret == "ok") {
       console.log(ret.file)
       let saveFileUrl = "http://localhost:1337/mxcad/file/" + ret.file;
       MxTools.downloadFileFromUrl(saveFileUrl, ret.file);
   }
},"",JSON.stringify({ width: "2000", height: "2000" }));
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|SSaveProgramURL | string | Backend POST request interface, specific implementation of the interface: First download the MxDraw cloud map development package< https://www.mxdraw.com/download.html >And unzip and find MxDrawCloudServer \ Bin \ MXCAD \ MXCADSaveFile \ serverless. js. You can find the corresponding implementation interface "/mxcad/savefiledwg", "/mxcad/savefiledwg": save the dwg file to the server "/mxcad/savefile": save the mxweb file to the server "/mxcad/savefdf": save the pdf file to the server. If not found, search for the definition of this interface under this project. It must comply with the definition of this interface to be used as a parameter|
|Call | (iResult: number, ServerResult: string)=>void | Save file result callback. The parameters received here should be based on the location where the drawing is saved according to the interface definition, Ref.file is not the complete request path, it is only the name of the saved drawing|
| `filename?` | `string` | - |
| `param?` | `any` | - |

#### Returns

`boolean`

Has the file been successfully saved

___

### setAttribute

▸ **setAttribute**(`val`): `boolean`

Set some property settings for objects

**`Example`**

```ts
Enable undo
mxcad.setAttribute({EnableUndo:true})
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Val | object | Property setting content 1. Display Precision display precision setting, default is 0, can take 0~10001000 as the highest precision. 2 Enable undo to enable undo function, which is not started by default|

#### Returns

`boolean`

___

### setBrowse

▸ **setBrowse**(`browse`): `void`

Set browsing mode

#### Parameters

| Name | Type |
| :------ | :------ |
| `browse` | `boolean` |

#### Returns

`void`

___

### setCurrentFileName

▸ **setCurrentFileName**(`fileName`): `void`

Set the current file name

#### Parameters

| Name | Type |
| :------ | :------ |
| `fileName` | `string` |

#### Returns

`void`

___

### setCurrentLayout

▸ **setCurrentLayout**(`layoutName`): `void`

Set the current layout name

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|LayoutName | string | Layout Name|

#### Returns

`void`

___

### setCurrentOriginaFileName

▸ **setCurrentOriginaFileName**(`fileName`): `void`

Set the current file name

#### Parameters

| Name | Type |
| :------ | :------ |
| `fileName` | `string` |

#### Returns

`void`

___

### setSysVarDouble

▸ **setSysVarDouble**(`varName`, `val`): `boolean`

Set floating-point values for system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|
|Val | number | Floating point value of variable|

#### Returns

`boolean`

Whether the variable value has been successfully set

___

### setSysVarLong

▸ **setSysVarLong**(`varName`, `val`): `boolean`

Set integer values for system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|
|Val | number | The integer value of a variable|

#### Returns

`boolean`

Whether the variable value has been successfully set

___

### setSysVarPoint

▸ **setSysVarPoint**(`varName`, `pt`): `boolean`

Set the point values of system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|
| `pt` | [`McGePoint3d`](2d.McGePoint3d.md) | - |

#### Returns

`boolean`

Whether the variable value has been successfully set

___

### setSysVarPoint2d

▸ **setSysVarPoint2d**(`varName`, `pt`): `boolean`

Set 2D point values for system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|
| `pt` | [`McGePoint3d`](2d.McGePoint3d.md) | - |

#### Returns

`boolean`

Whether the variable value has been successfully set

___

### setSysVarString

▸ **setSysVarString**(`varName`, `val`): `any`

Set string values for system variables

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|VarName | string | Variable Name|
|Val | string | The string value of the variable|

#### Returns

`any`

Whether the variable value has been successfully set

___

### setViewBackgroundColor

▸ **setViewBackgroundColor**(`red`, `green`, `blue`): `void`

Set the background color of the viewport

**`Example`**

```ts
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.setViewBackgroundColor(255, 255, 255)
```

#### Parameters

| Name | Type |
| :------ | :------ |
| `red` | `number` |
| `green` | `number` |
| `blue` | `number` |

#### Returns

`void`

___

### showLineWeight

▸ **showLineWeight**(`isShow`): `boolean`

Display line weight

#### Parameters

| Name | Type |
| :------ | :------ |
| `isShow` | `boolean` |

#### Returns

`boolean`

___

### undo

▸ **undo**(): `void`

Go back to the previous command or tag

#### Returns

`void`

___

### undoMark

▸ **undoMark**(): `void`

Set a rollback flag at the current time

#### Returns

`void`

___

### updateDisplay

▸ **updateDisplay**(`isImmediate?`, `delayTime?`): `void`

update display

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
|IsImmediate | boolean | false | Update now|
|DelayTime | number | 0 | Delay update time|

#### Returns

`void`

___

### updateLayerDisplayStatus

▸ **updateLayerDisplayStatus**(): `void`

Update the display of layers

#### Returns

`void`

___

### zoomAll

▸ **zoomAll**(`autoRegen?`): `boolean`

Show all

#### Parameters

| Name | Type | Default value |
| :------ | :------ | :------ |
| `autoRegen` | `boolean` | `false` |

#### Returns

`boolean`

___

### zoomAngle

▸ **zoomAngle**(`viewangle`): `void`

Set the angle of the display viewport, in PI units

**`Example`**

```typescript
import { MxCpp, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.zoomAngle(Math.PI / 2)
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Viewangle | number | Rotation angle Math PI |

#### Returns

`void`

void

___

### zoomCenter

▸ **zoomCenter**(`dCenX`, `dCenY`): `void`

Move the current display range to the specified position, dCenX, dCenY are DWG drawing coordinates.

**`Example`**

```typescript
import { MxCpp, McGePoint3d, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.zoomCenter(0, 0)
```

#### Parameters

| Name | Type |
| :------ | :------ |
| `dCenX` | `number` |
| `dCenY` | `number` |

#### Returns

`void`

void

___

### zoomScale

▸ **zoomScale**(`scale`): `void`

Scale the current display range, which is relative to the current display range

**`Example`**

```ts
import { MxCpp, McObject } from 'mxcad'
 const mxcad:McObject = MxCpp.getCurrentMxCAD()
   mxcad.drawLine(350, 220, 600, 220);
   mxcad.zoomScale(o.6);
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|Scale | number | scale scaling ratio|

#### Returns

`void`

void

___

### zoomW

▸ **zoomW**(`minPt`, `maxPt`): `void`

Move the current display range to the specified display range

**`Example`**

```typescript
import { MxApp, McGePoint3d, McObject } from "mxcad"
const mxcad:McObject = MxCpp.getCurrentMxCAD()
mxcad.zoomW(new McGePoint3d(0, 0), new McGePoint3d(30, 30))
```

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
|MinPt | [McGePoint3d] (2d. McGePoint3d. md) | Coordinate 1 McGePoint3d|
|MaxPt | [McGePoint3d] (2d. McGePoint3d. md) | Coordinates 2 McGePoint3d|

#### Returns

`void`

void
